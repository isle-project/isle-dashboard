"use strict";(self.webpackChunkisle_dashboard=self.webpackChunkisle_dashboard||[]).push([[4421],{13222:function(e,t,s){s.d(t,{Ib:function(){return h},Ll:function(){return u},kC:function(){return g},J3:function(){return b},qw:function(){return v},Tm:function(){return E},hA:function(){return k},Vw:function(){return L}});var n=s(98816),o=s.n(n),a=s(14065),i=s(67361),r=s(63163),l=s(63022),c=s(76417),p=s(39285),d=s(1209);function h({title:e,owners:t,announcements:s=[],cohorts:n=[],description:o,enableTicketing:a,_id:i}){return{type:d.WF,payload:{title:e,announcements:s,cohorts:n,description:o,enableTicketing:a,owners:t,_id:i}}}const m=async(e,{title:t,description:s,owners:n,props:a})=>{try{const i=await o().post(l.ZP+"/create_namespace",{title:t,description:s,owners:n});if(!i.data.successful)return(0,c.EG)(e,new Error(i.data.message));const r=i.data.namespace;a.onNamespace(r),e(function(e){return{type:d.$8,payload:{namespace:e}}}(r)),a.history.replace("/lessons"),(0,c.wN)(e,{message:i.data.message,level:i.data.successful?"success":"error"})}catch(i){(0,c.EG)(e,i)}},u=e=>async({title:t,description:s,owners:n,props:o})=>{await m(e,{title:t,description:s,owners:n,props:o})},f=async(e,t,s)=>{try{const n=await o().post(l.ZP+"/delete_namespace",{id:t});s&&s.replace("/lessons"),e(function(e){return{type:d.ke,payload:{id:e}}}(t)),(0,c.wN)(e,{message:n.data.message,level:"success"})}catch(n){return(0,c.EG)(e,n)}},g=e=>async(t,s)=>{await f(e,t,s)},y=async(e,t)=>{try{const s=await o().post(l.ZP+"/update_namespace",{ns:t});e(h(s.data.namespace)),e(function({title:e,owners:t,description:s,enableTicketing:n,_id:o}){return{type:d.Rg,payload:{title:e,description:s,owners:t,enableTicketing:n,_id:o}}}(s.data.namespace)),(0,c.wN)(e,{message:s.data.message,level:"success"}),(0,p.k$)(e,{namespaceID:t._id})}catch(s){(0,c.EG)(e,s)}},b=e=>async(t,s)=>{await y(e,t)},v=e=>async({namespaceID:t,namespaceTitle:s})=>{await(async(e,{namespaceID:t,namespaceTitle:s})=>{try{const e=await o().get(l.ZP+"/get_namespace_actions?"+a.stringify({namespaceID:t})),n=new Blob([e.data],{type:"application/json"}),i=`actions_${s}.json`;(0,r.Z)(n,i)}catch(n){(0,c.EG)(e,n)}})(e,{namespaceID:t,namespaceTitle:s})},w=async(e,{email:t,lessonID:s,namespaceID:n,progress:a,cohort:r})=>{const p=await o().post(l.ZP+"/user_adjust_progress",{email:t,lessonID:s,namespaceID:n,progress:a});(0,c.wN)(e,{title:i.Z.t("common:updated"),message:p.data.message,level:"success"}),e(function({email:e,lessonID:t,progress:s,cohort:n}){return{type:d.LX,payload:{email:e,lessonID:t,progress:s,cohort:n}}}({email:t,lessonID:s,progress:a,cohort:r}))},E=e=>async({email:t,lessonID:s,namespaceID:n,progress:o,cohort:a})=>{await w(e,{email:t,lessonID:s,namespaceID:n,progress:o,cohort:a})},k=e=>async()=>{await(async e=>{try{const t=await o().get(l.ZP+"/get_all_namespaces");e({type:d.XM,payload:{namespaces:t.data.namespaces}})}catch(t){return(0,c.EG)(e,t)}})(e)},L=e=>async({lessons:t,id:s})=>{await(async(e,{lessons:t,id:s})=>{try{await o().post(l.ZP+"/set_lesson_order",{lessons:t,id:s})}catch(n){return(0,c.EG)(e,n)}})(e,{lessons:t,id:s})}},17663:function(e,t){t.Z=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#c49c94","#e377c2","#17becf","#aec7e8","#ffbb78","#ff9896","#98df8a","#7f7f7f","#c5b0d5","#f7b6d2","#bcbd22","#c7c7c7","#dbdb8d","#9edae5"]},74075:function(e,t,s){s.r(t),s.d(t,{default:function(){return qe}});var n=s(38603),o=s(30322),a=s(2561),i=s.n(a),r=s(58651),l=s(91532),c=s.n(l),p=s(90192),d=s(12630),h=s(12908),m=s(69977),u=s(22949),f=s.n(u),g=s(89506),y=s.n(g),b=s(64817),v=s.n(b),w=s(32174),E=s.n(w),k=s(87324),L=s.n(k);var Z=(0,s(221).Z)((()=>s.e(7979).then(s.bind(s,97979)))),D=s(39029);var C=(0,o.$j)((function(e){return{admin:e.admin,user:e.user}}),(function(e){return{copyLesson:(0,D.Vo)(e)}}))(Z),N=s(85480),I=s(60805),R=s(60112),q=s(14224),T=s(74360),F=s.n(T),x=s(87078),S=s(47331),P=s(56233),_=s(72454),A=s(14704),U=s(71128),O=s(15138),M=s.n(O),j=s(63022);function $(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const G=i()("isle-dashboard");function B(e){e.stopPropagation()}class H extends n.Component{constructor(e){let t,s,n,o;super(e),$(this,"handleInputChange",(e=>{const t=e.target,s=t.value,n=t.name;G(`Input field ${n} changed to ${s}`),this.setState({[n]:s},(()=>{this.state.title.length>=3&&this.state.description.length>0?this.setState({disabled:!1}):this.setState({disabled:!0})}))})),$(this,"handleUnlockChange",(e=>{this.setState({unlockLesson:e.target.checked})})),$(this,"handleLockChange",(e=>{this.setState({lockLesson:e.target.checked})})),$(this,"handleTimeUntilChange",(e=>{this.setState({lockUntil:e})})),$(this,"handleTimeAfterChange",(e=>{this.setState({lockAfter:e})})),$(this,"handleTemplateChange",(e=>{this.setState({template:e.target.checked,changedTemplate:!0})})),$(this,"hideFromDashboardChange",(e=>{this.setState({hideFromDashboard:e.target.checked})})),$(this,"onSubmit",(e=>{e.preventDefault();const t={newTitle:this.state.title,newDescription:this.state.description};this.state.unlockLesson&&(t.lockUntil=this.state.lockUntil),this.state.lockLesson&&(t.lockAfter=this.state.lockAfter),this.state.hideFromDashboard!==this.props.hideFromDashboard&&(t.hideFromDashboard=this.state.hideFromDashboard),this.state.changedTemplate&&(t.template=this.state.template),this.props.update(t)})),e.lockUntil?(t=!0,n=e.lockUntil):(t=!1,n=new Date),e.lockAfter?(s=!0,o=e.lockAfter):(s=!1,o=new Date),this.state={title:e.title,description:e.description,disabled:!1,hideFromDashboard:e.hideFromDashboard,template:e.template,changedTemplate:!1,unlockLesson:t,lockUntil:n,lockLesson:s,lockAfter:o}}componentDidUpdate(e){const t={};e.title!==this.props.title&&(t.title=this.props.title),e.description!==this.props.description&&(t.description=this.props.description),e.template!==this.props.template&&(t.template=this.props.template),e.lockUntil!==this.props.lockUntil&&(this.props.lockUntil?(t.unlockLesson=!0,t.lockUntil=this.props.lockUntil):(t.unlockLesson=!1,t.lockUntil=new Date)),e.lockAfter!==this.props.lockAfter&&(this.props.lockAfter?(t.lockLesson=!0,t.lockAfter=this.props.lockAfter):(t.lockLesson=!1,t.lockAfter=new Date)),M()(t)||this.setState(t)}render(){const{t:e}=this.props;return n.createElement(A.Z,{show:this.props.show,onHide:this.props.close},n.createElement(_.Z,{action:j.ZP,method:"get",onSubmit:this.onSubmit,onKeyDown:B},n.createElement(A.Z.Header,null,n.createElement(A.Z.Title,{as:"h3"},e("lesson-details"))),n.createElement(A.Z.Body,null,n.createElement(P.Z,null,n.createElement(S.Z,null,e("common:title")),n.createElement(x.Z,{name:"title",type:"title",onChange:this.handleInputChange,defaultValue:this.state.title})),n.createElement(P.Z,null,n.createElement(S.Z,null,e("common:description")),n.createElement(x.Z,{name:"description",type:"description",onChange:this.handleInputChange,defaultValue:this.state.description})),n.createElement(P.Z,null,n.createElement(_.Z.Check,{type:"checkbox",label:e("common:lock-until"),checked:this.state.unlockLesson,onChange:this.handleUnlockChange}),n.createElement("div",null,this.state.unlockLesson?n.createElement(U.Z,{minDate:new Date,onChange:this.handleTimeUntilChange,value:this.state.lockUntil,clearIcon:null}):null)),n.createElement(P.Z,null,n.createElement(_.Z.Check,{type:"checkbox",label:e("common:lock-after"),checked:this.state.lockLesson,onChange:this.handleLockChange}),n.createElement("div",null,this.state.lockLesson?n.createElement(U.Z,{minDate:new Date,onChange:this.handleTimeAfterChange,value:this.state.lockAfter,clearIcon:null}):null)),n.createElement(P.Z,null,n.createElement(_.Z.Check,{type:"checkbox",label:e("common:hide-from-dashboard"),checked:this.state.hideFromDashboard,onChange:this.hideFromDashboardChange})),this.props.user.administrator?n.createElement(P.Z,null,n.createElement(_.Z.Check,{type:"checkbox",label:e("provide-as-template"),checked:this.state.template,onChange:this.handleTemplateChange})):null),n.createElement(A.Z.Footer,null,n.createElement(d.Z,{onClick:this.props.close},e("common:cancel")),n.createElement(d.Z,{variant:"success",type:"submit",disabled:this.state.disabled},e("common:save")))))}}H.propTypes={close:c().func.isRequired,description:c().string.isRequired,hideFromDashboard:c().bool,lockAfter:c().instanceOf(Date),lockUntil:c().instanceOf(Date),show:c().bool.isRequired,template:c().bool,title:c().string.isRequired,update:c().func.isRequired,user:c().object.isRequired},H.defaultProps={hideFromDashboard:!1,lockAfter:null,lockUntil:null,template:null};var K=H;const V=e=>n.createElement(A.Z,{show:e.show,onHide:e.close},n.createElement(A.Z.Header,null,n.createElement(A.Z.Title,null,e.t("common:delete"),"?")),n.createElement(A.Z.Body,null,e.t("delete-modal-body",{name:e.title})),n.createElement(A.Z.Footer,null,n.createElement(d.Z,{onClick:e.close},e.t("common:cancel")),n.createElement(d.Z,{variant:"danger",onClick:e.delete},e.t("common:delete"))));V.propTypes={close:c().func.isRequired,delete:c().func.isRequired,show:c().bool.isRequired,t:c().func.isRequired,title:c().string.isRequired};var z=V,W=s(17663),X=s(27316),J=s(30573);function Q(){return Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},Q.apply(this,arguments)}function Y(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ee=i()("isle:lessons-page:lesson"),te=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document;function se(e){e.target.src=X}class ne extends n.Component{constructor(e){super(e),Y(this,"toggleLessonState",(()=>{const e={lessonName:this.props.title,namespaceName:this.props.namespace};this.props.active?this.props.deactivateLesson(e):this.props.activateLesson(e)})),Y(this,"toggleLessonVisibility",(()=>{const e={lessonName:this.props.title,namespaceName:this.props.namespace};this.props.public?this.props.hideLessonInGallery(e):this.props.showLessonInGallery(e)})),Y(this,"delete",(()=>{this.props.deleteLesson({lessonName:this.props.title,namespaceName:this.props.namespace}),this.closeDeleteModal()})),Y(this,"update",(async({newTitle:e,newDescription:t,lockAfter:s,lockUntil:n,hideFromDashboard:o,template:a})=>{await this.props.updateLesson({lessonName:this.props.title,namespaceName:this.props.namespace,newTitle:e,newDescription:t,template:a,lockAfter:s?s.getTime():null,lockUntil:n?n.getTime():null,hideFromDashboard:o})&&this.closeDetailsModal()})),Y(this,"showDeleteModal",(()=>{this.setState({showDeleteModal:!0})})),Y(this,"showDetailsModal",(()=>{this.setState({showDetailsModal:!0})})),Y(this,"closeDeleteModal",(()=>{this.setState({showDeleteModal:!1})})),Y(this,"closeDetailsModal",(()=>{this.setState({showDetailsModal:!1})})),Y(this,"getIsleFile",(async()=>{if(ee("Request ISLE source code from server..."),!this.state.isleFile){const e=await this.props.getIsleFile({lessonName:this.props.title,namespaceName:this.props.namespace});e&&this.setState({isleFile:e})}})),Y(this,"copyIsleFileToClipboard",(()=>{if(!this.state.isleFile)return this.props.addNotification({message:this.props.t("source-file-error"),level:"error"});F()(this.state.isleFile).then((()=>{this.props.addNotification({message:this.props.t("source-file-copied"),level:"success"})})).catch((e=>{this.props.addNotification({message:e.message,level:"error"})}))})),Y(this,"copyLinkToClipboard",(()=>{F()(this.props.url).then((()=>{this.props.addNotification({message:this.props.t("link-copied"),level:"success"})})).catch((e=>{this.props.addNotification({message:e.message,level:"error"})}))})),Y(this,"copyNameToClipboard",(e=>{e.stopPropagation();F()(this.props.title).then((()=>{this.props.addNotification({message:this.props.t("name-copied"),level:"success"})})).catch((e=>{this.props.addNotification({message:e.message,level:"error"})}))})),Y(this,"showPreviewImage",(()=>{this.img.src=this.props.url+"/preview.jpg"})),Y(this,"openLesson",(()=>{if(te)window.location=this.props.url;else{window.open(this.props.url,"_blank").focus()}})),this.state={showDeleteModal:!1,showDetailsModal:!1,isleFile:null}}renderButtonToolbarDate(){const{t:e}=this.props;let t=new Date(this.props.updatedAt);t=t.toLocaleDateString();let s=new Date(this.props.createdAt);return s=s.toLocaleDateString(),n.createElement("span",{className:"lessons-upload"},n.createElement(h.Z,{placement:"top",overlay:n.createElement(m.Z,{id:"toggle_visibility"},e("created-at"))},n.createElement("span",{className:"lessons-uploaded-image"},n.createElement("img",{alt:"Upload Date Icon",style:{stroke:"white",fill:"red"},src:J}))),n.createElement(h.Z,{placement:"top",overlay:n.createElement(m.Z,{id:"toggle_visibility"},e("last-updated"),t)},n.createElement("span",{className:"lessons-uploaded"},s)))}renderActivateButton(){const{lockUntil:e,t:t}=this.props,s=!0===this.props.active?"success":"warning";return e?n.createElement(h.Z,{placement:"top",overlay:n.createElement(m.Z,{id:"lockUntil_disabled"},t("scheduled-at",{date:e.toLocaleString()}))},n.createElement(N.Z,{className:"lessons-status",variant:s,style:{opacity:.3}},this.props.active?t("active"):t("inactive"))):n.createElement(h.Z,{placement:"top",overlay:n.createElement(m.Z,{id:"toggle_availability"},this.props.active?t("disable-lesson"):t("activate-lesson"))},n.createElement(N.Z,{className:"lessons-status",onClick:this.toggleLessonState,variant:s},this.props.active?t("active"):t("inactive")))}renderButtonToolbar(){const{t:e}=this.props,t=!0===this.props.public?"success":"warning";return n.createElement(R.Z,{className:"lesson-button-toolbar"},n.createElement(I.Z,{style:{marginRight:"5px"}},n.createElement(h.Z,{placement:"top",overlay:n.createElement(m.Z,{id:"open_details"},e("open-details"))},n.createElement(d.Z,{size:"sm",variant:"secondary",onClick:this.showDetailsModal,"aria-label":e("open-details")},n.createElement("i",{className:"fa fa-cog"}))),n.createElement(h.Z,{placement:"top",overlay:n.createElement(m.Z,{id:"delete_lesson"},e("delete-lesson"))},n.createElement(d.Z,{size:"sm",variant:"secondary",onClick:this.showDeleteModal,"aria-label":e("delete-lesson")},n.createElement("i",{className:"fa fa-trash-alt"}))),n.createElement(h.Z,{placement:"top",overlay:n.createElement(m.Z,{id:"isle-file"},e("copy-file"))},n.createElement(d.Z,{variant:"secondary",size:"sm",onFocus:this.getIsleFile,onMouseEnter:this.getIsleFile,onClick:this.copyIsleFileToClipboard,style:{float:"right"},"aria-label":e("copy-file")},n.createElement("i",{className:"fa fa-clipboard"})))),this.renderActivateButton(),n.createElement(h.Z,{placement:"top",overlay:n.createElement(m.Z,{id:"toggle_visibility"},this.props.public?e("remove-from-gallery"):e("show-in-gallery"))},n.createElement(N.Z,{className:"lessons-status",onClick:this.toggleLessonVisibility,variant:t},this.props.public?e("public"):e("private"))),this.renderButtonToolbarDate())}renderModals(){return n.createElement(n.Fragment,null,n.createElement(z,Q({},this.props,{show:this.state.showDeleteModal,close:this.closeDeleteModal,delete:this.delete})),this.state.showDetailsModal?n.createElement(K,Q({},this.props,{show:this.state.showDetailsModal,close:this.closeDetailsModal,update:this.update})):null)}render(){const{t:e}=this.props;return n.createElement(q.Z,{className:"animated-lesson-card"},n.createElement(q.Z.Body,{style:{padding:0,opacity:this.props.hideFromDashboard?.6:1}},n.createElement("div",{style:{filter:"grayscale(30%)",background:W.Z[this.props.colorIndex]},className:"hovereffect",onMouseOver:this.showPreviewImage,onFocus:this.showPreviewImage},n.createElement("img",{className:"img-responsive",src:X,ref:e=>{this.img=e},alt:"",style:{width:"100%",height:180},onError:se}),n.createElement("div",{className:"overlay",style:{cursor:"cell"}},n.createElement("h2",null,n.createElement(h.Z,{placement:"top",overlay:n.createElement(m.Z,{id:"copy_name"},e("common:copy-name"))},n.createElement("span",{className:"lesson-title-button",role:"button",tabIndex:0,onClick:this.copyNameToClipboard,onKeyPress:this.copyNameToClipboard},this.props.title))),"No description supplied."!==this.props.description?n.createElement("h3",null,this.props.description):null,n.createElement("span",{ref:e=>{this.link=e},className:"info",onClick:this.openLesson,onKeyPress:this.openLesson,tabIndex:0,role:"button"},e("open-lesson")))),n.createElement(h.Z,{placement:"top",overlay:n.createElement(m.Z,{id:"copy_link"},e("common:copy-link"))},n.createElement("i",{role:"button",tabIndex:0,className:"lesson-link-icon fas fa-external-link-alt",onClick:this.copyLinkToClipboard,onKeyPress:this.copyLinkToClipboard,"aria-label":e("common:copy-link")})),this.renderButtonToolbar(),this.renderModals()))}}ne.propTypes={activateLesson:c().func.isRequired,active:c().bool.isRequired,addNotification:c().func.isRequired,colorIndex:c().number.isRequired,createdAt:c().any.isRequired,deactivateLesson:c().func.isRequired,deleteLesson:c().func.isRequired,description:c().string.isRequired,getIsleFile:c().func.isRequired,getLessons:c().func.isRequired,hideFromDashboard:c().bool.isRequired,hideLessonInGallery:c().func.isRequired,lockAfter:c().instanceOf(Date),lockUntil:c().instanceOf(Date),namespace:c().string.isRequired,public:c().bool.isRequired,showLessonInGallery:c().func.isRequired,title:c().string.isRequired,updateLesson:c().func.isRequired,updatedAt:c().any.isRequired,url:c().string.isRequired,user:c().object.isRequired},ne.defaultProps={lockAfter:null,lockUntil:null};var oe=(0,r.Z)(["lesson","common"])(ne),ae=s(92639),ie=s(70658),re=s.n(ie),le=s(2078),ce=s.n(le),pe=s(34980);function de(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function he(e){e.target.src=X}class me extends n.Component{constructor(e){super(e),de(this,"showPreviewImage",(()=>{this.img.src=this.props.url+"/preview.jpg"})),de(this,"openLesson",(()=>{window.open(this.props.url,"_blank").focus()})),de(this,"copyLinkToClipboard",(()=>{F()(this.props.url).then((()=>{this.props.addNotification({message:this.props.t("link-copied"),level:"success"})})).catch((e=>{this.props.addNotification({message:e.message,level:"error"})}))})),this.state={}}renderProgress(){let e;if(this.props.metadata&&!0===this.props.metadata.hideProgressBar)return n.createElement("div",{className:"enrolled-lesson-progress"});const t=this.props.user.lessonData[this.props._id];t?(e=t.progress,e*=100,e=ce()(re()(e),100)):e=0;const{t:s}=this.props;return n.createElement("div",{className:"enrolled-lesson-progress"},n.createElement(h.Z,{placement:"top",overlay:n.createElement(m.Z,{id:"open_details"},s("your-progress"))},n.createElement(ae.Z,{"aria-label":s("your-progress"),variant:"success",now:e,label:`${e}%`})))}renderButtonToolbar(){let e;const t=this.props.user.lessonData[this.props._id];e=t?t.spentTime:0;const{t:s}=this.props;return n.createElement(R.Z,{style:{position:"absolute",top:180,width:"100%",height:"36px",background:"rgba(0, 0, 0, 0.75)"}},this.renderProgress(),n.createElement("div",{className:"enrolled-lesson-time",style:{width:"35%",height:"100%"}},n.createElement(h.Z,{placement:"top",overlay:n.createElement(m.Z,{id:"open_details"},s("time-format"))},n.createElement("span",null,s("time-spent"),": ",(0,pe.Z)(e)))))}render(){const{t:e}=this.props;return n.createElement(q.Z,{className:"animated-lesson-card"},n.createElement(q.Z.Body,{style:{padding:0}},n.createElement("div",{style:{filter:"grayscale(30%)",background:W.Z[this.props.colorIndex]},onMouseOver:this.showPreviewImage,onFocus:this.showPreviewImage,className:"hovereffect"},n.createElement("img",{className:"img-responsive",src:X,ref:e=>{this.img=e},alt:"",style:{width:"100%",height:180},onError:he}),n.createElement("div",{className:"overlay"},n.createElement("h2",null,this.props.title),"No description supplied."!==this.props.description?n.createElement("h3",null,this.props.description):null,n.createElement("span",{ref:e=>{this.link=e},className:"info",role:"button",tabIndex:0,onClick:this.openLesson,onKeyPress:this.openLesson},e("open-lesson")))),n.createElement(h.Z,{placement:"top",overlay:n.createElement(m.Z,{id:"copy_link"},e("common:copy-link"))},n.createElement("i",{role:"button",tabIndex:0,className:"lesson-link-icon fas fa-external-link-alt",onClick:this.copyLinkToClipboard,onKeyPress:this.copyLinkToClipboard,"aria-label":e("common:copy-link")})),this.renderButtonToolbar()))}}me.propTypes={_id:c().string.isRequired,addNotification:c().func.isRequired,colorIndex:c().number.isRequired,description:c().string.isRequired,metadata:c().object,title:c().string.isRequired,url:c().string.isRequired,user:c().object.isRequired},me.defaultProps={metadata:null};var ue=(0,r.Z)(["lesson","common"])(me),fe=s(79298);var ge=(0,r.Z)(["lessons_page","common"])((e=>{const{user:t,t:s}=e;let o=null;return o=t.writeAccess?n.createElement("span",null,s("create-new-one"),n.createElement("i",{className:"fa fa-pencil-alt"}),"."):" .",n.createElement(fe.Z,{className:"lessons-jumbotron"},n.createElement("h1",null,s("common:no-course-selected")),n.createElement("p",null,s("no-course-description"),n.createElement("i",{className:"fa fa-align-justify"}),o))}));var ye=(0,r.Z)(["lessons_page","common"])((e=>{const{user:t,t:s}=e;let o=s("no-lessons");return t.writeAccess&&(o+=s("upload-from-editor")),n.createElement(fe.Z,{className:"lessons-jumbotron"},n.createElement("h1",null,s("no-lessons-found")),n.createElement("p",null,o))})),be=s(24435),ve=s(71169);s(50561),s(19223),s(6525);function we(){return we=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},we.apply(this,arguments)}function Ee(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ke=i()("isle-dashboard:lessons-page"),Le=(0,p.WidthProvider)(p.Responsive);function Ze(e,t){if(!t)return e;const s=[];if(f()(e))for(let n=0;n<e.length;n++)(y()(v()(e[n].title),t)||y()(v()(e[n].description),t))&&s.push(e[n]);return s}function De(e){ke("Create layout...");const t=3.52;let s=e.map(((e,s)=>({lg:{i:`cell-${e.title}-${s}`,x:4*s%24,y:L()(s/6)*t,w:4,h:t},md:{i:`cell-${e.title}-${s}`,x:4*s%20,y:L()(s/5)*t,w:4,h:t},sm:{i:`cell-${e.title}-${s}`,x:4*s%16,y:L()(s/4)*t,w:4,h:t},xs:{i:`cell-${e.title}-${s}`,x:4*s%12,y:L()(s/3)*t,w:4,h:t},xxs:{i:`cell-${e.title}-${s}`,x:4*s%8,y:L()(s/2)*t,w:4,h:t},tiny:{i:`cell-${e.title}-${s}`,x:4*s%4,y:L()(s/1)*t,w:4,h:t}})));return s={lg:E()(s,"lg"),md:E()(s,"md"),sm:E()(s,"sm"),xs:E()(s,"xs"),xxs:E()(s,"xxs"),tiny:E()(s,"tiny")},s}class Ce extends n.Component{constructor(e){super(e),Ee(this,"preventOpeningLink",(e=>{e.preventDefault()})),Ee(this,"handlePositionChangeFactory",(e=>t=>{let s=!1;switch(t.code){case"ArrowLeft":s=!0,this.repositionLessons(e,"left");break;case"ArrowRight":s=!0,this.repositionLessons(e,"right")}s&&(t.preventDefault(),t.stopPropagation())})),Ee(this,"toggleCreator",(()=>{this.props.getTemplateLessons(),this.setState({showLessonCreator:!this.state.showLessonCreator})})),Ee(this,"handleCreate",(()=>{this.setState({showLessonCreator:!1});const e=this.props.namespace;e.title&&(ke("Fetch lessons..."),this.props.getLessons(e.title))}));let t=e.namespace.lessons;(0,ve.Z)(e.user,e.namespace)||(ke("Filter out inactive or hidden lessons for enrolled students..."),t=t.filter((e=>!0===e.active&&!0!==e.hideFromDashboard))),this.state={filteredLessons:Ze(t,e.search.phrase),layouts:De(t),unfilteredLessons:t,search:e.search,activeElement:null,showLessonCreator:!1}}static getDerivedStateFromProps(e,t){if(e.namespace.lessons!==t.unfilteredLessons||e.search.phrase!==t.search.phrase||e.search.direction!==t.search.direction||e.search.type!==t.search.type){ke("Get derived state...");let t=e.namespace.lessons||[];(0,ve.Z)(e.user,e.namespace)||(ke("Filter out inactive or hidden lessons for enrolled students..."),t=t.filter((e=>!0===e.active&&!0!==e.hideFromDashboard)));const s=Ze(t,e.search.phrase);(0,be.Z)(s,e.search);return{filteredLessons:s,layouts:De(s),unfilteredLessons:e.namespace.lessons,search:e.search}}return null}componentDidMount(){ke("Component did mount...");const e=this.props.namespace;e.title&&(ke("Fetch lessons..."),this.props.getLessons(e.title))}shouldComponentUpdate(e,t){return(e.search.direction!==this.props.search.direction||e.search.type!==this.props.search.type||t.filteredLessons!==this.state.filteredLessons||t.showLessonCreator!==this.state.showLessonCreator)&&(ke("Should update page..."),!0)}repositionLessons(e,t){const s=this.state.unfilteredLessons.slice();if("left"===t){if(e>0){const t=s[e],n=s[e-1],o=n.pos;n.pos=t.pos,t.pos=o}}else if("right"===t&&e<s.length-1){const t=s[e],n=s[e+1],o=n.pos;n.pos=t.pos,t.pos=o}const n=Ze(s,this.props.search.phrase);(0,be.Z)(n,this.props.search);const o=De(n);this.setState({filteredLessons:n,layouts:o,unfilteredLessons:s},this.forceUpdate),this.props.setLessonOrder({id:this.props.namespace._id,lessons:s.map((e=>e._id))})}renderLessons(){let e=this.state.filteredLessons;return(0,ve.Z)(this.props.user,this.props.namespace)?e.map(((t,s)=>{const o=n.createElement(oe,we({},e[s],{addNotification:this.props.addNotification,deleteLesson:this.props.deleteLesson,updateLesson:this.props.updateLesson,deactivateLesson:this.props.deactivateLesson,activateLesson:this.props.activateLesson,showLessonInGallery:this.props.showLessonInGallery,hideLessonInGallery:this.props.hideLessonInGallery,getLessons:this.props.getLessons,getIsleFile:this.props.getIsleFile,user:this.props.user}));return"sequentially"===this.props.search.type?n.createElement("div",{className:"lesson-grid-item",key:`cell-${t.title}-${s}`,tabIndex:0,role:"button",ref:e=>(e&&this.state.activeElement===t.title&&e.focus(),e),onKeyDown:this.handlePositionChangeFactory(s),onFocus:()=>{this.setState({activeElement:t.title})}},o):n.createElement("div",{className:"lesson-grid-item",key:`cell-${t.title}-${s}`},o)})):e.map(((t,s)=>n.createElement("div",{className:"lesson-grid-item",key:`cell-${t.title}-${s}`},n.createElement(ue,we({},e[s],{addNotification:this.props.addNotification,user:this.props.user})))))}render(){if(!this.props.namespace.title)return n.createElement(ge,{user:this.props.user});let e=this.state.filteredLessons;if(f()(e)){const t=n.createElement(h.Z,{placement:"left",overlay:n.createElement(m.Z,{id:"create-from-template-tooltip"},this.props.t("create-from-template"))},n.createElement(d.Z,{"aria-label":this.props.t("create-from-template"),className:"create-from-template-button",onClick:this.toggleCreator},n.createElement("i",{className:"fas fa-plus"})));return 0===e.length?n.createElement(n.Fragment,null,n.createElement(ye,{user:this.props.user}),t,this.state.showLessonCreator?n.createElement(C,{onHide:this.toggleCreator,onCreate:this.handleCreate,namespace:this.props.namespace}):null):n.createElement(n.Fragment,null,n.createElement("div",{className:"lessons-grid-container"},n.createElement(Le,{layouts:this.state.layouts,breakpoints:{lg:1800,md:1550,sm:1200,xs:900,xxs:400,tiny:0},cols:{lg:24,md:20,sm:16,xs:12,xxs:8,tiny:4},containerPadding:[10,10],isResizable:!1,isBounded:!0,isDraggable:!1,rowHeight:(0,ve.Z)(this.props.user,this.props.namespace)?54.5:55},this.renderLessons()),t),this.state.showLessonCreator?n.createElement(C,{onHide:this.toggleCreator,onCreate:this.handleCreate,namespace:this.props.namespace}):null)}}}Ce.propTypes={activateLesson:c().func.isRequired,addNotification:c().func.isRequired,deactivateLesson:c().func.isRequired,deleteLesson:c().func.isRequired,getIsleFile:c().func.isRequired,getLessons:c().func.isRequired,getTemplateLessons:c().func.isRequired,hideLessonInGallery:c().func.isRequired,namespace:c().object.isRequired,search:c().object.isRequired,setLessonOrder:c().func.isRequired,showLessonInGallery:c().func.isRequired,updateLesson:c().func.isRequired,url:c().string,user:c().object.isRequired},Ce.defaultProps={url:null};var Ne=(0,r.Z)(["lessons_page","common"])(Ce),Ie=s(13222),Re=s(76417);var qe=(0,o.$j)((function(e){return{search:e.search,user:e.user,namespace:e.namespace}}),(function(e){return{addNotification:(0,Re.pP)(e),showLessonInGallery:(0,D.IH)(e),hideLessonInGallery:(0,D.kl)(e),activateLesson:(0,D.to)(e),deactivateLesson:(0,D.Ek)(e),updateLesson:(0,D.WU)(e),deleteLesson:(0,D.q2)(e),getLessons:(0,D.Hy)(e),getTemplateLessons:(0,D.BO)(e),getIsleFile:(0,D.OD)(e),setLessonOrder:(0,Ie.Vw)(e)}}))(Ne)},63163:function(e,t){const s=/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i;function n(e){setImmediate((function(){throw e}),0)}function o(e){return s.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}const a=function(e){if("undefined"===typeof e||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))return;function t(){return e.URL||e.webkitURL||e}function s(e){setTimeout((function(){"string"===typeof e?t().revokeObjectURL(e):e.remove()}),4e4)}const a=e.document.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in a,r=/constructor/i.test(e.HTMLElement)||e.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent),c=e.setImmediate||e.setTimeout;function p(p,d,h){h||(p=o(p));const m=this,u="application/octet-stream"===p.type;let f;function g(){!function(e,t,s){let o=(t=[].concat(t)).length;for(;o--;){let i=e["on"+t[o]];if("function"===typeof i)try{i.call(e,s||e)}catch(a){n(a)}}}(m,"writestart progress write writeend".split(" "))}if(m.readyState=m.INIT,i)return f=t().createObjectURL(p),void c((function(){a.href=f,a.download=d,function(e){const t=new MouseEvent("click");e.dispatchEvent(t)}(a),g(),s(f),m.readyState=m.DONE}),0);!function(){if((l||u&&r)&&e.FileReader){const t=new FileReader;return t.onloadend=function(){let s=l?t.result:t.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(s,"_blank")||(e.location.href=s),s=void 0,m.readyState=m.DONE,g()},t.readAsDataURL(p),void(m.readyState=m.INIT)}if(f||(f=t().createObjectURL(p)),u)e.location.href=f;else{e.open(f,"_blank")||(e.location.href=f)}m.readyState=m.DONE,g(),s(f)}()}const d=p.prototype;return"undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,s){return t=t||e.name||"download",s||(e=o(e)),navigator.msSaveOrOpenBlob(e,t)}:(d.abort=function(){},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=null,d.onwritestart=null,d.onprogress=null,d.onwrite=null,d.onabort=null,d.onerror=null,d.onwriteend=null,function(e,t,s){return new p(e,t||e.name||"download",s)})}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||(void 0).content);t.Z=a},34980:function(e,t,s){var n=s(87324),o=s.n(n);t.Z=(e,t={hours:!0,minutes:!0,seconds:!0})=>{e/=1e3;const s=o()(e/3600);e%=3600;let n=o()(e/60);n<10&&(n="0"+n),e%=60;let a=o()(e);a<10&&(a="0"+a);let i="";return t.hours&&(i+=s),t.minutes&&(i&&(i+=":"),i+=n),t.seconds&&(i&&(i+=":"),i+=a),i}},71169:function(e,t,s){var n=s(14478),o=s.n(n);t.Z=function(e,t){let s=!1;for(let n=0;n<t.owners.length;n++){const a=t.owners[n];o()(a)?a.email===e.email&&(s=!0):a===e.id&&(s=!0)}return s}},24435:function(e,t){const s={numeric:!0};t.Z=function(e,t){const{type:n,direction:o}=t;"sequentially"===n?"ascending"===o?e.sort(((e,t)=>e.pos-t.pos)):e.sort(((e,t)=>t.pos-e.pos)):"alphabetically"===n?"ascending"===o?e.sort(((e,t)=>{const n=e.namespace+e.title,o=t.namespace+t.title;return n.localeCompare(o,void 0,s)})):e.sort(((e,t)=>{const n=e.namespace+e.title;return(t.namespace+t.title).localeCompare(n,void 0,s)})):"created_at"===n?"ascending"===o?e.sort(((e,t)=>e.createdAt.localeCompare(t.createdAt,void 0,s))):e.sort(((e,t)=>t.createdAt.localeCompare(e.createdAt,void 0,s))):"updated_at"===n&&("ascending"===o?e.sort(((e,t)=>e.updatedAt.localeCompare(t.updatedAt,void 0,s))):e.sort(((e,t)=>t.updatedAt.localeCompare(e.updatedAt,void 0,s))))}},50561:function(){},30573:function(e,t,s){e.exports=s.p+"static/media/4da50dc471c73bebdc8e.svg"},27316:function(e,t,s){e.exports=s.p+"static/media/c9df90fc9571de99a51f.jpeg"}}]);
//# sourceMappingURL=4421.3069d8b7.chunk.js.map