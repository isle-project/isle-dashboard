"use strict";(self.webpackChunkisle_dashboard=self.webpackChunkisle_dashboard||[]).push([[4331],{419:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var o=n(38603),r=n(91532),l=n.n(r),a=n(38564),s=n.n(a),c=n(52458),i=n(39446),u=n(46832),m=n(26516),d=n(61092),g=n(52734);class p extends o.Component{render(){return o.createElement("button",{onClick:this.props.onClick})}}p.propTypes={onClick:l().func},p.defaultProps={onClick(){}};var h=g||p;const f=s()("isle:voice-input");const w=e=>{const{autorecord:t,bind:r,defaultValue:l,grammars:a,id:s,maxAlternatives:g,remote:p,startTooltip:w,stopTooltip:b,speechInterface:v,onChange:k,onClick:C,onFinalText:y,onRecordingStart:S,onRecordingStop:E,onSegment:x,onSubmit:N,timeout:R}=e,[T,F]=(0,o.useState)(t),A=(0,o.useContext)(m.Z),{t:P}=(0,c.$)("input"),[Z,$]=(0,o.useState)(r&&A.state?A.state[r]:l),V=(0,o.useRef)(),j=(0,o.useRef)(),I=(0,o.useCallback)((e=>{const t=e.target.value;$(t),k(t),r&&n.g.lesson.setState({[r]:t})}),[r,k]),O=(0,o.useCallback)((e=>{if(13===e.keyCode)N(Z)}),[Z,N]),Y=(0,o.useCallback)((()=>{f("Set `isRecording` to false..."),F(!1),V.current&&V.current.stop(),E()}),[E]),_=(0,o.useCallback)((()=>{V.current=null;const e=window.SpeechRecognition||window.webkitSpeechRecognition;if(e){const t=new e;t.lang=d.a.language,t.continuous=!0,t.interimResults=!0,t.maxAlternatives=g,t.grammars=function(e){const t=t||webkitSpeechGrammarList,n=new t;for(let o=0;o<e.length;o++){const{src:t,weight:r}=e[o];n.addFromString(t,r)}return n}(a),t.onerror=e=>{if(f("Encountered an error..."),"not-allowed"===e.error||"service-not-allowed"===e.error)return F(!1),A.addNotification({title:"Not allowed",message:"No permission to use the speech recognition service",level:"error",position:"tr"});try{t.start()}catch(n){f(n)}},t.onend=()=>{f("onend: %s",s),T&&t.start()},t.onstart=()=>{f("onstart: %s",s),S()},t.onresult=e=>{if(f("Processing result..."),"undefined"!==typeof e.results)for(let t=e.resultIndex;t<e.results.length;++t){const n=e.results[t];if(e.results[t].isFinal){let e;if(R&&(j.current=setTimeout(Y,R)),f("Received final text"),g>1){e=new Array(n.length);for(let t=0;t<n.length;t++)e[t]=n[t].transcript}else e=n[0].transcript;$(e),y(e),v&&v.check(e,{onStart:()=>{Y()},onEnd:()=>{_()}})}else{let e;if(j.current&&clearTimeout(j.current),g>1){e=new Array(n.length);for(let t=0;t<n.length;t++)e[t]=n[t].transcript}else e=n[0].transcript;$(e),x(e)}}else f("Something went wrong...")},t.start(),V.current=t}f("Set `isRecording` to true..."),F(!0)}),[a,s,T,g,S,A,v,Y,R,y,x]),B=(0,o.useCallback)((e=>{let t="";return t=e?!0===T?b||P("click-to-stop-recording"):w||P("click-to-start-recording"):"Your browser does not support voice recognition. You may use the Chrome Browser instead",t}),[T,w,b,P]);(0,o.useEffect)((()=>{p&&(window.onkeydown=e=>{switch(e.keyCode){case p.stop:Y();break;case p.start:T||_();break;case p.toggle:T?Y():_()}}),t&&(f("Should record voice..."),_())}),[t,p,T,_,Y]);const D=(0,o.useCallback)((e=>{C(e),T?Y():_()}),[T,_,Y,C]);let G="voice-microphone";!0===T&&(G="voice-microphone voice-recording");const K=B(function(){try{const e=e||webkitSpeechRecognition;return!!e}catch(e){return!1}}()),L=o.createElement(i.Z,{id:`${e.id}-voice-input-tooltip`},K);switch(e.mode){case"full":return o.createElement(o.Fragment,null,e.legend?o.createElement("label",null,e.legend):null,o.createElement("div",{className:`input voice-input ${e.className}`,style:{height:e.height,width:e.width,...e.style}},o.createElement("input",{className:"voice-input-text",type:"text",onKeyDown:O,onChange:I,placeholder:null!==e.placeholder?e.placeholder:P("enter-text"),value:Z}),o.createElement(u.Z,{placement:e.tooltipPlacement,overlay:L},o.createElement(h,{onClick:D,className:G}))));case"status":return o.createElement(o.Fragment,null,e.legend?o.createElement("label",null,e.legend):null,o.createElement("div",{className:`voice-input-status-text ${e.className}`,style:{height:e.height,width:e.width,...e.style}},o.createElement("div",{className:"voice-input-status"},Z),o.createElement(u.Z,{placement:"bottom",overlay:L},o.createElement(h,{onClick:D,className:G}))));case"microphone":return o.createElement(o.Fragment,null,e.legend?o.createElement("label",null,e.legend):null,o.createElement("div",{className:`voice-solo-microphone ${e.className}`,style:{height:e.height,width:e.width,...e.style}},o.createElement(u.Z,{placement:"bottom",overlay:L},o.createElement(h,{onClick:D,className:G}))));case"none":return null}};w.defaultProps={autorecord:!1,defaultValue:"",grammars:[],legend:"",mode:"full",maxAlternatives:1,onChange(){},onClick(){},onFinalText(){},onSegment(){},onRecordingStart(){},onRecordingStop(){},onSubmit(){},placeholder:null,remote:null,className:"",style:{},timeout:null,stopTooltip:null,startTooltip:null,tooltipPlacement:"left",width:500,height:36},w.propTypes={autorecord:l().bool,defaultValue:l().string,grammars:l().array,legend:l().oneOfType([l().string,l().node]),mode:l().string,maxAlternatives:l().number,onChange:l().func,onClick:l().func,onFinalText:l().func,onRecordingStart:l().func,onRecordingStop:l().func,onSegment:l().func,onSubmit:l().func,placeholder:l().string,remote:l().object,className:l().string,style:l().object,timeout:l().number,stopTooltip:l().string,startTooltip:l().string,tooltipPlacement:l().oneOf(["top","right","bottom","left"]),width:l().number,height:l().number};var b=w},52734:function(e,t,n){e.exports=n.p+"static/media/83859f4256064fcaae00.svg"}}]);
//# sourceMappingURL=VoiceInput.a340119f.chunk.js.map