{"version":3,"sources":["actions/namespace.js","components/help-icon/index.js","components/completions/compute_modal.js","components/confirm-modal/index.js","components/dashboard-table/index.js","components/namespace-data/files_page.js","components/namespace-data/announcements_page.js","components/namespace-data/editable_progress.js","components/namespace-data/progress_page.js","components/namespace-data/cohorts_page.js","components/namespace-data/completions_page.js","components/namespace-data/grades_page.js","components/namespace-data/actions_page.js","components/namespace-data/tickets_page.js","components/namespace-data/index.js","actions/announcement.js","containers/visible-namespace-data/index.js","ev/components/data-explorer/index.js","utils/create_boolean_column.js","utils/create_categorical_column.js","utils/create_date_column.js","utils/create_numeric_column.js","utils/create_text_column.js","utils/file_saver.js","utils/text_filter.js"],"names":["file","namespace","ticket","addAnnouncement","deleteAnnouncement","editAnnouncement","startDate","endDate","setImmediate","self","saveAs"],"mappings":"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","file":"static/js/7183.c194bf09.chunk.js","sourcesContent":["/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport axios from 'axios';\nimport qs from 'querystring';\nimport i18next from 'i18next';\nimport { isPrimitive as isString } from '@stdlib/assert/is-string';\nimport saveAs from 'utils/file_saver.js';\nimport server from 'constants/server';\nimport { addNotification, addErrorNotification } from 'actions/notification';\nimport { getCohorts } from 'actions/cohort';\nimport { APPEND_CREATED_NAMESPACE, CHANGED_NAMESPACE, DELETED_CURRENT_NAMESPACE, GET_ALL_NAMESPACES, UPDATED_OWNED_NAMESPACE, UPDATED_STUDENT_PROGRESS } from 'constants/action_types.js';\n\n\n// EXPORTS //\n\n/**\n * Returns an action object to be used in signalling that a namespace has been created.\n *\n * @param {Object} namespace - the created namespace\n * @returns {Object} the action object\n */\nexport function appendCreatedNamespace( namespace ) {\n\treturn {\n\t\ttype: APPEND_CREATED_NAMESPACE,\n\t\tpayload: {\n\t\t\tnamespace\n\t\t}\n\t};\n}\n\n/**\n * Returns an action object to be used in signalling that a namespace has been changed.\n *\n * @param {Object} namespace - the changed namespace\n * @param {string} namespace.title - namespace title\n * @param {Array} namespace.owners - ids of owners\n * @param {Array} namespace.announcements - announcements\n * @param {Array} namespace.cohorts - cohorts\n * @param {string} namespace.description - namespace description\n * @param {boolean} namespace.enableTicketing - controls if ticketing is enabled for the namespace\n * @param {string} namespace._id - id of the namespace\n * @param {Array} namespace.completions - array of completion metric objects associated with the namespace\n * @returns {Object} the action object\n */\nexport function changedNamespace({ title, owners, announcements = [], cohorts = [], description, enableTicketing, _id, completions }) {\n\treturn {\n\t\ttype: CHANGED_NAMESPACE,\n\t\tpayload: {\n\t\t\ttitle,\n\t\t\tannouncements,\n\t\t\tcohorts,\n\t\t\tdescription,\n\t\t\tenableTicketing,\n\t\t\towners,\n\t\t\tcompletions,\n\t\t\t_id\n\t\t}\n\t};\n}\n\n/**\n * Returns an action object to be used in signalling that a namespace has been deleted.\n *\n * @param {string} id - the id of the namespace to be deleted\n * @returns {Object} the action object\n */\nexport function deletedCurrentNamespace( id ) {\n\treturn {\n\t\ttype: DELETED_CURRENT_NAMESPACE,\n\t\tpayload: {\n\t\t\tid\n\t\t}\n\t};\n}\n\n/**\n * Returns an action object to be used in signalling that a student's progress has been updated.\n *\n * @param {Object} options - progress of the student\n * @param {string} options.email - email of the student\n * @param {string} options.lessonId - lesson id\n * @param {number} options.progress - progress of the student\n * @param {Object} options.cohort - cohort of the student\n */\nexport function updateStudentProgress({ email, lessonID, progress, cohort }) {\n\treturn {\n\t\ttype: UPDATED_STUDENT_PROGRESS,\n\t\tpayload: {\n\t\t\temail, lessonID, progress, cohort\n\t\t}\n\t};\n}\n\n/**\n * Returns an action object to be used in signalling that an owned namespace has been updated.\n *\n * @param {Object} namespace - the updated namespace\n * @param {string} namespace.title - namespace title\n * @param {Array} namespace.owners - ids of owners\n * @param {Array} namespace.enableTicketing - controls if ticketing is enabled for the namespace\n * @param {string} namespace._id - id of the namespace\n * @returns {Object} the action object\n */\nexport function updatedOwnedNamespace({ title, owners, description, enableTicketing, _id }) {\n\treturn {\n\t\ttype: UPDATED_OWNED_NAMESPACE,\n\t\tpayload: {\n\t\t\ttitle,\n\t\t\tdescription,\n\t\t\towners,\n\t\t\tenableTicketing,\n\t\t\t_id\n\t\t}\n\t};\n}\n\n/**\n * Makes a POST request to create a new namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} namespace - the new namespace\n * @param {string} namespace.title - namespace title\n * @param {Array} namespace.description - namespace description\n * @param {string} namespace.tag - a completion category associated with the namespace\n * @param {Array} namespace.owners - ids of owners\n * @param {Object} namespace.props - properties of the invoking component\n */\nexport const createNamespace = async ( dispatch, { title, description, tag, owners, props }) => {\n\ttry {\n\t\tconst body = {\n\t\t\ttitle,\n\t\t\tdescription,\n\t\t\towners,\n\t\t\t...(isString( tag ) && tag !== '_default_tag' && { tag })\n\t\t};\n\t\tconst res = await axios.post( server+'/create_namespace', body );\n\t\tif ( !res.data.successful ) {\n\t\t\treturn addErrorNotification( dispatch, new Error( res.data.message ));\n\t\t}\n\t\tconst namespace = res.data.namespace;\n\t\t// props.onNamespace( namespace );\n\t\tdispatch( appendCreatedNamespace( namespace ) );\n\t\twindow.location.replace( '/dashboard/lessons/'+title );\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: res.data.successful ? 'success' : 'error'\n\t\t});\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to create a new namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the POST request to create a new namespace\n */\nexport const createNamespaceInjector = dispatch => {\n\treturn async ({ title, description, tag, owners, props }) => {\n\t\tawait createNamespace( dispatch, { title, description, tag, owners, props } );\n\t};\n};\n\n/**\n * Makes a POST request to delete a namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @param {string} id - the id of the namespace to be deleted\n * @returns {void}\n */\nexport const deleteCurrentNamespace = async ( dispatch, id ) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/delete_namespace', { id });\n\t\tdispatch( deletedCurrentNamespace( id ) );\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to delete a namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the POST request to delete a namespace\n */\nexport const deleteCurrentNamespaceInjector = ( dispatch ) => {\n\treturn async ( id ) => {\n\t\tawait deleteCurrentNamespace( dispatch, id );\n\t};\n};\n\n/**\n * Makes a POST request to update a namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} ns - the updated namespace\n */\nexport const updateCurrentNamespace = async ( dispatch, ns ) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/update_namespace', { ns });\n\t\tdispatch( changedNamespace( res.data.namespace ) );\n\t\tdispatch( updatedOwnedNamespace( res.data.namespace ) );\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t\tgetCohorts( dispatch, {\n\t\t\tnamespaceID: ns._id\n\t\t});\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to update a namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the POST request to update a namespace\n */\nexport const updateCurrentNamespaceInjector = ( dispatch ) => {\n\treturn async ( id, ns ) => {\n\t\tawait updateCurrentNamespace( dispatch, id, ns );\n\t};\n};\n\n/**\n * Makes a GET request to get a namespace's actions.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.namespaceID - id of the namespace\n * @param {string} options.namespaceTitle - title of the namespace\n * @returns {void}\n */\nexport const getNamespaceActions = async ( dispatch, { namespaceID, namespaceTitle } ) => {\n\ttry {\n\t\tconst res = await axios.get( server+'/get_namespace_actions?'+qs.stringify({ namespaceID }) );\n\t\tconst blob = new Blob([ res.data ], {\n\t\t\ttype: 'application/json'\n\t\t});\n\t\tconst name = `actions_${namespaceTitle}.json`;\n\t\tsaveAs( blob, name );\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a GET request to get a namespace's actions.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the GET request to get a namespace's actions\n */\nexport const getNamespaceActionsInjector = ( dispatch ) => {\n\treturn async ({ namespaceID, namespaceTitle }) => {\n\t\tawait getNamespaceActions( dispatch, { namespaceID, namespaceTitle });\n\t};\n};\n\n/**\n * Makes a POST request to update a user's lesson progress.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.namespaceID - id of the namespace\n * @param {string} options.lessonID - id of the lesson\n * @param {string} options.email - email of the user\n * @param {number} options.progress - progress of the user\n * @param {Object} options.cohort - cohort of the user\n */\nexport const adjustProgress = async ( dispatch, { email, lessonID, namespaceID, progress, cohort }) => {\n\tconst res = await axios.post( server+'/user_adjust_progress', {\n\t\temail, lessonID, namespaceID, progress\n\t});\n\taddNotification( dispatch, {\n\t\ttitle: i18next.t('common:updated'),\n\t\tmessage: res.data.message,\n\t\tlevel: 'success'\n\t});\n\tdispatch( updateStudentProgress({ email, lessonID, progress, cohort }) );\n};\n\n/**\n * Returns a function to make a POST request to update a user's lesson progress.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the POST request to update a user's lesson progress\n */\nexport const adjustProgressInjector = ( dispatch ) => {\n\treturn async ( { email, lessonID, namespaceID, progress, cohort } ) => {\n\t\tawait adjustProgress( dispatch, { email, lessonID, namespaceID, progress, cohort } );\n\t};\n};\n\n/**\n * Makes a GET request to get a all available namespaces.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {void}\n */\nexport const getAllNamespaces = async ( dispatch ) => {\n\ttry {\n\t\tconst res = await axios.get( server+'/get_all_namespaces' );\n\t\tdispatch({\n\t\t\ttype: GET_ALL_NAMESPACES,\n\t\t\tpayload: {\n\t\t\t\tnamespaces: res.data.namespaces\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a GET request to get a all available namespaces.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the GET request to get a all available namespaces\n */\nexport const getAllNamespacesInjector = ( dispatch ) => {\n\treturn async () => {\n\t\tawait getAllNamespaces( dispatch );\n\t};\n};\n\n/**\n * Makes a POST request to set the order lessons appear on the dashboard.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {Array} options.lessons - lessons of the course in the order to be displayed on the dashboard\n * @param {string} options.id - id of the namespace\n * @returns {void}\n */\nexport const setLessonOrder = async ( dispatch, { lessons, id }) => {\n\ttry {\n\t\tawait axios.post( server+'/set_lesson_order', {\n\t\t\tlessons, id\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to set the order lessons appear on the dashboard.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the POST request to set the order lessons appear on the dashboard\n */\nexport const setLessonOrderInjector = ( dispatch ) => {\n\treturn async ({ lessons, id }) => {\n\t\tawait setLessonOrder( dispatch, { lessons, id } );\n\t};\n};\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React from 'react';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Popover from 'react-bootstrap/Popover';\nimport './help_icon.css';\n\n\n// MAIN //\n\nconst HelpIcon = ( props ) => {\n\tconst overlayRef = React.useRef( null );\n\treturn (\n\t\t<div className=\"help-panel\" role=\"button\" tabIndex={0} onKeyDown={(e) => overlayRef.current && (e.which === 13 || e.which === 32) && overlayRef.current.click(e)}>\n\t\t\t<OverlayTrigger\n\t\t\t\tplacement=\"right\"\n\t\t\t\ttrigger={[ 'click' ]}\n\t\t\t\trootClose={true}\n\t\t\t\tdelay={{ show: 250, hide: 0 }}\n\t\t\t\toverlay={ps => <Popover {...ps} className='help-text'><Popover.Body>{props.children}</Popover.Body></Popover>}\n\t\t\t>\n\t\t\t\t<span className=\"mr-1\" tabIndex=\"0\" role=\"button\" ref={overlayRef}>\n\t\t\t\t\tinfo\n\t\t\t\t</span>\n\t\t\t</OverlayTrigger>\n\t\t</div>\n\t);\n};\n\n\n// EXPORTS //\n\nexport default HelpIcon;\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React, { useCallback, useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { useTranslation } from 'react-i18next';\nimport DateTimeRangePicker from '@wojtekmaj/react-datetimerange-picker';\nimport HelpIcon from 'components/help-icon';\nimport Container from 'react-bootstrap/Container';\nimport Modal from 'react-bootstrap/Modal';\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport SelectInput from 'react-select';\nimport isArray from '@stdlib/assert/is-array';\n\n\n// VARIABLES //\n\nconst MULTIPLES_POLICIES = [\n\t{ value: 'last', label: 'Last submitted value' },\n\t{ value: 'first', label: 'First submitted value' },\n\t{ value: 'pass-through', label: 'All submitted values' },\n\t{ value: 'max', label: 'Best submitted value' }\n];\n\n\n// MAIN //\n\nconst memberSelection =( member ) => {\n\treturn { value: member.id, label: `${member.firstName} ${member.lastName} (${member.email})` };\n};\n\nfunction ComputeModal({ cohorts, metric, entity, level, show, onHide, computeCompletions, onCompute }) {\n\tconsole.log( 'Array of metrics with the same name:', metric );\n\tconst { t } = useTranslation();\n\tconst metricName = isArray( metric ) ? metric[ 0 ].name : metric.name;\n\n\tconst [ formValues, setFormValues ] = useState({\n\t\tusers: [],\n\t\tactiveCohorts: {},\n\t\tpolicyOptions: {\n\t\t\tmultiples: MULTIPLES_POLICIES[ 0 ]\n\t\t}\n\t});\n\tconst FORM_STORAGE_KEY = `ISLE?level=${level}&metric=${metricName}`;\n\tuseEffect( () => {\n\t\tlet oldFormValues = localStorage.getItem( FORM_STORAGE_KEY );\n\t\tif ( oldFormValues ) {\n\t\t\toldFormValues = JSON.parse( oldFormValues );\n\t\t\tif ( oldFormValues.policyOptions?.timeFilter ) {\n\t\t\t\toldFormValues.policyOptions.timeFilter = oldFormValues.policyOptions.timeFilter.map( x => new Date( x ) );\n\t\t\t}\n\t\t\tsetFormValues( oldFormValues );\n\t\t}\n\t}, [ FORM_STORAGE_KEY ] );\n\tconst onTimeChange = useCallback( ( dates ) => {\n\t\tconst newFormValues = { ...formValues };\n\t\tif ( dates ) {\n\t\t\tnewFormValues.policyOptions.timeFilter = dates;\n\t\t} else {\n\t\t\tdelete newFormValues.policyOptions.timeFilter;\n\t\t}\n\t\tsetFormValues( newFormValues );\n\t}, [ formValues ] );\n\tconst handleMultiplesPolicyChange = useCallback( ( multiples ) => {\n\t\tconst newFormValues = { ...formValues };\n\t\tnewFormValues.policyOptions.multiples = multiples;\n\t\tsetFormValues( newFormValues );\n\t}, [ formValues ] );\n\tconst handleCompute = useCallback( () => {\n\t\tconst policyOptions = {\n\t\t\t...formValues.policyOptions,\n\t\t\tmultiples: formValues.policyOptions.multiples.value\n\t\t};\n\t\tif ( formValues.policyOptions.timeFilter ) {\n\t\t\tpolicyOptions.timeFilter = formValues.policyOptions.timeFilter.map( x => x.getTime() );\n\t\t}\n\t\tlocalStorage.setItem( FORM_STORAGE_KEY, JSON.stringify( formValues ) );\n\t\tconst body = {\n\t\t\tids: isArray( entity ) ? entity.map( x => x._id ) : [ entity._id ],\n\t\t\tusers: formValues.users.map( x => x.value ),\n\t\t\tmetric: metric,\n\t\t\tpolicyOptions\n\t\t};\n\t\tcomputeCompletions( body ).then( onCompute );\n\t}, [ metric, entity, formValues, FORM_STORAGE_KEY, computeCompletions, onCompute ] );\n\tconst users = cohorts.reduce( ( userList, cohort ) => {\n\t\tconst members = cohort.members.map( member => memberSelection(member) );\n\t\treturn userList.concat( members );\n\t}, [] );\n\tconst selectOptions = [\n\t\t{ value: { category: 'all', members: users }, label: t( 'All users' ) },\n\t\t...( cohorts.length > 1 ? cohorts.map( cohort => {\n\t\t\treturn { value: { category: 'cohort', id: cohort._id, members: cohort.members }, label: 'Cohort ' + cohort.title };\n\t\t}) : [] )\n\t].concat( users );\n\n\tconst userSelectStyles = {\n\t\toption: ( styles, { data }) => {\n\t\t\tif ( data.value.category === 'cohort' && formValues.activeCohorts[ data.value.id ] ) {\n\t\t\t\treturn {\n\t\t\t\t\t...styles,\n\t\t\t\t\t':before': {\n\t\t\t\t\t\tcontent: '\"\\u2713 \"'\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn styles;\n\t\t}\n\t};\n\tconst handleUserSelectChange = useCallback( ( value ) => {\n\t\tif ( !value ) {\n\t\t\tsetFormValues( {\n\t\t\t\t...formValues,\n\t\t\t\tusers: []\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif ( value.some( x => x.value.category === 'all' ) ) {\n\t\t\tsetFormValues({\n\t\t\t\t...formValues,\n\t\t\t\tusers: users,\n\t\t\t\tactiveCohorts: {}\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tconst selectedUsersSet= new Set();\n\t\tconst removeIds = new Set();\n\t\tconst newValue = [];\n\t\tconst newActiveCohorts = Object.assign( {}, formValues.activeCohorts );\n\t\tfor ( let i = 0; i < value.length; i++ ) {\n\t\t\tif ( value[ i ].value.category === 'cohort' ) {\n\t\t\t\tif ( !formValues.activeCohorts[ value[i].value.id ] ) {\n\t\t\t\t\tnewActiveCohorts[ value[i].value.id ] = true;\n\t\t\t\t\tfor ( let j = 0; j < value[ i ].value.members.length; ++j ) {\n\t\t\t\t\t\tif ( !selectedUsersSet.has( value[ i ].value.members[ j ].id ) ) {\n\t\t\t\t\t\t\tconst member = value[ i ].value.members[ j ];\n\t\t\t\t\t\t\tnewValue.push( memberSelection( member ) );\n\t\t\t\t\t\t\tselectedUsersSet.add( member.id );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tnewActiveCohorts[ value[i].value.id ] = false;\n\t\t\t\t\tvalue[ i ].value.members.forEach( member => {\n\t\t\t\t\t\tremoveIds.add( member.id );\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if ( !selectedUsersSet.has( value[ i ].value ) ) {\n\t\t\t\tnewValue.push( value[ i ] );\n\t\t\t\tselectedUsersSet.add( value[ i ].value );\n\t\t\t}\n\t\t}\n\t\tsetFormValues({\n\t\t\t...formValues,\n\t\t\tusers: newValue.filter( x => !removeIds.has( x.value ) ),\n\t\t\tactiveCohorts: newActiveCohorts\n\t\t});\n\t}, [ formValues, users ] );\n\treturn (\n\t\t<Modal size=\"lg\" show={show} onHide={onHide}>\n\t\t\t<Modal.Header closeButton>\n\t\t\t\t<Modal.Title as=\"h3\">{`${t('calculate-scores-for')} ${metricName}`} </Modal.Title>\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Body>\n\t\t\t\t<Container>\n\t\t\t\t\t<Form.Group className=\"mb-2\" as={Row} controlId=\"multiplesPolicy\" >\n\t\t\t\t\t\t<Form.Label column sm={3} >\n\t\t\t\t\t\t\t{t('multiples-policy')}\n\t\t\t\t\t\t</Form.Label>\n\t\t\t\t\t\t<Col sm={8} >\n\t\t\t\t\t\t\t<SelectInput value={formValues.policyOptions.multiples} options={MULTIPLES_POLICIES} onChange={handleMultiplesPolicyChange} />\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col sm={1} >\n\t\t\t\t\t\t\t<HelpIcon>\n\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t{t('multiples-policy-description')}\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</HelpIcon>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Form.Group>\n\t\t\t\t\t<Form.Group className=\"mb-2\" as={Row} controlId=\"timeFilter\" >\n\t\t\t\t\t\t<Form.Label column sm={3} >\n\t\t\t\t\t\t\t{t('time-filter')}\n\t\t\t\t\t\t</Form.Label>\n\t\t\t\t\t\t<Col sm={8} >\n\t\t\t\t\t\t\t<DateTimeRangePicker onChange={onTimeChange} value={formValues.policyOptions.timeFilter} />\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col sm={1} >\n\t\t\t\t\t\t\t<HelpIcon>\n\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t{t('time-filter-description')}\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</HelpIcon>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Form.Group>\n\t\t\t\t\t<Form.Group className=\"mb-2\" as={Row} controlId=\"users\" >\n\t\t\t\t\t\t<Form.Label column sm={3} >\n\t\t\t\t\t\t\t{t('users')}\n\t\t\t\t\t\t</Form.Label>\n\t\t\t\t\t\t<Col sm={8} >\n\t\t\t\t\t\t\t<SelectInput\n\t\t\t\t\t\t\t\tvalue={formValues.users} isMulti\n\t\t\t\t\t\t\t\toptions={selectOptions} onChange={handleUserSelectChange}\n\t\t\t\t\t\t\t\thideSelectedOptions={true}\n\t\t\t\t\t\t\t\tstyles={userSelectStyles}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col sm={1} >\n\t\t\t\t\t\t\t<HelpIcon>\n\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t{t('users-description')}\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</HelpIcon>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Form.Group>\n\t\t\t\t</Container>\n\t\t\t</Modal.Body>\n\t\t\t<Modal.Footer>\n\t\t\t\t<Button onClick={onHide}>\n\t\t\t\t\t{t('common:cancel')}\n\t\t\t\t</Button>\n\t\t\t\t<Button variant=\"success\" onClick={handleCompute} disabled={formValues.users.length === 0}>\n\t\t\t\t\t{t('common:calculate')}\n\t\t\t\t</Button>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n}\n\n\n// PROPERTIES //\n\nComputeModal.propTypes = {\n\tcohorts: PropTypes.array.isRequired,\n\tcomputeCompletions: PropTypes.func.isRequired,\n\tentity: PropTypes.oneOfType([\n\t\tPropTypes.arrayOf( PropTypes.object ),\n\t\tPropTypes.object\n\t]).isRequired,\n\tlevel: PropTypes.string.isRequired,\n\tmetric: PropTypes.oneOfType([\n\t\tPropTypes.arrayOf( PropTypes.object ),\n\t\tPropTypes.object\n\t]).isRequired,\n\tonCompute: PropTypes.func.isRequired,\n\tonHide: PropTypes.func.isRequired,\n\tshow: PropTypes.bool.isRequired\n};\n\nComputeModal.defaultProps = {};\n\n\n// EXPORTS //\n\nexport default ComputeModal;\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { withTranslation } from 'react-i18next';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Modal from 'react-bootstrap/Modal';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n * A confirmation modal component.\r\n *\r\n * @param {Object} props - component properties\r\n * @param {string} props.title - modal title\r\n * @param {string} props.message - modal message\r\n * @param {boolean} props.show - boolean indicating whether the modal is visible\r\n * @param {Function} props.close - callback to invoke upon hiding the modal\r\n * @param {Function} props.onConfirm - callback to invoke upon confirming the modal\r\n * @returns {ReactElement} modal component\r\n */\r\nconst ConfirmModal = ( props ) => (\r\n\t<Modal show={props.show} onHide={props.close} >\r\n\t\t<Modal.Header>\r\n\t\t\t<Modal.Title as=\"h3\">{props.title}</Modal.Title>\r\n\t\t</Modal.Header>\r\n\t\t<Modal.Body>\r\n\t\t\t{props.message}\r\n\t\t</Modal.Body>\r\n\t\t<Modal.Footer>\r\n\t\t\t<Button onClick={props.close}>\r\n\t\t\t\t{props.t('cancel')}\r\n\t\t\t</Button>\r\n\t\t\t<Button variant=\"danger\" onClick={props.onConfirm}>\r\n\t\t\t\t{props.t('confirm')}\r\n\t\t\t</Button>\r\n\t\t</Modal.Footer>\r\n\t</Modal>\r\n);\r\n\r\n\r\n// PROPERTIES //\r\n\r\nConfirmModal.propTypes = {\r\n\tclose: PropTypes.func,\r\n\tmessage: PropTypes.node,\r\n\tonConfirm: PropTypes.func,\r\n\tshow: PropTypes.bool,\r\n\ttitle: PropTypes.string\r\n};\r\n\r\nConfirmModal.defaultProps = {\r\n\tclose() {},\r\n\tmessage: '',\r\n\tonConfirm() {},\r\n\tshow: false,\r\n\ttitle: ''\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default withTranslation( [ 'common' ] )( ConfirmModal );\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n\r\n// MODULES //\r\n\r\nimport React, { Fragment, forwardRef, useCallback } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport ReactTable from 'react-table';\r\nimport Button from 'react-bootstrap/Button';\r\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport 'react-table/react-table.css';\r\nimport './table.css';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n * A table component for displaying data.\r\n *\r\n * @param {Object} props - component properties\r\n * @param {(Array|Object)} props.data - array of objects containing data\r\n * @param {Array} props.columns - array of column objects\r\n * @param {Function} props.onButtonClick - callback to invoke upon clicking the data explorer button\r\n * @param {string} props.className - CSS class name\r\n * @param {boolean} props.disabled - boolean indicating whether the component is disabled\r\n * @param {Function} props.t - i18n translation function\r\n * @returns {ReactElement} component\r\n */\r\nconst DashboardTable = forwardRef( ( props, ref ) => {\r\n\tconst { id, t } = props;\r\n\tconst getProps = useCallback( () => {\r\n\t\treturn {\r\n\t\t\tid: id || 'dashboard-table'\r\n\t\t};\r\n\t}, [ id ] );\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<ReactTable\r\n\t\t\t\t{...props}\r\n\t\t\t\tfilterable\r\n\t\t\t\tclassName={`dashboard-table ${props.className}`}\r\n\t\t\t\tdata={props.data}\r\n\t\t\t\tcolumns={props.columns}\r\n\t\t\t\tpreviousText={t('common:previous')}\r\n\t\t\t\tnextText={t('common:next')}\r\n\t\t\t\tloadingText={t('common:loading')}\r\n\t\t\t\tnoDataText={t('common:no-rows-found')}\r\n\t\t\t\tpageText={t('common:page')}\r\n\t\t\t\tofText={t('common:of')}\r\n\t\t\t\trowsText={t('common:rows')}\r\n\t\t\t\tgetProps={getProps}\r\n\t\t\t\tref={ref}\r\n\t\t\t/>\r\n\t\t\t{props.onButtonClick ? <ButtonGroup vertical style={{ float: 'right', marginRight: -9 }} >\r\n\t\t\t\t<OverlayTrigger placement=\"left\" overlay={<Tooltip id=\"explorer-tooltip\">{t('common:data-explorer')}</Tooltip>}>\r\n\t\t\t\t\t<Button aria-label={t('common:data-explorer')} variant=\"primary\" style={{ marginBottom: 8 }} onClick={props.onButtonClick} disabled={props.disabled} >\r\n\t\t\t\t\t\t<i className=\"fas fa-chart-bar\" ></i>\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</OverlayTrigger>\r\n\t\t\t</ButtonGroup> : null}\r\n\t\t</Fragment>\r\n\t);\r\n});\r\n\r\n\r\n// PROPERTIES //\r\n\r\nDashboardTable.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tcolumns: PropTypes.array.isRequired,\r\n\tdata: PropTypes.oneOfType([\r\n\t\tPropTypes.object,\r\n\t\tPropTypes.array\r\n\t]).isRequired,\r\n\tdisabled: PropTypes.bool,\r\n\tonButtonClick: PropTypes.func.isRequired,\r\n\tt: PropTypes.func\r\n};\r\n\r\nDashboardTable.defaultProps = {\r\n\tclassName: '',\r\n\tdisabled: false,\r\n\tt() {}\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default DashboardTable;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport logger from 'debug';\r\nimport { withTranslation } from 'react-i18next';\r\nimport stringify from 'csv-stringify';\r\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\r\nimport Button from 'react-bootstrap/Button';\r\nimport FormLabel from 'react-bootstrap/FormLabel';\r\nimport FormGroup from 'react-bootstrap/FormGroup';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport Badge from 'react-bootstrap/Badge';\r\nimport copyToClipboard from 'clipboard-copy';\r\nimport roundn from '@stdlib/math/base/special/roundn';\r\nimport ceil from '@stdlib/math/base/special/ceil';\r\nimport pick from '@stdlib/utils/pick';\r\nimport contains from '@stdlib/assert/contains';\r\nimport lowercase from '@stdlib/string/lowercase';\r\nimport DashboardDataExplorer from 'ev/components/data-explorer';\r\nimport obsToVar from '@isle-project/utils/obs-to-var';\r\nimport DashboardTable from 'components/dashboard-table';\r\nimport ConfirmModal from 'components/confirm-modal';\r\nimport server from 'constants/server';\r\nimport saveAs from 'utils/file_saver.js';\r\nimport createDateColumn from 'utils/create_date_column.js';\r\nimport createTextColumn from 'utils/create_text_column.js';\r\nimport createNumericColumn from 'utils/create_numeric_column.js';\r\nimport 'css/input_range.css';\r\nimport './files_page.css';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst EXPORT_COLUMNS = [ 'name', 'email', 'lesson', 'title', 'filename', 'type', 'createdAt', 'updatedAt' ];\r\nconst debug = logger( 'isle:files-page' );\r\n\r\n\r\n// FUNCTIONS //\r\n\r\n/**\r\n * Keeps the part of the file path after `/media/`.\r\n *\r\n * @param {string} filepath - file path\r\n * @returns {string} part of the file path after `/media/`\r\n */\r\nconst getPartAfterMedia = ( filepath ) => {\r\n\treturn filepath.substring( filepath.indexOf( '/media/' ) + 7 );\r\n};\r\n\r\nconst prepareExportData = ( data ) => {\r\n\tfor ( let i = 0; i < data.length; i++ ) {\r\n\t\tconst row = pick( data[ i ], EXPORT_COLUMNS );\r\n\t\trow.lesson = row.lesson.title;\r\n\t\trow.filename = server+'/'+row.filename;\r\n\t\tdata[ i ] = row;\r\n\t}\r\n\treturn data;\r\n};\r\n\r\n\r\n// MAIN //\r\n\r\nclass FilesPage extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\t\tthis.state = {\r\n\t\t\tshowDeleteModal: false,\r\n\t\t\tdeletionID: null,\r\n\t\t\tfileMaxSize: 0,\r\n\t\t\tfileInputKey: 0,\r\n\t\t\tshowExplorer: false\r\n\t\t};\r\n\t\tthis.columns = this.createColumns();\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tdebug( 'Component did mount...' );\r\n\t\tthis.props.getFiles({\r\n\t\t\tnamespaceName: this.props.namespace.title\r\n\t\t});\r\n\t}\r\n\r\n\tcomponentDidUpdate( prevProps ) {\r\n\t\tif ( prevProps.files !== this.props.files ) {\r\n\t\t\tconst files = this.props.files;\r\n\t\t\tlet fileMaxSize = 0;\r\n\t\t\tfor ( let i = 0; i < files.length; i++ ) {\r\n\t\t\t\tconst size = files[ i ].size;\r\n\t\t\t\tif ( size && size > fileMaxSize ) {\r\n\t\t\t\t\tfileMaxSize = size;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.setState({\r\n\t\t\t\tfileMaxSize,\r\n\t\t\t\tfileInputKey: this.state.fileInputKey + 1\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\thandleDelete = () => {\r\n\t\tthis.props.handleFileDeletion( this.state.deletionID, this.props.ownerFiles );\r\n\t\tthis.toggleDeleteModal();\r\n\t};\r\n\r\n\ttoggleDeleteModal = () => {\r\n\t\tthis.setState({\r\n\t\t\tshowDeleteModal: !this.state.showDeleteModal\r\n\t\t});\r\n\t};\r\n\r\n\tcreateColumns = () => {\r\n\t\tconst { t } = this.props;\r\n\t\treturn [\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:filename'),\r\n\t\t\t\taccessor: 'title',\r\n\t\t\t\tminWidth: 250,\r\n\t\t\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\t\t\treturn contains( lowercase( row[ filter.id ] ), lowercase( filter.value ) );\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\t{\r\n\t\t\t\tHeader: t('common:open'),\r\n\t\t\t\taccessor: 'path',\r\n\t\t\t\tCell: ( row ) => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"left\" overlay={<Tooltip id=\"external-link-tooltip\">{t('open-file')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<a aria-label={t('open-file')} href={server+'/'+getPartAfterMedia( row.value )} target=\"_blank\" rel=\"noopener noreferrer\" >\r\n\t\t\t\t\t\t\t\t<Button aria-label={t('open-file')} size=\"sm\" variant=\"outline-secondary\">\r\n\t\t\t\t\t\t\t\t\t<i className=\"fa fa-external-link-alt\"></i>\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</OverlayTrigger> );\r\n\t\t\t\t},\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tfilterable: false,\r\n\t\t\t\tsortable: false,\r\n\t\t\t\twidth: 45\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tHeader: t('common:copy'),\r\n\t\t\t\tid: 'copy-path',\r\n\t\t\t\taccessor: 'path',\r\n\t\t\t\tCell: ( row ) => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"copy-clipboard-tooltip\">{t('common:copy-link')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<Button aria-label={t('common:copy-link')} variant=\"outline-secondary\" size=\"sm\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tcopyToClipboard( server+'/'+getPartAfterMedia( row.value ) );\r\n\t\t\t\t\t\t\t\t\tthis.props.addNotification({\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Copied',\r\n\t\t\t\t\t\t\t\t\t\tmessage: 'Link copied to clipboard',\r\n\t\t\t\t\t\t\t\t\t\tlevel: 'success',\r\n\t\t\t\t\t\t\t\t\t\tposition: 'tl'\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<i className=\"fa fa-clipboard\"></i>\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tfilterable: false,\r\n\t\t\t\tsortable: false,\r\n\t\t\t\twidth: 45\r\n\t\t\t},\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:lesson'),\r\n\t\t\t\taccessor: 'lesson',\r\n\t\t\t\tmaxWidth: 160,\r\n\t\t\t\tCell: ( row ) => {\r\n\t\t\t\t\tif ( !row.row.lesson ) {\r\n\t\t\t\t\t\treturn <span>{t('no-lesson')}</span>;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"open-lesson-tooltip\">{t('open-lesson-new-tab')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<div style={{ width: '100%', height: '100%' }} >\r\n\t\t\t\t\t\t\t\t<a aria-label={t('open-lesson-new-tab')} href={row.row.lesson.url} target=\"_blank\" rel=\"noopener noreferrer\" >\r\n\t\t\t\t\t\t\t\t\t{row.row.lesson.title}\r\n\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\t\t\treturn row[ filter.id ].title.startsWith( filter.value );\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:first-name'),\r\n\t\t\t\tid: 'first_name',\r\n\t\t\t\taccessor: 'user.firstName',\r\n\t\t\t\tmaxWidth: 75,\r\n\t\t\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\t\t\treturn contains( lowercase( row[ filter.id ] ), lowercase( filter.value ) );\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:last-name'),\r\n\t\t\t\tid: 'last_name',\r\n\t\t\t\taccessor: 'user.lastName',\r\n\t\t\t\tmaxWidth: 75,\r\n\t\t\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\t\t\treturn contains( lowercase( row[ filter.id ] ), lowercase( filter.value ) );\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:email'),\r\n\t\t\t\taccessor: 'user.email',\r\n\t\t\t\tmaxWidth: 160,\r\n\t\t\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\t\t\treturn contains( lowercase( row[ filter.id ] ), lowercase( filter.value ) );\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('type'),\r\n\t\t\t\taccessor: 'type',\r\n\t\t\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\t\t\treturn contains( row[ filter.id ], filter.value );\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tcreateNumericColumn({\r\n\t\t\t\tHeader: t('common:size'),\r\n\t\t\t\taccessor: 'size',\r\n\t\t\t\tCell: row => row.value ? `${roundn( row.value, -3 )}mb` : 'NA',\r\n\t\t\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\t\t\tconst id = filter.pivotId || filter.id;\r\n\t\t\t\t\tconst size = row[ id ];\r\n\t\t\t\t\treturn size >= filter.value.min && size <= filter.value.max;\r\n\t\t\t\t},\r\n\t\t\t\tformatLabel: value => roundn( value, -2 ),\r\n\t\t\t\tmaxValue: ceil( this.state.fileMaxSize ) || 1,\r\n\t\t\t\tminValue: 0\r\n\t\t\t}),\r\n\t\t\tcreateDateColumn({\r\n\t\t\t\tHeader: t('common:date'),\r\n\t\t\t\taccessor: 'updatedAt',\r\n\t\t\t\tCell: ( row ) => {\r\n\t\t\t\t\tif ( row.value && row.value.toLocaleDateString ) {\r\n\t\t\t\t\t\treturn row.value.toLocaleDateString( 'en-US' );\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn '';\r\n\t\t\t\t},\r\n\t\t\t\tmaxWidth: 120,\r\n\t\t\t\tt: t\r\n\t\t\t}),\r\n\t\t\t{\r\n\t\t\t\tHeader: 'Del',\r\n\t\t\t\taccessor: '_id',\r\n\t\t\t\tCell: ( row ) => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"left\" overlay={<Tooltip id=\"delete-file-tooltip\">{t('delete-file-tooltip')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\taria-label={t('delete-file-tooltip')}\r\n\t\t\t\t\t\t\t\tsize=\"sm\" variant=\"outline-secondary\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\t\t\tdeletionID: row.value,\r\n\t\t\t\t\t\t\t\t\tshowDeleteModal: true\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}} >\r\n\t\t\t\t\t\t\t\t<div className=\"fa fa-trash-alt\" />\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tfilterable: false,\r\n\t\t\t\tsortable: false,\r\n\t\t\t\twidth: 45\r\n\t\t\t}\r\n\t\t];\r\n\t};\r\n\r\n\tsaveJSON = () => {\r\n\t\tconst currentFiles = this.dashboardTable.getResolvedState().sortedData;\r\n\t\tlet data = prepareExportData( currentFiles );\r\n\t\tconst blob = new Blob([ JSON.stringify( data ) ], {\r\n\t\t\ttype: 'application/json'\r\n\t\t});\r\n\t\tconst name = `files_${this.props.namespace.title}.json`;\r\n\t\tsaveAs( blob, name );\r\n\t};\r\n\r\n\tsaveCSV = () => {\r\n\t\tconst currentFiles = this.dashboardTable.getResolvedState().sortedData;\r\n\t\tlet data = prepareExportData( currentFiles );\r\n\t\tstringify( data, {\r\n\t\t\theader: true\r\n\t\t}, ( err, output ) => {\r\n\t\t\tif ( err ) {\r\n\t\t\t\treturn this.props.addNotification({\r\n\t\t\t\t\ttitle: 'Error encountered',\r\n\t\t\t\t\tmessage: 'Encountered an error while creating CSV: '+err.message,\r\n\t\t\t\t\tlevel: 'error',\r\n\t\t\t\t\tposition: 'tl'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tconst blob = new Blob([ output ], {\r\n\t\t\t\ttype: 'text/plain'\r\n\t\t\t});\r\n\t\t\tconst name = `files_${this.props.namespace.title}.csv`;\r\n\t\t\tsaveAs( blob, name );\r\n\t\t});\r\n\t};\r\n\r\n\ttoggleExplorer = () => {\r\n\t\tthis.setState({\r\n\t\t\tshowExplorer: !this.state.showExplorer\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { t } = this.props;\r\n\t\tif ( this.state.showExplorer ) {\r\n\t\t\tconst files = this.props.files;\r\n\t\t\tlet data = [];\r\n\t\t\tfor ( let i = 0; i < files.length; i++ ) {\r\n\t\t\t\tconst file = files[ i ];\r\n\t\t\t\tconst replacement = {};\r\n\t\t\t\treplacement.title = file.title;\r\n\t\t\t\treplacement.type = file.type;\r\n\t\t\t\treplacement.lesson = file.lesson ? file.lesson.title : null;\r\n\t\t\t\treplacement.size = file.size ? file.size : null;\r\n\t\t\t\treplacement.email = file.email;\r\n\t\t\t\treplacement.createdAt = file.createdAt;\r\n\t\t\t\treplacement.updatedAt = file.updatedAt;\r\n\t\t\t\tdata.push( replacement );\r\n\t\t\t}\r\n\t\t\tdata = obsToVar( data );\r\n\t\t\tconst quantitative = [ 'size' ];\r\n\t\t\tconst categorical = [ 'title', 'type', 'lesson', 'email', 'createdAt', 'updatedAt' ];\r\n\t\t\treturn (\r\n\t\t\t\t<DashboardDataExplorer\r\n\t\t\t\t\ttitle={t('explorer-files-title')}\r\n\t\t\t\t\tdata={data}\r\n\t\t\t\t\tcategorical={categorical}\r\n\t\t\t\t\tquantitative={quantitative}\r\n\t\t\t\t\tclose={this.toggleExplorer}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t\tconsole.log( this.props.files );\r\n\t\treturn ( <div className=\"namespace-data-page\">\r\n\t\t\t<div className=\"namespace-data-buttons\">\r\n\t\t\t\t<ButtonGroup className=\"files-export-button-group\" >\r\n\t\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"csvTooltip\" >{t('save-as-csv')}</Tooltip>}>\r\n\t\t\t\t\t\t<Button size=\"sm\" variant=\"secondary\" onClick={this.saveCSV} ><i className=\"fas fa-download\"></i> CSV</Button>\r\n\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"jsonTooltip\">{t('save-as-json')}</Tooltip>}>\r\n\t\t\t\t\t\t<Button size=\"sm\" variant=\"secondary\" onClick={this.saveJSON} ><i className=\"fas fa-download\"></i> JSON</Button>\r\n\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t</ButtonGroup>\r\n\t\t\t\t{ this.props.ownerFiles ? <FormGroup className=\"file-upload-button\" >\r\n\t\t\t\t\t<FormLabel htmlFor=\"fileUpload\" style={{ cursor: 'pointer' }}>\r\n\t\t\t\t\t\t<Badge id=\"file-upload-badge\" bg=\"success\">{t('upload-file')}</Badge>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tid=\"fileUpload\"\r\n\t\t\t\t\t\t\tkey={this.state.fileInputKey}\r\n\t\t\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\t\t\taccept=\".pdf,.html,.md,image/*,video/*,audio/*,.json,.csv\"\r\n\t\t\t\t\t\t\tonChange={this.props.handleUpload}\r\n\t\t\t\t\t\t\tstyle={{ display: 'none' }}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</FormLabel>\r\n\t\t\t\t</FormGroup> : null }\r\n\t\t\t</div>\r\n\t\t\t<DashboardTable\r\n\t\t\t\tdata={this.props.files}\r\n\t\t\t\tcolumns={this.columns}\r\n\t\t\t\tt={t}\r\n\t\t\t\tref={(r) => {\r\n\t\t\t\t\tthis.dashboardTable = r;\r\n\t\t\t\t}}\r\n\t\t\t\tonButtonClick={this.toggleExplorer}\r\n\t\t\t/>\r\n\t\t\t<ConfirmModal\r\n\t\t\t\tshow={this.state.showDeleteModal}\r\n\t\t\t\tclose={this.toggleDeleteModal}\r\n\t\t\t\tmessage={t('delete-file')}\r\n\t\t\t\ttitle={`${t('common:delete')}?`}\r\n\t\t\t\tonConfirm={this.handleDelete}\r\n\t\t\t/>\r\n\t\t</div> );\r\n\t}\r\n}\r\n\r\n\r\n// PROPERTIES //\r\n\r\nFilesPage.propTypes = {\r\n\taddNotification: PropTypes.func.isRequired,\r\n\tfiles: PropTypes.array.isRequired,\r\n\tgetFiles: PropTypes.func.isRequired,\r\n\thandleFileDeletion: PropTypes.func.isRequired,\r\n\thandleUpload: PropTypes.func.isRequired,\r\n\tnamespace: PropTypes.object.isRequired,\r\n\townerFiles: PropTypes.bool\r\n};\r\n\r\nFilesPage.defaultProps = {\r\n\townerFiles: false\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default withTranslation( [ 'namespace_data', 'common' ] )( FilesPage );\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { withTranslation } from 'react-i18next';\r\nimport Button from 'react-bootstrap/Button';\r\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\r\nimport Card from 'react-bootstrap/Card';\r\nimport FormLabel from 'react-bootstrap/FormLabel';\r\nimport FormControl from 'react-bootstrap/FormControl';\r\nimport FormGroup from 'react-bootstrap/FormGroup';\r\nimport Form from 'react-bootstrap/Form';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport ConfirmModal from 'components/confirm-modal';\r\nimport '../profile-page/message-page.css';\r\nimport './message_admin_page.css';\r\n\r\n\r\n// MAIN //\r\n\r\nclass AnnouncementsPage extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\t\tthis.state = {\r\n\t\t\ttitle: '',\r\n\t\t\tbody: '',\r\n\t\t\tmode: 'new-announcement',\r\n\t\t\teditItem: null,\r\n\t\t\tshowDeleteModal: false\r\n\t\t};\r\n\t}\r\n\r\n\trenderModals() {\r\n\t\treturn null;\r\n\t}\r\n\r\n\teditMessage( ndx ) {\r\n\t\tconst announcement = this.props.namespace.announcements[ ndx ];\r\n\t\tthis.setState({\r\n\t\t\tmode: 'edit-announcement',\r\n\t\t\teditItem: ndx,\r\n\t\t\ttitle: announcement.title,\r\n\t\t\tbody: announcement.body\r\n\t\t});\r\n\t}\r\n\r\n\tdeleteSelectedMessage = () => {\r\n\t\tconst ndx = this.state.editItem;\r\n\t\tconst announcement = this.props.namespace.announcements[ ndx ];\r\n\t\tthis.props.deleteAnnouncement( announcement.createdAt, ndx );\r\n\t\tthis.clear();\r\n\t\tthis.closeDeleteModal();\r\n\t};\r\n\r\n\trenderMessages() {\r\n\t\tconst { t } = this.props;\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t{this.props.namespace.announcements.map( ( value, index ) => {\r\n\t\t\t\t\tconst date = new Date( value.createdAt );\r\n\t\t\t\t\tconst dateString = date.toLocaleDateString() + '  -  ' + date.toLocaleTimeString( navigator.language, {\r\n\t\t\t\t\t\thour: '2-digit',\r\n\t\t\t\t\t\tminute: '2-digit'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<div key={index}>\r\n\t\t\t\t\t\t<div className=\"message-container\">\r\n\t\t\t\t\t\t\t<div className=\"message-data\">\r\n\t\t\t\t\t\t\t\t<div className=\"message-profile-pic\">\r\n\t\t\t\t\t\t\t\t\t<img src={value.picture} alt=\"User Profile Pic\" />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"message-author-line\">\r\n\t\t\t\t\t\t\t\t\t<span className=\"message-author\">{ value.author }</span>\r\n\t\t\t\t\t\t\t\t\t&nbsp;{t('common:wrote-on', { date: dateString })}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"message-title\">\r\n\t\t\t\t\t\t\t\t{ value.title }\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"message-body\">\r\n\t\t\t\t\t\t\t\t{ value.body }\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"message-manip\">\r\n\t\t\t\t\t\t\t<button onClick={() => {\r\n\t\t\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\t\t\teditItem: index,\r\n\t\t\t\t\t\t\t\t\tshowDeleteModal: true\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}} className=\"message-delete\">{t('common:delete')}</button>\r\n\t\t\t\t\t\t\t<button onClick={() => {\r\n\t\t\t\t\t\t\t\tthis.editMessage(index);\r\n\t\t\t\t\t\t\t}} className=\"message-edit\">{t('common:edit')}</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t);\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcreateMessage = () => {\r\n\t\tconst now = new Date().getTime();\r\n\t\tconst message = {\r\n\t\t\ttitle: this.state.title,\r\n\t\t\tbody: this.state.body,\r\n\t\t\tauthor: this.props.user.name,\r\n\t\t\temail: this.props.user.email,\r\n\t\t\tpicture: this.props.user.picture\r\n\t\t};\r\n\t\tif ( this.state.editItem === null ) {\r\n\t\t\tmessage.createdAt = now;\r\n\t\t\tthis.props.addAnnouncement( message );\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconst announcement = this.props.namespace.announcements[ this.state.editItem ];\r\n\t\t\tmessage.createdAt = announcement.createdAt;\r\n\t\t\tthis.props.editAnnouncement( message );\r\n\t\t}\r\n\t\tthis.clear();\r\n\t};\r\n\r\n\thandleInputChange = ( event ) => {\r\n\t\tconst target = event.target;\r\n\t\tconst name = target.name;\r\n\t\tlet value = target.value;\r\n\t\tthis.setState({\r\n\t\t\t[ name ]: value\r\n\t\t});\r\n\t};\r\n\r\n\tclear = () => {\r\n\t\tthis.setState({\r\n\t\t\ttitle: '',\r\n\t\t\tbody: '',\r\n\t\t\tmode: 'new-announcement',\r\n\t\t\teditItem: null\r\n\t\t});\r\n\t};\r\n\r\n\tcloseDeleteModal = () => {\r\n\t\tthis.setState({\r\n\t\t\teditItem: null,\r\n\t\t\tshowDeleteModal: false\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { t } = this.props;\r\n\t\tconst isDisabled = this.state.title.length < 3 || this.state.body.length < 3;\r\n\t\tconst isEmpty = this.state.title.length === 0 && this.state.body.length === 0;\r\n\t\treturn ( <div className=\"namespace-data-page\">\r\n\t\t\t<div className=\"messages\">\r\n\t\t\t\t{ this.renderMessages() }\r\n\t\t\t</div>\r\n\t\t\t<div className=\"new_message\">\r\n\t\t\t\t<Card>\r\n\t\t\t\t\t<Card.Header>\r\n\t\t\t\t\t\t<Card.Title as=\"h3\">\r\n\t\t\t\t\t\t\t{t(this.state.mode)}\r\n\t\t\t\t\t\t</Card.Title>\r\n\t\t\t\t\t</Card.Header>\r\n\t\t\t\t\t<Card.Body>\r\n\t\t\t\t\t\t<Form style={{ padding: '20px' }}>\r\n\t\t\t\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"titleTooltip\">{t('announcement-title')}</Tooltip>}>\r\n\t\t\t\t\t\t\t\t<FormGroup controlId=\"form-title\" >\r\n\t\t\t\t\t\t\t\t\t<FormLabel>{t('common:title')}</FormLabel>\r\n\t\t\t\t\t\t\t\t\t<FormControl\r\n\t\t\t\t\t\t\t\t\t\tname=\"title\"\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tvalue={this.state.title}\r\n\t\t\t\t\t\t\t\t\t\tonChange={this.handleInputChange}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t\t\t<FormGroup controlId=\"form-text\" >\r\n\t\t\t\t\t\t\t\t<FormLabel>{t('announcement-text')}</FormLabel>\r\n\t\t\t\t\t\t\t\t<FormControl\r\n\t\t\t\t\t\t\t\t\tname=\"body\"\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\tas=\"textarea\" rows=\"10\"\r\n\t\t\t\t\t\t\t\t\tvalue={this.state.body}\r\n\t\t\t\t\t\t\t\t\tonChange={this.handleInputChange}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t</FormControl>\r\n\t\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t\t<ButtonGroup>\r\n\t\t\t\t\t\t\t<Button type=\"submit\" disabled={isDisabled} onClick={this.createMessage}>\r\n\t\t\t\t\t\t\t\t{ this.state.mode === 'new-announcement' ? t('common:create') : t('common:update') }\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t<Button onClick={this.clear} disabled={isEmpty} variant=\"danger\">{t('common:clear')}</Button>\r\n\t\t\t\t\t\t</ButtonGroup>\r\n\t\t\t\t\t</Card.Body>\r\n\t\t\t\t</Card>\r\n\t\t\t</div>\r\n\t\t\t<ConfirmModal\r\n\t\t\t\tshow={this.state.showDeleteModal}\r\n\t\t\t\tclose={this.closeDeleteModal}\r\n\t\t\t\tmessage={t('delete-announcement')}\r\n\t\t\t\ttitle={`${t('common:delete')}?`}\r\n\t\t\t\tonConfirm={this.deleteSelectedMessage}\r\n\t\t\t/>\r\n\t\t</div> );\r\n\t}\r\n}\r\n\r\n\r\n// PROPERTIES //\r\n\r\nAnnouncementsPage.propTypes = {\r\n\taddAnnouncement: PropTypes.func.isRequired,\r\n\tdeleteAnnouncement: PropTypes.func.isRequired,\r\n\teditAnnouncement: PropTypes.func.isRequired,\r\n\tnamespace: PropTypes.object.isRequired,\r\n\tuser: PropTypes.object.isRequired\r\n};\r\n\r\nAnnouncementsPage.defaultProps = {\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default withTranslation( [ 'namespace_data', 'common' ] )( AnnouncementsPage );\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component, Fragment } from 'react';\r\nimport ProgressBar from 'react-bootstrap/ProgressBar';\r\nimport clamp from '@stdlib/math/base/special/clamp';\r\nimport './editable_progress.css';\r\n\r\n\r\n// MAIN //\r\n\r\nclass EditableProgress extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\r\n\t\tthis.state = {\r\n\t\t\tisEditing: false,\r\n\t\t\thasChanged: false,\r\n\t\t\tnewProgress: props.progress,\r\n\t\t\toriginalProgress: props.progress\r\n\t\t};\r\n\t}\r\n\r\n\tstatic getDerivedStateFromProps( nextProps, prevState ) {\r\n\t\tif ( nextProps.progress !== prevState.originalProgress ) {\r\n\t\t\treturn {\r\n\t\t\t\tnewProgress: nextProps.progress,\r\n\t\t\t\toriginalProgress: nextProps.progress\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\ttoggleEditing = () => {\r\n\t\tthis.setState({\r\n\t\t\tisEditing: !this.state.isEditing,\r\n\t\t\tnewProgress: this.props.progress\r\n\t\t});\r\n\t};\r\n\r\n\thandleChange = ( event ) => {\r\n\t\tthis.setState({\r\n\t\t\tnewProgress: clamp( event.target.value, 0, 100 ),\r\n\t\t\thasChanged: true\r\n\t\t});\r\n\t};\r\n\r\n\thandleSubmit = () => {\r\n\t\tthis.setState({\r\n\t\t\tisEditing: false,\r\n\t\t\thasChanged: false\r\n\t\t});\r\n\t\tthis.props.onSubmit( this.state.newProgress );\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\tthis.state.isEditing ?\r\n\t\t\t<Fragment>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\tvalue={this.state.newProgress}\r\n\t\t\t\t\tmin={0}\r\n\t\t\t\t\tmax={100}\r\n\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t\tclassName=\"editable-progress-input\"\r\n\t\t\t\t/>\r\n\t\t\t\t<i\r\n\t\t\t\t\trole=\"button\" tabIndex={0}\r\n\t\t\t\t\tonClick={this.toggleEditing}\r\n\t\t\t\t\tonKeyPress={this.toggleEditing}\r\n\t\t\t\t\tclassName=\"fas fa-window-close editable-progress-close\"\r\n\t\t\t\t></i>\r\n\t\t\t\t<span className=\"editable-progress-submit\" style={{ display: this.state.hasChanged ? 'inline' : 'none' }}>\r\n\t\t\t\t\t<i\r\n\t\t\t\t\t\trole=\"button\" tabIndex={0}\r\n\t\t\t\t\t\tonClick={this.handleSubmit}\r\n\t\t\t\t\t\tonKeyPress={this.handleSubmit}\r\n\t\t\t\t\t\tclassName=\"fas fa-check-square\"\r\n\t\t\t\t\t></i>\r\n\t\t\t\t</span>\r\n\t\t\t</Fragment>: <ProgressBar\r\n\t\t\t\taria-label=\"new-progress\"\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tfontSize: '10px',\r\n\t\t\t\t\theight: '12px'\r\n\t\t\t\t}}\r\n\t\t\t\tnow={this.state.newProgress}\r\n\t\t\t\tlabel={`${this.state.newProgress}%`}\r\n\t\t\t\tonClick={this.toggleEditing}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default EditableProgress;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component, Fragment } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport logger from 'debug';\r\nimport { withTranslation } from 'react-i18next';\r\nimport stringify from 'csv-stringify';\r\nimport InputRange from 'react-input-range';\r\nimport Button from 'react-bootstrap/Button';\r\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport DropdownButton from 'react-bootstrap/DropdownButton';\r\nimport Dropdown from 'react-bootstrap/Dropdown';\r\nimport round from '@stdlib/math/base/special/round';\r\nimport min from '@stdlib/math/base/special/min';\r\nimport isArray from '@stdlib/assert/is-array';\r\nimport isUndefinedOrNull from '@stdlib/assert/is-undefined-or-null';\r\nimport contains from '@stdlib/assert/contains';\r\nimport lowercase from '@stdlib/string/lowercase';\r\nimport DashboardTable from 'components/dashboard-table';\r\nimport DashboardDataExplorer from 'ev/components/data-explorer';\r\nimport obsToVar from '@isle-project/utils/obs-to-var';\r\nimport server from 'constants/server';\r\nimport saveAs from 'utils/file_saver.js';\r\nimport createTextColumn from 'utils/create_text_column.js';\r\nimport EditableProgress from './editable_progress.js';\r\nimport formatTime from 'utils/format_time.js';\r\nimport './progress_page.css';\r\nimport 'css/input_range.css';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst debug = logger( 'isle:progress-page' );\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nfunction filterNumbersFactory( lessons, idx ) {\r\n\treturn ( filter, row ) => {\r\n\t\tconst data = row[ filter.id ];\r\n\t\tconst lessonData = data[ lessons[ idx ]._id ];\r\n\t\tif ( isUndefinedOrNull( lessonData ) ) {\r\n\t\t\treturn filter.value.min === 0;\r\n\t\t}\r\n\t\tconst progress = min( round( lessonData.progress*100 ), 100 );\r\n\t\treturn progress >= filter.value.min && progress <= filter.value.max;\r\n\t};\r\n}\r\n\r\nfunction sortFactory( lessons, idx ) {\r\n\treturn ( a, b ) => {\r\n\t\ta = a[ lessons[ idx ]._id ];\r\n\t\tb = b[ lessons[ idx ]._id ];\r\n\t\tif ( !a && !b ) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tif ( a && !b ) {\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\tif ( !a && b ) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tif ( a.progress > b.progress ) {\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\tif ( a.progress < b.progress ) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\treturn 0;\r\n\t};\r\n}\r\n\r\nfunction filterMethodCategories( filter, row ) {\r\n\tif ( filter.value === 'all' ) {\r\n\t\treturn true;\r\n\t}\r\n\tconst id = filter.pivotId || filter.id;\r\n\tif ( row[ id ] === void 0 ) {\r\n\t\treturn true;\r\n\t}\r\n\tif ( isArray( filter.value ) ) {\r\n\t\treturn contains( filter.value, String( row[ id ] ) );\r\n\t}\r\n\treturn String( row[ id ] ) === filter.value;\r\n}\r\n\r\n\r\n// MAIN //\r\n\r\nclass ProgressPage extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\r\n\t\tthis.columns = this.createColumns( props.lessons, props.cohorts );\r\n\t\tthis.state = {\r\n\t\t\tdisplayedMembers: [],\r\n\t\t\tlessonSortDirection: 'ascending',\r\n\t\t\tlessonOrder: 'createdAt',\r\n\t\t\tshowExplorer: false\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.createDisplayedMembers();\r\n\t}\r\n\r\n\tcomponentDidUpdate( prevProps ) {\r\n\t\tif (\r\n\t\t\tthis.props.cohorts !== prevProps.cohorts ||\r\n\t\t\tthis.props.lessons !== prevProps.lessons\r\n\t\t) {\r\n\t\t\tthis.createDisplayedMembers();\r\n\t\t\tthis.columns = this.createColumns( this.props.lessons, this.props.cohorts );\r\n\t\t}\r\n\t}\r\n\r\n\tcreateDisplayedMembers() {\r\n\t\tlet members = [];\r\n\t\tfor ( let i = 0; i < this.props.cohorts.length; i++ ) {\r\n\t\t\tconst cohortMembers = this.props.cohorts[ i ].members;\r\n\t\t\tfor ( let j = 0; j < cohortMembers.length; j++ ) {\r\n\t\t\t\tcohortMembers[ j ].cohort = this.props.cohorts[ i ].title;\r\n\t\t\t\tif ( !cohortMembers[ j ].lessonData ) {\r\n\t\t\t\t\tcohortMembers[ j ].lessonData = {};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmembers = members.concat( this.props.cohorts[ i ].members );\r\n\t\t}\r\n\t\tthis.setState({ // eslint-disable-line react/no-did-mount-set-state\r\n\t\t\tdisplayedMembers: members\r\n\t\t});\r\n\t}\r\n\r\n\tcreateColumns( lessons, cohorts ) {\r\n\t\tconst { t } = this.props;\r\n\t\tconst COLUMNS = [\r\n\t\t\t{\r\n\t\t\t\tHeader: 'Pic',\r\n\t\t\t\taccessor: 'picture',\r\n\t\t\t\tCell: row => (\r\n\t\t\t\t\t<img className=\"table-pic\" src={`${server}/thumbnail/${row.original.picture}`} alt=\"Profile Pic\" />\r\n\t\t\t\t),\r\n\t\t\t\tmaxWidth: 46,\r\n\t\t\t\tminWidth: 46,\r\n\t\t\t\tfilterable: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tsortable: false,\r\n\t\t\t\tstyle: { color: 'darkslategrey' }\r\n\t\t\t},\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:first-name'),\r\n\t\t\t\tid: 'first_name',\r\n\t\t\t\taccessor: 'firstName',\r\n\t\t\t\tmaxWidth: 75,\r\n\t\t\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\t\t\treturn contains( lowercase( row[ filter.id ] ), lowercase( filter.value ) );\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:last-name'),\r\n\t\t\t\tid: 'last_name',\r\n\t\t\t\taccessor: 'lastName',\r\n\t\t\t\tmaxWidth: 75,\r\n\t\t\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\t\t\treturn contains( lowercase( row[ filter.id ] ), lowercase( filter.value ) );\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:email'),\r\n\t\t\t\taccessor: 'email',\r\n\t\t\t\tmaxWidth: 200,\r\n\t\t\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\t\t\treturn contains( lowercase( row[ filter.id ] ), lowercase( filter.value ) );\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\t{\r\n\t\t\t\tHeader: t('common:cohort'),\r\n\t\t\t\taccessor: 'cohort',\r\n\t\t\t\tstyle: { marginTop: '8px', color: 'darkslategrey' },\r\n\t\t\t\tfilterMethod: filterMethodCategories,\r\n\t\t\t\tFilter: ({ filter, onChange }) => {\r\n\t\t\t\t\tconst handleChange = ( event ) => {\r\n\t\t\t\t\t\tconst newValue = event.target.value;\r\n\t\t\t\t\t\tonChange( newValue );\r\n\t\t\t\t\t};\r\n\t\t\t\t\tlet value;\r\n\t\t\t\t\tif ( !filter ) {\r\n\t\t\t\t\t\tvalue = 'all';\r\n\t\t\t\t\t} else if ( isArray( filter.value ) ) {\r\n\t\t\t\t\t\tvalue = filter.value.join( ', ' );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvalue = filter.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tonBlur={handleChange} onChange={handleChange}\r\n\t\t\t\t\t\t\tstyle={{ width: '100%', backgroundColor: 'ghostwhite' }}\r\n\t\t\t\t\t\t\tvalue={value}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"all\">Show All</option>\r\n\t\t\t\t\t\t\t{cohorts.map( ( v, key ) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<option\r\n\t\t\t\t\t\t\t\t\t\tkey={key}\r\n\t\t\t\t\t\t\t\t\t\tvalue={`${v.title}`}\r\n\t\t\t\t\t\t\t\t\t>{v.title}</option>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t];\r\n\t\tfor ( let i = 0; i < lessons.length; i++ ) {\r\n\t\t\tconst id = 'lesson_'+i;\r\n\t\t\tCOLUMNS.push({\r\n\t\t\t\tid,\r\n\t\t\t\tHeader: <span id={id} >{lessons[ i ].title}</span>,\r\n\t\t\t\t_lesson: lessons[ i ],\r\n\t\t\t\tCell: this.accessorFactory( lessons, i ),\r\n\t\t\t\taccessor: 'lessonData',\r\n\t\t\t\tsortMethod: sortFactory( lessons, i ),\r\n\t\t\t\tfilterMethod: filterNumbersFactory( lessons, i ),\r\n\t\t\t\tFilter: ({ filter, onChange }) => {\r\n\t\t\t\t\tconst defaultVal = {\r\n\t\t\t\t\t\tmax: 100,\r\n\t\t\t\t\t\tmin: 0\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<div style={{\r\n\t\t\t\t\t\t\tpaddingLeft: '4px',\r\n\t\t\t\t\t\t\tpaddingRight: '4px',\r\n\t\t\t\t\t\t\tpaddingTop: '8px'\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<InputRange\r\n\t\t\t\t\t\t\t\tariaLabelledby={id}\r\n\t\t\t\t\t\t\t\tariaControls=\"dashboard-table\"\r\n\t\t\t\t\t\t\t\tallowSameValues\r\n\t\t\t\t\t\t\t\tmaxValue={100}\r\n\t\t\t\t\t\t\t\tminValue={0}\r\n\t\t\t\t\t\t\t\tvalue={filter ? filter.value : defaultVal}\r\n\t\t\t\t\t\t\t\tonChange={( newValue ) => {\r\n\t\t\t\t\t\t\t\t\tonChange( newValue );\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn COLUMNS;\r\n\t}\r\n\r\n\taccessorFactory = ( lessons, idx ) => {\r\n\t\tconst { t } = this.props;\r\n\t\treturn d => {\r\n\t\t\tlet data = d.original.lessonData;\r\n\t\t\tconst lessonID = lessons[ idx ]._id;\r\n\t\t\tdata = data[ lessonID ];\r\n\t\t\tif ( data ) {\r\n\t\t\t\tconst progress = min( round( data.progress*100 ), 100 );\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<span style={{ fontSize: '12px', fontWeight: 800 }}>\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"durationTooltip\" >{t('hours-minutes-seconds')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<span>{t('duration')}: {formatTime( data.spentTime )}</span>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"startTooltip\" >{t('first-accessed')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<span> | {new Date( data.createdAt ).toLocaleString()}</span>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"startTooltip\" >{t('last-accessed')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<span> - {new Date( data.updatedAt ).toLocaleString()}</span>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t<EditableProgress\r\n\t\t\t\t\t\t\tprogress={progress}\r\n\t\t\t\t\t\t\temail={d.original.email}\r\n\t\t\t\t\t\t\tlessonID={lessonID}\r\n\t\t\t\t\t\t\tonSubmit={( newProgress ) => {\r\n\t\t\t\t\t\t\t\tthis.props.adjustProgress({\r\n\t\t\t\t\t\t\t\t\temail: d.original.email,\r\n\t\t\t\t\t\t\t\t\tlessonID: lessonID,\r\n\t\t\t\t\t\t\t\t\tnamespaceID: this.props.namespace._id,\r\n\t\t\t\t\t\t\t\t\tcohort: d.original.cohort,\r\n\t\t\t\t\t\t\t\t\tprogress: newProgress\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\treturn <span></span>;\r\n\t\t};\r\n\t};\r\n\r\n\tassembleData() {\r\n\t\tconst displayedMembers = this.dashboardTable.getResolvedState().sortedData;\r\n\t\tconst len = displayedMembers.length;\r\n\t\tconst out = new Array( len );\r\n\t\tconst lessons = this.props.lessons;\r\n\t\tfor ( let i = 0; i < len; i++ ) {\r\n\t\t\tconst member = displayedMembers[ i ]._original;\r\n\t\t\tout[ i ] = {\r\n\t\t\t\tname: member.name,\r\n\t\t\t\tfirstName: member.firstName,\r\n\t\t\t\tlastName: member.lastName,\r\n\t\t\t\temail: member.email,\r\n\t\t\t\tcohort: member.cohort\r\n\t\t\t};\r\n\t\t\tconst availableCustomFields = this.props.user.availableCustomFields;\r\n\t\t\tfor ( let j = 0; j < availableCustomFields.length; j++ ) {\r\n\t\t\t\tconst fieldName = availableCustomFields[ j ].name;\r\n\t\t\t\tif ( member.customFields ) {\r\n\t\t\t\t\tout[ i ][ fieldName ] = member.customFields[ fieldName ];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tout[ i ][ fieldName ] = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor ( let j = 0; j < lessons.length; j++ ) {\r\n\t\t\t\tconst lessonName = lessons[ j ]._id;\r\n\t\t\t\tlet data = member.lessonData;\r\n\t\t\t\tif ( data && data[ lessonName ] ) {\r\n\t\t\t\t\tdata = data[ lessonName ];\r\n\t\t\t\t\tout[ i ][ lessons[ j ].title+'_question_progress' ] = min( round( data.progress*100 ), 100 );\r\n\t\t\t\t\tout[ i ][ lessons[ j ].title+'_time' ] = round( data.spentTime / ( 1000*60 ) );\r\n\t\t\t\t\tout[ i ][ lessons[ j ].title+'_first_accessed' ] = new Date( data.createdAt ).toLocaleString();\r\n\t\t\t\t\tout[ i ][ lessons[ j ].title+'_last_accessed' ] = new Date( data.updatedAt ).toLocaleString();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tout[ i ][ lessons[ j ].title+'_question_progress' ] = 0;\r\n\t\t\t\t\tout[ i ][ lessons[ j ].title+'_time' ] = 0;\r\n\t\t\t\t\tout[ i ][ lessons[ j ].title+'_first_accessed' ] = '';\r\n\t\t\t\t\tout[ i ][ lessons[ j ].title+'_last_accessed' ] = '';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn out;\r\n\t}\r\n\r\n\tsaveJSON = () => {\r\n\t\tconst data = this.assembleData();\r\n\t\tconst blob = new Blob([ JSON.stringify( data ) ], {\r\n\t\t\ttype: 'application/json'\r\n\t\t});\r\n\t\tconst name = `completion_${this.props.namespace.title}.json`;\r\n\t\tsaveAs( blob, name );\r\n\t};\r\n\r\n\tsaveCSV = () => {\r\n\t\tconst data = this.assembleData();\r\n\t\tstringify( data, {\r\n\t\t\theader: true\r\n\t\t}, ( err, output ) => {\r\n\t\t\tif ( err ) {\r\n\t\t\t\treturn this.props.addNotification({\r\n\t\t\t\t\ttitle: 'Error encountered',\r\n\t\t\t\t\tmessage: 'Encountered an error while creating CSV: '+err.message,\r\n\t\t\t\t\tlevel: 'error',\r\n\t\t\t\t\tposition: 'tl'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tconst blob = new Blob([ output ], {\r\n\t\t\t\ttype: 'text/plain'\r\n\t\t\t});\r\n\t\t\tconst name = `completion_${this.props.namespace.title}.csv`;\r\n\t\t\tsaveAs( blob, name );\r\n\t\t});\r\n\t};\r\n\r\n\ttoggleExplorer = () => {\r\n\t\tthis.setState({\r\n\t\t\tshowExplorer: !this.state.showExplorer\r\n\t\t});\r\n\t};\r\n\r\n\treorderColumns( lessonOrder, lessonSortDirection ) {\r\n\t\tdebug( 'Sort columns by '+lessonOrder+' in '+lessonSortDirection+' order' );\r\n\t\tif ( lessonSortDirection === 'ascending' ) {\r\n\t\t\treturn this.columns.slice().sort( ( a, b ) => {\r\n\t\t\t\tif ( !a._lesson || !b._lesson ) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\t\t\t\tif ( lessonOrder === 'title' ) {\r\n\t\t\t\t\treturn a._lesson.title.localeCompare( b._lesson.title );\r\n\t\t\t\t}\r\n\t\t\t\treturn a._lesson[ lessonOrder ] > b._lesson[ lessonOrder ] ? 1 : -1;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this.columns.slice().sort( ( a, b ) => {\r\n\t\t\tif ( !a._lesson || !b._lesson ) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\tif ( lessonOrder === 'title' ) {\r\n\t\t\t\treturn b._lesson.title.localeCompare( a._lesson.title );\r\n\t\t\t}\r\n\t\t\treturn a._lesson[ lessonOrder ] < b._lesson[ lessonOrder ] ? 1 : -1;\r\n\t\t});\r\n\t}\r\n\r\n\trenderSortButton() {\r\n\t\tconst { t } = this.props;\r\n\t\tlet title;\r\n\t\tswitch ( this.state.lessonOrder ) {\r\n\t\t\tcase 'title':\r\n\t\t\t\ttitle = t('common:sort-alphabetically');\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'createdAt':\r\n\t\t\t\ttitle = t('common:sort-create-date');\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'updatedAt':\r\n\t\t\t\ttitle = t('common:sort-update-date');\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<ButtonGroup className=\"sort-button-group\" >\r\n\t\t\t\t<DropdownButton size=\"sm\" variant=\"secondary\" onSelect={( newValue ) => {\r\n\t\t\t\t\tthis.columns = this.reorderColumns( newValue, this.state.lessonSortDirection );\r\n\t\t\t\t\tthis.setState({ lessonOrder: newValue });\r\n\t\t\t\t}} id=\"dropdown\" title={<small>{title}</small>} >\r\n\t\t\t\t\t<Dropdown.Item eventKey=\"title\" >\r\n\t\t\t\t\t\t<small>{t('common:sort-alphabetically')}</small>\r\n\t\t\t\t\t</Dropdown.Item>\r\n\t\t\t\t\t<Dropdown.Item eventKey=\"createdAt\" >\r\n\t\t\t\t\t\t<small>{t('common:sort-create-date')}</small>\r\n\t\t\t\t\t</Dropdown.Item>\r\n\t\t\t\t\t<Dropdown.Item eventKey=\"updatedAt\" >\r\n\t\t\t\t\t\t<small>{t('common:sort-update-date')}</small>\r\n\t\t\t\t\t</Dropdown.Item>\r\n\t\t\t\t</DropdownButton>\r\n\t\t\t\t<Button size=\"sm\" variant=\"secondary\" style={{ marginLeft: 2 }} onClick={() => {\r\n\t\t\t\t\tif ( this.state.lessonSortDirection === 'ascending' ) {\r\n\t\t\t\t\t\tthis.columns = this.reorderColumns( this.state.lessonOrder, 'descending' );\r\n\t\t\t\t\t\tthis.setState({ lessonSortDirection: 'descending' });\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.columns = this.reorderColumns( this.state.lessonOrder, 'ascending' );\r\n\t\t\t\t\t\tthis.setState({ lessonSortDirection: 'ascending' });\r\n\t\t\t\t\t}\r\n\t\t\t\t}} aria-label={this.state.lessonSortDirection === 'ascending' ?\r\n\t\t\t\tt('common:sort-descending') : t('common:sort-ascending')} >\r\n\t\t\t\t\t{ this.state.lessonSortDirection === 'ascending' ?\r\n\t\t\t\t\t\t<i className=\"fas fa-arrow-right\" /> :\r\n\t\t\t\t\t\t<i className=\"fas fa-arrow-left\" />\r\n\t\t\t\t\t}\r\n\t\t\t\t</Button>\r\n\t\t\t</ButtonGroup>\r\n\t\t);\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { t } = this.props;\r\n\t\tif ( this.state.showExplorer ) {\r\n\t\t\tlet data = this.assembleData();\r\n\t\t\tdata = obsToVar( data );\r\n\t\t\tconst quantitative = [];\r\n\t\t\tconst categorical = [ 'name', 'email', 'cohort' ];\r\n\t\t\tfor ( let i = 0; i < this.props.lessons.length; i++ ) {\r\n\t\t\t\tconst title = this.props.lessons[ i ].title;\r\n\t\t\t\tquantitative.push( `${title}_question_progress` );\r\n\t\t\t\tquantitative.push( `${title}_time` );\r\n\t\t\t\tcategorical.push( `${title}_first_accessed` );\r\n\t\t\t\tcategorical.push( `${title}_last_accessed` );\r\n\t\t\t}\r\n\t\t\tconst availableCustomFields = this.props.user.availableCustomFields;\r\n\t\t\tfor ( let i = 0; i < availableCustomFields.length; i++ ) {\r\n\t\t\t\tcategorical.push( availableCustomFields[ i ].name );\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<DashboardDataExplorer\r\n\t\t\t\t\ttitle={t('explorer-progress-title')}\r\n\t\t\t\t\tdata={data}\r\n\t\t\t\t\tcategorical={categorical}\r\n\t\t\t\t\tquantitative={quantitative}\r\n\t\t\t\t\tclose={this.toggleExplorer}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<div className=\"namespace-data-buttons\" >\r\n\t\t\t\t\t{this.renderSortButton()}\r\n\t\t\t\t\t<ButtonGroup className=\"progress-button-group\" >\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"csvTooltip\" >{t('save-as-csv')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<Button size=\"sm\" variant=\"secondary\" onClick={this.saveCSV} ><i className=\"fas fa-download\"></i> CSV</Button>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"jsonTooltip\">{t('save-as-json')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<Button size=\"sm\" variant=\"secondary\" onClick={this.saveJSON} ><i className=\"fas fa-download\"></i> JSON</Button>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t</ButtonGroup>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"namespace-data-page\">\r\n\t\t\t\t\t<DashboardTable\r\n\t\t\t\t\t\tclassName=\"progress-table\"\r\n\t\t\t\t\t\tdata={this.state.displayedMembers}\r\n\t\t\t\t\t\tcolumns={this.columns}\r\n\t\t\t\t\t\tt={t}\r\n\t\t\t\t\t\tref={(r) => {\r\n\t\t\t\t\t\t\tthis.dashboardTable = r;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonButtonClick={this.toggleExplorer}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\n// PROPERTIES //\r\n\r\nProgressPage.propTypes = {\r\n\taddNotification: PropTypes.func.isRequired,\r\n\tadjustProgress: PropTypes.func.isRequired,\r\n\tcohorts: PropTypes.array.isRequired,\r\n\tlessons: PropTypes.array.isRequired,\r\n\tnamespace: PropTypes.object.isRequired,\r\n\tuser: PropTypes.object.isRequired\r\n};\r\n\r\nProgressPage.defaultProps = {\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default withTranslation( [ 'namespace_data', 'common' ] )( ProgressPage );\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component, Fragment } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport ProgressBar from 'react-bootstrap/ProgressBar';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport Select from 'react-select';\r\nimport round from '@stdlib/math/base/special/round';\r\nimport min from '@stdlib/math/base/special/min';\r\nimport contains from '@stdlib/assert/contains';\r\nimport server from 'constants/server';\r\nimport formatTime from 'utils/format_time.js';\r\nimport './cohorts.css';\r\n\r\n\r\n// MAIN //\r\n\r\nclass CohortsPage extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\r\n\t\tconst cohortOptions = props.cohorts.map( cohort => {\r\n\t\t\treturn { label: cohort.title, value: cohort.title, data: cohort };\r\n\t\t});\r\n\r\n\t\tlet displayedMembers = [];\r\n\t\tfor ( let i = 0; i < props.cohorts.length; i++ ) {\r\n\t\t\tdisplayedMembers = displayedMembers.concat( props.cohorts[i].members);\r\n\t\t}\r\n\r\n\t\tthis.state = {\r\n\t\t\tcohortOptions: cohortOptions,\r\n\t\t\tselectedCohorts: cohortOptions,\r\n\t\t\tdisplayedMembers: displayedMembers,\r\n\t\t\tactualMember: null\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidUpdate( prevProps ) {\r\n\t\tif ( this.props.cohorts !== prevProps.cohorts ) {\r\n\t\t\tconst cohortOptions = this.props.cohorts.map( cohort => {\r\n\t\t\t\treturn { label: cohort.title, value: cohort.title, data: cohort };\r\n\t\t\t});\r\n\t\t\tlet displayedMembers = [];\r\n\t\t\tfor ( let i = 0; i < this.props.cohorts.length; i++ ) {\r\n\t\t\t\tdisplayedMembers = displayedMembers.concat( this.props.cohorts[i].members);\r\n\t\t\t}\r\n\t\t\tthis.setState({\r\n\t\t\t\tcohortOptions: cohortOptions,\r\n\t\t\t\tselectedCohorts: cohortOptions,\r\n\t\t\t\tdisplayedMembers: displayedMembers,\r\n\t\t\t\tactualMember: null\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\thandleCohortChange = ( cohorts ) => {\r\n\t\tlet members = [];\r\n\t\tif ( cohorts ) {\r\n\t\t\tfor ( let i = 0; i < cohorts.length; i++ ) {\r\n\t\t\t\tmembers = members.concat( cohorts[ i ].data.members );\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\tselectedCohorts: cohorts,\r\n\t\t\tdisplayedMembers: members\r\n\t\t});\r\n\t};\r\n\r\n\tshowUser = (member) => {\r\n\t\tthis.setState({\r\n\t\t\tactualMember: member\r\n\t\t});\r\n\t};\r\n\r\n\trenderMember( member, key ) {\r\n\t\tlet phase = 0.3 + key*0.05;\r\n\t\tlet ani = 'scale-up ' + phase + 's';\r\n\t\treturn (\r\n\t\t\t<Fragment key={key}>\r\n\t\t\t\t<div className=\"cohort-member\" role=\"button\"\r\n\t\t\t\t\tonClick={() => this.showUser( member )}\r\n\t\t\t\t\tonKeyPress={() => this.showUser( member )}\r\n\t\t\t\t\tstyle={{ animation: ani }} tabIndex={0}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div className=\"cohort-member-name\">{member.name}</div>\r\n\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\tsrc={server + '/thumbnail/'+member.picture}\r\n\t\t\t\t\t\t\talt=\"Member Profile Pic\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<div className=\"cohort-member-email\">\r\n\t\t\t\t\t\t\t<a href={'mailto:' + member.email}>{member.email}</a>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</Fragment>\r\n\t\t);\r\n\t}\r\n\r\n\trenderCohort() {\r\n\t\tconst members = this.state.displayedMembers;\r\n\t\tconst list = [];\r\n\t\tfor ( let i = 0; i < members.length; i++ ) {\r\n\t\t\tlist.push( this.renderMember( members[ i ], i ) );\r\n\t\t}\r\n\t\treturn list;\r\n\t}\r\n\r\n\trenderMemberLessons( member ) {\r\n\t\tconst lessons = this.props.lessons;\r\n\t\tconst list = [];\r\n\t\tlet progress = 0;\r\n\t\tlet spentTime = 0;\r\n\t\tlet totalTime = 0;\r\n\r\n\t\tfor ( let i = 0; i < lessons.length; i++ ) {\r\n\t\t\tlet id = lessons[i]._id;\r\n\t\t\tif ( member.lessonData && member.lessonData[ id ] ) {\r\n\t\t\t\tconst data = member.lessonData[ id ];\r\n\t\t\t\tprogress = min( round( data.progress * 100 ), 100 );\r\n\t\t\t\tspentTime = formatTime( data.spentTime );\r\n\t\t\t\ttotalTime += data.spentTime;\r\n\t\t\t} else {\r\n\t\t\t\tprogress = 0;\r\n\t\t\t\tspentTime = formatTime( 0 );\r\n\t\t\t}\r\n\t\t\tlist.push(\r\n\t\t\t\t<div key={i} >\r\n\t\t\t\t\t<div className=\"cohort-actual-member-lesson-title\">{lessons[i].title}</div>\r\n\t\t\t\t\t<ProgressBar aria-label=\"lesson-progress\" className=\"cohort-actual-member-lesson-progress\" style={{ float: 'left', fontSize: '10px', height: '12px'\r\n\t\t\t\t\t}} now={progress} label={`${progress}%`} />\r\n\t\t\t\t\t<span className=\"cohort-actual-member-lesson-time\">{spentTime}</span>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t}\r\n\t\ttotalTime = formatTime( totalTime );\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<hr />\r\n\t\t\t\t<div className=\"cohort-actual-member-lesson-header\">COURSE INFO</div>\r\n\t\t\t\t<div className=\"cohort-actual-member-lesson-total\">COURSE TOTAL TIME: {totalTime}</div>\r\n\t\t\t\t<div className=\"lessons-area\">\r\n\t\t\t\t\t{list}\r\n\t\t\t\t</div>\r\n\t\t\t</Fragment>\r\n\t\t);\r\n\t}\r\n\r\n\tcloseActualMember = () => {\r\n\t\tthis.setState({\r\n\t\t\tactualMember: null\r\n\t\t});\r\n\t};\r\n\r\n\trenderMemberBadges(member) {\r\n\t\tconst badges = this.props.badges;\r\n\t\tconst time = formatTime( member.spentTime );\r\n\t\tconst list = [];\r\n\t\tfor ( let i = 0; i < badges.length; i++ ) {\r\n\t\t\tif ( contains(member.badges, badges[i].name ) ) {\r\n\t\t\t\tlist.push(\r\n\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t<OverlayTrigger\r\n\t\t\t\t\t\t\tplacement=\"bottom\"\r\n\t\t\t\t\t\t\toverlay={<Tooltip id=\"isleTime\">{badges[i].description}</Tooltip>}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div className=\"cohort-user-badge\" >\r\n\t\t\t\t\t\t\t\t<img src={server + '/badges/' + badges[i].picture} alt=\"User Badge\" />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t</Fragment>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst isleTime = 'the time the user spent with ISLE';\r\n\t\tconst scoreComment = 'user score';\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<div>General User Info</div>\r\n\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"isleTime\">{ isleTime }</Tooltip>}>\r\n\t\t\t\t\t<span className=\"user-info-time\">ISLE TIME: {time}</span>\r\n\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"isleTime\">{ scoreComment }</Tooltip>}>\r\n\t\t\t\t\t<span className=\"user-info-score\">SCORE: {member.score}</span>\r\n\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t<div></div>\r\n\t\t\t\t<div className=\"user-info-badges\">\r\n\t\t\t\t\t<div className=\"user-info-separator\">Badges</div>\r\n\t\t\t\t\t{list}\r\n\t\t\t\t</div>\r\n\t\t\t</Fragment>\r\n\t\t);\r\n\t}\r\n\r\n\trenderActualMember() {\r\n\t\tconst member = this.state.actualMember;\r\n\t\tlet date = null;\r\n\t\tif ( member.createdAt ) {\r\n\t\t\tdate = new Date( member.createdAt ).toLocaleDateString();\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<div className=\"cohort-actual-member\">\r\n\t\t\t\t<button onClick={this.closeActualMember} className=\"cohort-actual-member-exit empty-button\" >&#10005;</button>\r\n\t\t\t\t<img className=\"cohort-actual-member-portrait\" src={server + '/avatar/'+member.picture} alt=\"User Profile Pic\" />\r\n\t\t\t\t<div className=\"cohort-actual-member-portrait-shadow\" />\r\n\t\t\t\t{date ? <div className=\"cohort-actual-member-registered\">registered since {date}</div> : null}\r\n\t\t\t\t<div className=\"cohort-actual-member-name\">\r\n\t\t\t\t\t<h3>{member.name}</h3>\r\n\t\t\t\t\t<div>{member.email}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"cohort-actual-member-info\">\r\n\t\t\t\t\t{ this.renderMemberLessons(member)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"cohort-actual-member-badges\">\r\n\t\t\t\t\t{ this.renderMemberBadges(member) }\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"namespace-data-page\">\r\n\t\t\t\t<div style={{ width: '100%', height: '40px' }}>\r\n\t\t\t\t\t<Select\r\n\t\t\t\t\t\tvalue={this.state.selectedCohorts}\r\n\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\tname=\"cohorts\"\r\n\t\t\t\t\t\taria-label=\"Select cohorts\"\r\n\t\t\t\t\t\tplaceholder=\"Select cohorts to display\"\r\n\t\t\t\t\t\toptions={this.state.cohortOptions}\r\n\t\t\t\t\t\tonChange={this.handleCohortChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"cohort-page\">\r\n\t\t\t\t\t{this.renderCohort()}\r\n\t\t\t\t</div>\r\n\t\t\t\t{this.state.actualMember ? this.renderActualMember() : null}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\n// PROPERTIES //\r\n\r\nCohortsPage.propTypes = {\r\n\tbadges: PropTypes.array.isRequired,\r\n\tcohorts: PropTypes.array.isRequired,\r\n\tlessons: PropTypes.array.isRequired\r\n};\r\n\r\nCohortsPage.defaultProps = {\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default CohortsPage;\r\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport axios from 'axios';\nimport stringify from 'csv-stringify';\nimport { withTranslation } from 'react-i18next';\nimport Select from 'react-select';\nimport InputRange from 'react-input-range';\nimport Button from 'react-bootstrap/Button';\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Form from 'react-bootstrap/Form';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Tooltip from 'react-bootstrap/Tooltip';\nimport isArray from '@stdlib/assert/is-array';\nimport contains from '@stdlib/assert/contains';\nimport lowercase from '@stdlib/string/lowercase';\nimport roundn from '@stdlib/math/base/special/roundn';\nimport lpad from '@stdlib/string/left-pad';\nimport DashboardTable from 'components/dashboard-table';\nimport ComputeModal from 'components/completions/compute_modal.js';\nimport DashboardDataExplorer from 'ev/components/data-explorer';\nimport obsToVar from '@isle-project/utils/obs-to-var';\nimport server from 'constants/server';\nimport saveAs from 'utils/file_saver.js';\nimport createTextColumn from 'utils/create_text_column.js';\nimport './progress_page.css';\nimport 'css/input_range.css';\n\n\n// FUNCTIONS //\n\nfunction filterMethodCategories( filter, row ) {\n\tif ( filter.value === 'all' ) {\n\t\treturn true;\n\t}\n\tconst id = filter.pivotId || filter.id;\n\tif ( row[ id ] === void 0 ) {\n\t\treturn true;\n\t}\n\tif ( isArray( filter.value ) ) {\n\t\treturn contains( filter.value, String( row[ id ] ) );\n\t}\n\treturn String( row[ id ] ) === filter.value;\n}\n\n/**\n * Extracts metrics from cohort members for the chosen scope and returns a list of metrics.\n *\n * @param {Array} cohorts - array of cohorts\n * @param {Object} scope - scope of the completions (with 'value' key having value either `course-wide` or a lesson identifier)\n * @param {Object} namespace - namespace object\n * @returns {Array} array of objects with label (name of the metric) and value (key in user object)\n */\nfunction extractMetricSet( cohorts, scope, namespace ) {\n\tconst metricSet = new Set();\n\tconst metricLabels = {};\n\tconst keyCriterion = scope.value === 'course-wide' ? `namespace-${namespace._id}-` : `lesson-${scope.value}-`;\n\tfor ( let i = 0; i < cohorts.length; i++ ) {\n\t\tfor ( let j = 0; j < cohorts[ i ].members.length; j++ ) {\n\t\t\tconsole.log( 'Cohorts: ', cohorts[ i ] );\n\t\t\tconst userCompletions = Object.keys( cohorts[ i ].members[ j ].completions || {} );\n\t\t\tfor ( let k = 0; k < userCompletions.length; ++k ) {\n\t\t\t\tconst key = userCompletions[k];\n\t\t\t\tif ( key.startsWith(keyCriterion) ) {\n\t\t\t\t\tmetricSet.add( key );\n\t\t\t\t\tmetricLabels[ key ] = cohorts[ i ].members[ j ].completions[ key ].metricName;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tconst uniqueMetrics = [];\n\tmetricSet.forEach( key => {\n\t\tuniqueMetrics.push( { value: key, label: metricLabels[ key ] } );\n\t});\n\tuniqueMetrics.sort( (a, b) => a.label.localeCompare( b.label ) );\n\treturn uniqueMetrics;\n}\n\nfunction metricObject( scope, name, namespace, lessons ) {\n\tif ( scope.value === 'course-wide' ) {\n\t\treturn namespace.completions.find( c => c.name === name );\n\t}\n\tconst lesson = lessons.find( x => x._id === scope.value );\n\tif ( !lesson ) {\n\t\treturn null;\n\t}\n\treturn lesson.completions.find( c => c.name === name );\n}\n\n\n// MAIN //\n\nclass CompletionsPage extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tconst scope = { value: 'course-wide', label: props.t('common:course-wide') };\n\t\tthis.metrics = extractMetricSet( props.cohorts, scope, props.namespace );\n\t\tthis.columns = this.createColumns( props.lessons, props.cohorts );\n\t\tthis.state = {\n\t\t\tdisplayedMembers: [],\n\t\t\tshowExplorer: false,\n\t\t\tscope: scope,\n\t\t\tshowComputeModal: false,\n\t\t\ttags: [],\n\t\t\tcomputeMetric: null\n\t\t};\n\t\tthis.beginningOfDay = new Date( new Date().setHours( 0, 0, 0, 0 ) );\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.createDisplayedMembers();\n\t\tconst lessonIds = this.props.namespace.lessons.map( lesson => lesson._id );\n\t\taxios.post( `${server}/completion_tags`, {\n\t\t\tlessons: lessonIds\n\t\t})\n\t\t\t.then( response => {\n\t\t\t\tthis.setState({ tags: response.data });\n\t\t\t})\n\t\t\t.catch( err => {\n\t\t\t\tconsole.log( 'Error fetching completion tags:', err );\n\t\t\t\tthis.setState({\n\t\t\t\t\ttags: [\n\t\t\t\t\t\t'quiz',\n\t\t\t\t\t\t'homework',\n\t\t\t\t\t\t'exam',\n\t\t\t\t\t\t'_default_tag'\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tcomponentDidUpdate( prevProps, prevState ) {\n\t\tif (\n\t\t\tthis.props.cohorts !== prevProps.cohorts ||\n\t\t\tthis.props.lessons !== prevProps.lessons ||\n\t\t\tthis.state.scope !== prevState.scope\n\t\t) {\n\t\t\tthis.metrics = extractMetricSet( this.props.cohorts, this.state.scope, this.props.namespace );\n\t\t\tthis.columns = this.createColumns( this.props.lessons, this.props.cohorts );\n\t\t\tthis.createDisplayedMembers();\n\t\t}\n\t}\n\n\tcreateDisplayedMembers() {\n\t\tlet members = [];\n\t\tfor ( let i = 0; i < this.props.cohorts.length; i++ ) {\n\t\t\tconst cohortMembers = this.props.cohorts[ i ].members;\n\t\t\tfor ( let j = 0; j < cohortMembers.length; j++ ) {\n\t\t\t\tcohortMembers[ j ].cohort = this.props.cohorts[ i ].title;\n\t\t\t\tif ( !cohortMembers[ j ].lessonGrades ) {\n\t\t\t\t\tcohortMembers[ j ].lessonGrades = {};\n\t\t\t\t}\n\t\t\t}\n\t\t\tmembers = members.concat( this.props.cohorts[ i ].members );\n\t\t}\n\t\tthis.setState({ // eslint-disable-line react/no-did-mount-set-state\n\t\t\tdisplayedMembers: members\n\t\t});\n\t}\n\n\tcreateColumns( lessons, cohorts ) {\n\t\tconst { t } = this.props;\n\t\tconst COLUMNS = [\n\t\t\t{\n\t\t\t\tHeader: 'Pic',\n\t\t\t\taccessor: 'picture',\n\t\t\t\tCell: row => (\n\t\t\t\t\t<img className=\"table-pic\" src={`${server}/thumbnail/${row.original.picture}`} alt=\"Profile Pic\" />\n\t\t\t\t),\n\t\t\t\tmaxWidth: 46,\n\t\t\t\tminWidth: 46,\n\t\t\t\tfilterable: false,\n\t\t\t\tresizable: false,\n\t\t\t\tsortable: false,\n\t\t\t\tstyle: { color: 'darkslategrey' }\n\t\t\t},\n\t\t\tcreateTextColumn({\n\t\t\t\tHeader: t('common:first-name'),\n\t\t\t\tid: 'first_name',\n\t\t\t\taccessor: 'firstName',\n\t\t\t\tmaxWidth: 75,\n\t\t\t\tfilterMethod: ( filter, row ) => {\n\t\t\t\t\treturn contains( lowercase( row[ filter.id ] ), lowercase( filter.value ) );\n\t\t\t\t}\n\t\t\t}),\n\t\t\tcreateTextColumn({\n\t\t\t\tHeader: t('common:last-name'),\n\t\t\t\tid: 'last_name',\n\t\t\t\taccessor: 'lastName',\n\t\t\t\tmaxWidth: 75,\n\t\t\t\tfilterMethod: ( filter, row ) => {\n\t\t\t\t\treturn contains( lowercase( row[ filter.id ] ), lowercase( filter.value ) );\n\t\t\t\t}\n\t\t\t}),\n\t\t\tcreateTextColumn({\n\t\t\t\tHeader: t('common:email'),\n\t\t\t\taccessor: 'email',\n\t\t\t\tmaxWidth: 200,\n\t\t\t\tfilterMethod: ( filter, row ) => {\n\t\t\t\t\treturn contains( lowercase( row[ filter.id ] ), lowercase( filter.value ) );\n\t\t\t\t}\n\t\t\t}),\n\t\t\t{\n\t\t\t\tHeader: t('common:cohort'),\n\t\t\t\taccessor: 'cohort',\n\t\t\t\tstyle: { marginTop: '8px', color: 'darkslategrey' },\n\t\t\t\tfilterMethod: filterMethodCategories,\n\t\t\t\tFilter: ({ filter, onChange }) => {\n\t\t\t\t\tconst handleChange = ( event ) => {\n\t\t\t\t\t\tconst newValue = event.target.value;\n\t\t\t\t\t\tonChange( newValue );\n\t\t\t\t\t};\n\t\t\t\t\tlet value;\n\t\t\t\t\tif ( !filter ) {\n\t\t\t\t\t\tvalue = 'all';\n\t\t\t\t\t} else if ( isArray( filter.value ) ) {\n\t\t\t\t\t\tvalue = filter.value.join( ', ' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue = filter.value;\n\t\t\t\t\t}\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tonBlur={handleChange} onChange={handleChange}\n\t\t\t\t\t\t\tstyle={{ width: '100%', backgroundColor: 'ghostwhite' }}\n\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"all\">Show All</option>\n\t\t\t\t\t\t\t{cohorts.map( ( v, key ) => {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\t\tkey={key}\n\t\t\t\t\t\t\t\t\t\tvalue={`${v.title}`}\n\t\t\t\t\t\t\t\t\t>{v.title}</option>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tfor ( let i = 0; i < this.metrics.length; i++ ) {\n\t\t\tCOLUMNS.push({\n\t\t\t\tHeader: this.metrics[ i ].label,\n\t\t\t\taccessor: 'completions.'+this.metrics[ i ].value,\n\t\t\t\tCell: row => {\n\t\t\t\t\t// Check whether `lastUpdated` is on the same day as `now`\n\t\t\t\t\tif ( !row.value ) {\n\t\t\t\t\t\treturn <span></span>;\n\t\t\t\t\t}\n\t\t\t\t\tconst lastUpdated = row.value.lastUpdated;\n\t\t\t\t\tconst score = row.value.instance?.score ?? -999;\n\t\t\t\t\tconst missing = ' ';  // Value displayed for a missing score\n\t\t\t\t\t// ATTN:TODO - add click on score to show dismissible provenance table,\n\t\t\t\t\t// ATTN:TODO   should show level, entity title, score, time recorded, and tag\n\t\t\t\t\t// ATTN:TODO   in hierarchical display that reveals the structure\n\t\t\t\t\t// ATTN:TODO   and lets one show/hide whole levels and filter on tags or more\n\t\t\t\t\tlet displayDate = '';\n\t\t\t\t\tif ( lastUpdated instanceof Date ) {\n\t\t\t\t\t\tif ( lastUpdated >= this.beginningOfDay ) {\n\t\t\t\t\t\t\tdisplayDate = lastUpdated.toLocaleTimeString();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tdisplayDate = lastUpdated.toLocaleDateString();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdisplayDate = lastUpdated;\n\t\t\t\t\t}\n\t\t\t\t\treturn ( <OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"tooltip\">{`${t('last-updated')} ${displayDate}`}</Tooltip>} >\n\t\t\t\t\t\t<span style={{ whiteSpace: 'pre' }}>\n\t\t\t\t\t\t\t{lpad( score < 0 ? missing : String(roundn( score, -1 ).toFixed( 1 )), 5, '  ' )}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</OverlayTrigger> );\n\t\t\t\t},\n\t\t\t\tFilter: ({ filter, onChange }) => {\n\t\t\t\t\tconst defaultVal = {\n\t\t\t\t\t\tmax: 100,\n\t\t\t\t\t\tmin: 0\n\t\t\t\t\t};\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div className=\"completions-column\" style={{\n\t\t\t\t\t\t\tpaddingLeft: '4px',\n\t\t\t\t\t\t\tpaddingRight: '4px',\n\t\t\t\t\t\t\tpaddingTop: '8px'\n\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t<InputRange\n\t\t\t\t\t\t\t\tariaControls=\"dashboard-table\"\n\t\t\t\t\t\t\t\tallowSameValues\n\t\t\t\t\t\t\t\tmaxValue={100}\n\t\t\t\t\t\t\t\tminValue={0}\n\t\t\t\t\t\t\t\tvalue={filter ? filter.value : defaultVal}\n\t\t\t\t\t\t\t\tonChange={( newValue ) => {\n\t\t\t\t\t\t\t\t\tonChange( newValue );\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"tooltip\">{t('recompute-score')}</Tooltip>} >\n\t\t\t\t\t\t\t\t<Button size=\"sm\" style={{ marginLeft: 20 }} onClick={() => {\n\t\t\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\t\t\tcomputeMetric: metricObject( this.state.scope, this.metrics[ i ].label, this.props.namespace, this.props.lessons ),\n\t\t\t\t\t\t\t\t\t\tshowComputeModal: true\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}} >\n\t\t\t\t\t\t\t\t\t<i className=\"fas fa-solid fa-calculator\"></i>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</OverlayTrigger>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tfilterMethod: ( filter, row ) => {\n\t\t\t\t\treturn row[ filter.id ].instance.score >= filter.value.min && row[ filter.id ].instance.score <= filter.value.max;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn COLUMNS;\n\t}\n\n\tassembleData() {\n\t\tconst displayedMembers = this.dashboardTable.getResolvedState().sortedData;\n\t\tconst len = displayedMembers.length;\n\t\tconst out = new Array( len );\n\t\tfor ( let i = 0; i < len; i++ ) {\n\t\t\tconst member = displayedMembers[ i ]._original;\n\t\t\tout[ i ] = {\n\t\t\t\tname: member.name,\n\t\t\t\tfirstName: member.firstName,\n\t\t\t\tlastName: member.lastName,\n\t\t\t\temail: member.email,\n\t\t\t\tcohort: member.cohort\n\t\t\t};\n\t\t}\n\t\treturn out;\n\t}\n\n\tsaveJSON = () => {\n\t\tconst data = this.assembleData();\n\t\tconst blob = new Blob([ JSON.stringify( data ) ], {\n\t\t\ttype: 'application/json'\n\t\t});\n\t\tconst name = `completions_${this.props.namespace.title}.json`;\n\t\tsaveAs( blob, name );\n\t};\n\n\tsaveCSV = () => {\n\t\tconst data = this.assembleData();\n\t\tstringify( data, {\n\t\t\theader: true\n\t\t}, ( err, output ) => {\n\t\t\tif ( err ) {\n\t\t\t\treturn this.props.addNotification({\n\t\t\t\t\ttitle: 'Error encountered',\n\t\t\t\t\tmessage: 'Encountered an error while creating CSV: '+err.message,\n\t\t\t\t\tlevel: 'error',\n\t\t\t\t\tposition: 'tl'\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst blob = new Blob([ output ], {\n\t\t\t\ttype: 'text/plain'\n\t\t\t});\n\t\t\tconst name = `completions_${this.props.namespace.title}.csv`;\n\t\t\tsaveAs( blob, name );\n\t\t});\n\t};\n\n\ttoggleExplorer = () => {\n\t\tthis.setState({\n\t\t\tshowExplorer: !this.state.showExplorer\n\t\t});\n\t};\n\n\thandleScopeChange = ( value ) => {\n\t\tthis.setState({\n\t\t\tscope: value\n\t\t});\n\t};\n\n\trenderMetricSelect() {\n\t\tconst { t } = this.props;\n\t\tconst options = [\n\t\t\t{ value: 'course-wide', label: t('common:course-wide') },\n\t\t\t...this.props.lessons.map( ( lesson ) => {\n\t\t\t\treturn {\n\t\t\t\t\tvalue: lesson._id,\n\t\t\t\t\tlabel: lesson.title\n\t\t\t\t};\n\t\t\t})\n\t\t];\n\t\treturn (\n\t\t\t<Form.Group className=\"align-items-center d-flex\" as={Row} style={{ float: 'right', marginRight: 6, minWidth: 350, marginTop: -3 }} >\n\t\t\t\t<Col md={4} >\n\t\t\t\t\t<Form.Label style={{ marginBottom: 0 }} >\n\t\t\t\t\t\t{t('display-for')}:\n\t\t\t\t\t</Form.Label>\n\t\t\t\t</Col>\n\t\t\t\t<Col md={8} >\n\t\t\t\t\t<Select\n\t\t\t\t\t\tdefaultValue={options[ 0 ]}\n\t\t\t\t\t\toptions={options}\n\t\t\t\t\t\tonChange={this.handleScopeChange}\n\t\t\t\t\t/>\n\t\t\t\t</Col>\n\t\t\t</Form.Group>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst { t } = this.props;\n\t\tif ( this.state.showExplorer ) {\n\t\t\tlet data = this.assembleData();\n\t\t\tdata = obsToVar( data );\n\t\t\tconst quantitative = [];\n\t\t\tconst categorical = [ 'name', 'email', 'cohort' ];\n\t\t\tfor ( let i = 0; i < this.props.lessons.length; i++ ) {\n\t\t\t\tquantitative.push( this.props.lessons[ i ].title );\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<DashboardDataExplorer\n\t\t\t\t\ttitle={t('explorer-grades-title')}\n\t\t\t\t\tdata={data}\n\t\t\t\t\tcategorical={categorical}\n\t\t\t\t\tquantitative={quantitative}\n\t\t\t\t\tclose={this.toggleExplorer}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<div className=\"namespace-data-buttons\" >\n\t\t\t\t\t<ButtonGroup className=\"progress-button-group\" >\n\t\t\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"csvTooltip\" >{t('save-as-csv')}</Tooltip>}>\n\t\t\t\t\t\t\t<Button size=\"sm\" variant=\"secondary\" onClick={this.saveCSV} ><i className=\"fas fa-download\"></i> CSV</Button>\n\t\t\t\t\t\t</OverlayTrigger>\n\t\t\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"jsonTooltip\">{t('save-as-json')}</Tooltip>}>\n\t\t\t\t\t\t\t<Button size=\"sm\" variant=\"secondary\" onClick={this.saveJSON} ><i className=\"fas fa-download\"></i> JSON</Button>\n\t\t\t\t\t\t</OverlayTrigger>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t\t{this.renderMetricSelect()}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"namespace-data-page\">\n\t\t\t\t\t<DashboardTable\n\t\t\t\t\t\tclassName=\"grades-table\"\n\t\t\t\t\t\tdata={this.state.displayedMembers}\n\t\t\t\t\t\tcolumns={this.columns}\n\t\t\t\t\t\tt={t}\n\t\t\t\t\t\tref={(r) => {\n\t\t\t\t\t\t\tthis.dashboardTable = r;\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonButtonClick={this.toggleExplorer}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t{this.state.showComputeModal && <ComputeModal\n\t\t\t\t\tmetric={this.state.computeMetric}\n\t\t\t\t\tshow={this.state.showComputeModal}\n\t\t\t\t\tonHide={() => this.setState({ showComputeModal: false })}\n\t\t\t\t\tcohorts={this.props.cohorts}\n\t\t\t\t\ttags={this.state.tags}\n\t\t\t\t\tentity={this.props.namespace}\n\t\t\t\t\tlevel=\"namespace\"\n\t\t\t\t\tonCompute={() => {\n\t\t\t\t\t\tthis.setState({ showComputeModal: false });\n\t\t\t\t\t}}\n\t\t\t\t\tcomputeCompletions={this.props.computeCompletions}\n\t\t\t\t/>}\n\t\t\t</Fragment>\n\t\t);\n\t}\n}\n\n\n// PROPERTIES //\n\nCompletionsPage.propTypes = {\n\taddNotification: PropTypes.func.isRequired,\n\tcohorts: PropTypes.array.isRequired,\n\tcomputeCompletions: PropTypes.func.isRequired,\n\tlessons: PropTypes.array.isRequired,\n\tnamespace: PropTypes.object.isRequired\n};\n\nCompletionsPage.defaultProps = {\n};\n\n\n// EXPORTS //\n\nexport default withTranslation( [ 'namespace_data', 'common' ] )( CompletionsPage );\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component, Fragment } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport logger from 'debug';\r\nimport stringify from 'csv-stringify';\r\nimport { withTranslation } from 'react-i18next';\r\nimport InputRange from 'react-input-range';\r\nimport Button from 'react-bootstrap/Button';\r\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\r\nimport DropdownButton from 'react-bootstrap/DropdownButton';\r\nimport Dropdown from 'react-bootstrap/Dropdown';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Card from 'react-bootstrap/Card';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport isArray from '@stdlib/assert/is-array';\r\nimport isUndefinedOrNull from '@stdlib/assert/is-undefined-or-null';\r\nimport hasOwnProp from '@stdlib/assert/has-own-property';\r\nimport contains from '@stdlib/assert/contains';\r\nimport lowercase from '@stdlib/string/lowercase';\r\nimport DashboardTable from 'components/dashboard-table';\r\nimport DashboardDataExplorer from 'ev/components/data-explorer';\r\nimport obsToVar from '@isle-project/utils/obs-to-var';\r\nimport server from 'constants/server';\r\nimport saveAs from 'utils/file_saver.js';\r\nimport createTextColumn from 'utils/create_text_column.js';\r\nimport './progress_page.css';\r\nimport 'css/input_range.css';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst debug = logger( 'isle:progress-page' );\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nfunction filterNumbersFactory( lessons, idx ) {\r\n\treturn ( filter, row ) => {\r\n\t\tconst data = row[ filter.id ];\r\n\t\tconst grades = data[ lessons[ idx ]._id ];\r\n\t\tif ( isUndefinedOrNull( grades ) ) {\r\n\t\t\treturn filter.value.min === 0;\r\n\t\t}\r\n\t\tconst points = grades._sumPoints;\r\n\t\treturn points >= filter.value.min && points <= filter.value.max;\r\n\t};\r\n}\r\n\r\nfunction filterMethodCategories( filter, row ) {\r\n\tif ( filter.value === 'all' ) {\r\n\t\treturn true;\r\n\t}\r\n\tconst id = filter.pivotId || filter.id;\r\n\tif ( row[ id ] === void 0 ) {\r\n\t\treturn true;\r\n\t}\r\n\tif ( isArray( filter.value ) ) {\r\n\t\treturn contains( filter.value, String( row[ id ] ) );\r\n\t}\r\n\treturn String( row[ id ] ) === filter.value;\r\n}\r\n\r\nfunction sortFactory( lessons, idx ) {\r\n\treturn ( a, b ) => {\r\n\t\ta = a[ lessons[ idx ]._id ];\r\n\t\tb = b[ lessons[ idx ]._id ];\r\n\t\tif ( !a && !b ) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tif ( a && !b ) {\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\tif ( !a && b ) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tif ( a._sumPoints > b._sumPoints ) {\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\tif ( a._sumPoints < b._sumPoints ) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\treturn 0;\r\n\t};\r\n}\r\n\r\n\r\n// MAIN //\r\n\r\nclass GradesPage extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\r\n\t\tthis.columns = this.createColumns( props.lessons, props.cohorts );\r\n\t\tthis.state = {\r\n\t\t\tdisplayedMembers: [],\r\n\t\t\tlessonSortDirection: 'ascending',\r\n\t\t\tlessonOrder: 'createdAt',\r\n\t\t\tshowExplorer: false\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.createDisplayedMembers();\r\n\t}\r\n\r\n\tcomponentDidUpdate( prevProps ) {\r\n\t\tif (\r\n\t\t\tthis.props.cohorts !== prevProps.cohorts ||\r\n\t\t\tthis.props.lessons !== prevProps.lessons\r\n\t\t) {\r\n\t\t\tthis.createDisplayedMembers();\r\n\t\t\tthis.columns = this.createColumns( this.props.lessons, this.props.cohorts );\r\n\t\t}\r\n\t}\r\n\r\n\tcreateDisplayedMembers() {\r\n\t\tlet members = [];\r\n\t\tfor ( let i = 0; i < this.props.cohorts.length; i++ ) {\r\n\t\t\tconst cohortMembers = this.props.cohorts[ i ].members;\r\n\t\t\tfor ( let j = 0; j < cohortMembers.length; j++ ) {\r\n\t\t\t\tcohortMembers[ j ].cohort = this.props.cohorts[ i ].title;\r\n\t\t\t\tif ( !cohortMembers[ j ].lessonGrades ) {\r\n\t\t\t\t\tcohortMembers[ j ].lessonGrades = {};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmembers = members.concat( this.props.cohorts[ i ].members );\r\n\t\t}\r\n\t\tthis.setState({ // eslint-disable-line react/no-did-mount-set-state\r\n\t\t\tdisplayedMembers: members\r\n\t\t});\r\n\t}\r\n\r\n\tcreateColumns( lessons, cohorts ) {\r\n\t\tconst { t } = this.props;\r\n\t\tconst COLUMNS = [\r\n\t\t\t{\r\n\t\t\t\tHeader: 'Pic',\r\n\t\t\t\taccessor: 'picture',\r\n\t\t\t\tCell: row => (\r\n\t\t\t\t\t<img className=\"table-pic\" src={`${server}/thumbnail/${row.original.picture}`} alt=\"Profile Pic\" />\r\n\t\t\t\t),\r\n\t\t\t\tmaxWidth: 46,\r\n\t\t\t\tminWidth: 46,\r\n\t\t\t\tfilterable: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tsortable: false,\r\n\t\t\t\tstyle: { color: 'darkslategrey' }\r\n\t\t\t},\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:first-name'),\r\n\t\t\t\tid: 'first_name',\r\n\t\t\t\taccessor: 'firstName',\r\n\t\t\t\tmaxWidth: 75,\r\n\t\t\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\t\t\treturn contains( lowercase( row[ filter.id ] ), lowercase( filter.value ) );\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:last-name'),\r\n\t\t\t\tid: 'last_name',\r\n\t\t\t\taccessor: 'lastName',\r\n\t\t\t\tmaxWidth: 75,\r\n\t\t\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\t\t\treturn contains( lowercase( row[ filter.id ] ), lowercase( filter.value ) );\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:email'),\r\n\t\t\t\taccessor: 'email',\r\n\t\t\t\tmaxWidth: 200,\r\n\t\t\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\t\t\treturn contains( lowercase( row[ filter.id ] ), lowercase( filter.value ) );\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\t{\r\n\t\t\t\tHeader: t('common:cohort'),\r\n\t\t\t\taccessor: 'cohort',\r\n\t\t\t\tstyle: { marginTop: '8px', color: 'darkslategrey' },\r\n\t\t\t\tfilterMethod: filterMethodCategories,\r\n\t\t\t\tFilter: ({ filter, onChange }) => {\r\n\t\t\t\t\tconst handleChange = ( event ) => {\r\n\t\t\t\t\t\tconst newValue = event.target.value;\r\n\t\t\t\t\t\tonChange( newValue );\r\n\t\t\t\t\t};\r\n\t\t\t\t\tlet value;\r\n\t\t\t\t\tif ( !filter ) {\r\n\t\t\t\t\t\tvalue = 'all';\r\n\t\t\t\t\t} else if ( isArray( filter.value ) ) {\r\n\t\t\t\t\t\tvalue = filter.value.join( ', ' );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvalue = filter.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tonBlur={handleChange} onChange={handleChange}\r\n\t\t\t\t\t\t\tstyle={{ width: '100%', backgroundColor: 'ghostwhite' }}\r\n\t\t\t\t\t\t\tvalue={value}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"all\">Show All</option>\r\n\t\t\t\t\t\t\t{cohorts.map( ( v, key ) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<option\r\n\t\t\t\t\t\t\t\t\t\tkey={key}\r\n\t\t\t\t\t\t\t\t\t\tvalue={`${v.title}`}\r\n\t\t\t\t\t\t\t\t\t>{v.title}</option>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t];\r\n\t\tfor ( let i = 0; i < lessons.length; i++ ) {\r\n\t\t\tconst id = 'lesson_'+i;\r\n\t\t\tCOLUMNS.push({\r\n\t\t\t\tid,\r\n\t\t\t\tHeader: <span id={id} >{lessons[ i ].title}</span>,\r\n\t\t\t\t_lesson: lessons[ i ],\r\n\t\t\t\tCell: this.accessorFactory( lessons, i ),\r\n\t\t\t\tsortMethod: sortFactory( lessons, i ),\r\n\t\t\t\tfilterMethod: filterNumbersFactory( lessons, i ),\r\n\t\t\t\tFilter: ({ filter, onChange }) => {\r\n\t\t\t\t\tlet maxPoints = 0;\r\n\t\t\t\t\tif ( lessons[ i ].metadata && lessons[ i ].metadata.grades ) {\r\n\t\t\t\t\t\tmaxPoints = lessons[ i ].metadata.grades.maxPoints;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst defaultVal = {\r\n\t\t\t\t\t\tmax: maxPoints,\r\n\t\t\t\t\t\tmin: 0\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<div style={{\r\n\t\t\t\t\t\t\tpaddingLeft: '4px',\r\n\t\t\t\t\t\t\tpaddingRight: '4px',\r\n\t\t\t\t\t\t\tpaddingTop: '8px'\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<InputRange\r\n\t\t\t\t\t\t\t\tariaLabelledby={id}\r\n\t\t\t\t\t\t\t\tariaControls=\"dashboard-table\"\r\n\t\t\t\t\t\t\t\tallowSameValues\r\n\t\t\t\t\t\t\t\tmaxValue={maxPoints}\r\n\t\t\t\t\t\t\t\tminValue={0}\r\n\t\t\t\t\t\t\t\tvalue={filter ? filter.value : defaultVal}\r\n\t\t\t\t\t\t\t\tonChange={( newValue ) => {\r\n\t\t\t\t\t\t\t\t\tonChange( newValue );\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\taccessor: 'lessonGrades'\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn COLUMNS;\r\n\t}\r\n\r\n\taccessorFactory = ( lessons, idx ) => {\r\n\t\treturn d => {\r\n\t\t\tlet data = d.original.lessonGrades || {};\r\n\t\t\tconst lesson = lessons[ idx ];\r\n\t\t\tconst lessonID = lesson._id;\r\n\t\t\tlet maxPoints = '';\r\n\t\t\tif ( lesson.metadata && lesson.metadata.grades ) {\r\n\t\t\t\tmaxPoints += ` / ${lessons[ idx ].metadata.grades.maxPoints}`;\r\n\t\t\t}\r\n\t\t\tdata = data[ lessonID ];\r\n\t\t\tif ( data ) {\r\n\t\t\t\tlet tally = [];\r\n\t\t\t\tfor ( let key in data ) {\r\n\t\t\t\t\tif ( hasOwnProp( data, key ) && key !== '_sumPoints' ) {\r\n\t\t\t\t\t\ttally.push( <p style={{ margin: 0 }} key={key}>{key}: <b style={{ float: 'right', marginLeft: 12 }}>{data[ key ]}</b></p> );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn ( <OverlayTrigger placement=\"top\" overlay={<Card className=\"tickets-description-overlay\" body id=\"description-tooltip\">\r\n\t\t\t\t\t{tally}\r\n\t\t\t\t</Card>}>\r\n\t\t\t\t\t<p>{data._sumPoints}{maxPoints}</p>\r\n\t\t\t\t</OverlayTrigger> );\r\n\t\t\t}\r\n\t\t\treturn <span></span>;\r\n\t\t};\r\n\t};\r\n\r\n\treorderColumns( lessonOrder, lessonSortDirection ) {\r\n\t\tdebug( 'Sort columns by '+lessonOrder+' in '+lessonSortDirection+' order' );\r\n\t\tif ( lessonSortDirection === 'ascending' ) {\r\n\t\t\treturn this.columns.slice().sort( ( a, b ) => {\r\n\t\t\t\tif ( !a._lesson || !b._lesson ) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\t\t\t\tif ( lessonOrder === 'title' ) {\r\n\t\t\t\t\treturn a._lesson.title.localeCompare( b._lesson.title );\r\n\t\t\t\t}\r\n\t\t\t\treturn a._lesson[ lessonOrder ] > b._lesson[ lessonOrder ] ? 1 : -1;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this.columns.slice().sort( ( a, b ) => {\r\n\t\t\tif ( !a._lesson || !b._lesson ) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\tif ( lessonOrder === 'title' ) {\r\n\t\t\t\treturn b._lesson.title.localeCompare( a._lesson.title );\r\n\t\t\t}\r\n\t\t\treturn a._lesson[ lessonOrder ] < b._lesson[ lessonOrder ] ? 1 : -1;\r\n\t\t});\r\n\t}\r\n\r\n\tassembleData() {\r\n\t\tconst displayedMembers = this.dashboardTable.getResolvedState().sortedData;\r\n\t\tconst len = displayedMembers.length;\r\n\t\tconst out = new Array( len );\r\n\t\tconst lessons = this.props.lessons;\r\n\t\tfor ( let i = 0; i < len; i++ ) {\r\n\t\t\tconst member = displayedMembers[ i ]._original;\r\n\t\t\tout[ i ] = {\r\n\t\t\t\tname: member.name,\r\n\t\t\t\tfirstName: member.firstName,\r\n\t\t\t\tlastName: member.lastName,\r\n\t\t\t\temail: member.email,\r\n\t\t\t\tcohort: member.cohort\r\n\t\t\t};\r\n\t\t\tconst availableCustomFields = this.props.user.availableCustomFields;\r\n\t\t\tfor ( let j = 0; j < availableCustomFields.length; j++ ) {\r\n\t\t\t\tconst fieldName = availableCustomFields[ j ].name;\r\n\t\t\t\tif ( member.customFields ) {\r\n\t\t\t\t\tout[ i ][ fieldName ] = member.customFields[ fieldName ];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tout[ i ][ fieldName ] = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor ( let j = 0; j < lessons.length; j++ ) {\r\n\t\t\t\tconst lessonName = lessons[ j ]._id;\r\n\t\t\t\tlet data = member.lessonGrades;\r\n\t\t\t\tif ( data && data[ lessonName ] ) {\r\n\t\t\t\t\tdata = data[ lessonName ];\r\n\t\t\t\t\tout[ i ][ lessons[ j ].title ] = data._sumPoints;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tout[ i ][ lessons[ j ].title ] = '';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn out;\r\n\t}\r\n\r\n\tsaveJSON = () => {\r\n\t\tconst data = this.assembleData();\r\n\t\tconst blob = new Blob([ JSON.stringify( data ) ], {\r\n\t\t\ttype: 'application/json'\r\n\t\t});\r\n\t\tconst name = `grades_${this.props.namespace.title}.json`;\r\n\t\tsaveAs( blob, name );\r\n\t};\r\n\r\n\tsaveCSV = () => {\r\n\t\tconst data = this.assembleData();\r\n\t\tstringify( data, {\r\n\t\t\theader: true\r\n\t\t}, ( err, output ) => {\r\n\t\t\tif ( err ) {\r\n\t\t\t\treturn this.props.addNotification({\r\n\t\t\t\t\ttitle: 'Error encountered',\r\n\t\t\t\t\tmessage: 'Encountered an error while creating CSV: '+err.message,\r\n\t\t\t\t\tlevel: 'error',\r\n\t\t\t\t\tposition: 'tl'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tconst blob = new Blob([ output ], {\r\n\t\t\t\ttype: 'text/plain'\r\n\t\t\t});\r\n\t\t\tconst name = `grades_${this.props.namespace.title}.csv`;\r\n\t\t\tsaveAs( blob, name );\r\n\t\t});\r\n\t};\r\n\r\n\ttoggleExplorer = () => {\r\n\t\tthis.setState({\r\n\t\t\tshowExplorer: !this.state.showExplorer\r\n\t\t});\r\n\t};\r\n\r\n\trenderSortButton() {\r\n\t\tconst { t } = this.props;\r\n\t\tlet title;\r\n\t\tswitch ( this.state.lessonOrder ) {\r\n\t\t\tcase 'title':\r\n\t\t\t\ttitle = t('common:sort-alphabetically');\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'createdAt':\r\n\t\t\t\ttitle = t('common:sort-create-date');\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'updatedAt':\r\n\t\t\t\ttitle = t('common:sort-update-date');\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<ButtonGroup className=\"sort-button-group\" >\r\n\t\t\t\t<DropdownButton size=\"sm\" variant=\"secondary\" onSelect={( newValue ) => {\r\n\t\t\t\t\tthis.columns = this.reorderColumns( newValue, this.state.lessonSortDirection );\r\n\t\t\t\t\tthis.setState({ lessonOrder: newValue });\r\n\t\t\t\t}} id=\"dropdown\" title={<small>{title}</small>} >\r\n\t\t\t\t\t<Dropdown.Item eventKey=\"title\" >\r\n\t\t\t\t\t\t<small>{t('common:sort-alphabetically')}</small>\r\n\t\t\t\t\t</Dropdown.Item>\r\n\t\t\t\t\t<Dropdown.Item eventKey=\"createdAt\" >\r\n\t\t\t\t\t\t<small>{t('common:sort-create-date')}</small>\r\n\t\t\t\t\t</Dropdown.Item>\r\n\t\t\t\t\t<Dropdown.Item eventKey=\"updatedAt\" >\r\n\t\t\t\t\t\t<small>{t('common:sort-update-date')}</small>\r\n\t\t\t\t\t</Dropdown.Item>\r\n\t\t\t\t</DropdownButton>\r\n\t\t\t\t<Button size=\"sm\" variant=\"secondary\" style={{ marginLeft: 2 }} onClick={() => {\r\n\t\t\t\t\tif ( this.state.lessonSortDirection === 'ascending' ) {\r\n\t\t\t\t\t\tthis.columns = this.reorderColumns( this.state.lessonOrder, 'descending' );\r\n\t\t\t\t\t\tthis.setState({ lessonSortDirection: 'descending' });\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.columns = this.reorderColumns( this.state.lessonOrder, 'ascending' );\r\n\t\t\t\t\t\tthis.setState({ lessonSortDirection: 'ascending' });\r\n\t\t\t\t\t}\r\n\t\t\t\t}} aria-label={this.state.lessonSortDirection === 'ascending' ?\r\n\t\t\t\tt('common:sort-descending') : t('common:sort-ascending')} >\r\n\t\t\t\t\t{ this.state.lessonSortDirection === 'ascending' ?\r\n\t\t\t\t\t\t<i className=\"fas fa-arrow-right\" /> :\r\n\t\t\t\t\t\t<i className=\"fas fa-arrow-left\" />\r\n\t\t\t\t\t}\r\n\t\t\t\t</Button>\r\n\t\t\t</ButtonGroup>\r\n\t\t);\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { t } = this.props;\r\n\t\tif ( this.state.showExplorer ) {\r\n\t\t\tlet data = this.assembleData();\r\n\t\t\tdata = obsToVar( data );\r\n\t\t\tconst quantitative = [];\r\n\t\t\tconst categorical = [ 'name', 'email', 'cohort' ];\r\n\t\t\tfor ( let i = 0; i < this.props.lessons.length; i++ ) {\r\n\t\t\t\tquantitative.push( this.props.lessons[ i ].title );\r\n\t\t\t}\r\n\t\t\tconst availableCustomFields = this.props.user.availableCustomFields;\r\n\t\t\tfor ( let i = 0; i < availableCustomFields.length; i++ ) {\r\n\t\t\t\tcategorical.push( availableCustomFields[ i ].name );\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<DashboardDataExplorer\r\n\t\t\t\t\ttitle={t('explorer-grades-title')}\r\n\t\t\t\t\tdata={data}\r\n\t\t\t\t\tcategorical={categorical}\r\n\t\t\t\t\tquantitative={quantitative}\r\n\t\t\t\t\tclose={this.toggleExplorer}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<div className=\"namespace-data-buttons\" >\r\n\t\t\t\t\t{this.renderSortButton()}\r\n\t\t\t\t\t<ButtonGroup className=\"progress-button-group\" >\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"csvTooltip\" >{t('save-as-csv')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<Button size=\"sm\" variant=\"secondary\" onClick={this.saveCSV} ><i className=\"fas fa-download\"></i> CSV</Button>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"jsonTooltip\">{t('save-as-json')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<Button size=\"sm\" variant=\"secondary\" onClick={this.saveJSON} ><i className=\"fas fa-download\"></i> JSON</Button>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t</ButtonGroup>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"namespace-data-page\">\r\n\t\t\t\t\t<DashboardTable\r\n\t\t\t\t\t\tclassName=\"grades-table\"\r\n\t\t\t\t\t\tdata={this.state.displayedMembers}\r\n\t\t\t\t\t\tcolumns={this.columns}\r\n\t\t\t\t\t\tt={t}\r\n\t\t\t\t\t\tref={(r) => {\r\n\t\t\t\t\t\t\tthis.dashboardTable = r;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonButtonClick={this.toggleExplorer}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\n// PROPERTIES //\r\n\r\nGradesPage.propTypes = {\r\n\taddNotification: PropTypes.func.isRequired,\r\n\tcohorts: PropTypes.array.isRequired,\r\n\tlessons: PropTypes.array.isRequired,\r\n\tnamespace: PropTypes.object.isRequired,\r\n\tuser: PropTypes.object.isRequired\r\n};\r\n\r\nGradesPage.defaultProps = {\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default withTranslation( [ 'namespace_data', 'common' ] )( GradesPage );\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component, Fragment } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Button from 'react-bootstrap/Button';\r\nimport ToggleButtonGroup from 'react-bootstrap/ToggleButtonGroup';\r\nimport ToggleButton from 'react-bootstrap/ToggleButton';\r\nimport logger from 'debug';\r\nimport Select from 'react-select';\r\nimport './actions_page.css';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst debug = logger( 'isle-dashboard:namespace-data:actions-page' );\r\n\r\n\r\n// MAIN //\r\n\r\nclass ActionsPage extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\r\n\t\tconst cohortOptions = props.cohorts.map( cohort => {\r\n\t\t\treturn { label: cohort.title, value: cohort };\r\n\t\t});\r\n\r\n\t\tlet displayedMembers = [];\r\n\t\tfor ( let i = 0; i < props.cohorts.length; i++ ) {\r\n\t\t\tdisplayedMembers = displayedMembers.concat( props.cohorts[i].members);\r\n\t\t}\r\n\r\n\t\tthis.state = {\r\n\t\t\tcohortOptions: cohortOptions,\r\n\t\t\tselectedCohorts: cohortOptions,\r\n\t\t\tdisplayedMembers: displayedMembers,\r\n\t\t\tlessonActionsPage: false,\r\n\t\t\tactualLesson: null,\r\n\t\t\tanonymized: true\r\n\t\t};\r\n\t}\r\n\r\n\tretrieveActions = () => {\r\n\t\tthis.props.getNamespaceActions({\r\n\t\t\tnamespaceID: this.props.namespace._id,\r\n\t\t\tnamespaceTitle: this.props.namespace.title\r\n\t\t});\r\n\t};\r\n\r\n\thandleRadioChange = ( val ) => {\r\n\t\tthis.setState({\r\n\t\t\tanonymized: !this.state.anonymized\r\n\t\t});\r\n\t};\r\n\r\n\thandleCohortChange = ( cohorts ) => {\r\n\t\tlet members = [];\r\n\t\tfor ( let i = 0; i < cohorts.length; i++ ) {\r\n\t\t\tmembers = members.concat( cohorts[ i ].value.members );\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\tselectedCohorts: cohorts,\r\n\t\t\tdisplayedMembers: members\r\n\t\t}, () => {\r\n\t\t\tdebug( 'New number of displayed members: '+this.state.displayedMembers.length );\r\n\t\t});\r\n\t};\r\n\r\n\trenderCohorts() {\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<div className=\"actions-page-cohorts\">\r\n\t\t\t\t\t<div style={{ width: '400px', height: '40px' }}>\r\n\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\tvalue={this.state.selectedCohorts}\r\n\t\t\t\t\t\t\tisMulti\r\n\t\t\t\t\t\t\tname=\"cohorts\"\r\n\t\t\t\t\t\t\toptions={this.state.cohortOptions}\r\n\t\t\t\t\t\t\tonChange={this.handleCohortChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</Fragment>\r\n\t\t);\r\n\t}\r\n\r\n\trenderLessonActionsPage() {\r\n\t\treturn (\r\n\t\t\t<div className=\"actions-page-lesson-action-page\">\r\n\t\t\t\t<div className=\"lesson-action-page-resize\">\t&#x1f5d6;</div>\r\n\t\t\t\t<button onClick={this.hideLessonActions} className=\"lesson-action-page-exit empty-button\">&#10005;</button>\r\n\t\t\t\t<div className=\"lesson-action-page-title\">{ this.state.actualLesson.title}</div>\r\n\t\t\t\t<div className=\"lesson-action-page-filter\">\r\n\t\t\t\t\t{this.renderCohorts() }\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\r\n\thideLessonActions = () => {\r\n\t\tthis.setState({\r\n\t\t\tlessonActionsPage: false\r\n\t\t});\r\n\t};\r\n\r\n\tshowLessonActions = (lesson) => {\r\n\t\tthis.setState({\r\n\t\t\tlessonActionsPage: true,\r\n\t\t\tactualLesson: lesson\r\n\t\t});\r\n\t};\r\n\r\n\trenderLessons() {\r\n\t\tconst lessons = this.props.namespace.lessons;\r\n\t\tconst list = [];\r\n\t\tfor ( let i = 0; i < lessons.length; i++ ) {\r\n\t\t\tlist.push(\r\n\t\t\t\t<button key={i} onClick={()=> this.showLessonActions( lessons[i] )} className=\"actions-page-lesson\">\r\n\t\t\t\t\t<div className=\"actions-page-lesson-title\">{lessons[i].title}</div>\r\n\t\t\t\t</button>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<div className=\"actions-page\">\r\n\t\t\t\t<div className=\"actions-page-export\">\r\n\t\t\t\t{ this.renderExportSection() }\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"actions-page-lessons\">\r\n\t\t\t\t\t{ list }\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\trenderExportSection() {\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<div className=\"actions-page-export-title\">Export Actions</div>\r\n\t\t\t\t<ToggleButtonGroup\r\n\t\t\t\t\tname=\"options\"\r\n\t\t\t\t\tonChange={this.handleRadioChange}\r\n\t\t\t\t\ttype=\"radio\"\r\n\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\tvalue={this.state.anonymized}\r\n\t\t\t\t>\r\n\t\t\t\t\t<ToggleButton\r\n\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t\tvalue={false}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tfontSize: '12px',\r\n\t\t\t\t\t\t\tcolor: this.state.anonymized ? '#A9A9A9' : 'black'\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>Original</ToggleButton>\r\n\t\t\t\t\t<ToggleButton\r\n\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t\tvalue={true}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tfontSize: '12px',\r\n\t\t\t\t\t\t\tcolor: this.state.anonymized ? 'black' : '#A9A9A9'\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>Anonymized</ToggleButton>\r\n\t\t\t\t</ToggleButtonGroup>\r\n\t\t\t\t<Button onClick={this.retrieveActions}>\r\n\t\t\t\t\tSave all namespace actions\r\n\t\t\t\t</Button>\r\n\t\t\t</Fragment>\r\n\t\t);\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn ( <div className=\"namespace-data-page\">\r\n\t\t\t{ this.renderLessons() }\r\n\t\t\t{ this.state.lessonActionsPage ? this.renderLessonActionsPage() : null }\r\n\t\t</div> );\r\n\t}\r\n}\r\n\r\n\r\n// PROPERTIES //\r\n\r\nActionsPage.propTypes = {\r\n\tcohorts: PropTypes.array.isRequired,\r\n\tgetNamespaceActions: PropTypes.func.isRequired,\r\n\tnamespace: PropTypes.object.isRequired\r\n};\r\n\r\nActionsPage.defaultProps = {\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default ActionsPage;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport logger from 'debug';\r\nimport { withTranslation } from 'react-i18next';\r\nimport moment from 'moment';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport PINF from '@stdlib/constants/float64/pinf';\r\nimport omit from '@stdlib/utils/omit';\r\nimport Popover from 'react-bootstrap/Popover';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Card from 'react-bootstrap/Card';\r\nimport Badge from 'react-bootstrap/Badge';\r\nimport DashboardDataExplorer from 'ev/components/data-explorer';\r\nimport obsToVar from '@isle-project/utils/obs-to-var';\r\nimport DashboardTable from 'components/dashboard-table';\r\nimport createCategoricalColumn from 'utils/create_categorical_column.js';\r\nimport createBooleanColumn from 'utils/create_boolean_column.js';\r\nimport createTextColumn from 'utils/create_text_column.js';\r\nimport createDateColumn from 'utils/create_date_column.js';\r\nimport TicketModal from 'components/ticket-modal';\r\nimport server from 'constants/server';\r\nimport 'css/input_range.css';\r\nimport './tickets_page.css';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst debug = logger( 'isle:files-page' );\r\nconst RE_TICKET = /ticket=([^&]*)/;\r\n\r\n\r\n// MAIN //\r\n\r\nclass TicketsPage extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\r\n\t\tthis.state = {\r\n\t\t\tshowTicketModal: false,\r\n\t\t\tselectedTicket: null,\r\n\t\t\tshowExplorer: false\r\n\t\t};\r\n\t\tthis.columns = this.createColumns();\r\n\t}\r\n\r\n\tasync componentDidMount() {\r\n\t\tdebug( 'Component did mount...' );\r\n\t\tawait this.props.getCourseTickets( this.props.namespace._id );\r\n\r\n\t\tif ( window.location.search ) {\r\n\t\t\tconst match = RE_TICKET.exec( window.location.search );\r\n\t\t\tif ( match && match[ 1 ] ) {\r\n\t\t\t\tconst tickets = this.props.tickets;\r\n\t\t\t\tfor ( let i = 0; i < tickets.length; i++ ) {\r\n\t\t\t\t\tconst ticket = tickets[ i ];\r\n\t\t\t\t\tif ( ticket._id === match[ 1 ] ) {\r\n\t\t\t\t\t\t// eslint-disable-next-line react/no-did-mount-set-state\r\n\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\tselectedTicket: ticket,\r\n\t\t\t\t\t\t\tshowTicketModal: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\ttoggleTicketModal = () => {\r\n\t\tthis.setState({\r\n\t\t\tshowTicketModal: !this.state.showTicketModal\r\n\t\t});\r\n\t};\r\n\r\n\tcreateColumns = () => {\r\n\t\tconst { t } = this.props;\r\n\t\tconst tickets = this.props.tickets || [];\r\n\t\tlet minTime = PINF;\r\n\t\tlet maxTime = 0;\r\n\t\tfor ( let i = 0; i < tickets.length; i++ ) {\r\n\t\t\tif ( tickets[ i ].createdAt > maxTime ) {\r\n\t\t\t\tmaxTime = tickets[ i ].createdAt;\r\n\t\t\t}\r\n\t\t\tif ( tickets[ i ].updatedAt > maxTime ) {\r\n\t\t\t\tmaxTime = tickets[ i ].updatedAt;\r\n\t\t\t}\r\n\t\t\tif ( tickets[ i ].createdAt < minTime ) {\r\n\t\t\t\tminTime = tickets[ i ].createdAt;\r\n\t\t\t}\r\n\t\t\tif ( tickets[ i ].updatedAt < minTime ) {\r\n\t\t\t\tminTime = tickets[ i ].updatedAt;\r\n\t\t\t}\r\n\t\t}\r\n\t\tmaxTime = moment( maxTime );\r\n\t\tminTime = moment( minTime );\r\n\t\treturn [\r\n\t\t\t{\r\n\t\t\t\tHeader: 'Pic',\r\n\t\t\t\taccessor: 'user.picture',\r\n\t\t\t\tCell: ( row ) => {\r\n\t\t\t\t\treturn <img className=\"table-pic\" src={`${server}/thumbnail/${row.value}`} alt=\"Profile Pic\" />;\r\n\t\t\t\t},\r\n\t\t\t\tstyle: { marginTop: '8px', color: 'darkslategrey' },\r\n\t\t\t\tmaxWidth: 46,\r\n\t\t\t\tminWidth: 46,\r\n\t\t\t\tfilterable: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tsortable: false\r\n\t\t\t},\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:name'),\r\n\t\t\t\taccessor: 'user.name',\r\n\t\t\t\tstyle: { marginTop: '8px', color: 'darkslategrey' }\r\n\t\t\t}),\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:email'),\r\n\t\t\t\taccessor: 'user.email',\r\n\t\t\t\tstyle: { marginTop: '8px', color: 'darkslategrey' }\r\n\t\t\t}),\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:title'),\r\n\t\t\t\taccessor: 'title',\r\n\t\t\t\tminWidth: 200\r\n\t\t\t}),\r\n\t\t\t{\r\n\t\t\t\tHeader: t('common:description'),\r\n\t\t\t\taccessor: 'description',\r\n\t\t\t\tCell: ( row ) => {\r\n\t\t\t\t\treturn ( <OverlayTrigger placement=\"top\" overlay={<Card className=\"tickets-description-overlay\" body id=\"description-tooltip\">\r\n\t\t\t\t\t\t{row.value}\r\n\t\t\t\t\t</Card>}>\r\n\t\t\t\t\t\t<p className=\"tickets-description\" >{row.value}</p>\r\n\t\t\t\t\t</OverlayTrigger> );\r\n\t\t\t\t},\r\n\t\t\t\tstyle: { marginTop: '8px', color: 'darkslategrey' },\r\n\t\t\t\tminWidth: 300\r\n\t\t\t},\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:component'),\r\n\t\t\t\taccessor: 'component'\r\n\t\t\t}),\r\n\t\t\t{\r\n\t\t\t\tHeader: 'Reply',\r\n\t\t\t\taccessor: '_id',\r\n\t\t\t\tCell: ( row ) => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"left\" overlay={<Tooltip id=\"open-ticket-tooltip\">{t('common:open-ticket-tooltip')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\tsize=\"sm\" variant=\"outline-secondary\"\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\t\t\t\tselectedTicket: row.original\r\n\t\t\t\t\t\t\t\t\t}, this.toggleTicketModal );\r\n\t\t\t\t\t\t\t\t}} >\r\n\t\t\t\t\t\t\t\t<i className=\"fas fa-reply\"></i>\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tfilterable: false,\r\n\t\t\t\tsortable: false,\r\n\t\t\t\twidth: 45\r\n\t\t\t},\r\n\t\t\tcreateCategoricalColumn({\r\n\t\t\t\tHeader: t('common:priority'),\r\n\t\t\t\taccessor: 'priority',\r\n\t\t\t\tlabels: [ 'Low', 'Middle', 'High' ],\r\n\t\t\t\tmaxWidth: 200,\r\n\t\t\t\tCell: ( row ) => {\r\n\t\t\t\t\tif ( !row.value ) {\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet variant;\r\n\t\t\t\t\tlet higher;\r\n\t\t\t\t\tlet lower;\r\n\t\t\t\t\tswitch ( row.value ) {\r\n\t\t\t\t\t\tcase 'Low':\r\n\t\t\t\t\t\t\tvariant = 'secondary';\r\n\t\t\t\t\t\t\thigher = 'Middle';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'Middle':\r\n\t\t\t\t\t\t\tvariant = 'warning';\r\n\t\t\t\t\t\t\thigher = 'High';\r\n\t\t\t\t\t\t\tlower = 'Low';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'High':\r\n\t\t\t\t\t\t\tvariant = 'danger';\r\n\t\t\t\t\t\t\tlower = 'Middle';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn ( <div>\r\n\t\t\t\t\t\t<Badge bg={variant} style={{ marginRight: 6, fontSize: '1em' }} >\r\n\t\t\t\t\t\t\t{row.value}\r\n\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tsize=\"sm\" bg=\"outline-secondary\"\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tthis.props.updatePriority( row.original._id, higher );\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tdisabled={!higher}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<i className=\"fas fa-arrow-up\"></i>\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tsize=\"sm\" bg=\"outline-secondary\"\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tthis.props.updatePriority( row.original._id, lower );\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tdisabled={!lower}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<i className=\"fas fa-arrow-down\"></i>\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</div> );\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tcreateTextColumn({\r\n\t\t\t\tHeader: t('common:lesson'),\r\n\t\t\t\taccessor: 'lesson.title',\r\n\t\t\t\tmaxWidth: 140,\r\n\t\t\t\tCell: ( row ) => {\r\n\t\t\t\t\tif ( !row.value ) {\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst url = `${server}/${this.props.namespace.title}/${row.value}`;\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"open-lesson-tooltip\">{t('namespace_data:open-lesson-new-tab')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<Badge bg=\"light\" style={{ fontSize: '1em' }} >\r\n\t\t\t\t\t\t\t\t<a href={url} target=\"_blank\" rel=\"noopener noreferrer\" >\r\n\t\t\t\t\t\t\t\t\t{row.value}\r\n\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tcreateBooleanColumn({\r\n\t\t\t\tHeader: t('common:done'),\r\n\t\t\t\taccessor: 'done',\r\n\t\t\t\ttrueLabel: t('common:done'),\r\n\t\t\t\tfalseLabel: t('common:not-done')\r\n\t\t\t}),\r\n\t\t\t{\r\n\t\t\t\tHeader: t( 'common:platform' ),\r\n\t\t\t\taccessor: 'platform',\r\n\t\t\t\tstyle: { marginTop: '2px', color: 'darkslategrey', fontSize: 24, textAlign: 'center', cursor: 'pointer' },\r\n\t\t\t\tCell: ( row ) => {\r\n\t\t\t\t\tif ( row.value ) {\r\n\t\t\t\t\t\tconst popover = <Popover\r\n\t\t\t\t\t\t\tid=\"popover-data\"\r\n\t\t\t\t\t\t\tstyle={{ maxWidth: 500, maxHeight: '80vh', overflowY: 'auto' }}\r\n\t\t\t\t\t\t\tarrowProps={{ display: 'none' }}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Popover.Header as=\"h3\">{row.row._original.title}</Popover.Header>\r\n\t\t\t\t\t\t\t<Popover.Body style={{ backgroundColor: 'lightblue' }} >\r\n\t\t\t\t\t\t\t\t<pre>\r\n\t\t\t\t\t\t\t\t\t{JSON.stringify( omit( row.value, [ 'description' ] ), null, 2 )}\r\n\t\t\t\t\t\t\t\t</pre>\r\n\t\t\t\t\t\t\t</Popover.Body>\r\n\t\t\t\t\t\t</Popover>;\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<OverlayTrigger trigger=\"click\" placement=\"left\" overlay={popover}>\r\n\t\t\t\t\t\t\t\t<i className=\"data-icon fas fa-tablet-alt\"></i>\r\n\t\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t},\r\n\t\t\t\tmaxWidth: 75,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tfilterable: false,\r\n\t\t\t\tsortable: false\r\n\t\t\t},\r\n\t\t\tcreateDateColumn({\r\n\t\t\t\tHeader: t('created-at'),\r\n\t\t\t\taccessor: 'createdAt',\r\n\t\t\t\tstartDate: minTime,\r\n\t\t\t\tendDate: maxTime,\r\n\t\t\t\tt\r\n\t\t\t})\r\n\t\t];\r\n\t};\r\n\r\n\ttoggleExplorer = () => {\r\n\t\tthis.setState({\r\n\t\t\tshowExplorer: !this.state.showExplorer\r\n\t\t});\r\n\t};\r\n\r\n\tassembleExplorerData = () => {\r\n\t\tlet tickets = this.props.tickets;\r\n\t\tlet data = [];\r\n\t\tfor ( let i = 0; i < tickets.length; i++ ) {\r\n\t\t\tconst ticket = tickets[ i ];\r\n\t\t\tconst replacement = {};\r\n\t\t\treplacement.component = ticket.component;\r\n\t\t\treplacement.title = ticket.title;\r\n\t\t\treplacement.description = ticket.description;\r\n\t\t\treplacement.lesson = ticket.lesson ? ticket.lesson.title : null;\r\n\t\t\treplacement.messages = ticket.messages.length;\r\n\t\t\treplacement.attachments = ticket.attachments.length;\r\n\t\t\treplacement.user = ticket.user.email;\r\n\t\t\treplacement.done = ticket.done;\r\n\t\t\treplacement.priority = ticket.priority;\r\n\t\t\treplacement.browser = `${ticket.platform.name} ${ticket.platform.version}`;\r\n\t\t\tconst os = ticket.platform.os;\r\n\t\t\treplacement.os = `${os.family} ${os.version ? os.version : ''} ${os.architecture}bit`;\r\n\t\t\treplacement.createdAt = ticket.createdAt;\r\n\t\t\treplacement.updatedAt = ticket.updatedAt;\r\n\t\t\tdata.push( replacement );\r\n\t\t}\r\n\t\tdata = obsToVar( data );\r\n\t\treturn data;\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { t } = this.props;\r\n\t\tif ( this.state.showExplorer ) {\r\n\t\t\treturn (\r\n\t\t\t\t<DashboardDataExplorer\r\n\t\t\t\t\ttitle={t('explorer-tickets-title')}\r\n\t\t\t\t\tdata={this.assembleExplorerData()}\r\n\t\t\t\t\tcategorical={[ 'component', 'lesson', 'done', 'createdAt', 'updatedAt', 'priority', 'browser', 'os' ]}\r\n\t\t\t\t\tquantitative={[ 'messages', 'attachments' ]}\r\n\t\t\t\t\tclose={this.toggleExplorer}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn ( <div className=\"namespace-data-page\">\r\n\t\t\t<DashboardTable\r\n\t\t\t\tdata={this.props.tickets}\r\n\t\t\t\tcolumns={this.columns}\r\n\t\t\t\tt={t}\r\n\t\t\t\tonButtonClick={this.toggleExplorer}\r\n\t\t\t/>\r\n\t\t\t{ this.state.showTicketModal ? <TicketModal\r\n\t\t\t\tshow={this.state.showTicketModal}\r\n\t\t\t\tonHide={this.toggleTicketModal}\r\n\t\t\t\tticket={this.state.selectedTicket}\r\n\t\t\t\tsubmitTicketMessage={this.props.submitTicketMessage}\r\n\t\t\t\topenTicket={this.props.openTicket}\r\n\t\t\t\tcloseTicket={this.props.closeTicket}\r\n\t\t\t/> : null }\r\n\t\t</div> );\r\n\t}\r\n}\r\n\r\n\r\n// PROPERTIES //\r\n\r\nTicketsPage.propTypes = {\r\n\tcloseTicket: PropTypes.func.isRequired,\r\n\tgetCourseTickets: PropTypes.func.isRequired,\r\n\tnamespace: PropTypes.object.isRequired,\r\n\topenTicket: PropTypes.func.isRequired,\r\n\tsubmitTicketMessage: PropTypes.func.isRequired,\r\n\ttickets: PropTypes.array,\r\n\tupdatePriority: PropTypes.func.isRequired\r\n};\r\n\r\nTicketsPage.defaultProps = {\r\n\ttickets: []\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default withTranslation( [ 'namespace_data', 'common' ] )( TicketsPage );\r\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport logger from 'debug';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate, Route, Routes } from 'react-router-dom';\nimport Alert from 'react-bootstrap/Alert';\nimport Nav from 'react-bootstrap/Nav';\nimport FilesPage from './files_page.js';\nimport AnnouncementsPage from './announcements_page.js';\nimport ProgressPage from './progress_page.js';\nimport CohortsPage from './cohorts_page.js';\nimport CompletionsPage from './completions_page.js';\nimport GradesPage from './grades_page.js';\nimport ActionsPage from './actions_page.js';\nimport TicketsPage from './tickets_page.js';\nimport './namespace_data.css';\n\n\n// VARIABLES //\n\nconst debug = logger( 'isle-dashboard:namespace-data' );\n\n\n// MAIN //\n\nconst NamespaceData = ({\n\t\taddAnnouncement, deleteAnnouncement, editAnnouncement, badges, namespace, user,\n\t\tgetBadges, uploadFile, deleteFile, getFiles, sendTicketMessage, addNotification,\n\t\tadjustProgress, getCourseTickets, getNamespaceActions, openTicket, closeTicket,\n\t\tcomputeCompletions, updatePriority, getOwnerFiles\n}) => {\n\tlet pathname = window.location.pathname;\n\tconst [ activePage, setActivePage ] = useState( pathname.substring( pathname.lastIndexOf( '/' ) + 1 ) );\n\tconst { t } = useTranslation( [ 'namespace_data', 'common' ] );\n\tconst navigate = useNavigate();\n\tuseEffect( () => {\n\t\tdebug( 'Getting badges upon mounting...' );\n\t\tgetBadges();\n\t}, [ getBadges ] );\n\tif ( !namespace._id ) {\n\t\treturn ( <div className=\"namespace-data-div\">\n\t\t\t<Alert variant=\"danger\">{t('common:no-course-selected')}</Alert>\n\t\t</div> );\n\t}\n\tconst handleUpload = ( event ) => {\n\t\tdebug( 'Uploading file...' );\n\t\tconst file = event.target.files[ 0 ];\n\t\tconst formData = new FormData();\n\t\tformData.append( 'file', file, file.name );\n\t\tformData.append( 'namespaceName', namespace.title );\n\t\tformData.append( 'owner', 'true' );\n\t\tuploadFile({ formData, user });\n\t};\n\tconst handleAnnouncementDeletion = ( createdAt, index ) => {\n\t\tdeleteAnnouncement( {\n\t\t\tnamespaceName: namespace.title,\n\t\t\tindex,\n\t\t\tcreatedAt\n\t\t});\n\t};\n\tconst handleAnnouncementEdit = ( announcement ) => {\n\t\teditAnnouncement({\n\t\t\tnamespaceName: namespace.title,\n\t\t\tannouncement\n\t\t});\n\t};\n\tconst handleAnnouncementCreation = ( announcement ) => {\n\t\taddAnnouncement({\n\t\t\tnamespaceName: namespace.title,\n\t\t\tannouncement\n\t\t});\n\t};\n\tconst handleFileDeletion = ( _id, ownerFiles ) => {\n\t\tdeleteFile( _id, namespace.title, ownerFiles );\n\t};\n\tconst submitTicketMessage = ({ message, ticketID }) => {\n\t\tsendTicketMessage({ message, ticketID, user: user });\n\t};\n\tconst handleSelect = ( selectedKey ) => {\n\t\tconst title = namespace.title;\n\t\tnavigate( `/namespace-data/${title}/${selectedKey}` );\n\t\tsetActivePage( selectedKey );\n\t};\n\treturn (\n\t\t<div className=\"namespace-data-div\" >\n\t\t\t<div className=\"namespace-data-navbar\" >\n\t\t\t\t<Nav variant=\"pills\" className=\"namespace-data-navbar-pills\" activeKey={activePage} onSelect={handleSelect} >\n\t\t\t\t\t<Nav.Item>\n\t\t\t\t\t\t<Nav.Link eventKey=\"announcements\" title=\"Announcements\" >{t('common:announcements')}</Nav.Link>\n\t\t\t\t\t</Nav.Item>\n\t\t\t\t\t<Nav.Item>\n\t\t\t\t\t\t<Nav.Link eventKey=\"progress\" title=\"Progress\" >{t('common:progress')}</Nav.Link>\n\t\t\t\t\t</Nav.Item>\n\t\t\t\t\t<Nav.Item>\n\t\t\t\t\t\t<Nav.Link eventKey=\"completions\" title=\"Completions\" >{t('completions')}</Nav.Link>\n\t\t\t\t\t</Nav.Item>\n\t\t\t\t\t<Nav.Item>\n\t\t\t\t\t\t<Nav.Link eventKey=\"grades\" title=\"Grades\" >{t('grades')}</Nav.Link>\n\t\t\t\t\t</Nav.Item>\n\t\t\t\t\t<Nav.Item>\n\t\t\t\t\t\t<Nav.Link eventKey=\"cohorts\" title=\"Cohorts\" >{t('common:cohorts')}</Nav.Link>\n\t\t\t\t\t</Nav.Item>\n\t\t\t\t\t<Nav.Item>\n\t\t\t\t\t\t<Nav.Link eventKey=\"owner-files\" title=\"Owner Files\" >{t('owner-files')}</Nav.Link>\n\t\t\t\t\t</Nav.Item>\n\t\t\t\t\t<Nav.Item>\n\t\t\t\t\t\t<Nav.Link eventKey=\"student-files\" title=\"Student Files\" >{t('student-files')}</Nav.Link>\n\t\t\t\t\t</Nav.Item>\n\t\t\t\t\t<Nav.Item>\n\t\t\t\t\t\t<Nav.Link eventKey=\"tickets\" title=\"Tickets\" disabled={!namespace.enableTicketing} >{t('common:tickets')}</Nav.Link>\n\t\t\t\t\t</Nav.Item>\n\t\t\t\t\t<Nav.Item>\n\t\t\t\t\t\t<Nav.Link eventKey=\"actions\" title=\"Actions\" disabled >{t('common:actions')}</Nav.Link>\n\t\t\t\t\t</Nav.Item>\n\t\t\t\t</Nav>\n\t\t\t</div>\n\t\t\t<div className=\"namespace-data-page-container\" style={{ overflowY: 'auto' }}>\n\t\t\t\t<Routes>\n\t\t\t\t\t<Route path=\"announcements\" element={<AnnouncementsPage\n\t\t\t\t\t\tnamespace={namespace} editAnnouncement={handleAnnouncementEdit}\n\t\t\t\t\t\tdeleteAnnouncement={handleAnnouncementDeletion}\n\t\t\t\t\t\taddAnnouncement={handleAnnouncementCreation} user={user} />}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route path=\"progress\" element={<ProgressPage adjustProgress={adjustProgress} addNotification={addNotification}\n\t\t\t\t\t\tnamespace={namespace} cohorts={namespace.cohorts}\n\t\t\t\t\t\tlessons={namespace.lessons} user={user} />}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route path=\"completions\" element={<CompletionsPage addNotification={addNotification} namespace={namespace}\n\t\t\t\t\t\tcohorts={namespace.cohorts} lessons={namespace.lessons} user={user} computeCompletions={computeCompletions} />}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route path=\"grades\" element={<GradesPage addNotification={addNotification} namespace={namespace}\n\t\t\t\t\t\tcohorts={namespace.cohorts} lessons={namespace.lessons} user={user} />}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route path=\"cohorts\" element={<CohortsPage badges={badges} cohorts={namespace.cohorts}\n\t\t\t\t\t\tlessons={namespace.lessons} />}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route path=\"owner-files\" element={<FilesPage ownerFiles files={namespace.ownerFiles} namespace={namespace}\n\t\t\t\t\t\thandleUpload={handleUpload} handleFileDeletion={handleFileDeletion}\n\t\t\t\t\t\taddNotification={addNotification} getFiles={getOwnerFiles} />}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route path=\"student-files\" element={<FilesPage files={namespace.files} namespace={namespace} handleUpload={handleUpload}\n\t\t\t\t\t\thandleFileDeletion={handleFileDeletion} addNotification={addNotification} getFiles={getFiles} />}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route path=\"tickets\" element={<TicketsPage tickets={namespace.tickets} namespace={namespace}\n\t\t\t\t\t\tgetCourseTickets={getCourseTickets} submitTicketMessage={submitTicketMessage}\n\t\t\t\t\t\topenTicket={openTicket} closeTicket={closeTicket}\n\t\t\t\t\t\tupdatePriority={updatePriority} />}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route path=\"actions\" element={<ActionsPage namespace={namespace} getNamespaceActions={getNamespaceActions}\n\t\t\t\t\t\tuser={user} cohorts={namespace.cohorts} />}\n\t\t\t\t\t/>\n\t\t\t\t</Routes>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\n\n// PROPERTIES //\n\nNamespaceData.propTypes = {\n\taddAnnouncement: PropTypes.func.isRequired,\n\taddNotification: PropTypes.func.isRequired,\n\tadjustProgress: PropTypes.func.isRequired,\n\tbadges: PropTypes.array,\n\tcloseTicket: PropTypes.func.isRequired,\n\tcomputeCompletions: PropTypes.func.isRequired,\n\tdeleteAnnouncement: PropTypes.func.isRequired,\n\tdeleteFile: PropTypes.func.isRequired,\n\teditAnnouncement: PropTypes.func.isRequired,\n\tgetBadges: PropTypes.func.isRequired,\n\tgetCourseTickets: PropTypes.func.isRequired,\n\tgetFiles: PropTypes.func.isRequired,\n\tgetNamespaceActions: PropTypes.func.isRequired,\n\tgetOwnerFiles: PropTypes.func.isRequired,\n\tnamespace: PropTypes.object.isRequired,\n\topenTicket: PropTypes.func.isRequired,\n\tsendTicketMessage: PropTypes.func.isRequired,\n\tupdatePriority: PropTypes.func.isRequired,\n\tuploadFile: PropTypes.func.isRequired,\n\tuser: PropTypes.object.isRequired\n};\n\nNamespaceData.defaultProps = {\n\tbadges: null\n};\n\n\n// EXPORTS //\n\nexport default NamespaceData;\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport server from 'constants/server';\r\nimport { CREATED_ANNOUNCEMENT, EDITED_ANNOUNCEMENT, DELETED_ANNOUNCEMENT } from 'constants/action_types.js';\r\nimport { addNotification, addErrorNotification } from 'actions/notification';\r\nimport { namespaceAxios } from 'helpers/axios.js';\r\n\r\n\r\n// EXPORTS //\r\n\r\n/**\r\n * Returns an action object to be used in signalling that an announcement has been edited.\r\n *\r\n * @param {Object} announcement\r\n * @param {string} namespaceName\r\n * @returns {Object} an action object\r\n */\r\nexport function editedAnnouncement( announcement, namespaceName ) {\r\n\treturn {\r\n\t\ttype: EDITED_ANNOUNCEMENT,\r\n\t\tpayload: {\r\n\t\t\tannouncement,\r\n\t\t\tnamespaceName\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Returns an action object to be used in signalling that an announcement has been created.\r\n *\r\n * @param {Object} announcement\r\n * @param {string} namespaceName\r\n * @returns {Object} an action object\r\n */\r\nexport function createdAnnouncement( announcement, namespaceName ) {\r\n\treturn {\r\n\t\ttype: CREATED_ANNOUNCEMENT,\r\n\t\tpayload: {\r\n\t\t\tannouncement,\r\n\t\t\tnamespaceName\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Returns an action object to be used in signalling that an announcement has been deleted.\r\n *\r\n * @param {number} index - index of the announcement\r\n * @param {string} namespaceName\r\n * @returns {Object} an action object\r\n */\r\nexport function deletedAnnouncement( index, namespaceName ) {\r\n\treturn {\r\n\t\ttype: DELETED_ANNOUNCEMENT,\r\n\t\tpayload: {\r\n\t\t\tindex,\r\n\t\t\tnamespaceName\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Makes a request to create an announcement.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} opts - request options\r\n * @param {string} opts.namespaceName - namespace name\r\n * @param {Object} opts.announcement - announcement object\r\n */\r\nexport const addAnnouncement = async ( dispatch, { namespaceName, announcement }) => {\r\n\ttry {\r\n\t\tconst res = await namespaceAxios.post( server+'/new_announcement', {\r\n\t\t\tnamespaceName,\r\n\t\t\tannouncement\r\n\t\t});\r\n\t\taddNotification( dispatch, {\r\n\t\t\tmessage: res.data.message,\r\n\t\t\tlevel: 'success'\r\n\t\t});\r\n\t\tdispatch( createdAnnouncement( announcement, namespaceName ) );\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function for making an request to create an announcement with a bound dispatch function\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} wrapped `addAnnouncement` function\r\n */\r\nexport const addAnnouncementInjector = dispatch => {\r\n\treturn async ( { namespaceName, announcement } ) => {\r\n\t\tawait addAnnouncement( dispatch, { namespaceName, announcement } );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a request to delete an announcement.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} opts - request options\r\n * @param {string} opts.namespaceName - namespace name\r\n * @param {number} opts.index - index of the announcement\r\n * @param {string} opts.createdAt - creation time of the announcement\r\n */\r\nexport const deleteAnnouncement = async ( dispatch, { namespaceName, createdAt, index }) => {\r\n\ttry {\r\n\t\tconst res = await namespaceAxios.post( server+'/delete_announcement', {\r\n\t\t\tnamespaceName,\r\n\t\t\tcreatedAt\r\n\t\t});\r\n\t\taddNotification( dispatch, {\r\n\t\t\tmessage: res.data.message,\r\n\t\t\tlevel: 'success'\r\n\t\t});\r\n\t\tdispatch( deletedAnnouncement( index, namespaceName ) );\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function for making an request to delete an announcement with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} wrapped `deleteAnnouncement` function\r\n */\r\nexport const deleteAnnouncementInjector = dispatch => {\r\n\treturn async ( { namespaceName, createdAt, index } ) => {\r\n\t\tawait deleteAnnouncement( dispatch, { namespaceName, createdAt, index } );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a request to edit an announcement.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} opts - request options\r\n * @param {string} opts.namespaceName - namespace name\r\n * @param {Object} opts.announcement - announcement object\r\n */\r\nexport const editAnnouncement = async ( dispatch, { namespaceName, announcement }) => {\r\n\ttry {\r\n\t\tconst res = await namespaceAxios.post( server+'/edit_announcement', {\r\n\t\t\tnamespaceName,\r\n\t\t\tannouncement\r\n\t\t});\r\n\t\taddNotification( dispatch, {\r\n\t\t\tmessage: res.data.message,\r\n\t\t\tlevel: 'success'\r\n\t\t});\r\n\t\tdispatch( editedAnnouncement( announcement, namespaceName ) );\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function for making an request to edit an announcement with a bound dispatch function.\r\n *\r\n* @param {Function} dispatch - dispatch function\r\n* @returns {Function} wrapped `editAnnouncement` function\r\n*/\r\nexport const editAnnouncementInjector = dispatch => {\r\n\treturn async ( { namespaceName, announcement } ) => {\r\n\t\tawait editAnnouncement( dispatch, { namespaceName, announcement } );\r\n\t};\r\n};\r\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport NamespaceData from 'components/namespace-data';\nimport { addAnnouncementInjector, deleteAnnouncementInjector, editAnnouncementInjector } from 'actions/announcement';\nimport { getAvailableBadgesInjector } from 'actions/badge';\nimport { deleteFileInjector, getFilesInjector, getOwnerFilesInjector, uploadFileInjector } from 'actions/file';\nimport { addNotificationInjector } from 'actions/notification';\nimport { getNamespaceActionsInjector, adjustProgressInjector } from 'actions/namespace';\nimport { getCourseTicketsInjector, sendTicketMessageInjector,\n\tcloseTicketInjector, openTicketInjector, updatePriorityInjector } from 'actions/ticket';\nimport { computeCompletionsInjector } from 'actions/completions';\n\n\n// FUNCTIONS //\n\nfunction mapStateToProps( state ) {\n\treturn {\n\t\tbadges: state.badges,\n\t\tuser: state.user,\n\t\tnamespace: state.namespace\n\t};\n}\n\nfunction mapDispatchToProps( dispatch ) {\n\treturn {\n\t\tadjustProgress: adjustProgressInjector( dispatch ),\n\t\tgetBadges: getAvailableBadgesInjector( dispatch ),\n\t\tgetCourseTickets: getCourseTicketsInjector( dispatch ),\n\t\tgetFiles: getFilesInjector( dispatch ),\n\t\tgetOwnerFiles: getOwnerFilesInjector( dispatch ),\n\t\tgetNamespaceActions: getNamespaceActionsInjector( dispatch ),\n\t\taddNotification: addNotificationInjector( dispatch ),\n\t\tdeleteFile: deleteFileInjector( dispatch ),\n\t\tdeleteAnnouncement: deleteAnnouncementInjector( dispatch ),\n\t\teditAnnouncement: editAnnouncementInjector( dispatch ),\n\t\taddAnnouncement: addAnnouncementInjector( dispatch ),\n\t\tsendTicketMessage: sendTicketMessageInjector( dispatch ),\n\t\tcloseTicket: closeTicketInjector( dispatch ),\n\t\tcomputeCompletions: computeCompletionsInjector( dispatch ),\n\t\topenTicket: openTicketInjector( dispatch ),\n\t\tuploadFile: uploadFileInjector( dispatch ),\n\t\tupdatePriority: updatePriorityInjector( dispatch )\n\t};\n}\n\n\n// MAIN //\n\nconst VisibleNamespaceData = connect( mapStateToProps, mapDispatchToProps )( NamespaceData );\n\n\n// EXPORTS //\n\nexport default VisibleNamespaceData;\n","// MODULES //\r\n\r\nimport asyncComponent from 'components/async';\r\n\r\n\r\n// MAIN //\r\n\r\nconst DashboardDataExplorer = asyncComponent( () => import( './main.js' ) );\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default DashboardDataExplorer;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\n\r\n\r\n// MAIN //\r\n\r\nfunction createBooleanColumn({ Header, accessor, trueLabel, falseLabel, printLabels = false, maxWidth = 150 }) {\r\n\tlet Cell;\r\n\tlet style;\r\n\tif ( printLabels ) {\r\n\t\tCell = ( row ) => {\r\n\t\t\tif ( row.value === true ) {\r\n\t\t\t\treturn trueLabel;\r\n\t\t\t} else if ( row.value === false ) {\r\n\t\t\t\treturn falseLabel;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t};\r\n\t\tstyle = { marginTop: '8px', color: 'darkslategrey' };\r\n\t} else {\r\n\t\tCell = ( row ) => {\r\n\t\t\tif ( row.value ) {\r\n\t\t\t\treturn <i className=\"far fa-check-square\"></i>;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t};\r\n\t\tstyle = { marginTop: '2px', color: 'darkslategrey', fontSize: 24, textAlign: 'center' };\r\n\t}\r\n\treturn {\r\n\t\tHeader,\r\n\t\taccessor,\r\n\t\tstyle,\r\n\t\tCell: Cell,\r\n\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\tif ( filter.value === 'all' ) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tconst id = filter.pivotId || filter.id;\r\n\t\t\tif ( row[ id ] === void 0 ) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn String( row[ id ] ) === filter.value;\r\n\t\t},\r\n\t\tFilter: ({ filter, onChange }) => {\r\n\t\t\tconst handleChange = ( event ) => {\r\n\t\t\t\tconst newValue = event.target.value;\r\n\t\t\t\tonChange( newValue );\r\n\t\t\t};\r\n\t\t\tlet value;\r\n\t\t\tif ( !filter ) {\r\n\t\t\t\tvalue = 'all';\r\n\t\t\t} else {\r\n\t\t\t\tvalue = filter.value;\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<select\r\n\t\t\t\t\tonBlur={handleChange} onChange={handleChange}\r\n\t\t\t\t\tstyle={{ width: '100%', backgroundColor: 'ghostwhite' }}\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t>\r\n\t\t\t\t\t<option value=\"all\">Show All</option>\r\n\t\t\t\t\t<option value={true} >{trueLabel}</option>\r\n\t\t\t\t\t<option value={false} >{falseLabel}</option>\r\n\t\t\t\t</select>\r\n\t\t\t);\r\n\t\t},\r\n\t\tmaxWidth: maxWidth\r\n\t};\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default createBooleanColumn;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\n\r\n\r\n// MAIN //\r\n\r\nfunction createCategoricalColumn({ Header, Cell, accessor, labels, maxWidth = 150, width }) {\r\n\tlet style;\r\n\treturn {\r\n\t\tHeader,\r\n\t\taccessor,\r\n\t\tstyle,\r\n\t\tCell,\r\n\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\tif ( filter.value === 'all' ) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tconst id = filter.pivotId || filter.id;\r\n\t\t\tif ( row[ id ] === void 0 ) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn String( row[ id ] ) === filter.value;\r\n\t\t},\r\n\t\tFilter: ({ filter, onChange }) => {\r\n\t\t\tconst handleChange = ( event ) => {\r\n\t\t\t\tconst newValue = event.target.value;\r\n\t\t\t\tonChange( newValue );\r\n\t\t\t};\r\n\t\t\tlet value;\r\n\t\t\tif ( !filter ) {\r\n\t\t\t\tvalue = 'all';\r\n\t\t\t} else {\r\n\t\t\t\tvalue = filter.value;\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<select\r\n\t\t\t\t\tonBlur={handleChange} onChange={handleChange}\r\n\t\t\t\t\tstyle={{ width: '100%', backgroundColor: 'ghostwhite' }}\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t>\r\n\t\t\t\t\t<option value=\"all\">Show All</option>\r\n\t\t\t\t\t{labels.map( ( x, idx ) => <option value={x} key={idx} >{x}</option> )}\r\n\t\t\t\t</select>\r\n\t\t\t);\r\n\t\t},\r\n\t\tmaxWidth: maxWidth,\r\n\t\twidth: width\r\n\t};\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default createCategoricalColumn;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component, Fragment } from 'react';\r\nimport { DateRangePicker } from 'react-dates';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Popover from 'react-bootstrap/Popover';\r\nimport Button from 'react-bootstrap/Button';\r\nimport 'react-dates/lib/css/_datepicker.css';\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nclass CustomDatePicker extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\t\tthis.state = {\r\n\t\t\tstartDate: props.startDate,\r\n\t\t\tendDate: props.endDate\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidUpdate( prevProps ) {\r\n\t\tif (\r\n\t\t\tthis.props.startDate !== prevProps.startDate ||\r\n\t\t\tthis.props.endDate !== prevProps.endDate\r\n\t\t) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tstartDate: this.props.startDate,\r\n\t\t\t\tendDate: this.props.endDate\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\thandleDatesChange = ({ startDate, endDate }) => {\r\n\t\tthis.setState({\r\n\t\t\tstartDate,\r\n\t\t\tendDate\r\n\t\t}, () => {\r\n\t\t\tthis.props.onDatesChange( this.state );\r\n\t\t});\r\n\t};\r\n\r\n\thandleReset = () => {\r\n\t\tthis.setState({\r\n\t\t\tstartDate: this.props.minDate,\r\n\t\t\tendDate: this.props.maxDate\r\n\t\t}, () => {\r\n\t\t\tthis.props.onDatesChange( this.state );\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<DateRangePicker\r\n\t\t\t\t\tstartDate={this.state.startDate}\r\n\t\t\t\t\tendDate={this.state.endDate}\r\n\t\t\t\t\tstartDateId=\"start_date_input\"\r\n\t\t\t\t\tendDateId=\"end_date_input\"\r\n\t\t\t\t\tonDatesChange={this.handleDatesChange}\r\n\t\t\t\t\tfocusedInput={this.state.focusedInput}\r\n\t\t\t\t\tonFocusChange={focusedInput => this.setState({ focusedInput })}\r\n\t\t\t\t\tisOutsideRange={() => false}\r\n\t\t\t\t/>\r\n\t\t\t\t<Button\r\n\t\t\t\t\taria-label={this.props.t('common:close')}\r\n\t\t\t\t\tvariant=\"warning\"\r\n\t\t\t\t\tonClick={this.handleReset}\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tpaddingTop: 8,\r\n\t\t\t\t\t\tpaddingLeft: 16,\r\n\t\t\t\t\t\tpaddingRight: 16,\r\n\t\t\t\t\t\tpaddingBottom: 8,\r\n\t\t\t\t\t\tfontSize: 20\r\n\t\t\t\t\t}}\r\n\t\t\t\t>x</Button>\r\n\t\t\t</Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst DefaultCell = ( row ) => {\r\n\treturn new Date( row.value ).toLocaleString();\r\n};\r\n\r\n\r\n// MAIN //\r\n\r\nfunction createBooleanColumn({ Header, accessor, Cell, style, startDate, endDate, t, maxWidth = 150 }) {\r\n\treturn {\r\n\t\tHeader,\r\n\t\taccessor,\r\n\t\tstyle,\r\n\t\tCell: Cell || DefaultCell,\r\n\t\tfilterMethod: ( filter, row ) => {\r\n\t\t\tif ( !filter.value ) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tconst { startDate, endDate } = filter.value;\r\n\t\t\tconst id = filter.pivotId || filter.id;\r\n\t\t\tconst value = row[ id ].getTime();\r\n\t\t\tif ( startDate && endDate ) {\r\n\t\t\t\treturn value >= startDate.valueOf() && value <= endDate.valueOf();\r\n\t\t\t}\r\n\t\t\tif ( startDate ) {\r\n\t\t\t\treturn value >= startDate.valueOf();\r\n\t\t\t}\r\n\t\t\tif ( endDate ) {\r\n\t\t\t\treturn value <= endDate.valueOf();\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tFilter: ({ filter, onChange }) => {\r\n\t\t\tconst filterValue = filter ? ( filter.value || {} ) : {};\r\n\t\t\tconst popover = <Popover id=\"popover-data\" style={{ maxWidth: 400 }}>\r\n\t\t\t\t<Popover.Header as=\"h3\">{t('common:dates')}</Popover.Header>\r\n\t\t\t\t<Popover.Body style={{ backgroundColor: 'grey' }} >\r\n\t\t\t\t\t<CustomDatePicker\r\n\t\t\t\t\t\tstartDate={filterValue.startDate || startDate}\r\n\t\t\t\t\t\tminDate={startDate}\r\n\t\t\t\t\t\tmaxDate={endDate}\r\n\t\t\t\t\t\tendDate={filterValue.endDate || endDate}\r\n\t\t\t\t\t\tonDatesChange={({ startDate, endDate }) => {\r\n\t\t\t\t\t\t\tonChange({ startDate, endDate });\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tt={t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Popover.Body>\r\n\t\t\t</Popover>;\r\n\t\t\treturn (\r\n\t\t\t\t<OverlayTrigger trigger=\"click\" placement=\"right\" overlay={popover}>\r\n\t\t\t\t\t<Button aria-label={t('common:toggle-calendar')} size=\"sm\" style={{ float: 'left', marginLeft: 6 }} variant=\"secondary\" >\r\n\t\t\t\t\t\t<i className=\"far fa-calendar-alt\"></i>\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</OverlayTrigger>\r\n\t\t\t);\r\n\t\t},\r\n\t\tmaxWidth: maxWidth\r\n\t};\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default createBooleanColumn;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\nimport InputRange from 'react-input-range';\r\nimport replace from '@stdlib/string/replace';\r\nimport lowercase from '@stdlib/string/lowercase';\r\nimport roundn from '@stdlib/math/base/special/roundn';\r\nimport 'css/input_range.css';\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nconst defaultFilterMethod = ( filter, row ) => {\r\n\tconst id = filter.pivotId || filter.id;\r\n\tconst val = row[ id ];\r\n\treturn val >= filter.value.min && val <= filter.value.max;\r\n};\r\n\r\nconst defaultFormatLabel = ( value ) => roundn( value, -2 );\r\n\r\n\r\n// MAIN //\r\n\r\nfunction createNumericColumn({ Header, accessor, Cell, minValue = 0, maxValue = 1, maxWidth = 150, filterMethod, formatLabel }) {\r\n\tconst id = `header-${lowercase( replace( Header, ' ', '-' ) )}`;\r\n\treturn {\r\n\t\tHeader: <span id={id} >{Header}</span>,\r\n\t\taccessor,\r\n\t\tCell: Cell ? Cell : ( row ) => row.value ? `${roundn( row.value, -3 )}` : 'NA',\r\n\t\tfilterMethod: filterMethod || defaultFilterMethod,\r\n\t\tFilter: ({ filter, onChange }) => {\r\n\t\t\tif ( minValue === maxValue ) {\r\n\t\t\t\tmaxValue = minValue += 1;\r\n\t\t\t}\r\n\t\t\tconst defaultVal = {\r\n\t\t\t\tmax: maxValue,\r\n\t\t\t\tmin: minValue\r\n\t\t\t};\r\n\t\t\treturn (\r\n\t\t\t\t<div style={{\r\n\t\t\t\t\tpaddingLeft: '4px',\r\n\t\t\t\t\tpaddingRight: '4px',\r\n\t\t\t\t\tpaddingTop: '8px'\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<InputRange\r\n\t\t\t\t\t\tariaLabelledby={id}\r\n\t\t\t\t\t\tariaControls=\"dashboard-table\"\r\n\t\t\t\t\t\tallowSameValues\r\n\t\t\t\t\t\tmaxValue={maxValue}\r\n\t\t\t\t\t\tminValue={minValue}\r\n\t\t\t\t\t\tstep={0.1}\r\n\t\t\t\t\t\tvalue={filter ? filter.value : defaultVal}\r\n\t\t\t\t\t\tonChange={( newValue ) => {\r\n\t\t\t\t\t\t\tonChange( newValue );\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tformatLabel={formatLabel || defaultFormatLabel}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t},\r\n\t\tmaxWidth: maxWidth\r\n\t};\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default createNumericColumn;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\nimport FormControl from 'react-bootstrap/FormControl';\r\nimport textFilter from './text_filter.js';\r\n\r\n\r\n// MAIN //\r\n\r\nfunction createTextColumn({ id, Header, Cell, accessor, maxWidth = 150, minWidth, filterMethod }) {\r\n\tif ( minWidth > maxWidth ) {\r\n\t\tmaxWidth = minWidth;\r\n\t}\r\n\tconst spec = {\r\n\t\tid,\r\n\t\tHeader,\r\n\t\taccessor,\r\n\t\tCell,\r\n\t\tfilterMethod: filterMethod ? filterMethod : textFilter,\r\n\t\tFilter: ({ filter, onChange }) => {\r\n\t\t\treturn (\r\n\t\t\t\t<FormControl\r\n\t\t\t\t\taria-label={Header}\r\n\t\t\t\t\tautoComplete=\"none\"\r\n\t\t\t\t\tonChange={( event ) => {\r\n\t\t\t\t\t\tonChange( event.target.value );\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\tif ( maxWidth ) {\r\n\t\tspec.maxWidth = maxWidth;\r\n\t}\r\n\tif ( minWidth ) {\r\n\t\tspec.minWidth = minWidth;\r\n\t}\r\n\treturn spec;\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default createTextColumn;\r\n","/*\r\n* Adapted from:\r\n*\r\n* FileSaver.js\r\n* A saveAs() FileSaver implementation.\r\n* 1.3.8\r\n* 2018-03-22 14:03:47\r\n*\r\n* By Eli Grey, https://eligrey.com\r\n* License: MIT\r\n*   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\r\n*\r\n* @source http://purl.eligrey.com/github/FileSaver.js/blob/master/src/FileSaver.js\r\n*/\r\n\r\n// VARIABLES //\r\n\r\nconst RE_AUTO_BOM = /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i;\r\nconst ARBITRARY_REVOKE_TIMEOUT = 1000 * 40; // Time in ms\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nfunction click(node) {\r\n\tconst event = new MouseEvent( 'click' );\r\n\tnode.dispatchEvent( event );\r\n}\r\n\r\nfunction throwOutside( ex ) {\r\n\tsetImmediate(function throwEx() {\r\n\t\tthrow ex;\r\n\t}, 0 );\r\n}\r\n\r\nfunction autoBOM( blob ) {\r\n\t// Prepend BOM for UTF-8 XML and text/* types (including HTML). Note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\r\n\tif ( RE_AUTO_BOM.test( blob.type ) ) {\r\n\t\treturn new Blob([ String.fromCharCode( 0xFEFF ), blob ], {\r\n\t\t\ttype: blob.type\r\n\t\t});\r\n\t}\r\n\treturn blob;\r\n}\r\n\r\nfunction dispatch( filesaver, eventTypes, event ) {\r\n\teventTypes = [].concat( eventTypes );\r\n\tlet i = eventTypes.length;\r\n\twhile ( i-- ) {\r\n\t\tlet listener = filesaver[ 'on' + eventTypes[i] ];\r\n\t\tif ( typeof listener === 'function' ) {\r\n\t\t\ttry {\r\n\t\t\t\tlistener.call( filesaver, event || filesaver );\r\n\t\t\t} catch ( ex ) {\r\n\t\t\t\tthrowOutside( ex );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n// MAIN //\r\n\r\nfunction saveFactory( view ) {\r\n\tif (\r\n\t\ttypeof view === 'undefined' ||\r\n\t\ttypeof navigator !== 'undefined' &&\r\n\t\t/MSIE [1-9]\\./.test( navigator.userAgent )\r\n\t) {\r\n\t\treturn;\r\n\t}\r\n\tconst doc = view.document;\r\n\r\n\t// Only get URL when necessary in case Blob.js hasn't overridden it yet:\r\n\tfunction getURL() {\r\n\t\treturn view.URL || view.webkitURL || view;\r\n\t}\r\n\tfunction revoke( file ) {\r\n\t\tfunction revoker() {\r\n\t\t\tif ( typeof file === 'string' ) { // File is an object URL...\r\n\t\t\t\tgetURL().revokeObjectURL(file);\r\n\t\t\t} else { // File is a File...\r\n\t\t\t\tfile.remove();\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetTimeout( revoker, ARBITRARY_REVOKE_TIMEOUT );\r\n\t}\r\n\r\n\tconst saveLink = doc.createElementNS( 'http://www.w3.org/1999/xhtml', 'a' );\r\n\tconst canUseSaveLink = 'download' in saveLink;\r\n\tconst isSafari = /constructor/i.test( view.HTMLElement ) || view.safari;\r\n\tconst isChromeIOS =/CriOS\\/[\\d]+/.test( navigator.userAgent );\r\n\tconst setImmediate = view.setImmediate || view.setTimeout;\r\n\tconst forceSavableType = 'application/octet-stream';\r\n\r\n\tfunction FileSaver(blob, name, noAutoBOM ) {\r\n\t\tif ( !noAutoBOM ) {\r\n\t\t\tblob = autoBOM(blob);\r\n\t\t}\r\n\t\t// First try a.download, then web filesystem, then object URLs\r\n\t\tconst self = this;\r\n\t\tconst type = blob.type;\r\n\t\tconst force = type === forceSavableType;\r\n\t\tlet objectURL;\r\n\t\tfunction dispatchAll() {\r\n\t\t\tdispatch( self, 'writestart progress write writeend'.split(' ') );\r\n\t\t}\r\n\t\t// On any filesystem errors, revert to saving with object URLs:\r\n\t\tfunction fsError() {\r\n\t\t\tif ((isChromeIOS || (force && isSafari)) && view.FileReader) {\r\n\t\t\t\t// Safari doesn't allow downloading of blob urls\r\n\t\t\t\tconst reader = new FileReader();\r\n\t\t\t\treader.onloadend = function onLoadEnd() {\r\n\t\t\t\t\tlet url = isChromeIOS ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\r\n\t\t\t\t\tconst popup = view.open(url, '_blank');\r\n\t\t\t\t\tif ( !popup ) {\r\n\t\t\t\t\t\tview.location.href = url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\turl = void 0; // Release reference before dispatching...\r\n\t\t\t\t\tself.readyState = self.DONE;\r\n\t\t\t\t\tdispatchAll();\r\n\t\t\t\t};\r\n\t\t\t\treader.readAsDataURL(blob);\r\n\t\t\t\tself.readyState = self.INIT;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// Don't create more object URLs than needed:\r\n\t\t\tif ( !objectURL ) {\r\n\t\t\t\tobjectURL = getURL().createObjectURL( blob );\r\n\t\t\t}\r\n\t\t\tif ( force ) {\r\n\t\t\t\tview.location.href = objectURL;\r\n\t\t\t} else {\r\n\t\t\t\tconst opened = view.open( objectURL, '_blank' );\r\n\t\t\t\tif ( !opened ) {\r\n\t\t\t\t\t// Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\r\n\t\t\t\t\tview.location.href = objectURL;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.readyState = self.DONE;\r\n\t\t\tdispatchAll();\r\n\t\t\trevoke( objectURL );\r\n\t\t}\r\n\t\tself.readyState = self.INIT;\r\n\r\n\t\tif ( canUseSaveLink ) {\r\n\t\t\tobjectURL = getURL().createObjectURL(blob);\r\n\t\t\tsetImmediate(function save() {\r\n\t\t\t\tsaveLink.href = objectURL;\r\n\t\t\t\tsaveLink.download = name;\r\n\t\t\t\tclick( saveLink );\r\n\t\t\t\tdispatchAll();\r\n\t\t\t\trevoke( objectURL );\r\n\t\t\t\tself.readyState = self.DONE;\r\n\t\t\t}, 0);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfsError();\r\n\t}\r\n\tconst proto = FileSaver.prototype;\r\n\tfunction saveAs( blob, name, noAutoBOM ) {\r\n\t\treturn new FileSaver( blob, name || blob.name || 'download', noAutoBOM );\r\n\t}\r\n\r\n\t// IE 10+ (native saveAs)\r\n\tif ( typeof navigator !== 'undefined' && navigator.msSaveOrOpenBlob ) {\r\n\t\treturn function saveAs( blob, name, noAutoBOM ) {\r\n\t\t\tname = name || blob.name || 'download';\r\n\t\t\tif ( !noAutoBOM ) {\r\n\t\t\t\tblob = autoBOM( blob );\r\n\t\t\t}\r\n\t\t\treturn navigator.msSaveOrOpenBlob(blob, name);\r\n\t\t};\r\n\t}\r\n\r\n\tproto.abort = function abort() {};\r\n\tproto.readyState = proto.INIT = 0;\r\n\tproto.WRITING = 1;\r\n\tproto.DONE = 2;\r\n\r\n\tproto.error = null;\r\n\tproto.onwritestart = null;\r\n\tproto.onprogress = null;\r\n\tproto.onwrite = null;\r\n\tproto.onabort = null;\r\n\tproto.onerror = null;\r\n\tproto.onwriteend = null;\r\n\r\n\treturn saveAs;\r\n}\r\n\r\nconst saveAs = saveFactory(\r\n\ttypeof self !== 'undefined' && self ||\r\n\ttypeof window !== 'undefined' && window ||\r\n\tthis.content\r\n);\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default saveAs;\r\n","// MODULES //\r\n\r\nimport contains from '@stdlib/assert/contains';\r\nimport lowercase from '@stdlib/string/lowercase';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n* Checks whether a row contains a string that matches a filter.\r\n*\r\n* @param {Object} filter - filter object\r\n* @param {Object} row - row of data\r\n* @returns {boolean} boolean indicating whether a row contains a string that matches a filter\r\n*/\r\nconst textFilter = ( filter, row ) => {\r\n\tconst str = row[ filter.id ] || '';\r\n\treturn contains( lowercase( str ), lowercase( filter.value ) );\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default textFilter;\r\n"],"sourceRoot":""}