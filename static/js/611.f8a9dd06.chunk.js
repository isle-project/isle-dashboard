/*! For license information please see 611.f8a9dd06.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkisle_dashboard=self.webpackChunkisle_dashboard||[]).push([[611],{50388:function(e,t,a){const n=(0,a(29191).Z)((()=>a.e(1438).then(a.bind(a,17451))));t.Z=n},20611:function(e,t,a){a.r(t),a.d(t,{default:function(){return Oe}});var n=a(38603),r=a(91532),s=a.n(r),l=a(93918),i=a(38564),o=a.n(i),c=a(22720),m=a(85944),u=a(15020),d=a(13880),h=a(79174),p=a(89956),g=a(7846),b=a(83729),f=a(80988),E=a.n(f),y=a(45014),v=a.n(y),Z=a(21598),C=a.n(Z),w=a(63041),N=a.n(w),k=a(42415),x=a(28564),V=a(3021),q=a(42152),P=a(38020),F=a(18237);var G=(0,a(29191).Z)((()=>a.e(1894).then(a.bind(a,53009)))),S=a(25461),H=a(34064),$=a.n(H),A=a(32921),R=a(84111),L=a(96077),T=a(28965),z=a(2443),M=a(72077);var K=function(e){e.stopPropagation()},B=a(70395),j=a(1611);const D=o()("isle:data-explorer:variable-transformer"),I=/shapes\[(\d)\]\.x0/,O={group:null,displayDensity:!0,densityType:"Data-driven",chooseBins:!1,nBins:null};function Y(e,t){return e-t}const J=e=>{const t=[];for(let a=0;a<e.length;a++)t.push({type:"line",x0:e[a],y0:-100,x1:e[a],y1:100,line:{color:"red",width:3}});return t},W=(e,t)=>{const a=new Array(t.length);t[0]?a[0]=t[0]:a[0]=`(-\u221e,${e[0]})`;for(let r=1;r<t.length;r++)t[r]?a[r]=t[r]:a[r]=`[${e[r-1]},${e[r]})`;const n=t.length-1;return t[n]?a[n]=t[n]:a[n]=`[${e[e.length-1]},\u221e)`,a},_=e=>{const[t,a]=(0,n.useState)(""),[r,s]=(0,n.useState)(0),[i,o]=(0,n.useState)({variable:null,configHist:null,breakpoints:null,categories:null,customNames:null}),f=t.length<2,y=()=>{const{variable:a,categories:n,breakpoints:r}=i,s=e.data[a],l=(0,B.Z)(s,n,r);e.logAction(z.dU,{name:t,variable:a,breaks:r,categories:n});const o=(0,A.Z)(t,n);e.onGenerate(o,l),e.onHide()},Z=e=>{13!==e.charCode||f||y()},w=e=>{a(e.target.value)},H=e=>t=>{D("Change break point...");const a=i.breakpoints.slice();a[e]=C()(t,-r),a.sort(Y);const n=N()(i.configHist);n.layout.shapes=J(a),o({...i,configHist:n,breakpoints:a,categories:W(a,i.customNames)})},_=e=>t=>{const a=i.categories.slice();a[e]=t;const n=i.customNames.slice();n[e]=t;const r={...i,categories:a,customNames:n};o(r)},U=e=>()=>{const{breakpoints:t,categories:a,customNames:n}=i;t.splice(e,1),a.splice(e,1),n.splice(e,1);const r={...i.configHist};r.layout.shapes=J(t),o({...i,configHist:r,categories:a,customNames:n,breakpoints:t})},X=e=>{const t=v()(e),a=I.exec(t[0]);if(a){const n=a[1],s=i.breakpoints.slice();s[n]=C()(e[t[0]],-r),s.sort(Y);const l=N()(i.configHist);l.layout.shapes=J(s),o({...i,configHist:l,breakpoints:s,categories:W(s,i.customNames)})}},Q=t=>{D("Change variable to bin...");const a={data:e.data,variable:t,...O},n=(0,M.N)(a);n.layout.yaxis={range:[(0,L.Z)(n.data[1].y),(0,T.Z)(n.data[1].y)],fixedrange:!0},n.layout.xaxis={fixedrange:!0};let s=e.data[t];s=s.filter((e=>(0,k.isPrimitive)(e)&&!$()(e)));const l=[C()((0,R.Z)(s),-r)];n.layout.shapes=J(l);const i=[!1,!1];o({variable:t,configHist:n,breakpoints:l,customNames:i,categories:W(l,i)})},ee=()=>{const t=i.breakpoints.slice();let a=e.data[i.variable];a=a.filter((e=>(0,k.isPrimitive)(e)&&!$()(e)));const n=E()(.8,1.2)*(0,R.Z)(a);t.push(C()(n,-r)),t.sort(Y);const s=N()(i.configHist);s.layout.shapes=J(t);const l=i.customNames;l.push(!1);const c={...i,breakpoints:t,configHist:s,categories:W(t,l)};o(c)};return n.createElement(P.Z,{cancel:".card-body",onDragStart:K,style:{zIndex:1006}},n.createElement(G,{onHide:e.onHide,show:e.show,header:e.t("bin-transformer-header"),footer:n.createElement(l.Z,{onClick:y,disabled:f},e.t("create-new-variable")),bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"},role:"button",tabIndex:0},(()=>{const t=i.configHist,a=n.createElement(V.Z,{legend:e.t("variable-to-bin"),defaultValue:i.variable,options:e.quantitative,onChange:Q,style:{maxWidth:400}});return t?n.createElement(n.Fragment,null,a,n.createElement(l.Z,{className:"insert-line-button",onClick:ee},e.t("insert-break-line")),n.createElement("p",null,e.t("drag-red-bars"),"(",n.createElement(x.Z,{legend:e.t("digits-after-comma-snap"),min:0,max:9,inline:!0,defaultValue:r,onChange:s}),")"),n.createElement("div",{style:{height:250}},n.createElement(F.Z,{data:t.data,layout:t.layout,editable:!0,fit:!0,removeButtons:!0,legendButtons:!1,onRelayout:X})),n.createElement("div",null,n.createElement(p.Z,{className:"mb-2"},n.createElement(p.Z.Header,null,e.t("choose-category-labels"),":"),n.createElement(p.Z.Body,null,(()=>{const t=[],a=i.breakpoints,r=1===a.length;if(t.push(n.createElement(g.Z,{key:"div-0"},n.createElement(b.Z,{md:7},n.createElement(S.Z,{raw:"x < "}),n.createElement(x.Z,{inline:!0,onBlur:H(0),defaultValue:a[0],step:"any"})),n.createElement(b.Z,{md:4},n.createElement(q.Z,{key:0,legend:`${e.t("label")} 1`,defaultValue:i.categories[0],onChange:_(0),style:{width:200}})),n.createElement(b.Z,{md:1}))),a.length>1)for(let l=0;l<a.length-1;l++){const s=_(l+1);t.push(n.createElement(g.Z,{key:`div-${l+1}`},n.createElement(b.Z,{md:7},n.createElement(x.Z,{inline:!0,onBlur:H(l),defaultValue:a[l],step:"any"}),n.createElement(S.Z,{raw:"\\le x <"}),n.createElement(x.Z,{inline:!0,onBlur:H(l+1),defaultValue:a[l+1],step:"any"})),n.createElement(b.Z,{md:4},n.createElement(q.Z,{key:1+l,legend:`${e.t("label")} ${l+2}`,defaultValue:i.categories[l+1],onChange:s,style:{width:200}})),n.createElement(b.Z,{md:1},n.createElement(j.Z,{onClick:U(l),style:{marginTop:"5px"},disabled:r,tooltipPlacement:"right"}))))}const s=a.length;return t.push(n.createElement(g.Z,{key:`div-${s}`},n.createElement(b.Z,{md:7},n.createElement(S.Z,{raw:"x \\ge"}),n.createElement(x.Z,{inline:!0,onChange:H(s-1),defaultValue:a[s-1],step:"any"})),n.createElement(b.Z,{md:4},n.createElement(q.Z,{legend:`Label ${s+1}`,defaultValue:i.categories[s],onChange:_(s),key:s,style:{width:200}})),n.createElement(b.Z,{md:1},n.createElement(j.Z,{onClick:U(s-1),style:{marginTop:"5px"},disabled:r})))),t})()))),n.createElement(u.Z,{style:{width:"fit-content"}},n.createElement(m.Z,null,e.t("name-new-variable"),":"),n.createElement(c.Z,{type:"text",placeholder:e.t("select-name"),onChange:w,onKeyPress:Z}),n.createElement(d.Z,null,e.t("new-variable-appended")))):n.createElement(n.Fragment,null,a,n.createElement(h.Z,{variant:"info"},e.t("select-variable-bin")))})()))};_.defaultProps={logAction(){},onGenerate(){}},_.propTypes={show:s().bool.isRequired,data:s().object.isRequired,quantitative:s().array.isRequired,logAction:s().func,onHide:s().func.isRequired,onGenerate:s().func};var U=_,X=a(24466),Q=a(53010),ee=a(86635),te=a(16982),ae=a(95818),ne=a(50388),re=a(26234),se=a(94123),le=a(99262),ie=a.n(le),oe=a(89506),ce=a.n(oe),me=a(83087),ue=a.n(me),de=a(4436),he=a(53742);function pe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const ge=ie()(0,10,1),be=/(?:^|\n)([^\n]*)$/,fe=/^[0-9]/,Ee=n.forwardRef((({children:e,style:t,className:a,"aria-labelledby":r},s)=>{const[l,i]=(0,n.useState)("");return n.createElement("div",{ref:s,style:t,className:a,"aria-labelledby":r},n.createElement(c.Z,{className:"mx-3 my-2 w-auto",placeholder:"Type to filter...",onChange:e=>i(e.target.value),value:l}),n.createElement("ul",{className:"list-unstyled"},n.Children.toArray(e).filter((e=>!l||e.props.children.toLowerCase().startsWith(l)))))}));class ye extends n.Component{constructor(e){super(e),pe(this,"handleGenerate",(()=>{let e,{code:t,name:a}=this.state;ce()(t,"return ")||(t=ue()(t,be,"\nreturn $1"));try{e=(0,de.Z)(t,this.props.data),this.props.logAction(z.gx,{code:t,name:a}),this.props.onGenerate(a,e)}catch(n){return this.props.session.addNotification({title:"Errored",message:"Encountered the following error: "+n.message,level:"error",position:"tr"})}this.props.onHide()})),pe(this,"handleNameChange",(e=>{this.setState({name:e.target.value})})),pe(this,"handleCodeChange",(e=>{this.setState({code:e})})),pe(this,"handleKeyPress",(e=>{13===e.charCode&&this.state.name.length>=2&&this.handleGenerate()})),pe(this,"insertVarFactory",(e=>()=>{let t=this.state.code.substring(0,this.state.selection),a="datum";a+=!ce()(e," ")&&!ce()(e,".")&&!fe.test(e)?`.${e}`:`['${e}']`,t+=a,t+=this.state.code.substring(this.state.selection),this.setState({code:t,selection:this.state.selection+a.length})})),pe(this,"insertLiteralFactory",(e=>()=>{let t=this.state.code.substring(0,this.state.selection);const a=e;t+=a,t+=this.state.code.substring(this.state.selection),this.setState({code:t,selection:this.state.selection+a.length})})),pe(this,"insertFuncFactory",(e=>()=>{let t=this.state.code.substring(0,this.state.selection);const a=" "+e+"()";t+=a,t+=this.state.code.substring(this.state.selection),this.setState({code:t,selection:this.state.selection+a.length-1})})),this.state={code:e.defaultCode,selection:null,name:"",showGuide:!1}}render(){const{t:e}=this.props,t=this.props.quantitative.map(((e,t)=>n.createElement(ae.Z.Item,{key:t,onClick:this.insertVarFactory(e),eventKey:t},e)));return n.createElement(P.Z,{cancel:".card-body",onDragStart:e=>{e.stopPropagation()},style:{zIndex:1006}},n.createElement(G,{show:this.props.show,onHide:this.props.onHide,header:this.props.t("formula-transformer-header"),footer:n.createElement(l.Z,{onClick:this.handleGenerate,disabled:this.state.name.length<2},this.props.t("create-new-variable")),role:"button",tabIndex:0,bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"}},n.createElement("div",{className:"formula-transformer-body"},n.createElement(ne.Z,{headerClassName:"title",header:this.state.showGuide?e("hide-example-guide"):e("show-example-guide"),visible:this.state.showGuide,onClick:()=>this.setState({showGuide:!this.state.showGuide})},n.createElement("p",null,e("formula-transformer-example-intro")),n.createElement(Q.Z,{condensed:!0},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,e("type")),n.createElement("th",null,e("example")),n.createElement("th",null,e("description")))),n.createElement("tbody",null,n.createElement("tr",null,n.createElement("td",null,e("interaction"),":"),n.createElement("td",null,n.createElement("code",null,"datum.",this.props.quantitative[0]," * datum.",this.props.quantitative[1])),n.createElement("td",null,n.createElement(X.c,{i18nKey:"example-description-multiply",ns:"DataExplorer"},"Multiply values of variables ",n.createElement("code",null,{first:this.props.quantitative[0]})," and ",n.createElement("code",null,{second:this.props.quantitative[1]})))),n.createElement("tr",null,n.createElement("td",null,e("transformation"),":"),n.createElement("td",null,n.createElement("code",null,"exp( datum.",this.props.quantitative[0]," )")),n.createElement("td",null,n.createElement(X.c,{i18nKey:"example-description-exponential",ns:"DataExplorer"},"Natural exponential function of variable ",n.createElement("code",null,{variable:this.props.quantitative[0]})))),n.createElement("tr",null,n.createElement("td",null,e("function"),":"),n.createElement("td",null,n.createElement("code",null,"9/5 * ",this.props.quantitative[0]," + 32")),n.createElement("td",null,n.createElement(X.c,{i18nKey:"example-description-calculation",ns:"DataExplorer"},"Multiply values of ",n.createElement("code",null,{variable:this.props.quantitative[0]})," by ",n.createElement("code",null,"9/5")," and add ",n.createElement("code",null,"32"))))))),n.createElement("hr",null),n.createElement("div",{className:"mb-2"},n.createElement(te.Z,{style:{marginBottom:5}},n.createElement(ae.Z,{className:"mr-2"},n.createElement(ae.Z.Toggle,{variant:"light",id:"dropdown-custom-components"},e("quantitative")),n.createElement(ae.Z.Menu,{variant:"light",as:Ee,id:"bg-nested-dropdown"},t)),n.createElement(ae.Z,{className:"mr-2"},n.createElement(ae.Z.Toggle,{variant:"light",id:"dropdown-custom-components"},e("categorical")),n.createElement(ae.Z.Menu,{variant:"light",as:Ee,id:"bg-nested-dropdown"},this.props.categorical.map(((e,t)=>n.createElement(ae.Z.Item,{key:t,onClick:this.insertVarFactory(e),eventKey:t},e))))))),n.createElement(p.Z,{className:"mb-2"},n.createElement(p.Z.Body,null,n.createElement(te.Z,{style:{marginBottom:5}},n.createElement(ee.Z,{size:"sm",className:"mr-2"},n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(" < ")},"<"),n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(" > ")},">"),n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(" <= ")},"<="),n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(" >= ")},">=")),n.createElement(ee.Z,{size:"sm",className:"mr-2"},n.createElement(se.Z,{placement:"top",tooltip:e("open-parenthesis")},n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(" ( ")},"(")),n.createElement(se.Z,{placement:"top",tooltip:e("closing-parenthesis")},n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(" ) ")},")"))),n.createElement(ee.Z,{size:"sm",className:"mr-2"},n.createElement(se.Z,{placement:"top",tooltip:e("addition")},n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(" + ")},"+")),n.createElement(se.Z,{placement:"top",tooltip:e("subtraction")},n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(" - ")},"-")),n.createElement(se.Z,{placement:"top",tooltip:e("multiplication")},n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(" * ")},"*")),n.createElement(se.Z,{placement:"top",tooltip:e("division")},n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(" / ")},"/"))),n.createElement(ee.Z,{size:"sm",className:"mr-2"},n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(" && ")},e("and")),n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(" || ")},e("or")),n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(" !")},e("not"))),n.createElement(ee.Z,{size:"sm",className:"me-2"},he.map(((e,t)=>n.createElement(l.Z,{key:t,variant:"light",onClick:this.insertFuncFactory(e),eventKey:t},e))))),n.createElement(te.Z,null,n.createElement(ee.Z,{size:"sm",className:"mr-2"},ge.map(((e,t)=>n.createElement(l.Z,{key:t,variant:"light",onClick:this.insertLiteralFactory(`${e}`)},e))),n.createElement(l.Z,{variant:"light",onClick:this.insertLiteralFactory(".")},"."))))),n.createElement(p.Z,{className:"mb-2"},n.createElement(p.Z.Body,null,n.createElement(re.Z,{ref:e=>{this.textarea=e},legend:`${e("expression")}:`,placeholder:e("enter-formula"),value:this.state.code,onChange:this.handleCodeChange,onBlur:e=>{const t=e.target.selectionStart;this.setState({selection:t})},rows:3}))),n.createElement(u.Z,{style:{margin:8}},n.createElement(m.Z,null,e("name-new-variable"),":"),n.createElement(c.Z,{type:"text",placeholder:e("select-name"),onChange:this.handleNameChange,onKeyPress:this.handleKeyPress}),n.createElement(d.Z,null,e("new-variable-appended"))))))}}ye.defaultProps={logAction(){},onGenerate(){},defaultCode:"",session:{}},ye.propTypes={show:s().bool.isRequired,categorical:s().array.isRequired,quantitative:s().array.isRequired,data:s().object.isRequired,defaultCode:s().string,logAction:s().func,onGenerate:s().func,onHide:s().func.isRequired,session:s().object};var ve=ye,Ze=a(5883),Ce=a(19189),we=a.n(Ce),Ne=a(55236),ke=a.n(Ne),xe=a(53975),Ve=a.n(xe),qe=a(38408),Pe=a(57330),Fe=a(67630);function Ge(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const Se=o()("isle:data-explorer:variable-transformer");function He(e){return e?ue()(e,".","[dot]"):e}function $e(e){const t=v()(e);let a=!0;for(let n=0;n<t.length;n++)Ve()(e[t[n]])||(a=!1);return a}class Ae extends n.Component{constructor(e){super(e),Ge(this,"handleFirstVariableChange",(e=>{const t={};let a;if(this.state.secondVar){const n=e,r=this.state.secondVar,s=this.props.data[n];a=we()(s,ke());const l=(0,Fe.Z)(a,n),i=(0,Fe.Z)(this.state.secondFreqs,r);for(let e=0;e<l.length;e++)for(let a=0;a<i.length;a++){const n=l[e]+"-"+i[a];t[He(n)]=n}}else{const n=this.props.data[e];a=we()(n,ke());const r=(0,Fe.Z)(a,e);for(let e=0;e<r.length;e++)t[He(r[e])]=r[e]}const n=$e(t);this.setState({firstVar:e,firstFreqs:a,nameMappings:t,onlyNumbers:n})})),Ge(this,"handleSecondVariableChange",(e=>{if(!e){const t=this.state.firstVar,a=(0,Fe.Z)(this.state.firstFreqs,t),n={};for(let e=0;e<a.length;e++)n[He(a[e])]=a[e];return this.setState({secondVar:e,nameMappings:n})}const t={},a=this.state.firstVar,n=this.props.data[e],r=we()(n,ke()),s=(0,Fe.Z)(this.state.firstFreqs,a),l=(0,Fe.Z)(r,e);for(let o=0;o<s.length;o++)for(let e=0;e<l.length;e++){const a=s[o]+"-"+l[e];t[He(a)]=a}const i=$e(t);this.setState({secondVar:e,secondFreqs:r,nameMappings:t,onlyNumbers:i})})),Ge(this,"handleKeyPress",(e=>{13===e.charCode&&this.state.generatedName.length>=2&&this.makeNewVar()})),Ge(this,"changeFreqFactory",(e=>t=>{const a=N()(this.state.nameMappings);a[He(e)]=t.target.value;const n=$e(a);this.setState({nameMappings:a,onlyNumbers:n})})),Ge(this,"changeContigencyFactory",((e,t)=>a=>{const n=N()(this.state.nameMappings);n[He(t)+"-"+He(e)]=a.target.value,this.setState({nameMappings:n})})),Ge(this,"handleGeneratedNameChange",(e=>{this.setState({generatedName:e.target.value})})),Ge(this,"makeNewVar",(()=>{Se("Generating new categorical variable...");const{firstVar:e,secondVar:t,nameMappings:a,castNumeric:n}=this.state,r=(0,Pe.Z)(e,t,a,this.props.data,n);this.props.onGenerate(this.state.generatedName,r),this.props.logAction(z.CS,{name:this.state.generatedName,firstVar:e,secondVar:t,nameMappings:a,castNumeric:n}),this.props.onHide()})),Ge(this,"renderFrequencyTable",(()=>{const e=this.state.firstVar,t=this.props.data[e],a=we()(t,ke()),r=(0,Fe.Z)(a,e);return n.createElement(Ze.Z,{bordered:!0,style:{margin:8}},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,this.props.t("old"),":"),r.map(((t,a)=>n.createElement("th",{key:`${e}-${a}-old`},t))))),n.createElement("tbody",null,n.createElement("tr",null,n.createElement("th",null,this.props.t("new"),":"),r.map(((t,a)=>n.createElement("th",{key:`${e}-${a}-new`},n.createElement("input",{className:"transformer-table-input",type:"text",defaultValue:t,onChange:this.changeFreqFactory(t)}))))),n.createElement("tr",{style:{borderTop:"1px solid black"}},n.createElement("th",null,this.props.t("frequencies"),":"),r.map(((t,a)=>{const r=this.state.firstFreqs[t];return n.createElement("td",{key:`${e}-${a}-freq`},r)})))))})),Ge(this,"renderContingencyTable",(()=>{const e=this.state.secondVar,t=this.state.firstVar,a=this.props.data[e],r=this.props.data[t],s=we()(a,ke()),l=we()(r,ke()),i=(0,Fe.Z)(s,e),o=(0,Fe.Z)(l,t);return n.createElement(Ze.Z,{bordered:!0,style:{margin:8}},n.createElement("tr",null,n.createElement("th",null),o.map(((e,t)=>n.createElement("th",{key:`${e}-${t}`},e)))),i.map(((e,t)=>n.createElement("tr",{key:`${e}-${t}`},n.createElement("th",null,e),o.map(((t,a)=>n.createElement("td",{key:`${e}-${t}-${a}`},n.createElement("input",{className:"transformer-table-input",type:"text",defaultValue:`${t}-${e}`,onChange:this.changeContigencyFactory(e,t)}))))))))}));const t=e.categorical[0],a=e.data[t],r=we()(a,ke()),s=(0,Fe.Z)(r,t),l={};for(let n=0;n<s.length;n++)l[He(s[n])]=s[n];this.state={generatedName:"",firstVar:t,firstFreqs:r,nameMappings:l,secondVar:null,secondFreqs:null,castNumeric:!1,onlyNumbers:!1}}renderTable(){return this.state.firstVar&&this.state.secondVar?this.renderContingencyTable():this.state.firstVar||this.state.secondVar?this.renderFrequencyTable():null}render(){const{t:e}=this.props;return n.createElement(P.Z,{cancel:".card-body",onDragStart:e=>{e.stopPropagation()},style:{zIndex:1006}},n.createElement(G,{onHide:this.props.onHide,show:this.props.show,header:e("categorical-transformer-header"),footer:n.createElement(l.Z,{onClick:this.makeNewVar,disabled:this.state.generatedName.length<2},e("create-new-variable")),bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"},role:"button",tabIndex:0},n.createElement(g.Z,null,n.createElement(b.Z,{md:4},n.createElement(V.Z,{legend:e("first-variable"),defaultValue:this.state.firstVar||"",options:this.props.categorical,onChange:this.handleFirstVariableChange})),n.createElement(b.Z,{md:4},n.createElement(V.Z,{clearable:!0,legend:e("optional-second-variable"),defaultValue:this.state.secondVar||"",options:this.props.categorical,onChange:this.handleSecondVariableChange}))),n.createElement(g.Z,{style:{overflowX:"auto",width:"100%"}},this.renderTable()),n.createElement(g.Z,null,n.createElement(se.Z,{tooltip:e("treat-labels-as-numbers-tooltip")},n.createElement(qe.Z,{legend:e("treat-labels-as-numbers"),defaultValue:!1,disabled:!this.state.onlyNumbers,onChange:()=>{this.setState({castNumeric:!this.state.castNumeric})}}))),n.createElement(g.Z,null,n.createElement(u.Z,{style:{margin:8}},n.createElement(m.Z,null,e("name-new-variable"),":"),n.createElement(c.Z,{type:"text",placeholder:e("select-name"),onChange:this.handleGeneratedNameChange,onKeyPress:this.handleKeyPress}),n.createElement(d.Z,null,e("new-variable-appended"))))))}}Ae.defaultProps={logAction(){}},Ae.propTypes={categorical:s().array.isRequired,data:s().object.isRequired,onGenerate:s().func.isRequired,logAction:s().func,onHide:s().func.isRequired,show:s().bool.isRequired};var Re=Ae,Le=a(42702),Te=a.n(Le),ze=a(22069),Me=a.n(ze);function Ke(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const Be=o()("isle:data-explorer:group-transformer");class je extends n.Component{constructor(e){super(e),Ke(this,"handleGeneratedNameChange",(e=>{this.setState({generatedName:e.target.value})})),Ke(this,"handleGroupNumberChange",(e=>{const t=new Array(e).fill(1/e),a=new Array(e);for(let n=0;n<a.length;n++)a[n]=`${this.props.t("group")} ${n+1}`;this.setState({groupProbs:t,labels:a,nGroups:e})})),Ke(this,"handleKeyPress",(e=>{if(13===e.charCode){let e=0;for(let t=0;t<this.state.groupProbs.length;t++)e+=this.state.groupProbs[t];this.state.generatedName.length>2&&Me()(e,1)<=15e-9&&this.makeNewVar()}})),Ke(this,"makeNewVar",(()=>{Be("Generating new categorical variable...");const e=v()(this.props.data),t=this.props.data[e[0]].length,a=Te()(this.state.labels,{size:t,probs:this.state.groupProbs,replace:!0});this.props.onGenerate(this.state.generatedName,a),this.props.logAction(z.Dp,{name:this.state.generatedName,labels:this.state.labels,groupProbs:this.state.groupProbs}),this.props.onHide()})),this.state={generatedName:"",nGroups:2,groupProbs:[.5,.5],labels:["Group 1","Group 2"]}}renderTable(){const e=new Array(this.state.nGroups);for(let t=0;t<e.length;t++)e[t]=n.createElement(g.Z,{key:t},n.createElement(b.Z,null,n.createElement(q.Z,{legend:`Label for Group ${t+1}`,defaultValue:this.state.labels[t],onChange:e=>{const a=this.state.labels.slice();a[t]=e,this.setState({labels:a})}})),n.createElement(b.Z,null,n.createElement(x.Z,{legend:this.props.t("group-proportion"),onChange:e=>{const a=this.state.groupProbs.slice();a[t]=e,this.setState({groupProbs:a})},defaultValue:this.state.groupProbs[t],step:.01,min:0,max:1,numbersOnly:!1})));return n.createElement(n.Fragment,null,e,n.createElement("p",null,this.props.t("proportions-sum-one")))}render(){let e=0;for(let a=0;a<this.state.groupProbs.length;a++)e+=this.state.groupProbs[a];const t=this.state.generatedName.length>2&&Me()(e,1)<=15e-9;return n.createElement(P.Z,{cancel:".card-body",onDragStart:e=>{e.stopPropagation()},style:{zIndex:1006}},n.createElement(G,{onHide:this.props.onHide,show:this.props.show,header:this.props.t("group-transformer-header"),footer:n.createElement(l.Z,{onClick:this.makeNewVar,disabled:!t},this.props.t("create-new-variable")),role:"button",tabIndex:0,bodyStyle:{maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"relative"}},n.createElement(g.Z,null,n.createElement(b.Z,null,n.createElement(x.Z,{legend:this.props.t("number-of-groups"),onChange:this.handleGroupNumberChange,defaultValue:this.state.nGroups,step:1,min:1,max:99}))),this.renderTable(),n.createElement(g.Z,null,n.createElement(u.Z,{style:{margin:8}},n.createElement(m.Z,null,this.props.t("name-new-variable"),":"),n.createElement(c.Z,{type:"text",placeholder:this.props.t("select-name"),onChange:this.handleGeneratedNameChange,onKeyPress:this.handleKeyPress}),n.createElement(d.Z,null,this.props.t("new-variable-appended"))))))}}je.defaultProps={logAction(){}},je.propTypes={data:s().object.isRequired,onGenerate:s().func.isRequired,logAction:s().func,onHide:s().func.isRequired,show:s().bool.isRequired};var De=je;const Ie=e=>{const{data:t,categorical:a,quantitative:r,t:s,session:i,defaultCode:o,logAction:c,onGenerate:m}=e,[u,d]=(0,n.useState)(null),h=()=>{const t="formula"===u?null:"formula";d(t),e.onActive(t)},p=()=>{const t="bin"===u?null:"bin";d(t),e.onActive(t)},g=()=>{const t="categorical"===u?null:"categorical";d(t),e.onActive(t)},b=()=>{const t="group"===u?null:"group";d(t),e.onActive(t)};let f;if(t)switch(u){case"bin":f=n.createElement(U,{show:!0,onHide:p,quantitative:r,logAction:c,onGenerate:m,data:t,t:s});break;case"categorical":f=n.createElement(Re,{show:!0,onHide:g,categorical:a,logAction:c,onGenerate:m,data:t,t:s});break;case"formula":f=n.createElement(ve,{show:!0,onHide:h,categorical:a,quantitative:r,data:t,defaultCode:o,logAction:c,onGenerate:m,session:i,t:s});break;case"group":f=n.createElement(De,{show:!0,onHide:b,logAction:c,onGenerate:m,data:t,t:s})}return n.createElement(n.Fragment,null,n.createElement("div",{className:"well",style:{padding:15,margin:15}},n.createElement("div",{style:{padding:12}},n.createElement(l.Z,{onClick:h,variant:"primary",block:!0,style:{fontSize:"1.2em"}},s("interactions-functions"))),n.createElement("div",{style:{padding:12}},n.createElement(l.Z,{onClick:p,disabled:!r||0===r.length,variant:"primary",block:!0,style:{fontSize:"1.2em"}},s("bin-quantitative"))),n.createElement("div",{style:{padding:12}},n.createElement(l.Z,{onClick:g,disabled:!a||0===a.length,variant:"primary",block:!0,style:{fontSize:"1.2em"}},s("rename-or-combine"))),n.createElement("div",{style:{padding:12}},n.createElement(l.Z,{onClick:b,variant:"primary",block:!0,style:{fontSize:"1.2em"}},s("create-groups")))),f)};Ie.defaultProps={logAction(){},onActive(){},onGenerate(){},defaultCode:"",session:{}},Ie.propTypes={categorical:s().array.isRequired,quantitative:s().array.isRequired,data:s().object.isRequired,defaultCode:s().string,logAction:s().func,onActive:s().func,onGenerate:s().func,session:s().object};var Oe=Ie},16982:function(e,t,a){var n=a(87462),r=a(63366),s=a(68761),l=a.n(s),i=a(38603),o=a(87001),c=["bsPrefix","className"],m=i.forwardRef((function(e,t){var a=e.bsPrefix,s=e.className,m=(0,r.Z)(e,c),u=(0,o.vE)(a,"btn-toolbar");return i.createElement("div",(0,n.Z)({},m,{ref:t,className:l()(s,u)}))}));m.displayName="ButtonToolbar",m.defaultProps={role:"toolbar"},t.Z=m},53010:function(e,t,a){var n=a(87462),r=a(63366),s=a(68761),l=a.n(s),i=a(38603),o=a(87001),c=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],m=i.forwardRef((function(e,t){var a=e.bsPrefix,s=e.className,m=e.striped,u=e.bordered,d=e.borderless,h=e.hover,p=e.size,g=e.variant,b=e.responsive,f=(0,r.Z)(e,c),E=(0,o.vE)(a,"table"),y=l()(s,E,g&&E+"-"+g,p&&E+"-"+p,m&&E+"-striped",u&&E+"-bordered",d&&E+"-borderless",h&&E+"-hover"),v=i.createElement("table",(0,n.Z)({},f,{className:y,ref:t}));if(b){var Z=E+"-responsive";return"string"===typeof b&&(Z=Z+"-"+b),i.createElement("div",{className:Z},v)}return v}));t.Z=m},53975:function(e,t,a){var n=a(49651);e.exports=n},49651:function(e,t,a){var n=a(24500).isPrimitive;e.exports=function(e){var t,a,r;if(!n(e))return!1;if(0===(t=e.length))return!1;for(r=0;r<t;r++)if((a=e.charCodeAt(r))<48||a>57)return!1;return!0}},48906:function(e,t,a){var n=a(93165),r=a(47534),s=a(91799),l=a(87973),i=a(13578),o=a(74802),c=a(90422),m=a(4593),u=a(61599).factory,d=a(4286),h=a(74304),p=a(65558),g=a(45972);e.exports=function(){var e,t,a,b,f,E;if(0===arguments.length)t=u();else if(1===arguments.length){if(!l(e=arguments[0]))throw new TypeError("invalid argument. Options argument must be an object. Value: `"+e+"`.");if(o(e,"prng")){if(!i(e.prng))throw new TypeError("invalid option. `prng` option must be a pseudorandom number generator function. Option: `"+e.prng+"`.");t=e.prng}else t=u(e)}else{if(b=p(f=arguments[0],E=arguments[1]))throw b;if(arguments.length>2){if(!l(e=arguments[2]))throw new TypeError("invalid argument. Options argument must be an object. Value: `"+e+"`.");if(o(e,"prng")){if(!i(e.prng))throw new TypeError("invalid option. `prng` option must be a pseudorandom number generator function. Option: `"+e.prng+"`.");t=e.prng}else t=u(e)}else t=u()}return n(a=void 0===f?V:x,"NAME","uniform"),e&&e.prng?(n(a,"seed",null),n(a,"seedLength",null),s(a,"state",c(null),m),n(a,"stateLength",null),n(a,"byteLength",null),n(a,"toJSON",c(null)),n(a,"PRNG",t)):(r(a,"seed",y),r(a,"seedLength",v),s(a,"state",w,N),r(a,"stateLength",Z),r(a,"byteLength",C),n(a,"toJSON",k),n(a,"PRNG",t),t=t.normalized),a;function y(){return t.seed}function v(){return t.seedLength}function Z(){return t.stateLength}function C(){return t.byteLength}function w(){return t.state}function N(e){t.state=e}function k(){var e={type:"PRNG"};return e.name=a.NAME,e.state=h(t.state),e.params=void 0===f?[]:[f,E],e}function x(){return g(t,f,E)}function V(e,a){return d(e)||d(a)||e>=a?NaN:g(t,e,a)}}},80988:function(e,t,a){var n=a(93165),r=a(81172);n(r,"factory",a(48906)),e.exports=r},81172:function(e,t,a){var n=a(48906)();e.exports=n},45972:function(e){e.exports=function(e,t,a){var n=e();return a*n+(1-n)*t}},65558:function(e,t,a){var n=a(42415).isPrimitive,r=a(34064);e.exports=function(e,t){return!n(e)||r(e)?new TypeError("invalid argument. First argument must be a number primitive and not `NaN`. Value: `"+e+"`."):!n(t)||r(t)?new TypeError("invalid argument. Second argument must be a number primitive and not `NaN`. Value: `"+t+"`."):e>=t?new RangeError("invalid argument. Minimum support `a` must be less than maximum support `b`. Value: `["+e+","+t+"]`."):null}}}]);
//# sourceMappingURL=611.f8a9dd06.chunk.js.map