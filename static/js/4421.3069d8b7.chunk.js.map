{"version":3,"file":"static/js/4421.3069d8b7.chunk.js","mappings":"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","sources":["actions/namespace.js","constants/colors.js","ev/components/lesson-creator/index.js","ev/containers/lesson-creator/index.js","components/lessons-page/details_modal.js","components/lessons-page/delete_modal.js","components/lessons-page/lesson.js","components/lessons-page/enrolled_lesson.js","components/lessons-page/no_course_banner.js","components/lessons-page/no_lesson_banner.js","components/lessons-page/index.js","containers/visible-lessons-page/index.js","utils/file_saver.js","utils/format_time.js","utils/is_owner.js","utils/sort_lessons.js"],"sourcesContent":["/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport axios from 'axios';\nimport qs from 'querystring';\nimport i18next from 'i18next';\nimport saveAs from 'utils/file_saver.js';\nimport server from 'constants/server';\nimport { addNotification, addErrorNotification } from 'actions/notification';\nimport { getCohorts } from 'actions/cohort';\nimport { APPEND_CREATED_NAMESPACE, CHANGED_NAMESPACE, DELETED_CURRENT_NAMESPACE, GET_ALL_NAMESPACES, UPDATED_OWNED_NAMESPACE, UPDATED_STUDENT_PROGRESS } from 'constants/action_types.js';\n\n\n// EXPORTS //\n\n/**\n * Returns an action object to be used in signalling that a namespace has been created.\n *\n * @param {Object} namespace - the created namespace\n * @returns {Object} the action object\n */\nexport function appendCreatedNamespace( namespace ) {\n\treturn {\n\t\ttype: APPEND_CREATED_NAMESPACE,\n\t\tpayload: {\n\t\t\tnamespace\n\t\t}\n\t};\n}\n\n/**\n * Returns an action object to be used in signalling that a namespace has been changed.\n *\n * @param {Object} namespace - the changed namespace\n * @param {string} namespace.title - namespace title\n * @param {Array} namespace.owners - ids of owners\n * @param {Array} namespace.announcements - announcements\n * @param {Array} namespace.cohorts - cohorts\n * @param {string} namespace.description - namespace description\n * @param {boolean} namespace.enableTicketing - controls if ticketing is enabled for the namespace\n * @param {string} namespace._id - id of the namespace\n * @returns {Object} the action object\n */\nexport function changedNamespace({ title, owners, announcements = [], cohorts = [], description, enableTicketing, _id }) {\n\treturn {\n\t\ttype: CHANGED_NAMESPACE,\n\t\tpayload: {\n\t\t\ttitle,\n\t\t\tannouncements,\n\t\t\tcohorts,\n\t\t\tdescription,\n\t\t\tenableTicketing,\n\t\t\towners,\n\t\t\t_id\n\t\t}\n\t};\n}\n\n/**\n * Returns an action object to be used in signalling that a namespace has been deleted.\n *\n * @param {string} id - the id of the namespace to be deleted\n * @returns {Object} the action object\n */\nexport function deletedCurrentNamespace( id ) {\n\treturn {\n\t\ttype: DELETED_CURRENT_NAMESPACE,\n\t\tpayload: {\n\t\t\tid\n\t\t}\n\t};\n}\n\n/**\n * Returns an action object to be used in signalling that a student's progress has been updated.\n *\n * @param {Object} options - progress of the student\n * @param {string} options.email - email of the student\n * @param {string} options.lessonId - lesson id\n * @param {number} options.progress - progress of the student\n * @param {Object} options.cohort - cohort of the student\n */\nexport function updateStudentProgress({ email, lessonID, progress, cohort }) {\n\treturn {\n\t\ttype: UPDATED_STUDENT_PROGRESS,\n\t\tpayload: {\n\t\t\temail, lessonID, progress, cohort\n\t\t}\n\t};\n}\n\n/**\n * Returns an action object to be used in signalling that an owned namespace has been updated.\n *\n * @param {Object} namespace - the updated namespace\n * @param {string} namespace.title - namespace title\n * @param {Array} namespace.owners - ids of owners\n * @param {Array} namespace.enableTicketing - controls if ticketing is enabled for the namespace\n * @param {string} namespace._id - id of the namespace\n * @returns {Object} the action object\n */\nexport function updatedOwnedNamespace({ title, owners, description, enableTicketing, _id }) {\n\treturn {\n\t\ttype: UPDATED_OWNED_NAMESPACE,\n\t\tpayload: {\n\t\t\ttitle,\n\t\t\tdescription,\n\t\t\towners,\n\t\t\tenableTicketing,\n\t\t\t_id\n\t\t}\n\t};\n}\n\n/**\n * Makes a POST request to create a new namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} namespace - the new namespace\n * @param {string} namespace.title - namespace title\n * @param {Array} namespace.description - namespace description\n * @param {Array} namespace.owners - ids of owners\n * @param {Object} namespace.props - properties of the invoking component\n */\nexport const createNamespace = async ( dispatch, { title, description, owners, props }) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/create_namespace', { title, description, owners });\n\t\tif ( !res.data.successful ) {\n\t\t\treturn addErrorNotification( dispatch, new Error( res.data.message ));\n\t\t}\n\t\tconst namespace = res.data.namespace;\n\t\tprops.onNamespace( namespace );\n\t\tdispatch( appendCreatedNamespace( namespace ) );\n\t\tprops.history.replace( '/lessons' );\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: res.data.successful ? 'success' : 'error'\n\t\t});\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to create a new namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the POST request to create a new namespace\n */\nexport const createNamespaceInjector = dispatch => {\n\treturn async ({ title, description, owners, props }) => {\n\t\tawait createNamespace( dispatch, { title, description, owners, props } );\n\t};\n};\n\n/**\n * Makes a POST request to delete a namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @param {string} id - the id of the namespace to be deleted\n * @param {Object} history - browser history object\n * @returns {void}\n */\nexport const deleteCurrentNamespace = async ( dispatch, id, history ) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/delete_namespace', { id });\n\t\tif ( history ) {\n\t\t\thistory.replace( '/lessons' );\n\t\t}\n\t\tdispatch( deletedCurrentNamespace( id ) );\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to delete a namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the POST request to delete a namespace\n */\nexport const deleteCurrentNamespaceInjector = ( dispatch ) => {\n\treturn async ( id, history ) => {\n\t\tawait deleteCurrentNamespace( dispatch, id, history );\n\t};\n};\n\n/**\n * Makes a POST request to update a namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} ns - the updated namespace\n */\nexport const updateCurrentNamespace = async ( dispatch, ns ) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/update_namespace', { ns });\n\t\tdispatch( changedNamespace( res.data.namespace ) );\n\t\tdispatch( updatedOwnedNamespace( res.data.namespace ) );\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t\tgetCohorts( dispatch, {\n\t\t\tnamespaceID: ns._id\n\t\t});\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to update a namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the POST request to update a namespace\n */\nexport const updateCurrentNamespaceInjector = ( dispatch ) => {\n\treturn async ( id, ns ) => {\n\t\tawait updateCurrentNamespace( dispatch, id, ns );\n\t};\n};\n\n/**\n * Makes a GET request to get a namespace's actions.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.namespaceID - id of the namespace\n * @param {string} options.namespaceTitle - title of the namespace\n * @returns {void}\n */\nexport const getNamespaceActions = async ( dispatch, { namespaceID, namespaceTitle } ) => {\n\ttry {\n\t\tconst res = await axios.get( server+'/get_namespace_actions?'+qs.stringify({ namespaceID }) );\n\t\tconst blob = new Blob([ res.data ], {\n\t\t\ttype: 'application/json'\n\t\t});\n\t\tconst name = `actions_${namespaceTitle}.json`;\n\t\tsaveAs( blob, name );\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a GET request to get a namespace's actions.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the GET request to get a namespace's actions\n */\nexport const getNamespaceActionsInjector = ( dispatch ) => {\n\treturn async ({ namespaceID, namespaceTitle }) => {\n\t\tawait getNamespaceActions( dispatch, { namespaceID, namespaceTitle });\n\t};\n};\n\n/**\n * Makes a POST request to update a user's lesson progress.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.namespaceID - id of the namespace\n * @param {string} options.lessonID - id of the lesson\n * @param {string} options.email - email of the user\n * @param {number} options.progress - progress of the user\n * @param {Object} options.cohort - cohort of the user\n */\nexport const adjustProgress = async ( dispatch, { email, lessonID, namespaceID, progress, cohort }) => {\n\tconst res = await axios.post( server+'/user_adjust_progress', {\n\t\temail, lessonID, namespaceID, progress\n\t});\n\taddNotification( dispatch, {\n\t\ttitle: i18next.t('common:updated'),\n\t\tmessage: res.data.message,\n\t\tlevel: 'success'\n\t});\n\tdispatch( updateStudentProgress({ email, lessonID, progress, cohort }) );\n};\n\n/**\n * Returns a function to make a POST request to update a user's lesson progress.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the POST request to update a user's lesson progress\n */\nexport const adjustProgressInjector = ( dispatch ) => {\n\treturn async ( { email, lessonID, namespaceID, progress, cohort } ) => {\n\t\tawait adjustProgress( dispatch, { email, lessonID, namespaceID, progress, cohort } );\n\t};\n};\n\n/**\n * Makes a GET request to get a all available namespaces.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {void}\n */\nexport const getAllNamespaces = async ( dispatch ) => {\n\ttry {\n\t\tconst res = await axios.get( server+'/get_all_namespaces' );\n\t\tdispatch({\n\t\t\ttype: GET_ALL_NAMESPACES,\n\t\t\tpayload: {\n\t\t\t\tnamespaces: res.data.namespaces\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a GET request to get a all available namespaces.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the GET request to get a all available namespaces\n */\nexport const getAllNamespacesInjector = ( dispatch ) => {\n\treturn async () => {\n\t\tawait getAllNamespaces( dispatch );\n\t};\n};\n\n/**\n * Makes a POST request to set the order lessons appear on the dashboard.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {Array} options.lessons - lessons of the course in the order to be displayed on the dashboard\n * @param {string} options.id - id of the namespace\n * @returns {void}\n */\nexport const setLessonOrder = async ( dispatch, { lessons, id }) => {\n\ttry {\n\t\tawait axios.post( server+'/set_lesson_order', {\n\t\t\tlessons, id\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to set the order lessons appear on the dashboard.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make the POST request to set the order lessons appear on the dashboard\n */\nexport const setLessonOrderInjector = ( dispatch ) => {\n\treturn async ({ lessons, id }) => {\n\t\tawait setLessonOrder( dispatch, { lessons, id } );\n\t};\n};\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MAIN //\n\nconst COLORS = [\n\t'#1f77b4',\n\t'#ff7f0e',\n\t'#2ca02c',\n\t'#d62728',\n\t'#9467bd',\n\t'#8c564b',\n\t'#c49c94',\n\t'#e377c2',\n\t'#17becf',\n\t'#aec7e8',\n\t'#ffbb78',\n\t'#ff9896',\n\t'#98df8a',\n\t'#7f7f7f',\n\t'#c5b0d5',\n\t'#f7b6d2',\n\t'#bcbd22',\n\t'#c7c7c7',\n\t'#dbdb8d',\n\t'#9edae5'\n];\n\n\n// EXPORTS //\n\nexport default COLORS;\n","// MODULES //\n\nimport asyncComponent from 'components/async';\n\n\n// MAIN //\n\nconst LessonCreator = asyncComponent( () => import( './main.js' ) );\n\n\n// EXPORTS //\n\nexport default LessonCreator;\n","// MODULES //\n\nimport { connect } from 'react-redux';\nimport LessonCreator from 'ev/components/lesson-creator';\nimport { copyLessonInjector } from 'actions/lesson';\n\n\n// FUNCTIONS //\n\nfunction mapStateToProps( state ) {\n\treturn {\n\t\tadmin: state.admin,\n\t\tuser: state.user\n\t};\n}\n\nfunction mapDispatchToProps( dispatch ) {\n\treturn {\n\t\tcopyLesson: copyLessonInjector( dispatch )\n\t};\n}\n\n\n// MAIN //\n\nconst VisibleLessonCreator = connect( mapStateToProps, mapDispatchToProps )( LessonCreator );\n\n\n// EXPORTS //\n\nexport default VisibleLessonCreator;\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport logger from 'debug';\nimport Button from 'react-bootstrap/Button';\nimport FormControl from 'react-bootstrap/FormControl';\nimport FormLabel from 'react-bootstrap/FormLabel';\nimport FormGroup from 'react-bootstrap/FormGroup';\nimport Form from 'react-bootstrap/Form';\nimport Modal from 'react-bootstrap/Modal';\nimport DateTimePicker from 'react-datetime-picker';\nimport isEmptyObject from '@stdlib/assert/is-empty-object';\nimport SERVER from 'constants/server';\n\n\n// VARIABLES //\n\nconst debug = logger( 'isle-dashboard' );\n\n\n// FUNCTIONS //\n\nfunction preventPropagation( event ) {\n\tevent.stopPropagation();\n}\n\n\n// MAIN //\n\nclass DetailsModal extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tlet unlockLesson;\n\t\tlet lockLesson;\n\t\tlet lockUntil;\n\t\tlet lockAfter;\n\t\tif ( props.lockUntil ) {\n\t\t\tunlockLesson = true;\n\t\t\tlockUntil = props.lockUntil;\n\t\t} else {\n\t\t\tunlockLesson = false;\n\t\t\tlockUntil = new Date();\n\t\t}\n\t\tif ( props.lockAfter ) {\n\t\t\tlockLesson = true;\n\t\t\tlockAfter = props.lockAfter;\n\t\t} else {\n\t\t\tlockLesson = false;\n\t\t\tlockAfter = new Date();\n\t\t}\n\t\tthis.state = {\n\t\t\ttitle: props.title,\n\t\t\tdescription: props.description,\n\t\t\tdisabled: false,\n\t\t\thideFromDashboard: props.hideFromDashboard,\n\t\t\ttemplate: props.template,\n\t\t\tchangedTemplate: false,\n\t\t\tunlockLesson,\n\t\t\tlockUntil,\n\t\t\tlockLesson,\n\t\t\tlockAfter\n\t\t};\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tconst newState = {};\n\t\tif ( prevProps.title !== this.props.title ) {\n\t\t\tnewState.title = this.props.title;\n\t\t}\n\t\tif ( prevProps.description !== this.props.description ) {\n\t\t\tnewState.description = this.props.description;\n\t\t}\n\t\tif ( prevProps.template !== this.props.template ) {\n\t\t\tnewState.template = this.props.template;\n\t\t}\n\t\tif ( prevProps.lockUntil !== this.props.lockUntil ) {\n\t\t\tif ( this.props.lockUntil ) {\n\t\t\t\tnewState.unlockLesson = true;\n\t\t\t\tnewState.lockUntil = this.props.lockUntil;\n\t\t\t} else {\n\t\t\t\tnewState.unlockLesson = false;\n\t\t\t\tnewState.lockUntil = new Date();\n\t\t\t}\n\t\t}\n\t\tif ( prevProps.lockAfter !== this.props.lockAfter ) {\n\t\t\tif ( this.props.lockAfter ) {\n\t\t\t\tnewState.lockLesson = true;\n\t\t\t\tnewState.lockAfter = this.props.lockAfter;\n\t\t\t} else {\n\t\t\t\tnewState.lockLesson = false;\n\t\t\t\tnewState.lockAfter = new Date();\n\t\t\t}\n\t\t}\n\t\tif ( !isEmptyObject( newState ) ) {\n\t\t\tthis.setState( newState );\n\t\t}\n\t}\n\n\thandleInputChange = ( event ) => {\n\t\tconst target = event.target;\n\t\tconst value = target.value;\n\t\tconst name = target.name;\n\t\tdebug( `Input field ${name} changed to ${value}` );\n\t\tthis.setState({\n\t\t\t[ name ]: value\n\t\t}, () => {\n\t\t\tif ( this.state.title.length >= 3 && this.state.description.length > 0 ) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tdisabled: false\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.setState({\n\t\t\t\t\tdisabled: true\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\n\thandleUnlockChange = ( event ) => {\n\t\tthis.setState({\n\t\t\tunlockLesson: event.target.checked\n\t\t});\n\t};\n\n\thandleLockChange = ( event ) => {\n\t\tthis.setState({\n\t\t\tlockLesson: event.target.checked\n\t\t});\n\t};\n\n\thandleTimeUntilChange = ( value ) => {\n\t\tthis.setState({\n\t\t\tlockUntil: value\n\t\t});\n\t};\n\n\thandleTimeAfterChange = ( value ) => {\n\t\tthis.setState({\n\t\t\tlockAfter: value\n\t\t});\n\t};\n\n\thandleTemplateChange = ( event ) => {\n\t\tthis.setState({\n\t\t\ttemplate: event.target.checked,\n\t\t\tchangedTemplate: true\n\t\t});\n\t};\n\n\thideFromDashboardChange = ( event ) => {\n\t\tthis.setState({\n\t\t\thideFromDashboard: event.target.checked\n\t\t});\n\t};\n\n\tonSubmit = ( evt ) => {\n\t\tevt.preventDefault();\n\t\tconst details = {\n\t\t\tnewTitle: this.state.title,\n\t\t\tnewDescription: this.state.description\n\t\t};\n\t\tif ( this.state.unlockLesson ) {\n\t\t\tdetails.lockUntil = this.state.lockUntil;\n\t\t}\n\t\tif ( this.state.lockLesson ) {\n\t\t\tdetails.lockAfter = this.state.lockAfter;\n\t\t}\n\t\tif ( this.state.hideFromDashboard !== this.props.hideFromDashboard ) {\n\t\t\tdetails.hideFromDashboard = this.state.hideFromDashboard;\n\t\t}\n\t\tif ( this.state.changedTemplate ) {\n\t\t\tdetails.template = this.state.template;\n\t\t}\n\t\tthis.props.update( details );\n\t};\n\n\trender() {\n\t\tconst { t } = this.props;\n\t\treturn (\n\t\t\t<Modal show={this.props.show} onHide={this.props.close}>\n\t\t\t\t<Form action={SERVER} method=\"get\" onSubmit={this.onSubmit} onKeyDown={preventPropagation} >\n\t\t\t\t\t<Modal.Header>\n\t\t\t\t\t\t<Modal.Title as=\"h3\">{t('lesson-details')}</Modal.Title>\n\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t<Modal.Body>\n\t\t\t\t\t\t<FormGroup>\n\t\t\t\t\t\t\t<FormLabel>{t('common:title')}</FormLabel>\n\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\tname=\"title\"\n\t\t\t\t\t\t\t\ttype=\"title\"\n\t\t\t\t\t\t\t\tonChange={this.handleInputChange}\n\t\t\t\t\t\t\t\tdefaultValue={this.state.title}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t<FormGroup>\n\t\t\t\t\t\t\t<FormLabel>{t('common:description')}</FormLabel>\n\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\tname=\"description\"\n\t\t\t\t\t\t\t\ttype=\"description\"\n\t\t\t\t\t\t\t\tonChange={this.handleInputChange}\n\t\t\t\t\t\t\t\tdefaultValue={this.state.description}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t<FormGroup>\n\t\t\t\t\t\t\t<Form.Check\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\tlabel={t('common:lock-until')}\n\t\t\t\t\t\t\t\tchecked={this.state.unlockLesson}\n\t\t\t\t\t\t\t\tonChange={this.handleUnlockChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t{this.state.unlockLesson ? <DateTimePicker\n\t\t\t\t\t\t\t\t\tminDate={new Date()}\n\t\t\t\t\t\t\t\t\tonChange={this.handleTimeUntilChange}\n\t\t\t\t\t\t\t\t\tvalue={this.state.lockUntil}\n\t\t\t\t\t\t\t\t\tclearIcon={null}\n\t\t\t\t\t\t\t\t/> : null }\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t<FormGroup>\n\t\t\t\t\t\t\t<Form.Check\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\tlabel={t('common:lock-after')}\n\t\t\t\t\t\t\t\tchecked={this.state.lockLesson}\n\t\t\t\t\t\t\t\tonChange={this.handleLockChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t{this.state.lockLesson ? <DateTimePicker\n\t\t\t\t\t\t\t\t\tminDate={new Date()}\n\t\t\t\t\t\t\t\t\tonChange={this.handleTimeAfterChange}\n\t\t\t\t\t\t\t\t\tvalue={this.state.lockAfter}\n\t\t\t\t\t\t\t\t\tclearIcon={null}\n\t\t\t\t\t\t\t\t/> : null }\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t<FormGroup>\n\t\t\t\t\t\t\t<Form.Check\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\tlabel={t('common:hide-from-dashboard')}\n\t\t\t\t\t\t\t\tchecked={this.state.hideFromDashboard}\n\t\t\t\t\t\t\t\tonChange={this.hideFromDashboardChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t{ this.props.user.administrator ? <FormGroup>\n\t\t\t\t\t\t\t<Form.Check\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\tlabel={t('provide-as-template')}\n\t\t\t\t\t\t\t\tchecked={this.state.template}\n\t\t\t\t\t\t\t\tonChange={this.handleTemplateChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FormGroup> : null}\n\t\t\t\t\t</Modal.Body>\n\t\t\t\t\t<Modal.Footer>\n\t\t\t\t\t\t<Button onClick={this.props.close}>{t('common:cancel')}</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"success\"\n\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\tdisabled={this.state.disabled}\n\t\t\t\t\t\t>{t('common:save')}</Button>\n\t\t\t\t\t</Modal.Footer>\n\t\t\t\t</Form>\n\t\t\t</Modal>\n\t\t);\n\t}\n}\n\n\n// PROPERTIES //\n\nDetailsModal.propTypes = {\n\tclose: PropTypes.func.isRequired,\n\tdescription: PropTypes.string.isRequired,\n\thideFromDashboard: PropTypes.bool,\n\tlockAfter: PropTypes.instanceOf( Date ),\n\tlockUntil: PropTypes.instanceOf( Date ),\n\tshow: PropTypes.bool.isRequired,\n\ttemplate: PropTypes.bool,\n\ttitle: PropTypes.string.isRequired,\n\tupdate: PropTypes.func.isRequired,\n\tuser: PropTypes.object.isRequired\n};\n\nDetailsModal.defaultProps = {\n\thideFromDashboard: false,\n\tlockAfter: null,\n\tlockUntil: null,\n\ttemplate: null\n};\n\n\n// EXPORTS //\n\nexport default DetailsModal;\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Button from 'react-bootstrap/Button';\nimport Modal from 'react-bootstrap/Modal';\n\n\n// MAIN //\n\nconst DeleteModal = ( props ) => (\n\t<Modal show={props.show} onHide={props.close}>\n\t\t<Modal.Header>\n\t\t\t<Modal.Title>{props.t('common:delete')}?</Modal.Title>\n\t\t</Modal.Header>\n\t\t<Modal.Body>\n\t\t\t{props.t('delete-modal-body', { name: props.title })}\n\t\t</Modal.Body>\n\t\t<Modal.Footer>\n\t\t\t<Button onClick={props.close}>{props.t('common:cancel')}</Button>\n\t\t\t<Button variant=\"danger\" onClick={props.delete} >{props.t('common:delete')}</Button>\n\t\t</Modal.Footer>\n\t</Modal>\n);\n\n\n// PROPERTIES //\n\nDeleteModal.propTypes = {\n\tclose: PropTypes.func.isRequired,\n\tdelete: PropTypes.func.isRequired,\n\tshow: PropTypes.bool.isRequired,\n\tt: PropTypes.func.isRequired,\n\ttitle: PropTypes.string.isRequired\n};\n\n\n// EXPORTS //\n\nexport default DeleteModal;\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport logger from 'debug';\nimport { withTranslation } from 'react-i18next';\nimport Badge from 'react-bootstrap/Badge';\nimport Button from 'react-bootstrap/Button';\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\nimport ButtonToolbar from 'react-bootstrap/ButtonToolbar';\nimport Card from 'react-bootstrap/Card';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Tooltip from 'react-bootstrap/Tooltip';\nimport copyToClipboard from 'clipboard-copy';\nimport DetailsModal from './details_modal.js';\nimport DeleteModal from './delete_modal.js';\nimport COLORS from 'constants/colors';\nimport background from './architecture.jpeg';\nimport upload from './upload.svg';\nimport './lesson.css';\n\n\n// VARIABLES //\n\nconst DEFAULT_DESCRIPTION = 'No description supplied.';\nconst debug = logger( 'isle:lessons-page:lesson' );\nconst IS_IOS = isIOS();\n\n\n// FUNCTIONS //\n\nfunction addDefaultSrc( event ) {\n\tevent.target.src = background;\n}\n\nfunction isIOS() {\n\treturn [\n\t\t'iPad Simulator',\n\t\t'iPhone Simulator',\n\t\t'iPod Simulator',\n\t\t'iPad',\n\t\t'iPhone',\n\t\t'iPod'\n\t].includes( navigator.platform ) ||\n\t(\n\t\tnavigator.userAgent.includes('Mac') &&\n\t\t'ontouchend' in document\n\t);\n}\n\n\n// MAIN //\n\nclass Lesson extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tthis.state = {\n\t\t\tshowDeleteModal: false,\n\t\t\tshowDetailsModal: false,\n\t\t\tisleFile: null\n\t\t};\n\t}\n\n\ttoggleLessonState = () => {\n\t\tconst query = {\n\t\t\tlessonName: this.props.title,\n\t\t\tnamespaceName: this.props.namespace\n\t\t};\n\t\tif ( this.props.active ) {\n\t\t\tthis.props.deactivateLesson( query );\n\t\t} else {\n\t\t\tthis.props.activateLesson( query );\n\t\t}\n\t};\n\n\ttoggleLessonVisibility = () => {\n\t\tconst query = {\n\t\t\tlessonName: this.props.title,\n\t\t\tnamespaceName: this.props.namespace\n\t\t};\n\t\tif ( this.props.public ) {\n\t\t\tthis.props.hideLessonInGallery( query );\n\t\t} else {\n\t\t\tthis.props.showLessonInGallery( query );\n\t\t}\n\t};\n\n\tdelete = () => {\n\t\tthis.props.deleteLesson({\n\t\t\tlessonName: this.props.title,\n\t\t\tnamespaceName: this.props.namespace\n\t\t});\n\t\tthis.closeDeleteModal();\n\t};\n\n\tupdate = async ({ newTitle, newDescription, lockAfter, lockUntil, hideFromDashboard, template }) => {\n\t\tconst bool = await this.props.updateLesson({\n\t\t\tlessonName: this.props.title,\n\t\t\tnamespaceName: this.props.namespace,\n\t\t\tnewTitle,\n\t\t\tnewDescription,\n\t\t\ttemplate,\n\t\t\tlockAfter: lockAfter ? lockAfter.getTime() : null,\n\t\t\tlockUntil: lockUntil ? lockUntil.getTime() : null,\n\t\t\thideFromDashboard\n\t\t});\n\t\tif ( bool ) {\n\t\t\tthis.closeDetailsModal();\n\t\t}\n\t};\n\n\tshowDeleteModal = () => {\n\t\tthis.setState({ showDeleteModal: true });\n\t};\n\n\tshowDetailsModal = () => {\n\t\tthis.setState({ showDetailsModal: true });\n\t};\n\n\tcloseDeleteModal = () => {\n\t\tthis.setState({ showDeleteModal: false });\n\t};\n\n\tcloseDetailsModal = () => {\n\t\tthis.setState({ showDetailsModal: false });\n\t};\n\n\tgetIsleFile = async () => {\n\t\tdebug( 'Request ISLE source code from server...' );\n\t\tif ( !this.state.isleFile ) {\n\t\t\tconst data = await this.props.getIsleFile({\n\t\t\t\tlessonName: this.props.title,\n\t\t\t\tnamespaceName: this.props.namespace\n\t\t\t});\n\t\t\tif ( data ) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tisleFile: data\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n\tcopyIsleFileToClipboard = () => {\n\t\tif ( !this.state.isleFile ) {\n\t\t\treturn this.props.addNotification({\n\t\t\t\tmessage: this.props.t('source-file-error'),\n\t\t\t\tlevel: 'error'\n\t\t\t});\n\t\t}\n\t\tconst promise = copyToClipboard( this.state.isleFile );\n\t\tpromise.then( () => {\n\t\t\tthis.props.addNotification({\n\t\t\t\tmessage: this.props.t('source-file-copied'),\n\t\t\t\tlevel: 'success'\n\t\t\t});\n\t\t}).catch( err => {\n\t\t\tthis.props.addNotification({\n\t\t\t\tmessage: err.message,\n\t\t\t\tlevel: 'error'\n\t\t\t});\n\t\t});\n\t};\n\n\tcopyLinkToClipboard = () => {\n\t\tconst promise = copyToClipboard( this.props.url );\n\t\tpromise.then( () => {\n\t\t\tthis.props.addNotification({\n\t\t\t\tmessage: this.props.t('link-copied'),\n\t\t\t\tlevel: 'success'\n\t\t\t});\n\t\t}).catch( err => {\n\t\t\tthis.props.addNotification({\n\t\t\t\tmessage: err.message,\n\t\t\t\tlevel: 'error'\n\t\t\t});\n\t\t});\n\t};\n\n\tcopyNameToClipboard = ( event ) => {\n\t\tevent.stopPropagation();\n\t\tconst promise = copyToClipboard( this.props.title );\n\t\tpromise.then( () => {\n\t\t\tthis.props.addNotification({\n\t\t\t\tmessage: this.props.t('name-copied'),\n\t\t\t\tlevel: 'success'\n\t\t\t});\n\t\t}).catch( err => {\n\t\t\tthis.props.addNotification({\n\t\t\t\tmessage: err.message,\n\t\t\t\tlevel: 'error'\n\t\t\t});\n\t\t});\n\t};\n\n\tshowPreviewImage = () => {\n\t\tthis.img.src = this.props.url+'/preview.jpg';\n\t};\n\n\topenLesson = () => {\n\t\tif ( IS_IOS ) {\n\t\t\twindow.location = this.props.url;\n\t\t} else {\n\t\t\tconst win = window.open( this.props.url, '_blank' );\n\t\t\twin.focus();\n\t\t}\n\t};\n\n\trenderButtonToolbarDate() {\n\t\tconst { t } = this.props;\n\n\t\tlet updated = new Date( this.props.updatedAt );\n\t\tupdated = updated.toLocaleDateString();\n\n\t\tlet date = new Date( this.props.createdAt );\n\t\tdate = date.toLocaleDateString();\n\t\treturn (\n\t\t\t<span className=\"lessons-upload\">\n\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"toggle_visibility\">{t('created-at')}</Tooltip>}>\n\t\t\t\t<span className=\"lessons-uploaded-image\">\n\t\t\t\t\t<img alt=\"Upload Date Icon\" style={{ stroke: 'white', fill: 'red' }} src={upload} />\n\t\t\t\t</span>\n\t\t\t</OverlayTrigger>\n\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"toggle_visibility\">{t('last-updated')}{updated}</Tooltip>}>\n\t\t\t\t<span className=\"lessons-uploaded\">{date}</span>\n\t\t\t</OverlayTrigger>\n\t\t</span>\n\t\t);\n\t}\n\n\trenderActivateButton() {\n\t\tconst { lockUntil, t } = this.props;\n\t\tconst activeStyle = this.props.active === true ? 'success' : 'warning';\n\t\tif ( lockUntil ) {\n\t\t\treturn ( <OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"lockUntil_disabled\">\n\t\t\t\t{t('scheduled-at', { date: lockUntil.toLocaleString() })}\n\t\t\t</Tooltip>} >\n\t\t\t\t<Badge\n\t\t\t\t\tclassName=\"lessons-status\"\n\t\t\t\t\tvariant={activeStyle}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\topacity: 0.3\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{this.props.active ? t('active') : t('inactive')}\n\t\t\t\t</Badge>\n\t\t\t</OverlayTrigger> );\n\t\t}\n\t\treturn (\n\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"toggle_availability\">{this.props.active ? t('disable-lesson') : t('activate-lesson')}</Tooltip>}>\n\t\t\t\t<Badge\n\t\t\t\t\tclassName=\"lessons-status\"\n\t\t\t\t\tonClick={this.toggleLessonState}\n\t\t\t\t\tvariant={activeStyle}\n\t\t\t\t>\n\t\t\t\t\t{this.props.active ? t('active') : t('inactive')}\n\t\t\t\t</Badge>\n\t\t\t</OverlayTrigger>\n\t\t);\n\t}\n\n\trenderButtonToolbar() {\n\t\tconst { t } = this.props;\n\t\tconst publicStyle = this.props.public === true ? 'success' : 'warning';\n\t\treturn ( <ButtonToolbar className=\"lesson-button-toolbar\">\n\t\t\t<ButtonGroup style={{ marginRight: '5px' }} >\n\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"open_details\">{t('open-details')}</Tooltip>}>\n\t\t\t\t\t<Button size=\"sm\" variant=\"secondary\" onClick={this.showDetailsModal} aria-label={t('open-details')} >\n\t\t\t\t\t\t<i className=\"fa fa-cog\"></i>\n\t\t\t\t\t</Button>\n\t\t\t\t</OverlayTrigger>\n\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"delete_lesson\">{t('delete-lesson')}</Tooltip>}>\n\t\t\t\t\t<Button size=\"sm\" variant=\"secondary\" onClick={this.showDeleteModal} aria-label={t('delete-lesson')} >\n\t\t\t\t\t\t<i className=\"fa fa-trash-alt\"></i>\n\t\t\t\t\t</Button>\n\t\t\t\t</OverlayTrigger>\n\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"isle-file\">{t('copy-file')}</Tooltip>}>\n\t\t\t\t\t<Button variant=\"secondary\" size=\"sm\" onFocus={this.getIsleFile} onMouseEnter={this.getIsleFile}\n\t\t\t\t\t\tonClick={this.copyIsleFileToClipboard} style={{ float: 'right' }}\n\t\t\t\t\t\taria-label={t('copy-file')}\n\t\t\t\t\t>\n\t\t\t\t\t\t<i className=\"fa fa-clipboard\"></i>\n\t\t\t\t\t</Button>\n\t\t\t\t</OverlayTrigger>\n\t\t\t</ButtonGroup>\n\t\t\t{this.renderActivateButton()}\n\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"toggle_visibility\">{this.props.public ? t('remove-from-gallery') : t('show-in-gallery') }</Tooltip>}>\n\t\t\t\t<Badge className=\"lessons-status\" onClick={this.toggleLessonVisibility} variant={publicStyle}>{this.props.public ? t(('public')) : t('private')}</Badge>\n\t\t\t</OverlayTrigger>\n\t\t\t{ this.renderButtonToolbarDate() }\n\t\t</ButtonToolbar> );\n\t}\n\n\trenderModals() {\n\t\treturn ( <Fragment>\n\t\t\t<DeleteModal {...this.props} show={this.state.showDeleteModal} close={this.closeDeleteModal} delete={this.delete} />\n\t\t\t{ this.state.showDetailsModal ?\n\t\t\t\t<DetailsModal {...this.props} show={this.state.showDetailsModal} close={this.closeDetailsModal} update={this.update} /> :\n\t\t\t\tnull\n\t\t\t}\n\t\t</Fragment> );\n\t}\n\n\trender() {\n\t\tconst { t } = this.props;\n\t\treturn (\n\t\t\t<Card className=\"animated-lesson-card\">\n\t\t\t\t<Card.Body style={{ padding: 0, opacity: this.props.hideFromDashboard ? 0.6 : 1.0 }}>\n\t\t\t\t\t<div style={{\n\t\t\t\t\t\tfilter: 'grayscale(30%)',\n\t\t\t\t\t\tbackground: COLORS[ this.props.colorIndex ]\n\t\t\t\t\t}} className=\"hovereffect\"\n\t\t\t\t\t\tonMouseOver={this.showPreviewImage}\n\t\t\t\t\t\tonFocus={this.showPreviewImage}\n\t\t\t\t\t>\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tclassName=\"img-responsive\"\n\t\t\t\t\t\t\tsrc={background}\n\t\t\t\t\t\t\tref={( div ) => {\n\t\t\t\t\t\t\t\tthis.img = div;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\theight: 180\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonError={addDefaultSrc}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"overlay\"\n\t\t\t\t\t\t\tstyle={{ cursor: 'cell' }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<h2>\n\t\t\t\t\t\t\t\t<OverlayTrigger\n\t\t\t\t\t\t\t\t\tplacement=\"top\"\n\t\t\t\t\t\t\t\t\toverlay={<Tooltip id=\"copy_name\">\n\t\t\t\t\t\t\t\t\t\t{t('common:copy-name')\n\t\t\t\t\t\t\t\t\t}</Tooltip>}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\tclassName=\"lesson-title-button\"\n\t\t\t\t\t\t\t\t\t\trole=\"button\" tabIndex={0}\n\t\t\t\t\t\t\t\t\t\tonClick={this.copyNameToClipboard}\n\t\t\t\t\t\t\t\t\t\tonKeyPress={this.copyNameToClipboard}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{this.props.title}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</OverlayTrigger>\n\t\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t\t{this.props.description !== DEFAULT_DESCRIPTION ?\n\t\t\t\t\t\t\t\t<h3>{this.props.description}</h3> :\n\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tref={( link ) => {\n\t\t\t\t\t\t\t\t\tthis.link = link;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tclassName=\"info\"\n\t\t\t\t\t\t\t\tonClick={this.openLesson} onKeyPress={this.openLesson}\n\t\t\t\t\t\t\t\ttabIndex={0} role=\"button\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{t('open-lesson')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"copy_link\">{t('common:copy-link')}</Tooltip>}>\n\t\t\t\t\t\t<i\n\t\t\t\t\t\t\trole=\"button\" tabIndex={0}\n\t\t\t\t\t\t\tclassName=\"lesson-link-icon fas fa-external-link-alt\"\n\t\t\t\t\t\t\tonClick={this.copyLinkToClipboard}\n\t\t\t\t\t\t\tonKeyPress={this.copyLinkToClipboard}\n\t\t\t\t\t\t\taria-label={t('common:copy-link')}\n\t\t\t\t\t\t></i>\n\t\t\t\t\t</OverlayTrigger>\n\t\t\t\t\t{this.renderButtonToolbar()}\n\t\t\t\t\t{this.renderModals()}\n\t\t\t\t</Card.Body>\n\t\t\t</Card>\n\t\t);\n\t}\n}\n\n\n// PROPERTIES //\n\nLesson.propTypes = {\n\tactivateLesson: PropTypes.func.isRequired,\n\tactive: PropTypes.bool.isRequired,\n\taddNotification: PropTypes.func.isRequired,\n\tcolorIndex: PropTypes.number.isRequired,\n\tcreatedAt: PropTypes.any.isRequired,\n\tdeactivateLesson: PropTypes.func.isRequired,\n\tdeleteLesson: PropTypes.func.isRequired,\n\tdescription: PropTypes.string.isRequired,\n\tgetIsleFile: PropTypes.func.isRequired,\n\tgetLessons: PropTypes.func.isRequired,\n\thideFromDashboard: PropTypes.bool.isRequired,\n\thideLessonInGallery: PropTypes.func.isRequired,\n\tlockAfter: PropTypes.instanceOf( Date ),\n\tlockUntil: PropTypes.instanceOf( Date ),\n\tnamespace: PropTypes.string.isRequired,\n\tpublic: PropTypes.bool.isRequired,\n\tshowLessonInGallery: PropTypes.func.isRequired,\n\ttitle: PropTypes.string.isRequired,\n\tupdateLesson: PropTypes.func.isRequired,\n\tupdatedAt: PropTypes.any.isRequired,\n\turl: PropTypes.string.isRequired,\n\tuser: PropTypes.object.isRequired\n};\n\nLesson.defaultProps = {\n\tlockAfter: null,\n\tlockUntil: null\n};\n\n\n// EXPORTS //\n\nexport default withTranslation( [ 'lesson', 'common' ] )( Lesson );\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Card from 'react-bootstrap/Card';\nimport ButtonToolbar from 'react-bootstrap/ButtonToolbar';\nimport ProgressBar from 'react-bootstrap/ProgressBar';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Tooltip from 'react-bootstrap/Tooltip';\nimport copyToClipboard from 'clipboard-copy';\nimport round from '@stdlib/math/base/special/round';\nimport min from '@stdlib/math/base/special/min';\nimport COLORS from 'constants/colors';\nimport formatTime from 'utils/format_time.js';\nimport background from './architecture.jpeg';\nimport './lessons.css';\n\n\n// FUNCTIONS //\n\nfunction addDefaultSrc( event ) {\n\tevent.target.src = background;\n}\n\n\n// VARIABLES //\n\nconst DEFAULT_DESCRIPTION = 'No description supplied.';\n\n\n// MAIN //\n\nclass EnrolledLesson extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\t\tthis.state = {};\n\t}\n\n\tshowPreviewImage = () => {\n\t\tthis.img.src = this.props.url+'/preview.jpg';\n\t};\n\n\topenLesson = () => {\n\t\tconst win = window.open( this.props.url, '_blank' );\n\t\twin.focus();\n\t};\n\n\tcopyLinkToClipboard = () => {\n\t\tconst promise = copyToClipboard( this.props.url );\n\t\tpromise.then( () => {\n\t\t\tthis.props.addNotification({\n\t\t\t\tmessage: this.props.t('link-copied'),\n\t\t\t\tlevel: 'success'\n\t\t\t});\n\t\t}).catch( err => {\n\t\t\tthis.props.addNotification({\n\t\t\t\tmessage: err.message,\n\t\t\t\tlevel: 'error'\n\t\t\t});\n\t\t});\n\t};\n\n\trenderProgress() {\n\t\tlet progress;\n\t\tif ( this.props.metadata && this.props.metadata.hideProgressBar === true ) {\n\t\t\treturn <div className=\"enrolled-lesson-progress\"></div>;\n\t\t}\n\t\tconst lessonData = this.props.user.lessonData;\n\t\tconst data = lessonData[ this.props._id ];\n\t\tif ( data ) {\n\t\t\tprogress = data.progress;\n\t\t\tprogress *= 100;\n\t\t\tprogress = min( round( progress ), 100.0 );\n\t\t} else {\n\t\t\tprogress = 0;\n\t\t}\n\t\tconst { t } = this.props;\n\t\treturn ( <div className=\"enrolled-lesson-progress\">\n\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"open_details\">{t('your-progress')}</Tooltip>}>\n\t\t\t\t<ProgressBar aria-label={t('your-progress')} variant='success' now={progress} label={`${progress}%`} />\n\t\t\t</OverlayTrigger>\n\t\t</div> );\n\t}\n\n\trenderButtonToolbar() {\n\t\tlet duration;\n\t\tconst lessonData = this.props.user.lessonData;\n\t\tconst data = lessonData[ this.props._id ];\n\t\tif ( data ) {\n\t\t\tduration = data.spentTime;\n\t\t} else {\n\t\t\tduration = 0;\n\t\t}\n\t\tconst { t } = this.props;\n\t\treturn (\n\t\t\t<ButtonToolbar style={{\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: 180,\n\t\t\t\twidth: '100%',\n\t\t\t\theight: '36px',\n\t\t\t\tbackground: 'rgba(0, 0, 0, 0.75)'\n\t\t\t}}>\n\t\t\t\t{this.renderProgress()}\n\t\t\t\t<div className=\"enrolled-lesson-time\" style={{ width: '35%', height: '100%' }} >\n\t\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"open_details\">{t('time-format')}</Tooltip>}>\n\t\t\t\t\t\t<span>{t('time-spent')}: {formatTime( duration )}</span>\n\t\t\t\t\t</OverlayTrigger>\n\t\t\t\t</div>\n\t\t\t</ButtonToolbar>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst { t } = this.props;\n\t\treturn (\n\t\t\t<Card className=\"animated-lesson-card\">\n\t\t\t\t<Card.Body style={{ padding: 0 }}>\n\t\t\t\t\t<div style={{\n\t\t\t\t\t\tfilter: 'grayscale(30%)',\n\t\t\t\t\t\tbackground: COLORS[ this.props.colorIndex ]\n\t\t\t\t\t}} onMouseOver={this.showPreviewImage} onFocus={this.showPreviewImage}\n\t\t\t\t\t\tclassName=\"hovereffect\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tclassName=\"img-responsive\"\n\t\t\t\t\t\t\tsrc={background}\n\t\t\t\t\t\t\tref={( div ) => {\n\t\t\t\t\t\t\t\tthis.img = div;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\theight: 180\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonError={addDefaultSrc}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div className=\"overlay\" >\n\t\t\t\t\t\t\t<h2>{this.props.title}</h2>\n\t\t\t\t\t\t\t{this.props.description !== DEFAULT_DESCRIPTION ?\n\t\t\t\t\t\t\t\t<h3>{this.props.description}</h3> :\n\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tref={( link ) => {\n\t\t\t\t\t\t\t\t\tthis.link = link;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tclassName=\"info\"\n\t\t\t\t\t\t\t\trole=\"button\" tabIndex={0}\n\t\t\t\t\t\t\t\tonClick={this.openLesson} onKeyPress={this.openLesson}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{t('open-lesson')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"copy_link\">{t('common:copy-link')}</Tooltip>}>\n\t\t\t\t\t\t<i\n\t\t\t\t\t\t\trole=\"button\" tabIndex={0}\n\t\t\t\t\t\t\tclassName=\"lesson-link-icon fas fa-external-link-alt\"\n\t\t\t\t\t\t\tonClick={this.copyLinkToClipboard}\n\t\t\t\t\t\t\tonKeyPress={this.copyLinkToClipboard}\n\t\t\t\t\t\t\taria-label={t('common:copy-link')}\n\t\t\t\t\t\t></i>\n\t\t\t\t\t</OverlayTrigger>\n\t\t\t\t\t{this.renderButtonToolbar()}\n\t\t\t\t</Card.Body>\n\t\t\t</Card>\n\t\t);\n\t}\n}\n\n\n// PROPERTIES //\n\nEnrolledLesson.propTypes = {\n\t'_id': PropTypes.string.isRequired,\n\taddNotification: PropTypes.func.isRequired,\n\tcolorIndex: PropTypes.number.isRequired,\n\tdescription: PropTypes.string.isRequired,\n\tmetadata: PropTypes.object,\n\ttitle: PropTypes.string.isRequired,\n\turl: PropTypes.string.isRequired,\n\tuser: PropTypes.object.isRequired\n};\n\nEnrolledLesson.defaultProps = {\n\tmetadata: null\n};\n\n\n// EXPORTS //\n\nexport default withTranslation( [ 'lesson', 'common' ] )( EnrolledLesson );\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React from 'react';\nimport { withTranslation } from 'react-i18next';\nimport Jumbotron from 'react-bootstrap/Jumbotron';\n\n\n// MAIN //\n\nconst NoCourseBanner = ( props ) => {\n\tconst { user, t } = props;\n\tlet appendix = null;\n\tif ( user.writeAccess ) {\n\t\tappendix = <span>{t('create-new-one')}<i className=\"fa fa-pencil-alt\"></i>.</span>;\n\t} else {\n\t\tappendix = ' .';\n\t}\n\treturn ( <Jumbotron className=\"lessons-jumbotron\" >\n\t\t<h1>{t('common:no-course-selected')}</h1>\n\t\t<p>{t('no-course-description')}<i className=\"fa fa-align-justify\"></i>{appendix}\n\t\t</p>\n\t</Jumbotron> );\n};\n\n\n// EXPORTS //\n\nexport default withTranslation( [ 'lessons_page', 'common' ] )( NoCourseBanner );\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React from 'react';\nimport { withTranslation } from 'react-i18next';\nimport Jumbotron from 'react-bootstrap/Jumbotron';\n\n\n// MAIN //\n\nconst NoLessonBanner = ( props ) => {\n\tconst { user, t } = props;\n\tlet description = t('no-lessons');\n\tif ( user.writeAccess ) {\n\t\tdescription += t('upload-from-editor');\n\t}\n\treturn ( <Jumbotron className=\"lessons-jumbotron\">\n\t\t<h1>{t('no-lessons-found')}</h1>\n\t\t<p>{description}</p>\n\t</Jumbotron> );\n};\n\n\n// EXPORTS //\n\nexport default withTranslation( [ 'lessons_page', 'common' ] )( NoLessonBanner );\n\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React, { Component, Fragment } from 'react';\nimport logger from 'debug';\nimport { withTranslation } from 'react-i18next';\nimport PropTypes from 'prop-types';\nimport { Responsive, WidthProvider } from 'react-grid-layout';\nimport Button from 'react-bootstrap/Button';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Tooltip from 'react-bootstrap/Tooltip';\nimport isArray from '@stdlib/assert/is-array';\nimport contains from '@stdlib/assert/contains';\nimport lowercase from '@stdlib/string/lowercase';\nimport pluck from '@stdlib/utils/pluck';\nimport floor from '@stdlib/math/base/special/floor';\nimport LessonCreator from 'ev/containers/lesson-creator';\nimport Lesson from './lesson.js';\nimport EnrolledLesson from './enrolled_lesson.js';\nimport NoCourseBanner from './no_course_banner.js';\nimport NoLessonBanner from './no_lesson_banner.js';\nimport sortLessons from 'utils/sort_lessons.js';\nimport isOwner from 'utils/is_owner.js';\nimport 'css/image.css';\nimport 'react-grid-layout/css/styles.css';\nimport 'react-resizable/css/styles.css';\nimport './lessons.css';\n\n\n// VARIABLES //\n\nconst debug = logger( 'isle-dashboard:lessons-page' );\nconst ResponsiveReactGridLayout = WidthProvider( Responsive );\n\n\n// FUNCTIONS //\n\nfunction searchLessons( lessons, phrase ) {\n\tif ( !phrase ) {\n\t\treturn lessons;\n\t}\n\tconst filteredLessons = [];\n\tif ( isArray( lessons ) ) {\n\t\tfor ( let i = 0; i < lessons.length; i++ ) {\n\t\t\tif (\n\t\t\t\tcontains( lowercase( lessons[ i ].title ), phrase ) ||\n\t\t\t\tcontains( lowercase( lessons[ i ].description ), phrase )\n\t\t\t) {\n\t\t\t\tfilteredLessons.push( lessons[ i ] );\n\t\t\t}\n\t\t}\n\t}\n\treturn filteredLessons;\n}\n\nfunction createLayout( lessons ) {\n\tdebug( 'Create layout...' );\n\tconst elemH = 3.52;\n\tlet layouts = lessons.map( ( e, i ) => {\n\t\treturn {\n\t\t\tlg: { i: `cell-${e.title}-${i}`, x: i*4 % 24, y: floor( i / 6 ) * elemH, w: 4, h: elemH },\n\t\t\tmd: { i: `cell-${e.title}-${i}`, x: i*4 % 20, y: floor( i / 5 ) * elemH, w: 4, h: elemH },\n\t\t\tsm: { i: `cell-${e.title}-${i}`, x: i*4 % 16, y: floor( i / 4 ) * elemH, w: 4, h: elemH },\n\t\t\txs: { i: `cell-${e.title}-${i}`, x: i*4 % 12, y: floor( i / 3 ) * elemH, w: 4, h: elemH },\n\t\t\txxs: { i: `cell-${e.title}-${i}`, x: i*4 % 8, y: floor( i / 2 ) * elemH, w: 4, h: elemH },\n\t\t\ttiny: { i: `cell-${e.title}-${i}`, x: i*4 % 4, y: floor( i / 1 ) * elemH, w: 4, h: elemH }\n\t\t};\n\t});\n\tlayouts = {\n\t\tlg: pluck( layouts, 'lg' ),\n\t\tmd: pluck( layouts, 'md' ),\n\t\tsm: pluck( layouts, 'sm' ),\n\t\txs: pluck( layouts, 'xs' ),\n\t\txxs: pluck( layouts, 'xxs' ),\n\t\ttiny: pluck( layouts, 'tiny' )\n\t};\n\treturn layouts;\n}\n\n\n// MAIN //\n\nclass LessonsPage extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tlet lessons = props.namespace.lessons;\n\t\tif ( !isOwner( props.user, props.namespace ) ) {\n\t\t\tdebug( 'Filter out inactive or hidden lessons for enrolled students...' );\n\t\t\tlessons = lessons.filter( e => e.active === true && e.hideFromDashboard !== true );\n\t\t}\n\t\tthis.state = {\n\t\t\tfilteredLessons: searchLessons( lessons, props.search.phrase ),\n\t\t\tlayouts: createLayout( lessons ),\n\t\t\tunfilteredLessons: lessons,\n\t\t\tsearch: props.search,\n\t\t\tactiveElement: null,\n\t\t\tshowLessonCreator: false\n\t\t};\n\t}\n\n\tstatic getDerivedStateFromProps( nextProps, prevState ) {\n\t\tif (\n\t\t\tnextProps.namespace.lessons !== prevState.unfilteredLessons ||\n\t\t\tnextProps.search.phrase !== prevState.search.phrase ||\n\t\t\tnextProps.search.direction !== prevState.search.direction ||\n\t\t\tnextProps.search.type !== prevState.search.type\n\t\t) {\n\t\t\tdebug( 'Get derived state...' );\n\t\t\tlet lessons = nextProps.namespace.lessons || [];\n\t\t\tif ( !isOwner( nextProps.user, nextProps.namespace ) ) {\n\t\t\t\tdebug( 'Filter out inactive or hidden lessons for enrolled students...' );\n\t\t\t\tlessons = lessons.filter( e => e.active === true && e.hideFromDashboard !== true );\n\t\t\t}\n\t\t\tconst filteredLessons = searchLessons( lessons, nextProps.search.phrase );\n\t\t\tsortLessons( filteredLessons, nextProps.search );\n\t\t\tconst layouts = createLayout( filteredLessons );\n\t\t\treturn {\n\t\t\t\tfilteredLessons,\n\t\t\t\tlayouts,\n\t\t\t\tunfilteredLessons: nextProps.namespace.lessons,\n\t\t\t\tsearch: nextProps.search\n\t\t\t};\n\t\t}\n\t\treturn null;\n\t}\n\n\tcomponentDidMount() {\n\t\tdebug( 'Component did mount...' );\n\t\tconst course = this.props.namespace;\n\t\tif ( course.title ) {\n\t\t\tdebug( 'Fetch lessons...' );\n\t\t\tthis.props.getLessons( course.title );\n\t\t}\n\t}\n\n\tshouldComponentUpdate( nextProps, nextState ) {\n\t\tif (\n\t\t\tnextProps.search.direction !== this.props.search.direction ||\n\t\t\tnextProps.search.type !== this.props.search.type ||\n\t\t\tnextState.filteredLessons !== this.state.filteredLessons ||\n\t\t\tnextState.showLessonCreator !== this.state.showLessonCreator\n\t\t) {\n\t\t\tdebug( 'Should update page...' );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpreventOpeningLink = ( event ) => {\n\t\tevent.preventDefault();\n\t};\n\n\trepositionLessons( idx, direction ) {\n\t\tconst unfilteredLessons = this.state.unfilteredLessons.slice();\n\t\tif ( direction === 'left' ) {\n\t\t\tif ( idx > 0 ) {\n\t\t\t\tconst lesson = unfilteredLessons[ idx ];\n\t\t\t\tconst left = unfilteredLessons[ idx - 1 ];\n\t\t\t\tconst tmp = left.pos;\n\t\t\t\tleft.pos = lesson.pos;\n\t\t\t\tlesson.pos = tmp;\n\t\t\t}\n\t\t}\n\t\telse if ( direction === 'right' ) {\n\t\t\tif ( idx < unfilteredLessons.length - 1 ) {\n\t\t\t\tconst lesson = unfilteredLessons[ idx ];\n\t\t\t\tconst right = unfilteredLessons[ idx + 1 ];\n\t\t\t\tconst tmp = right.pos;\n\t\t\t\tright.pos = lesson.pos;\n\t\t\t\tlesson.pos = tmp;\n\t\t\t}\n\t\t}\n\t\tconst filteredLessons = searchLessons( unfilteredLessons, this.props.search.phrase );\n\t\tsortLessons( filteredLessons, this.props.search );\n\t\tconst layouts = createLayout( filteredLessons );\n\t\tthis.setState({\n\t\t\tfilteredLessons,\n\t\t\tlayouts,\n\t\t\tunfilteredLessons\n\t\t}, this.forceUpdate );\n\t\tthis.props.setLessonOrder({\n\t\t\tid: this.props.namespace._id,\n\t\t\tlessons: unfilteredLessons.map( x => x._id )\n\t\t});\n\t}\n\n\thandlePositionChangeFactory = ( idx ) => {\n\t\treturn ( event ) => {\n\t\t\tlet bool = false;\n\t\t\tswitch ( event.code ) {\n\t\t\t\tcase 'ArrowLeft':\n\t\t\t\t\tbool = true;\n\t\t\t\t\tthis.repositionLessons( idx, 'left' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowRight':\n\t\t\t\t\tbool = true;\n\t\t\t\t\tthis.repositionLessons( idx, 'right' );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif ( bool ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t};\n\t};\n\n\ttoggleCreator = () => {\n\t\tthis.props.getTemplateLessons();\n\t\tthis.setState({ showLessonCreator: !this.state.showLessonCreator });\n\t};\n\n\thandleCreate = () => {\n\t\tthis.setState({ showLessonCreator: false });\n\t\tconst course = this.props.namespace;\n\t\tif ( course.title ) {\n\t\t\tdebug( 'Fetch lessons...' );\n\t\t\tthis.props.getLessons( course.title );\n\t\t}\n\t};\n\n\trenderLessons() {\n\t\tlet lessons = this.state.filteredLessons;\n\t\tif ( !isOwner( this.props.user, this.props.namespace ) ) {\n\t\t\treturn lessons.map( ( e, i ) => {\n\t\t\t\treturn (<div className=\"lesson-grid-item\" key={`cell-${e.title}-${i}`}>\n\t\t\t\t\t<EnrolledLesson\n\t\t\t\t\t\t{...lessons[ i ]}\n\t\t\t\t\t\taddNotification={this.props.addNotification}\n\t\t\t\t\t\tuser={this.props.user}\n\t\t\t\t\t/>\n\t\t\t\t</div>);\n\t\t\t});\n\t\t}\n\t\treturn (\n\t\t\tlessons.map( ( e, i ) => {\n\t\t\t\tconst lesson = <Lesson\n\t\t\t\t\t{...lessons[ i ]}\n\t\t\t\t\taddNotification={this.props.addNotification}\n\t\t\t\t\tdeleteLesson={this.props.deleteLesson}\n\t\t\t\t\tupdateLesson={this.props.updateLesson}\n\t\t\t\t\tdeactivateLesson={this.props.deactivateLesson}\n\t\t\t\t\tactivateLesson={this.props.activateLesson}\n\t\t\t\t\tshowLessonInGallery={this.props.showLessonInGallery}\n\t\t\t\t\thideLessonInGallery={this.props.hideLessonInGallery}\n\t\t\t\t\tgetLessons={this.props.getLessons}\n\t\t\t\t\tgetIsleFile={this.props.getIsleFile}\n\t\t\t\t\tuser={this.props.user}\n\t\t\t\t/>;\n\t\t\t\tif ( this.props.search.type === 'sequentially' ) {\n\t\t\t\t\treturn ( <div\n\t\t\t\t\t\tclassName=\"lesson-grid-item\"\n\t\t\t\t\t\tkey={`cell-${e.title}-${i}`}\n\t\t\t\t\t\ttabIndex={0} role=\"button\"\n\t\t\t\t\t\tref={input => {\n\t\t\t\t\t\t\tif ( input && this.state.activeElement === e.title ) {\n\t\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn input;\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonKeyDown={this.handlePositionChangeFactory( i )}\n\t\t\t\t\t\tonFocus={() => {\n\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\tactiveElement: e.title\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{lesson}\n\t\t\t\t\t</div> );\n\t\t\t\t}\n\t\t\t\treturn (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"lesson-grid-item\" key={`cell-${e.title}-${i}`}\n\t\t\t\t\t>\n\t\t\t\t\t\t{lesson}\n\t\t\t\t\t</div>\n\t\t\t\t);\n\t\t\t})\n\t\t);\n\t}\n\n\trender() {\n\t\tif ( !this.props.namespace.title ) {\n\t\t\treturn <NoCourseBanner user={this.props.user} />;\n\t\t}\n\t\tlet lessons = this.state.filteredLessons;\n\t\tif ( isArray( lessons ) ) {\n\t\t\tconst templateButton = <OverlayTrigger placement=\"left\" overlay={<Tooltip id=\"create-from-template-tooltip\">{this.props.t('create-from-template')}</Tooltip>}>\n\t\t\t\t<Button aria-label={this.props.t('create-from-template')} className=\"create-from-template-button\" onClick={this.toggleCreator} >\n\t\t\t\t\t<i className=\"fas fa-plus\" />\n\t\t\t\t</Button>\n\t\t\t</OverlayTrigger>;\n\t\t\tif ( lessons.length === 0 ) {\n\t\t\t\treturn ( <Fragment>\n\t\t\t\t\t<NoLessonBanner user={this.props.user} />\n\t\t\t\t\t{templateButton}\n\t\t\t\t\t{this.state.showLessonCreator ? <LessonCreator\n\t\t\t\t\t\tonHide={this.toggleCreator}\n\t\t\t\t\t\tonCreate={this.handleCreate}\n\t\t\t\t\t\tnamespace={this.props.namespace}\n\t\t\t\t\t/> : null}\n\t\t\t\t</Fragment> );\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<Fragment>\n\t\t\t\t\t<div className=\"lessons-grid-container\">\n\t\t\t\t\t\t<ResponsiveReactGridLayout\n\t\t\t\t\t\t\tlayouts={this.state.layouts}\n\t\t\t\t\t\t\tbreakpoints={{ lg: 1800, md: 1550, sm: 1200, xs: 900, xxs: 400, tiny: 0 }}\n\t\t\t\t\t\t\tcols={{ lg: 24, md: 20, sm: 16, xs: 12, xxs: 8, tiny: 4 }}\n\t\t\t\t\t\t\tcontainerPadding={[10, 10]}\n\t\t\t\t\t\t\tisResizable={false}\n\t\t\t\t\t\t\tisBounded={true}\n\t\t\t\t\t\t\tisDraggable={false}\n\t\t\t\t\t\t\trowHeight={isOwner( this.props.user, this.props.namespace ) ? 54.5 : 55}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{this.renderLessons()}\n\t\t\t\t\t\t</ResponsiveReactGridLayout>\n\t\t\t\t\t\t{templateButton}\n\t\t\t\t\t</div>\n\t\t\t\t\t{this.state.showLessonCreator ? <LessonCreator\n\t\t\t\t\t\tonHide={this.toggleCreator}\n\t\t\t\t\t\tonCreate={this.handleCreate}\n\t\t\t\t\t\tnamespace={this.props.namespace}\n\t\t\t\t\t/> : null}\n\t\t\t\t</Fragment>\n\t\t\t);\n\t\t}\n\t}\n}\n\n\n// PROPERTIES //\n\nLessonsPage.propTypes = {\n\tactivateLesson: PropTypes.func.isRequired,\n\taddNotification: PropTypes.func.isRequired,\n\tdeactivateLesson: PropTypes.func.isRequired,\n\tdeleteLesson: PropTypes.func.isRequired,\n\tgetIsleFile: PropTypes.func.isRequired,\n\tgetLessons: PropTypes.func.isRequired,\n\tgetTemplateLessons: PropTypes.func.isRequired,\n\thideLessonInGallery: PropTypes.func.isRequired,\n\tnamespace: PropTypes.object.isRequired,\n\tsearch: PropTypes.object.isRequired,\n\tsetLessonOrder: PropTypes.func.isRequired,\n\tshowLessonInGallery: PropTypes.func.isRequired,\n\tupdateLesson: PropTypes.func.isRequired,\n\turl: PropTypes.string,\n\tuser: PropTypes.object.isRequired\n};\n\nLessonsPage.defaultProps = {\n\turl: null\n};\n\n\n// EXPORTS //\n\nexport default withTranslation( [ 'lessons_page', 'common' ] )( LessonsPage );\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport LessonsPage from 'components/lessons-page';\nimport { setLessonOrderInjector } from 'actions/namespace';\nimport { activateLessonInjector, deactivateLessonInjector, deleteLessonInjector, getIsleFileInjector, getLessonsInjector, getTemplateLessonsInjector,\n\tshowLessonInGalleryInjector, hideLessonInGalleryInjector, updateLessonInjector } from 'actions/lesson';\nimport { addNotificationInjector } from 'actions/notification';\n\n\n// EXPORTS //\n\nconst VisibleLessonsPage = connect( mapStateToProps, mapDispatchToProps )( LessonsPage );\n\nfunction mapStateToProps( state ) {\n\treturn {\n\t\tsearch: state.search,\n\t\tuser: state.user,\n\t\tnamespace: state.namespace\n\t};\n}\n\nfunction mapDispatchToProps( dispatch ) {\n\treturn {\n\t\taddNotification: addNotificationInjector( dispatch ),\n\t\tshowLessonInGallery: showLessonInGalleryInjector( dispatch ),\n\t\thideLessonInGallery: hideLessonInGalleryInjector( dispatch ),\n\t\tactivateLesson: activateLessonInjector( dispatch ),\n\t\tdeactivateLesson: deactivateLessonInjector( dispatch ),\n\t\tupdateLesson: updateLessonInjector( dispatch ),\n\t\tdeleteLesson: deleteLessonInjector( dispatch ),\n\t\tgetLessons: getLessonsInjector( dispatch ),\n\t\tgetTemplateLessons: getTemplateLessonsInjector( dispatch ),\n\t\tgetIsleFile: getIsleFileInjector( dispatch ),\n\t\tsetLessonOrder: setLessonOrderInjector( dispatch )\n\t};\n}\n\nexport default VisibleLessonsPage;\n","/*\n* Adapted from:\n*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n* 1.3.8\n* 2018-03-22 14:03:47\n*\n* By Eli Grey, https://eligrey.com\n* License: MIT\n*   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\n*\n* @source http://purl.eligrey.com/github/FileSaver.js/blob/master/src/FileSaver.js\n*/\n\n// VARIABLES //\n\nconst RE_AUTO_BOM = /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i;\nconst ARBITRARY_REVOKE_TIMEOUT = 1000 * 40; // Time in ms\n\n\n// FUNCTIONS //\n\nfunction click(node) {\n\tconst event = new MouseEvent( 'click' );\n\tnode.dispatchEvent( event );\n}\n\nfunction throwOutside( ex ) {\n\tsetImmediate(function throwEx() {\n\t\tthrow ex;\n\t}, 0 );\n}\n\nfunction autoBOM( blob ) {\n\t// Prepend BOM for UTF-8 XML and text/* types (including HTML). Note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n\tif ( RE_AUTO_BOM.test( blob.type ) ) {\n\t\treturn new Blob([ String.fromCharCode( 0xFEFF ), blob ], {\n\t\t\ttype: blob.type\n\t\t});\n\t}\n\treturn blob;\n}\n\nfunction dispatch( filesaver, eventTypes, event ) {\n\teventTypes = [].concat( eventTypes );\n\tlet i = eventTypes.length;\n\twhile ( i-- ) {\n\t\tlet listener = filesaver[ 'on' + eventTypes[i] ];\n\t\tif ( typeof listener === 'function' ) {\n\t\t\ttry {\n\t\t\t\tlistener.call( filesaver, event || filesaver );\n\t\t\t} catch ( ex ) {\n\t\t\t\tthrowOutside( ex );\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n// MAIN //\n\nfunction saveFactory( view ) {\n\tif (\n\t\ttypeof view === 'undefined' ||\n\t\ttypeof navigator !== 'undefined' &&\n\t\t/MSIE [1-9]\\./.test( navigator.userAgent )\n\t) {\n\t\treturn;\n\t}\n\tconst doc = view.document;\n\n\t// Only get URL when necessary in case Blob.js hasn't overridden it yet:\n\tfunction getURL() {\n\t\treturn view.URL || view.webkitURL || view;\n\t}\n\tfunction revoke( file ) {\n\t\tfunction revoker() {\n\t\t\tif ( typeof file === 'string' ) { // File is an object URL...\n\t\t\t\tgetURL().revokeObjectURL(file);\n\t\t\t} else { // File is a File...\n\t\t\t\tfile.remove();\n\t\t\t}\n\t\t}\n\t\tsetTimeout( revoker, ARBITRARY_REVOKE_TIMEOUT );\n\t}\n\n\tconst saveLink = doc.createElementNS( 'http://www.w3.org/1999/xhtml', 'a' );\n\tconst canUseSaveLink = 'download' in saveLink;\n\tconst isSafari = /constructor/i.test( view.HTMLElement ) || view.safari;\n\tconst isChromeIOS =/CriOS\\/[\\d]+/.test( navigator.userAgent );\n\tconst setImmediate = view.setImmediate || view.setTimeout;\n\tconst forceSavableType = 'application/octet-stream';\n\n\tfunction FileSaver(blob, name, noAutoBOM ) {\n\t\tif ( !noAutoBOM ) {\n\t\t\tblob = autoBOM(blob);\n\t\t}\n\t\t// First try a.download, then web filesystem, then object URLs\n\t\tconst self = this;\n\t\tconst type = blob.type;\n\t\tconst force = type === forceSavableType;\n\t\tlet objectURL;\n\t\tfunction dispatchAll() {\n\t\t\tdispatch( self, 'writestart progress write writeend'.split(' ') );\n\t\t}\n\t\t// On any filesystem errors, revert to saving with object URLs:\n\t\tfunction fsError() {\n\t\t\tif ((isChromeIOS || (force && isSafari)) && view.FileReader) {\n\t\t\t\t// Safari doesn't allow downloading of blob urls\n\t\t\t\tconst reader = new FileReader();\n\t\t\t\treader.onloadend = function onLoadEnd() {\n\t\t\t\t\tlet url = isChromeIOS ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\n\t\t\t\t\tconst popup = view.open(url, '_blank');\n\t\t\t\t\tif ( !popup ) {\n\t\t\t\t\t\tview.location.href = url;\n\t\t\t\t\t}\n\t\t\t\t\turl = void 0; // Release reference before dispatching...\n\t\t\t\t\tself.readyState = self.DONE;\n\t\t\t\t\tdispatchAll();\n\t\t\t\t};\n\t\t\t\treader.readAsDataURL(blob);\n\t\t\t\tself.readyState = self.INIT;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Don't create more object URLs than needed:\n\t\t\tif ( !objectURL ) {\n\t\t\t\tobjectURL = getURL().createObjectURL( blob );\n\t\t\t}\n\t\t\tif ( force ) {\n\t\t\t\tview.location.href = objectURL;\n\t\t\t} else {\n\t\t\t\tconst opened = view.open( objectURL, '_blank' );\n\t\t\t\tif ( !opened ) {\n\t\t\t\t\t// Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\n\t\t\t\t\tview.location.href = objectURL;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.readyState = self.DONE;\n\t\t\tdispatchAll();\n\t\t\trevoke( objectURL );\n\t\t}\n\t\tself.readyState = self.INIT;\n\n\t\tif ( canUseSaveLink ) {\n\t\t\tobjectURL = getURL().createObjectURL(blob);\n\t\t\tsetImmediate(function save() {\n\t\t\t\tsaveLink.href = objectURL;\n\t\t\t\tsaveLink.download = name;\n\t\t\t\tclick( saveLink );\n\t\t\t\tdispatchAll();\n\t\t\t\trevoke( objectURL );\n\t\t\t\tself.readyState = self.DONE;\n\t\t\t}, 0);\n\t\t\treturn;\n\t\t}\n\n\t\tfsError();\n\t}\n\tconst proto = FileSaver.prototype;\n\tfunction saveAs( blob, name, noAutoBOM ) {\n\t\treturn new FileSaver( blob, name || blob.name || 'download', noAutoBOM );\n\t}\n\n\t// IE 10+ (native saveAs)\n\tif ( typeof navigator !== 'undefined' && navigator.msSaveOrOpenBlob ) {\n\t\treturn function saveAs( blob, name, noAutoBOM ) {\n\t\t\tname = name || blob.name || 'download';\n\t\t\tif ( !noAutoBOM ) {\n\t\t\t\tblob = autoBOM( blob );\n\t\t\t}\n\t\t\treturn navigator.msSaveOrOpenBlob(blob, name);\n\t\t};\n\t}\n\n\tproto.abort = function abort() {};\n\tproto.readyState = proto.INIT = 0;\n\tproto.WRITING = 1;\n\tproto.DONE = 2;\n\n\tproto.error = null;\n\tproto.onwritestart = null;\n\tproto.onprogress = null;\n\tproto.onwrite = null;\n\tproto.onabort = null;\n\tproto.onerror = null;\n\tproto.onwriteend = null;\n\n\treturn saveAs;\n}\n\nconst saveAs = saveFactory(\n\ttypeof self !== 'undefined' && self ||\n\ttypeof window !== 'undefined' && window ||\n\tthis.content\n);\n\n\n// EXPORTS //\n\nexport default saveAs;\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport floor from '@stdlib/math/base/special/floor';\n\n\n// MAIN //\n\n/**\n* Formats a timestamp in a human readable format.\n*\n* @param {number} timestamp - timestamp\n* @param {Object} [opts] - options\n* @param {string} [opts.hours] - hours\n* @param {string} [opts.minutes] - minutes\n* @param {string} [opts.seconds] - seconds\n* @returns {string} formatted timestamp\n*/\nconst formatTime = ( time, opts = { hours: true, minutes: true, seconds: true }) => {\n\ttime = time / 1000;\n\tconst hours = floor( time / ( 60*60 ) );\n\ttime = time % ( 60*60 );\n\tlet minutes = floor( time / 60 );\n\tif ( minutes < 10 ) {\n\t\tminutes = '0'+minutes;\n\t}\n\ttime = time % 60;\n\tlet seconds = floor( time );\n\tif ( seconds < 10 ) {\n\t\tseconds = '0'+seconds;\n\t}\n\tlet out = '';\n\tif ( opts.hours ) {\n\t\tout += hours;\n\t}\n\tif ( opts.minutes ) {\n\t\tif ( out ) {\n\t\t\tout += ':';\n\t\t}\n\t\tout += minutes;\n\t}\n\tif ( opts.seconds ) {\n\t\tif ( out ) {\n\t\t\tout += ':';\n\t\t}\n\t\tout += seconds;\n\t}\n\treturn out;\n};\n\n\n// EXPORTS //\n\nexport default formatTime;\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport isObject from '@stdlib/assert/is-object';\n\n\n// MAIN //\n\n/**\n* Validates if a user is an owner of the specified namespace.\n*\n* @param {Object} user - user object\n* @param {Object} namespace - namespace object\n* @returns {boolean} boolean indicating if the user is an owner of the namespace\n*/\nfunction isOwner( user, namespace ) {\n\tlet bool = false;\n\tfor ( let i = 0; i < namespace.owners.length; i++ ) {\n\t\tconst owner = namespace.owners[ i ];\n\t\tif ( isObject( owner ) ) {\n\t\t\tif ( owner.email === user.email ) {\n\t\t\t\tbool = true;\n\t\t\t}\n\t\t} else if ( owner === user.id ) {\n\t\t\t// Case: Owners array is not yet populated but contains only string IDs:\n\t\t\tbool = true;\n\t\t}\n\t}\n\treturn bool;\n}\n\n\n// EXPORTS //\n\nexport default isOwner;\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// VARIABLES //\n\nconst OPTS = {\n\tnumeric: true // Use numeric collation such that \"1\" < \"2\" < \"10\"...\n};\n\n\n// MAIN //\n\n/**\n* Sorts lessons according to the `search` object in place.\n*\n* @param {Array} lessons - a list of lessons\n* @param {Object} search - search object\n* @param {string} search.type - either `sequentially`, `alphabetically`, `created_at`, or `updated_at`\n* @param {string} search.direction - either `ascending` or `descending`\n*/\nfunction sortLessons( lessons, search ) {\n\tconst { type, direction } = search;\n\tif ( type === 'sequentially' ) {\n\t\tif ( direction === 'ascending' ) {\n\t\t\tlessons.sort( ( a, b ) => {\n\t\t\t\treturn a.pos - b.pos;\n\t\t\t});\n\t\t} else {\n\t\t\tlessons.sort( ( a, b ) => {\n\t\t\t\treturn b.pos - a.pos;\n\t\t\t});\n\t\t}\n\t}\n\telse if ( type === 'alphabetically' ) {\n\t\tif ( direction === 'ascending' ) {\n\t\t\tlessons.sort( ( a, b ) => {\n\t\t\t\tconst x = a.namespace + a.title;\n\t\t\t\tconst y = b.namespace + b.title;\n\t\t\t\treturn x.localeCompare( y, void 0, OPTS );\n\t\t\t});\n\t\t} else {\n\t\t\tlessons.sort( ( a, b ) => {\n\t\t\t\tconst x = a.namespace + a.title;\n\t\t\t\tconst y = b.namespace + b.title;\n\t\t\t\treturn y.localeCompare( x, void 0, OPTS );\n\t\t\t});\n\t\t}\n\t}\n\telse if ( type === 'created_at' ) {\n\t\tif ( direction === 'ascending' ) {\n\t\t\tlessons.sort( ( a, b ) => {\n\t\t\t\treturn a.createdAt.localeCompare( b.createdAt, void 0, OPTS );\n\t\t\t});\n\t\t} else {\n\t\t\tlessons.sort( ( a, b ) => {\n\t\t\t\treturn b.createdAt.localeCompare( a.createdAt, void 0, OPTS );\n\t\t\t});\n\t\t}\n\t}\n\telse if ( type === 'updated_at' ) {\n\t\tif ( direction === 'ascending' ) {\n\t\t\tlessons.sort( ( a, b ) => {\n\t\t\t\treturn a.updatedAt.localeCompare( b.updatedAt, void 0, OPTS );\n\t\t\t});\n\t\t} else {\n\t\t\tlessons.sort( ( a, b ) => {\n\t\t\t\treturn b.updatedAt.localeCompare( a.updatedAt, void 0, OPTS );\n\t\t\t});\n\t\t}\n\t}\n}\n\n\n// EXPORTS //\n\nexport default sortLessons;\n"],"names":["changedNamespace","title","owners","announcements","cohorts","description","enableTicketing","_id","type","CHANGED_NAMESPACE","payload","createNamespace","async","dispatch","props","res","axios","server","data","successful","addErrorNotification","Error","message","namespace","onNamespace","APPEND_CREATED_NAMESPACE","appendCreatedNamespace","history","replace","addNotification","level","err","createNamespaceInjector","deleteCurrentNamespace","id","DELETED_CURRENT_NAMESPACE","deletedCurrentNamespace","deleteCurrentNamespaceInjector","updateCurrentNamespace","ns","UPDATED_OWNED_NAMESPACE","updatedOwnedNamespace","getCohorts","namespaceID","updateCurrentNamespaceInjector","getNamespaceActionsInjector","namespaceTitle","qs","blob","Blob","name","saveAs","getNamespaceActions","adjustProgress","email","lessonID","progress","cohort","i18next","UPDATED_STUDENT_PROGRESS","updateStudentProgress","adjustProgressInjector","getAllNamespacesInjector","GET_ALL_NAMESPACES","namespaces","getAllNamespaces","setLessonOrderInjector","lessons","setLessonOrder","asyncComponent","connect","state","admin","user","copyLesson","copyLessonInjector","LessonCreator","debug","logger","preventPropagation","event","stopPropagation","DetailsModal","Component","constructor","unlockLesson","lockLesson","lockUntil","lockAfter","super","target","value","this","setState","length","disabled","checked","template","changedTemplate","hideFromDashboard","evt","preventDefault","details","newTitle","newDescription","update","Date","componentDidUpdate","prevProps","newState","isEmptyObject","render","t","Modal","show","onHide","close","Form","action","SERVER","method","onSubmit","onKeyDown","as","FormGroup","FormLabel","FormControl","onChange","handleInputChange","defaultValue","label","handleUnlockChange","minDate","handleTimeUntilChange","clearIcon","handleLockChange","handleTimeAfterChange","hideFromDashboardChange","administrator","handleTemplateChange","Button","onClick","variant","propTypes","PropTypes","defaultProps","DeleteModal","delete","IS_IOS","includes","navigator","platform","userAgent","document","addDefaultSrc","src","background","Lesson","query","lessonName","namespaceName","active","deactivateLesson","activateLesson","public","hideLessonInGallery","showLessonInGallery","deleteLesson","closeDeleteModal","updateLesson","getTime","closeDetailsModal","showDeleteModal","showDetailsModal","isleFile","getIsleFile","copyToClipboard","then","catch","url","img","window","location","open","focus","renderButtonToolbarDate","updated","updatedAt","toLocaleDateString","date","createdAt","className","OverlayTrigger","placement","overlay","Tooltip","alt","style","stroke","fill","upload","renderActivateButton","activeStyle","toLocaleString","Badge","opacity","toggleLessonState","renderButtonToolbar","publicStyle","ButtonToolbar","ButtonGroup","marginRight","size","onFocus","onMouseEnter","copyIsleFileToClipboard","float","toggleLessonVisibility","renderModals","Fragment","Card","padding","filter","COLORS","colorIndex","onMouseOver","showPreviewImage","ref","div","width","height","onError","cursor","role","tabIndex","copyNameToClipboard","onKeyPress","link","openLesson","copyLinkToClipboard","getLessons","withTranslation","EnrolledLesson","renderProgress","metadata","hideProgressBar","lessonData","min","round","ProgressBar","now","duration","spentTime","position","top","formatTime","appendix","writeAccess","Jumbotron","ResponsiveReactGridLayout","WidthProvider","Responsive","searchLessons","phrase","filteredLessons","isArray","i","contains","lowercase","push","createLayout","elemH","layouts","map","e","lg","x","y","floor","w","h","md","sm","xs","xxs","tiny","pluck","LessonsPage","idx","bool","code","repositionLessons","getTemplateLessons","showLessonCreator","course","isOwner","search","unfilteredLessons","activeElement","nextProps","prevState","direction","sortLessons","componentDidMount","shouldComponentUpdate","nextState","slice","lesson","left","tmp","pos","right","forceUpdate","renderLessons","key","input","handlePositionChangeFactory","templateButton","toggleCreator","onCreate","handleCreate","breakpoints","cols","containerPadding","isResizable","isBounded","isDraggable","rowHeight","addNotificationInjector","showLessonInGalleryInjector","hideLessonInGalleryInjector","activateLessonInjector","deactivateLessonInjector","updateLessonInjector","deleteLessonInjector","getLessonsInjector","getTemplateLessonsInjector","getIsleFileInjector","RE_AUTO_BOM","throwOutside","ex","setImmediate","autoBOM","test","String","fromCharCode","view","getURL","URL","webkitURL","revoke","file","setTimeout","revokeObjectURL","remove","saveLink","createElementNS","canUseSaveLink","isSafari","HTMLElement","safari","isChromeIOS","FileSaver","noAutoBOM","self","force","objectURL","dispatchAll","filesaver","eventTypes","concat","listener","call","split","readyState","INIT","createObjectURL","href","download","node","MouseEvent","dispatchEvent","click","DONE","FileReader","reader","onloadend","result","readAsDataURL","fsError","proto","prototype","msSaveOrOpenBlob","abort","WRITING","error","onwritestart","onprogress","onwrite","onabort","onerror","onwriteend","saveFactory","content","time","opts","hours","minutes","seconds","out","owner","isObject","OPTS","numeric","sort","a","b","localeCompare"],"sourceRoot":""}