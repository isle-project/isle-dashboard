"use strict";(self.webpackChunkisle_dashboard=self.webpackChunkisle_dashboard||[]).push([[6756],{49615:function(e,t,s){s.r(t),s.d(t,{default:function(){return He}});var a=s(38603),n=s(30322),i=s(91532),l=s.n(i),r=s(58651),o=s(16165),c=s.n(o),d=s(12630),m=s(14224),p=s(68137),h=s(65678),u=s(12908),g=s(69977),f=s(45014),E=s.n(f),k=s(14478),b=s.n(k),Z=s(22949),v=s.n(Z),y=s(89675),T=s.n(y),w=s(34980),C=s(221),N=s(63022),S=s(67289),R=s(85480),M=s(20328),P=s(30528),q=s(47331),F=s(87078),I=s(56233),D=s(72454),x=s(14704),H=s(15138),A=s.n(H),L=s(2561),U=s.n(L);function B(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class z extends a.Component{constructor(e){super(e),B(this,"requestTfaQRCode",(async()=>{const e=await this.props.getTfaQRCode();e&&this.setState({tfaQRCode:{__html:e.data}})})),B(this,"enableTfa",(()=>{this.props.enableTFA(this.state.token)})),B(this,"disableTfa",(()=>{this.props.disableTFA()})),B(this,"renderQRCode",(()=>{if(!this.state.tfaQRCode)return null;const e=this.props.t;return a.createElement(a.Fragment,null,a.createElement("div",{dangerouslySetInnerHTML:this.state.tfaQRCode}),a.createElement("p",null,e("tfa-enable-instructions")),a.createElement(M.Z,null,a.createElement(P.Z,{sm:8},a.createElement(F.Z,{autoFocus:!0,type:"text",onChange:e=>{this.setState({token:e.target.value})}})),a.createElement(P.Z,{sm:3},a.createElement(d.Z,{onClick:this.enableTfa,disabled:6!==this.state.token.length},e("common:confirm")))))})),this.state={token:""}}render(){const e=this.props.t;return this.props.user.twoFactorAuth?a.createElement(m.Z,{bg:"light",border:"success"},a.createElement(m.Z.Header,null,e("two-factor-authentication")),a.createElement(m.Z.Body,null,a.createElement("p",null,e("two-factor-authentication-is-enabled")),a.createElement(d.Z,{variant:"warning",style:{float:"right",marginRight:5},onClick:this.disableTfa},e("common:disable")))):a.createElement(m.Z,{bg:"light"},a.createElement(m.Z.Header,null,a.createElement("span",{className:"title"},e("common:two-factor-authentication"))),a.createElement(m.Z.Body,null,a.createElement("p",null,e("two-factor-authentication-is-disabled")),a.createElement(d.Z,{variant:"success",style:{float:"right",marginRight:5},onClick:this.requestTfaQRCode},a.createElement("i",{className:"fas fa-qrcode",style:{marginRight:10}}),e("common:enable")),this.renderQRCode()))}}z.propTypes={disableTFA:l().func.isRequired,enableTFA:l().func.isRequired,getTfaQRCode:l().func.isRequired,t:l().func.isRequired,user:l().object.isRequired},z.defaultProps={};var _=z;function O(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Q extends a.Component{constructor(e){super(e),O(this,"handleInputChange",(e=>{this.setState({token:e.target.value})})),O(this,"handleSubmit",(async()=>{await this.props.authenticate({writeAccessToken:this.state.token})&&this.props.onHide()})),this.state={token:null}}render(){return a.createElement(x.Z,{onHide:this.props.onHide,show:this.props.show},a.createElement(x.Z.Header,{closeButton:!0},a.createElement(x.Z.Title,{as:"h3"},"Enter Access Token")),a.createElement(x.Z.Body,null,a.createElement("div",null,"Please enter the write-access token that was sent to you. If you have not received it yet, please get in touch with ",a.createElement("a",{href:"mailto:pgb@andrew.cmu.edu"},"Philipp Burckhardt"),"."),a.createElement("br",null),a.createElement(D.Z,null,a.createElement(u.Z,{placement:"right",overlay:a.createElement(g.Z,{id:"ownerTooltip"},"Please enter the access token.")},a.createElement(I.Z,null,a.createElement(M.Z,null,a.createElement(P.Z,{sm:2},a.createElement(q.Z,null,"Token")),a.createElement(P.Z,{sm:10},a.createElement(F.Z,{name:"title",type:"text",placeholder:"Enter token",onChange:this.handleInputChange}))))))),a.createElement(x.Z.Footer,null,a.createElement(d.Z,{onClick:this.handleSubmit,disabled:!this.state.token},"Submit")))}}Q.propTypes={authenticate:l().func.isRequired,onHide:l().func.isRequired,show:l().bool.isRequired};var j=Q;function $(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const K=e=>a.createElement(g.Z,{id:"tooltip"},e),G=U()("isle-dashboard");class V extends a.Component{constructor(e){super(e),$(this,"handleUpdate",(()=>{const{name:e,password:t,passwordRepeat:s,organization:a,customFields:n}=this.state,i={name:e,organization:a};let l=!1;t&&s===t&&(l=!0,i.password=t),e===this.props.user.name&&a===this.props.user.organization||(l=!0),A()(n)||(i.customFields=n,l=!0),l&&(G("Update user..."),this.props.updateUser(i),this.props.onHide())})),$(this,"handleInputChange",(e=>{const t=e.target,s=t.value,a=t.name;this.setState({[a]:s,changed:!0})})),$(this,"getNameValidationState",(()=>{const{name:e}=this.state;return!!(e&&e.length>3)})),$(this,"getPasswordValidationState",(()=>{const{password:e,passwordRepeat:t}=this.state;return!(e.length<6||0===t.length)&&e===t})),$(this,"toggleTokenModal",(()=>{this.setState({showTokenModal:!this.state.showTokenModal})})),this.state={email:e.user.email,name:e.user.name,organization:e.user.organization,password:"",passwordRepeat:"",changed:!1,showTokenModal:!1,customFields:e.user.customFields||{}}}renderInstructorButton(){if(this.props.user.writeAccess)return null;const e=this.props.t;return a.createElement(d.Z,{onClick:this.toggleTokenModal,variant:"outline-success",style:{float:"right",marginRight:5}},e("get-instructor-access"))}render(){const e=this.getPasswordValidationState(),t=this.getNameValidationState(),s=this.state.password||this.state.passwordRepeat,n=this.props.user,i=this.props.t,l=this.state.customFields,r=n.availableCustomFields||[];return a.createElement(a.Fragment,null,a.createElement(x.Z,{show:this.props.show,onHide:this.props.onHide,dialogClassName:"edit-modal"},a.createElement(x.Z.Header,null,a.createElement(x.Z.Title,{as:"h3",style:{width:"100%"}},i("profile"),a.createElement(u.Z,{placement:"right",overlay:K(i("close-edit-modal"))},a.createElement(d.Z,{onClick:this.props.onHide,style:{float:"right"},variant:"outline-secondary","aria-label":i("close-edit-modal"),className:"modal-close"},a.createElement("span",{"aria-hidden":"true"},"x"))),this.renderInstructorButton())),a.createElement(x.Z.Body,null,a.createElement(D.Z,{as:M.Z},a.createElement(P.Z,{sm:6},a.createElement(I.Z,{controlId:"form-email"},a.createElement(q.Z,{style:{width:"100%"}},i("common:email"),n.verifiedEmail?null:a.createElement(R.Z,{variant:"danger",style:{float:"right"}},i("common:email-not-verified"),a.createElement(u.Z,{placement:"right",overlay:K(i("resend-confirm-email"))},a.createElement(d.Z,{"aria-label":i("resend-confirm-email"),size:"sm",variant:"outline-light",onClick:this.props.resendConfirmEmail,style:{fontSize:12,marginLeft:6}},a.createElement("i",{className:"fas fa-redo-alt"}))))),a.createElement(F.Z,{name:"email",type:"email",value:this.state.email,disabled:!0})),a.createElement(u.Z,{placement:"right",overlay:K(i("update-name"))},a.createElement(I.Z,{controlId:"form-name"},a.createElement(q.Z,null,i("common:name")),a.createElement(F.Z,{name:"name",type:"text",value:this.state.name,onChange:this.handleInputChange,isInvalid:!t}),a.createElement(D.Z.Control.Feedback,{type:"invalid"},i("invalid-name")))),a.createElement(u.Z,{placement:"right",overlay:K(i("update-organization"))},a.createElement(I.Z,{controlId:"form-organization"},a.createElement(q.Z,null,i("common:organization")),a.createElement(F.Z,{name:"organization",type:"text",value:this.state.organization,onChange:this.handleInputChange}))),r.filter((e=>e.showOnProfile||e.editableOnProfile)).map(((e,t)=>{let s;const n=l[e.name];return s="checkbox"===e.type?a.createElement(D.Z.Check,{type:"checkbox",label:e.name,defaultChecked:n,disabled:!e.editableOnProfile,onChange:t=>{const s={...this.state.customFields};s[e.name]=t.target.checked,this.setState({customFields:s,changed:!0})}}):"text"===e.type?a.createElement(I.Z,{controlId:`form-${e.name}`},a.createElement(q.Z,null,e.name),a.createElement(F.Z,{name:e.name,type:"text",value:n,placeholder:`Enter ${e.name}...`,disabled:!e.editableOnProfile,onChange:t=>{const s={...this.state.customFields};s[e.name]=t.target.value,this.setState({customFields:s,changed:!0})},autoComplete:"none"})):a.createElement(I.Z,{controlId:`form-${e.name}`},a.createElement(q.Z,null,e.name),a.createElement(S.ZP,{defaultValue:n?{label:n,value:n}:null,disabled:!e.editableOnProfile,options:e.options.map((e=>({value:e,label:e}))),onChange:t=>{const s={...this.state.customFields};s[e.name]=t.value,this.setState({customFields:s,changed:!0})}})),a.createElement(u.Z,{key:t,placement:"top",overlay:K(e.description)},s)}))),a.createElement(P.Z,{sm:6},a.createElement(u.Z,{placement:"right",overlay:K(i("enter-password"))},a.createElement(I.Z,{controlId:"form-password"},a.createElement(q.Z,null,i("common:password")),a.createElement(F.Z,{name:"password",type:"password",value:this.state.password,autoComplete:"none",placeholder:i("common:choose-new-password"),onChange:this.handleInputChange,maxLength:30,minLength:6,isInvalid:s&&!e}),a.createElement(D.Z.Control.Feedback,{type:"invalid"},"Please enter a new password with at least six characters."))),a.createElement(I.Z,{controlId:"form-repeat-password"},a.createElement(F.Z,{name:"passwordRepeat",type:"password",value:this.state.passwordRepeat,autoComplete:"none",placeholder:i("repeat-new-password"),onChange:this.handleInputChange,maxLength:30,minLength:6,isInvalid:s&&!e}),a.createElement(D.Z.Control.Feedback,{type:"invalid"},i("invalid-password"))),a.createElement("hr",null),a.createElement(_,{user:this.props.user,t:this.props.t,disableTFA:this.props.disableTFA,enableTFA:this.props.enableTFA,getTfaQRCode:this.props.getTfaQRCode}))),a.createElement(M.Z,{style:{paddingTop:10}},a.createElement(d.Z,{block:!0,disabled:!this.state.changed||!t||!e&&s,onClick:this.handleUpdate},i("common:update"))))),a.createElement(j,{user:n,authenticate:this.props.authenticate,show:this.state.showTokenModal,onHide:this.toggleTokenModal}))}}V.propTypes={authenticate:l().func.isRequired,disableTFA:l().func.isRequired,enableTFA:l().func.isRequired,getTfaQRCode:l().func.isRequired,onHide:l().func.isRequired,resendConfirmEmail:l().func.isRequired,show:l().bool.isRequired,t:l().func.isRequired,updateUser:l().func.isRequired,user:l().object.isRequired},V.defaultProps={};var J=V,W=s(66797);class X extends a.Component{shouldComponentUpdate(e){return e.selectedNamespaceID!==this.props.selectedNamespaceID}render(){const{selectedNamespace:e,lessonData:t}=this.props;if(!e||!t)return null;const s=e.lessons;if(!s)return null;const n={};for(let a=0;a<s.length;a++){const e=s[a]._id;if(t[e]){const s=t[e].actionTypes;if(s){const e=E()(s);for(let t=0;t<e.length;t++){const a=e[t];n[a]?n[a]+=s[a]:n[a]=s[a]}}}}const i=E()(n),l=new Array(i.length);for(let r=0;r<i.length;r++){const e=i[r],t=n[i[r]];l[r]=a.createElement("tr",{key:r},a.createElement("td",null,e),a.createElement("td",null,t))}return a.createElement(W.Z,{size:"sm",striped:!0,style:{fontSize:"0.8rem"}},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Action Type"),a.createElement("th",null,"Count"))),a.createElement("tbody",null,l))}}X.propTypes={lessonData:l().object,selectedNamespace:l().object,selectedNamespaceID:l().string},X.defaultProps={lessonData:null,selectedNamespace:null,selectedNamespaceID:""};var Y=X,ee=s(71191),te=s(77536),se=s(13938),ae=s.n(se);function ne(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ie=U()("isle:toolbar:ticketing"),le=e=>({value:e,label:e.title});class re extends a.Component{constructor(e){super(e),ne(this,"attachFile",(()=>{const e=document.createElement("input");e.type="file",e.onchange=e=>{const t=e.target.files,s=[...this.state.files,...t];this.setState({files:s})},e.click()})),ne(this,"handleTitleChange",(e=>{this.setState({title:e.target.value})})),ne(this,"handleDescriptionChange",(e=>{this.setState({description:e.target.value})})),ne(this,"handleCourseChange",(e=>{this.setState({selectedCourse:e})})),ne(this,"handleSubmit",(async()=>{ie("Create ticket..."),await this.props.createTicket({title:this.state.title,description:this.state.description,platform:{name:ae().name,version:ae().version,product:ae().product,manufacturer:ae().manufacturer,os:ae().os,description:ae().description},namespace:this.state.selectedCourse.value,files:this.state.files}),this.props.onHide()})),ne(this,"removeFileFactory",(e=>()=>{const t=this.state.files.slice();t.splice(e,1),this.setState({files:t})})),this.state={title:"",description:"",selectedCourse:e.enrolledNamespaces?le(e.enrolledNamespaces[0]):null,files:[]}}renderAttachments(){return 0===this.state.files.length?null:a.createElement(a.Fragment,null,a.createElement("span",{className:"title"},this.props.t("attachments"),":"),a.createElement(ee.Z,{className:"ticketing-attachment-list"},this.state.files.map(((e,t)=>a.createElement(ee.Z.Item,{key:`file-${t}`},e.name,a.createElement(d.Z,{variant:"danger",size:"sm",onClick:this.removeFileFactory(t),style:{float:"right"}},"x"))))))}render(){const{t:e}=this.props;return a.createElement(x.Z,{onHide:this.props.onHide,show:this.props.show,dialogClassName:"modal-40w"},a.createElement(x.Z.Header,{closeButton:!0},a.createElement(x.Z.Title,{as:"h3"},e("new-ticket"))),a.createElement(x.Z.Body,null,a.createElement("p",null,e("ticketing-intro")),a.createElement(I.Z,null,a.createElement(q.Z,null,e("common:course"),":"),a.createElement(S.ZP,{options:this.props.enrolledNamespaces.map(le),onChange:this.handleCourseChange,value:this.state.selectedCourse})),a.createElement(I.Z,null,a.createElement(q.Z,null,e("common:title"),":"),a.createElement(F.Z,{type:"text",placeholder:e("ticket-title-placeholder"),onChange:this.handleTitleChange})),a.createElement(I.Z,{controlId:"form-text"},a.createElement(q.Z,null,e("common:description"),":"),a.createElement(F.Z,{name:"body",type:"text",as:"textarea",rows:"5",placeholder:e("ticket-description-placeholder"),value:this.state.description,onChange:this.handleDescriptionChange})),this.renderAttachments()),a.createElement(x.Z.Footer,null,a.createElement(u.Z,{placement:"left",overlay:a.createElement(g.Z,{id:"attachmentTooltip"},e("attach-file"))},a.createElement(d.Z,{onClick:this.attachFile},a.createElement("i",{className:"fas fa-paperclip"}))),a.createElement(d.Z,{onClick:this.props.onHide},e("common:cancel")),a.createElement(d.Z,{onClick:this.handleSubmit},e("create-ticket"))))}}re.propTypes={createTicket:l().func.isRequired,enrolledNamespaces:l().array,onHide:l().func.isRequired,show:l().bool.isRequired},re.defaultProps={enrolledNamespaces:[]};var oe=re;function ce(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const de=/ticket=([^&]*)/;class me extends a.Component{constructor(e){super(e),ce(this,"toggleCreateModal",(()=>{this.setState({showCreateModal:!this.state.showCreateModal})})),ce(this,"toggleTicketModal",(()=>{this.setState({showMessagesModal:!this.state.showMessagesModal})})),ce(this,"toggleShowAll",(()=>{this.setState({showOpen:!this.state.showOpen})})),this.state={showCreateModal:!1,showMessagesModal:!1,showOpen:!0}}async componentDidMount(){if(await this.props.getUserTickets(),this.props.history&&this.props.history.location.search){const e=de.exec(this.props.history.location.search);if(e&&e[1]){const{tickets:t}=this.props.user;if(t)for(let s=0;s<t.length;s++){const a=t[s];if(a._id===e[1]){this.setState({selectedTicket:a,showMessagesModal:!0});break}}}}}renderTicketList(){const e=[],{user:t,t:s}=this.props;if(!t)return null;const{tickets:n}=t;if(!n)return null;if(this.state.showOpen)for(let i=0;i<n.length;i++){const t=n[i];!0!==t.done&&e.push(a.createElement(ee.Z.Item,{key:`ticket-${i}`},t.title,": ",t.description,a.createElement(u.Z,{placement:"bottom",overlay:a.createElement(g.Z,{id:"ticket-status-tooltip"},s("common:close-ticket"))},a.createElement(d.Z,{variant:"outline-secondary",size:"sm",style:{float:"right",marginLeft:6},onClick:()=>{this.props.closeTicket(t._id)}},a.createElement("i",{className:"far fa-square"}))),a.createElement(d.Z,{size:"sm",variant:"outline-secondary",style:{float:"right"},onClick:()=>{this.setState({selectedTicket:t},this.toggleTicketModal)}},s("common:messages"),a.createElement(R.Z,{className:"ticket-badge",variant:"secondary"},t.messages.length))))}else for(let i=0;i<n.length;i++){const t=n[i];!1!==t.done&&e.push(a.createElement(ee.Z.Item,{key:`ticket-${i}`},t.title,": ",t.description,a.createElement(u.Z,{placement:"bottom",overlay:a.createElement(g.Z,{id:"ticket-status-tooltip"},s("common:open-ticket"))},a.createElement(d.Z,{variant:"outline-secondary",size:"sm",style:{float:"right",marginLeft:6},onClick:()=>{this.props.openTicket(t._id)}},a.createElement("i",{className:"far fa-check-square"}))),a.createElement(d.Z,{size:"sm",variant:"outline-secondary",style:{float:"right"},onClick:()=>{this.setState({selectedTicket:t},this.toggleTicketModal)}},s("common:messages"),a.createElement(R.Z,{className:"ticket-badge",variant:"secondary"},t.messages.length))))}return a.createElement(ee.Z,null,e)}render(){const{t:e}=this.props,t=this.props.user.enrolledNamespaces.filter((e=>e.enableTicketing));return a.createElement(a.Fragment,null,a.createElement(x.Z,{onHide:this.props.onHide,show:this.props.show,dialogClassName:"modal-40w"},a.createElement(x.Z.Header,{closeButton:!0},a.createElement(x.Z.Title,{as:"h3"},e("my-tickets"))),a.createElement(x.Z.Body,null,this.renderTicketList()),a.createElement(x.Z.Footer,null,a.createElement(d.Z,{onClick:this.toggleShowAll},this.state.showOpen?e("show-completed-tickets"):e("show-open-tickets")),a.createElement(d.Z,{onClick:this.toggleCreateModal},e("new-ticket")),a.createElement(d.Z,{onClick:this.props.onHide},e("common:close")))),this.state.showCreateModal?a.createElement(oe,{show:this.state.showCreateModal,onHide:this.toggleCreateModal,enrolledNamespaces:t,createTicket:this.props.createTicket,t:e}):null,this.state.showMessagesModal?a.createElement(te.Z,{show:this.state.showMessagesModal,onHide:this.toggleTicketModal,ticket:this.state.selectedTicket,submitTicketMessage:this.props.submitTicketMessage,closeTicket:this.props.closeTicket,openTicket:this.props.openTicket}):null)}}me.propTypes={closeTicket:l().func.isRequired,createTicket:l().func.isRequired,getUserTickets:l().func.isRequired,onHide:l().func.isRequired,openTicket:l().func.isRequired,show:l().bool.isRequired,submitTicketMessage:l().func.isRequired,user:l().object.isRequired};var pe=me,he=s(41565),ue=s(27695),ge=s(42270);s(87196);function fe(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Ee=(0,C.Z)((()=>s.e(9732).then(s.bind(s,9732)))),ke=(0,C.Z)((()=>Promise.all([s.e(9671),s.e(9807),s.e(4866)]).then(s.bind(s,14866)))),be=(0,C.Z)((()=>Promise.all([s.e(9671),s.e(9807),s.e(8758)]).then(s.bind(s,28758))));function Ze(e,t){if(!e)return"";for(let s=0;s<e.length;s++)if(e[s]._id===t)return e[s].title;return""}class ve extends a.Component{constructor(e){super(e),fe(this,"toggleEditModal",(()=>{this.setState({showEditModal:!this.state.showEditModal})})),fe(this,"toggleTicketListModal",(()=>{this.setState({showTicketListModal:!this.state.showTicketListModal})})),fe(this,"toggleProfilePicModal",(()=>{this.setState({showProfilePicModal:!this.state.showProfilePicModal})})),fe(this,"handleSelect",((e,t)=>{const s=t.target.title,a=t.target.dataset.id;this.setState({selectedNamespaceID:e,selectedNamespace:this.props.user.enrolledNamespaces[a]},(()=>{const e=this.props.user.enrolledNamespaces[a];b()(e.lessons[0])||this.props.getLessons(s)}))})),fe(this,"handleStatsSelect",((e,t)=>{this.setState({selectedStatsType:e})})),fe(this,"handleDataSelect",((e,t)=>{this.setState({selectedDataType:e})})),fe(this,"submitTicketMessage",(({message:e,ticketID:t})=>{this.props.sendTicketMessage({message:e,ticketID:t,user:this.props.user})}));let t=null,s=null;e.user.enrolledNamespaces.length>0&&(t=e.user.enrolledNamespaces[0],s=t._id),this.state={showEditModal:!1,showProfilePicModal:!1,showTicketListModal:!1,selectedNamespace:t,selectedNamespaceID:s,selectedDataType:"messages",selectedStatsType:"progress"}}componentDidMount(){this.props.user.files||this.props.getUserFiles();const e=this.state.selectedNamespace;e&&this.props.getLessons(e.title),this.props.getUserBadges()}renderRightPanel(){return this.state.selectedNamespace?"progress"===this.state.selectedStatsType?a.createElement(be,{user:this.props.user,selectedNamespace:this.state.selectedNamespace}):"timeSpent"===this.state.selectedStatsType?a.createElement(ke,{user:this.props.user,selectedNamespace:this.state.selectedNamespace}):void 0:null}renderLeftPanel(){if(!this.state.selectedNamespace)return null;if("files"===this.state.selectedDataType)return this.renderFiles();if("actions"===this.state.selectedDataType){const e=this.props.user.lessonData;return a.createElement(Y,{lessonData:e,selectedNamespace:this.state.selectedNamespace,selectedNamespaceID:this.state.selectedNamespaceID})}return"messages"===this.state.selectedDataType?this.renderMessages():void 0}renderFiles(){const{t:e,user:t}=this.props;let s=t.files;if(s&&(s=s[this.state.selectedNamespaceID]),!v()(s))return null;const n=[];for(let i=0;i<s.length;i++){const t=s[i],l=Ze(this.state.selectedNamespace.lessons,t.lesson);let r="fas fa-file-image fa-4x";switch(c().extname(t.filename)){case".html":r="fab fa-html5 fa-4x";break;case".pdf":r="far fa-file-pdf fa-4x";break;case".jpg":r="fas fa-file-image fa-4x"}n.push(a.createElement(p.Z,{key:i},a.createElement("div",{className:"mr-3"},a.createElement("a",{href:N.ZP+"/"+t.filename,target:"_blank",rel:"noopener noreferrer"},a.createElement("i",{className:r}))),a.createElement(p.Z.Body,null,a.createElement("a",{href:N.ZP+"/"+t.filename,target:"_blank",rel:"noopener noreferrer"},a.createElement("h4",null,t.title)),a.createElement("p",null,e("common:date"),": ",new Date(t.createdAt).toLocaleDateString(),l?`, ${e("common:lesson")}: ${l}`:l))))}return n}renderMessages(){return this.state.selectedNamespace.announcements?a.createElement("div",null,this.state.selectedNamespace.announcements.map(((e,t)=>{const s=new Date(e.createdAt),n=s.toLocaleDateString()+"  -  "+s.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"});return a.createElement("div",{key:t,className:"message-container"},a.createElement("div",{className:"message-data"},a.createElement("div",{className:"message-profile-pic"},a.createElement("img",{src:e.picture,alt:"Message User Profile"})),a.createElement("div",{className:"message-author-line"},a.createElement("span",{className:"message-author"},e.author," "),"wrote on ",n)),a.createElement("div",{className:"message-title"},e.title),a.createElement("div",{className:"message-body"},e.body))}))):null}renderStatisticDataToolbar(){const{t:e}=this.props;return a.createElement(h.Z,{variant:"tabs",activeKey:this.state.selectedDataType,onSelect:this.handleDataSelect},a.createElement(h.Z.Item,null,a.createElement(h.Z.Link,{eventKey:"messages",title:e("messages")},e("messages"))),a.createElement(h.Z.Item,null,a.createElement(h.Z.Link,{eventKey:"files",title:e("common:files")},e("common:files"))),a.createElement(h.Z.Item,null,a.createElement(h.Z.Link,{eventKey:"actions",title:e("actions")},e("actions"))))}renderStatisticStatsToolbar(){const{t:e}=this.props;return a.createElement(h.Z,{variant:"tabs",activeKey:this.state.selectedStatsType,onSelect:this.handleStatsSelect},a.createElement(h.Z.Item,null,a.createElement(h.Z.Link,{eventKey:"progress",title:e("progress")},e("progress"))),a.createElement(h.Z.Item,null,a.createElement(h.Z.Link,{eventKey:"timeSpent",title:e("time-spent")},e("time-spent"))))}renderStatisticSection(){const{t:e,user:t}=this.props,s=t.enrolledNamespaces;return a.createElement("div",{className:"profile-page-statistics"},a.createElement("div",{className:"profile-page-statistics-navigation-title"},e("common:courses")),a.createElement("div",{className:"profile-page-statistics-navigation"},a.createElement(h.Z,{variant:"tabs",activeKey:this.state.selectedNamespaceID,onSelect:this.handleSelect},s.map(((e,t)=>{const s=e.title,n=e._id;return a.createElement(h.Z.Item,{key:t},a.createElement(h.Z.Link,{eventKey:n,title:s,"data-id":t},s))})))),a.createElement("div",{className:"profile-page-statistics-data-select"},e("common:data")),a.createElement("div",{className:"profile-page-statistics-top-actions"},this.state.selectedNamespaceID?this.renderStatisticDataToolbar():null),a.createElement("div",{className:"profile-page-statistics-title2"},e("common:statistics")),a.createElement("div",{className:"profile-page-statistics-actions"},this.renderLeftPanel()),a.createElement("div",{className:"profile-page-statistics-select"},this.state.selectedNamespaceID?this.renderStatisticStatsToolbar():null),a.createElement("div",{className:"profile-page-statistics-stats"},this.renderRightPanel()))}renderBadgesSection(){let e=[],t=this.props.user.badges||[];for(let s=0;s<24;s++){let n=ue,i="Hidden Badge",l="profile-page-badge-item-interior unknown",r="badge-not-acquired";s<t.length&&(n=N.ZP+"/badges/"+t[s].picture,i=t[s].description,l="profile-page-badge-item-interior",t[s].acquired&&(r="badge-acquired")),e.push(a.createElement("div",{style:{animation:"scale-up "+(.05*s+.1)+"s"},className:"profile-page-badge-item-nova",key:s},a.createElement(u.Z,{placement:"top",overlay:a.createElement(g.Z,{id:`badge-${s}-description`},i)},a.createElement("div",{className:"profile-page-badge-item"},a.createElement("img",{className:"mask",src:ge,alt:""}),a.createElement("div",{className:l},a.createElement("img",{className:r,src:n,alt:"User Badge"}))))))}return e}renderUserSection(){const{t:e,user:t}=this.props;let s=null;t.createdAt&&(s=new Date(t.createdAt).toLocaleDateString());let n=he;t.picture&&(n=t.picture);const i=T()(this.props.user.enrolledNamespaces,(e=>e.enableTicketing)),l=E()(t.lessonData).length;return a.createElement("div",{className:"profile-page-user-container"},a.createElement("div",{role:"button",className:"profile-page-user-portrait",onClick:this.toggleProfilePicModal,onKeyPress:this.toggleProfilePicModal,tabIndex:0},a.createElement("img",{alt:"User Profile",src:n})),a.createElement("div",{className:"profile-page-user-personal"},a.createElement("div",{className:"profile-page-user-personal-name"},a.createElement(m.Z,null,a.createElement(m.Z.Header,null,a.createElement(m.Z.Title,{as:"h3"},t.name," ",a.createElement("br",null),t.organization?a.createElement("small",null,t.organization):null),s?a.createElement("div",null,e("registered-since",{date:s})):null),a.createElement(m.Z.Body,null,a.createElement("div",{className:"profile-page-user-values"},a.createElement("div",{className:"profile-page-user-legend"},e("score")),a.createElement("div",{className:"profile-page-user-value"},t.score),a.createElement("div",{className:"profile-page-user-legend"},e("no-lessons")),a.createElement("div",{className:"profile-page-user-value"},l),a.createElement("div",{className:"profile-page-user-legend"},e("time-spent")),a.createElement("div",{className:"profile-page-user-value"},(0,w.Z)(t.spentTime))))),a.createElement("div",null,a.createElement(d.Z,{style:{marginTop:15},block:!0,onClick:this.toggleEditModal},e("edit-profile")),i?a.createElement(d.Z,{style:{marginTop:15},block:!0,onClick:this.toggleTicketListModal},e("show-tickets")):null))),a.createElement("div",{className:"profile-page-user-footer"}))}render(){const{t:e}=this.props;return a.createElement(a.Fragment,null,a.createElement("div",{className:"profile-page-grid-container"},a.createElement("div",{className:"profile-page-left"},this.renderUserSection()),this.renderStatisticSection(),a.createElement("div",{className:"profile-page-badge-title"},e("common:badges")),a.createElement("div",{className:"profile-page-badge-container"},this.renderBadgesSection())),a.createElement(J,{user:this.props.user,authenticate:this.props.authenticate,show:this.state.showEditModal,addNotification:this.props.addNotification,updateUser:this.props.updateUser,onHide:this.toggleEditModal,resendConfirmEmail:this.props.resendConfirmEmail,disableTFA:this.props.disableTFA,enableTFA:this.props.enableTFA,getTfaQRCode:this.props.getTfaQRCode,t:e}),a.createElement(pe,{createTicket:this.props.createTicket,show:this.state.showTicketListModal,onHide:this.toggleTicketListModal,getUserTickets:this.props.getUserTickets,user:this.props.user,submitTicketMessage:this.submitTicketMessage,closeTicket:this.props.closeTicket,openTicket:this.props.openTicket,history:this.props.history,t:e}),a.createElement(Ee,{user:this.props.user,show:this.state.showProfilePicModal,onHide:this.toggleProfilePicModal,uploadProfilePic:this.props.uploadProfilePic,t:e}))}}ve.propTypes={addNotification:l().func.isRequired,authenticate:l().func.isRequired,closeTicket:l().func.isRequired,createTicket:l().func.isRequired,disableTFA:l().func.isRequired,enableTFA:l().func.isRequired,getLessons:l().func.isRequired,getTfaQRCode:l().func.isRequired,getUserBadges:l().func.isRequired,getUserFiles:l().func.isRequired,getUserTickets:l().func.isRequired,openTicket:l().func.isRequired,resendConfirmEmail:l().func.isRequired,sendTicketMessage:l().func.isRequired,updateUser:l().func.isRequired,uploadProfilePic:l().func.isRequired,user:l().object.isRequired},ve.defaultProps={};var ye=(0,r.Z)(["profile_page","common"])(ve),Te=s(39029),we=s(64193),Ce=s(40024),Ne=s(96162),Se=s(76417),Re=s(44804),Me=s(98816),Pe=s.n(Me),qe=s(67361),Fe=s(1209);const Ie=e=>async()=>{const t=await(async e=>{try{const t=await Pe().get(N.ZP+"/get_tfa_qrcode");return e({type:Fe.Bu,payload:{events:t.data.events}}),t}catch(t){return(0,Se.EG)(e,t)}})(e);return t},De=e=>async t=>{await(async(e,t)=>{try{const s=await Pe().post(N.ZP+"/enable_tfa",{token:t});(0,Se.wN)(e,{title:s.data.verified?qe.Z.t("common:tfa-enabled"):qe.Z.t("common:tfa-not-enabled"),message:s.data.message,level:s.data.verified?"success":"error"}),e({type:Fe.E4,payload:{verified:s.data.verified}})}catch(s){return(0,Se.EG)(e,s)}})(e,t)},xe=e=>async()=>{await(async e=>{try{const t=await Pe().post(N.ZP+"/disable_tfa");(0,Se.wN)(e,{title:qe.Z.t("common:tfa-disabled"),message:t.data.message,level:"success"}),e({type:Fe.oF,payload:{message:t.data.message,disabled:t.data.disabled}})}catch(t){return(0,Se.EG)(e,t)}})(e)};var He=(0,n.$j)((function(e){return{user:e.user}}),(function(e){return{addNotification:(0,Se.pP)(e),createTicket:(0,Re.Cn)(e),getUserBadges:(0,we.fH)(e),updateUser:(0,Ne.vi)(e),authenticate:(0,Ne.m8)(e),getUserFiles:(0,Ce.f2)(e),getLessons:(0,Te.Hy)(e),resendConfirmEmail:(0,Ne.WA)(e),sendTicketMessage:(0,Re.fG)(e),closeTicket:(0,Re.xG)(e),openTicket:(0,Re.mJ)(e),getUserTickets:(0,Re.S$)(e),uploadProfilePic:(0,Ne.UA)(e),enableTFA:De(e),disableTFA:xe(e),getTfaQRCode:Ie(e)}}))(ye)},42270:function(e,t,s){e.exports=s.p+"static/media/d94dd9bbaddc0c1000d4.svg"},27695:function(e,t,s){e.exports=s.p+"static/media/4a50b186a7dd3b0400ec.svg"},41565:function(e,t,s){e.exports=s.p+"static/media/b28478deeaed54279dc6.jpg"}}]);
//# sourceMappingURL=6756.9a133608.chunk.js.map