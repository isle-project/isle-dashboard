"use strict";(self.webpackChunkisle_dashboard=self.webpackChunkisle_dashboard||[]).push([[195],{87594:function(module,__unused_webpack_exports,__webpack_require__){var trim=__webpack_require__(84001);module.exports=trim},84001:function(module,__unused_webpack_exports,__webpack_require__){var isString=__webpack_require__(99301).isPrimitive,replace=__webpack_require__(51594),RE=/^[\u0020\f\n\r\t\v\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]*([\S\s]*?)[\u0020\f\n\r\t\v\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]*$/;function trim(str){if(!isString(str))throw new TypeError("invalid argument. Must provide a string primitive. Value: `"+str+"`.");return replace(str,RE,"$1")}module.exports=trim},93390:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _stdlib_string_trim__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(87594),_stdlib_string_trim__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_stdlib_string_trim__WEBPACK_IMPORTED_MODULE_0__),_stdlib_utils_keys__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(25351),_stdlib_utils_keys__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_stdlib_utils_keys__WEBPACK_IMPORTED_MODULE_1__);const RE_NUMBER=/^\s*[+-]?[\d.]+e?[+-]?\d*\s*$/;function obsToVar(arr){const data={},keymap={},columnNames=_stdlib_utils_keys__WEBPACK_IMPORTED_MODULE_1___default()(arr[0]).filter(x=>x!=="");for(let i=0;i<columnNames.length;i++){const col=_stdlib_string_trim__WEBPACK_IMPORTED_MODULE_0___default()(columnNames[i]);keymap[columnNames[i]]=col,data[col]=new Array(arr.length)}for(let i=0;i<arr.length;i++)for(let j=0;j<columnNames.length;j++){const col=columnNames[j];let val=arr[i][col];RE_NUMBER.test(val)&&(val=Number(val)),data[keymap[col]][i]=val}return data}__webpack_exports__.Z=obsToVar},35811:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(67294),prop_types__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(45697),prop_types__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_15__),debug__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(11227),debug__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(debug__WEBPACK_IMPORTED_MODULE_1__),react_i18next__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(81468),moment__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(30381),moment__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_2__),react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(89876),react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_14__),react_bootstrap_OverlayTrigger__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(99201),react_bootstrap_OverlayTrigger__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(react_bootstrap_OverlayTrigger__WEBPACK_IMPORTED_MODULE_12__),react_bootstrap_Tooltip__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(18868),react_bootstrap_Tooltip__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(react_bootstrap_Tooltip__WEBPACK_IMPORTED_MODULE_13__),_stdlib_constants_float64_pinf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(51235),_stdlib_constants_float64_pinf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_stdlib_constants_float64_pinf__WEBPACK_IMPORTED_MODULE_3__),components_dashboard_table__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1624),components_confirm_modal__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(88608),_isle_project_utils_obs_to_var__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(93390),ev_components_data_explorer__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(63787),utils_text_filter_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(31190),utils_create_users_column_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(4859),utils_create_numeric_column_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(56739),utils_create_date_column_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(30691),__defProp=Object.defineProperty,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField=(obj,key,value)=>(__defNormalProp(obj,typeof key!="symbol"?key+"":key,value),value),__async=(__this,__arguments,generator)=>new Promise((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())});const debug=debug__WEBPACK_IMPORTED_MODULE_1___default()("isle-dashboard:admin");class ProgramPage extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),__publicField(this,"createColumns",()=>{const{t}=this.props,programs=this.props.admin.programs||[];let maxOwners=0,minTime=_stdlib_constants_float64_pinf__WEBPACK_IMPORTED_MODULE_3___default(),maxTime=0;for(let i=0;i<programs.length;i++){const nOwners=programs[i].owners.length;nOwners&&nOwners>maxOwners&&(maxOwners=nOwners),programs[i].createdAt>maxTime&&(maxTime=programs[i].createdAt),programs[i].updatedAt>maxTime&&(maxTime=programs[i].updatedAt),programs[i].createdAt<minTime&&(minTime=programs[i].createdAt),programs[i].updatedAt<minTime&&(minTime=programs[i].updatedAt)}return maxTime=moment__WEBPACK_IMPORTED_MODULE_2___default()(maxTime),minTime=moment__WEBPACK_IMPORTED_MODULE_2___default()(minTime),[{Header:t("common:title"),id:"title",accessor:"title",maxWidth:200,style:{marginTop:"8px",color:"darkslategrey"},filterMethod:utils_text_filter_js__WEBPACK_IMPORTED_MODULE_8__.Z},{Header:t("common:description"),accessor:"description",style:{marginTop:"2px",color:"darkslategrey"},maxWidth:200,filterMethod:utils_text_filter_js__WEBPACK_IMPORTED_MODULE_8__.Z},(0,utils_create_users_column_js__WEBPACK_IMPORTED_MODULE_9__.Z)({Header:t("common:owners"),accessor:"owners"}),(0,utils_create_numeric_column_js__WEBPACK_IMPORTED_MODULE_10__.Z)({Header:`# ${t("common:owners")}`,accessor:"owners.length",maxWidth:120,style:{marginTop:"2px",color:"darkslategrey"},minValue:1,maxValue:maxOwners}),(0,utils_create_date_column_js__WEBPACK_IMPORTED_MODULE_11__.Z)({Header:t("last-updated"),accessor:"updatedAt",startDate:minTime,endDate:maxTime,t}),(0,utils_create_date_column_js__WEBPACK_IMPORTED_MODULE_11__.Z)({Header:t("created-at"),accessor:"createdAt",startDate:minTime,endDate:maxTime,t}),{Header:t("common:actions"),Cell:row=>react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_OverlayTrigger__WEBPACK_IMPORTED_MODULE_12___default(),{placement:"bottom",overlay:react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Tooltip__WEBPACK_IMPORTED_MODULE_13___default(),{id:"delete_course"},t("program:delete-program"))},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_14___default(),{variant:"outline-secondary",style:{marginLeft:8},onClick:this.askToDeleteSelectedProgramFactory(row.row._original),"aria-label":t("program:delete-program")},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"fa fa-trash-alt"})))),resizable:!1,filterable:!1,sortable:!1}]}),__publicField(this,"askToDeleteSelectedProgramFactory",program=>()=>{this.setState({showDeleteModal:!this.state.showDeleteModal,selectedProgram:program})}),__publicField(this,"deleteSelectedProgram",()=>{debug(`Delete program ${this.state.selectedProgram.title} with id ${this.state.selectedProgram._id}`),this.setState({showDeleteModal:!1},()=>__async(this,null,function*(){yield this.props.deleteProgram(this.state.selectedProgram._id),this.props.getAllPrograms()}))}),__publicField(this,"toggleDeleteModal",()=>{this.setState({showDeleteModal:!this.state.showDeleteModal})}),__publicField(this,"toggleExplorer",()=>{this.setState({showExplorer:!this.state.showExplorer})}),__publicField(this,"toggleProgramCreation",()=>{this.setState({showProgramCreation:!this.state.showProgramCreation})}),this.state={selectedProgram:null,showProgramCreation:!1,showDeleteModal:!1,columns:this.createColumns(),showExplorer:!1}}componentDidMount(){this.props.getAllPrograms()}componentDidUpdate(prevProps){prevProps.admin.programs!==this.props.admin.programs&&this.setState({columns:this.createColumns()})}render(){const{t}=this.props;if(this.state.showExplorer){const programs=this.props.admin.programs||[];let data=[];for(let i=0;i<programs.length;i++){const program=programs[i],replacement={};replacement.title=program.title,replacement.description=program.description,replacement.owners=program.owners.length,replacement.createdAt=program.createdAt,replacement.updatedAt=program.updatedAt,data.push(replacement)}return data=(0,_isle_project_utils_obs_to_var__WEBPACK_IMPORTED_MODULE_6__.Z)(data),react__WEBPACK_IMPORTED_MODULE_0__.createElement(ev_components_data_explorer__WEBPACK_IMPORTED_MODULE_7__.Z,{title:t("explorer-programs-title"),data,categorical:["title","createdAt","updatedAt"],quantitative:["owners"],close:this.toggleExplorer})}return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_dashboard_table__WEBPACK_IMPORTED_MODULE_4__.Z,{data:this.props.admin.programs,columns:this.state.columns,onButtonClick:this.toggleExplorer,disabled:!this.props.admin.programs||this.props.admin.programs.length===0,t}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_OverlayTrigger__WEBPACK_IMPORTED_MODULE_12___default(),{placement:"left",overlay:react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Tooltip__WEBPACK_IMPORTED_MODULE_13___default(),null,t("create-new-program"))},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_14___default(),{"aria-label":t("create-new-program"),style:{marginRight:-9,float:"right"},onClick:this.toggleProgramCreation},react__WEBPACK_IMPORTED_MODULE_0__.createElement("i",{className:"fas fa-plus"}))),this.state.showDeleteModal?react__WEBPACK_IMPORTED_MODULE_0__.createElement(components_confirm_modal__WEBPACK_IMPORTED_MODULE_5__.Z,{title:t("program:delete-program"),message:react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",null,t("program:delete-program-confirm"),react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",{style:{color:"red"}},this.state.selectedProgram.title)),close:this.toggleDeleteModal,show:this.state.showDeleteModal,onConfirm:this.deleteSelectedProgram}):null,this.state.showUserCreation?react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",null):null)}}ProgramPage.propTypes={admin:prop_types__WEBPACK_IMPORTED_MODULE_15___default().object.isRequired,deleteProgram:prop_types__WEBPACK_IMPORTED_MODULE_15___default().func.isRequired,getAllPrograms:prop_types__WEBPACK_IMPORTED_MODULE_15___default().func.isRequired,t:prop_types__WEBPACK_IMPORTED_MODULE_15___default().func.isRequired},__webpack_exports__.default=(0,react_i18next__WEBPACK_IMPORTED_MODULE_16__.Zh)(["admin","program","common"])(ProgramPage)},88608:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(67294),prop_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(45697),prop_types__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_3__),react_i18next__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(81468),react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(89876),react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_2__),react_bootstrap_Modal__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(89194),react_bootstrap_Modal__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react_bootstrap_Modal__WEBPACK_IMPORTED_MODULE_1__);const ConfirmModal=props=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Modal__WEBPACK_IMPORTED_MODULE_1___default(),{show:props.show,onHide:props.close},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Modal__WEBPACK_IMPORTED_MODULE_1___default().Header,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Modal__WEBPACK_IMPORTED_MODULE_1___default().Title,{as:"h3"},props.title)),react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Modal__WEBPACK_IMPORTED_MODULE_1___default().Body,null,props.message),react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Modal__WEBPACK_IMPORTED_MODULE_1___default().Footer,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_2___default(),{onClick:props.close},props.t("cancel")),react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_2___default(),{variant:"danger",onClick:props.onConfirm},props.t("confirm"))));ConfirmModal.propTypes={close:prop_types__WEBPACK_IMPORTED_MODULE_3___default().func,message:prop_types__WEBPACK_IMPORTED_MODULE_3___default().node,onConfirm:prop_types__WEBPACK_IMPORTED_MODULE_3___default().func,show:prop_types__WEBPACK_IMPORTED_MODULE_3___default().bool,title:prop_types__WEBPACK_IMPORTED_MODULE_3___default().string},ConfirmModal.defaultProps={close(){},message:"",onConfirm(){},show:!1,title:""},__webpack_exports__.Z=(0,react_i18next__WEBPACK_IMPORTED_MODULE_4__.Zh)(["common"])(ConfirmModal)},63787:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var components_async__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(15052);const DashboardDataExplorer=(0,components_async__WEBPACK_IMPORTED_MODULE_0__.Z)(()=>Promise.all([__webpack_require__.e(8234),__webpack_require__.e(1419)]).then(__webpack_require__.bind(__webpack_require__,72186)));__webpack_exports__.Z=DashboardDataExplorer}}]);

//# sourceMappingURL=195.71d2fab8.chunk.js.map