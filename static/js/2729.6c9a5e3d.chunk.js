"use strict";(self.webpackChunkisle_dashboard=self.webpackChunkisle_dashboard||[]).push([[2729],{92729:function(e,t,n){n.r(t),n.d(t,{default:function(){return V}});var a=n(15671),l=n(43144),o=n(97326),r=n(60136),s=n(29388),c=n(4942),i=n(1413),m=n(87757),d=n.n(m),u=n(15861),h=n(70885),p=n(41488),E=n(25472),f=n(18306),g=n(67583),Z=n.n(g),v=n(75314),w=n(93391),y=n(70048),k=n(9050),C=n(3252),R=n(54544),b=n(54012),x=n(51189),_=n(75018),M=n(73230),S=n(36659),D=n(23596),F=n(72945),z=n(89308),N=n(5557),T=n(42263),B=JSON.parse('[{"name":"Announcements","actions":[{"name":"create_announcement","description":""},{"name":"edit_announcement","description":""},{"name":"delete_announcement","description":""}]},{"name":"Cohorts","actions":[{"name":"create_cohort","description":""},{"name":"delete_cohort","description":""},{"name":"update_cohort","description":""}]},{"name":"Lessons","actions":[{"name":"create_lesson","description":""},{"name":"delete_lesson","description":""},{"name":"update_lesson","description":""},{"name":"activate_lesson","description":""},{"name":"deactivate_lesson","description":""},{"name":"show_lesson","description":""},{"name":"hide_lesson","description":""}]},{"name":"Namespaces","actions":[{"name":"create_namespace","description":""},{"name":"delete_namespace","description":""},{"name":"update_namespace","description":""}]},{"name":"Admin","actions":[{"name":"upload_file","description":""},{"name":"custom-fields","description":""},{"name":"backups","description":""},{"name":"license","description":""}]},{"name":"Roles","actions":[{"name":"viewRoles","description":""},{"name":"assignRoles","description":""},{"name":"editRoles","description":""}]},{"name":"Views","actions":[{"name":"gallery","description":""},{"name":"progress","description":""},{"name":"grades","description":""},{"name":"tickets","description":""}]},{"name":"Views","actions":[{"name":"gallery","description":""},{"name":"progress","description":""},{"name":"grades","description":""},{"name":"tickets","description":""}]},{"name":"Views","actions":[{"name":"gallery","description":""},{"name":"progress","description":""},{"name":"grades","description":""},{"name":"tickets","description":""}]}]'),H=[{label:"course",value:"course"},{label:"program",value:"program"},{label:"global",value:"global"}],I=function(e){var t=e.createRole,n=e.modal,a=e.roles,l=e.onHide,o=e.selectedRole,r=e.updateRole,s=e.t,c=(0,p.useState)("edit"===n?o.title:""),m=(0,h.Z)(c,2),E=m[0],g=m[1],Z=(0,p.useState)(null),v=(0,h.Z)(Z,2),w=v[0],k=v[1],R=(0,p.useState)("edit"===n?{label:o.searchContext,value:o.searchContext}:H[2]),T=(0,h.Z)(R,2),I=T[0],A=T[1],G=(0,p.useState)("edit"===n?o.permissions:{}),P=(0,h.Z)(G,2),V=P[0],Y=P[1],j=(0,p.useState)("all"),J=(0,h.Z)(j,2),L=J[0],O=J[1],W=(0,p.useState)("edit"===n?o.authorizedRoles.map((function(e){return{label:e.title,value:e}})):[]),X=(0,h.Z)(W,2),q=X[0],K=X[1],Q=function(e){var t=e.target.checked,n=e.target.dataset.show;t&&O(n)},U=function(){var e=(0,u.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r({id:o._id,title:E,authorizedRoles:q.map((function(e){return e.value._id})),searchContext:I.value,permissions:V||{}});case 2:e.sent instanceof Error===!1&&l();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=(0,u.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t({title:E,authorizedRoles:q.map((function(e){return e.value._id})),searchContext:I.value,permissions:V});case 2:e.sent instanceof Error===!1&&l();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return p.createElement(C.Z,{show:null!==n,dialogClassName:"modal-75w",onHide:l},p.createElement(C.Z.Header,{closeButton:!0},p.createElement(C.Z.Title,{as:"h3"},s("common:"+n))),p.createElement(C.Z.Body,null,p.createElement(D.Z,null,p.createElement(M.Z,{controlId:"form-title",as:F.Z},p.createElement(b.Z,null,s("common:title")),p.createElement(_.Z,{name:"title",type:"text",value:E,onChange:function(e){g(e.target.value)},autoComplete:"none"})),p.createElement(M.Z,{controlId:"form-authorized-roles",as:F.Z},p.createElement(b.Z,null,s("authorized-roles"),":"),p.createElement(z.ZP,{options:a.map((function(e){return{label:e.title,value:e}})),isMulti:!0,value:q,onChange:function(e){K(e||[])}})),p.createElement(M.Z,{controlId:"form-context",as:F.Z},p.createElement(b.Z,null,s("search-context")),p.createElement(z.ZP,{options:H,onChange:A,value:I}))),p.createElement("div",{style:{height:50}},p.createElement("h4",{style:{float:"left",width:150}},s("permissions")),p.createElement(x.Z,{"data-show":"all",type:"radio",inline:!0,checked:"all"===L,label:s("show-all"),name:"radioGroup",onChange:Q}),p.createElement(x.Z,{"data-show":"allowed",type:"radio",inline:!0,checked:"allowed"===L,label:s("show-allowed"),name:"radioGroup",onChange:Q}),p.createElement(x.Z,{"data-show":"disallowed",type:"radio",inline:!0,checked:"disallowed"===L,label:s("show-disallowed"),name:"radioGroup",onChange:Q}),p.createElement(x.Z,{"data-show":"inactive",type:"radio",inline:!0,checked:"inactive"===L,label:s("show-inactive"),name:"radioGroup",onChange:Q}),p.createElement(N.Z,{onChange:function(e){k(e.target.value)},value:w||"",placeholder:s("search-permissions"),style:{float:"right"}})),p.createElement("div",{key:L,style:{height:"calc(100vh - 400px)",overflowY:"auto",overflowX:"hidden",backgroundColor:"rgba(255,128,0,0.04)",padding:12}},B.map((function(e,t){var n=e.actions.filter((function(e){return!(w&&!e.name.includes(w))&&!("allowed"===L&&!V[e.name]||"disallowed"===L&&!1!==V[e.name]||"inactive"===L&&(0,f.isPrimitive)(V[e.name]))})).map((function(e,t){var n;return n=!0===V[e.name]?"green":!1===V[e.name]?"red":"black",p.createElement(F.Z,{key:t,sm:3},p.createElement(x.Z,{inline:!0,id:e.name},p.createElement(x.Z.Input,{type:"checkbox",checked:!0===V[e.name],key:"".concat(e.name,"-").concat(t,"-input"),ref:function(t){t&&(t.indeterminate=!1===V[e.name])},onChange:function(t){var n=(0,i.Z)({},V);switch(V[e.name]){case!0:n[e.name]=!1,t.target.indeterminate=!0;break;case!1:n[e.name]=null,t.target.indeterminate=!1;break;default:n[e.name]=!0,t.target.indeterminate=!1}Y(n)}}),p.createElement("span",{style:{color:n}},e.name)),p.createElement(S.Z.Text,null,e.description||"Description comes here..."))}));return 0===n.length?null:p.createElement(p.Fragment,{key:"".concat(e.name,"-").concat(t)},p.createElement("h5",null,e.name),p.createElement(S.Z.Row,{style:{marginBottom:16}},n),p.createElement("hr",null))})))),p.createElement(C.Z.Footer,null,p.createElement(y.Z,{onClick:l},s("common:cancel")),p.createElement(y.Z,{onClick:"create"===n?$:U,disabled:!E},s("create"===n?"common:create":"common:update"))))},A=function(e){var t=e.permissions,n=e.status,a=e.t,l=Z()(t),o=[];if("allowed"===n)for(var r=0;r<l.length;r++){var s=l[r];!0===t[s]&&o.push(p.createElement(R.Z.Item,null,s))}else if("disallowed"===n)for(var c=0;c<l.length;c++){var i=l[c];!1===t[i]&&o.push(p.createElement(R.Z.Item,null,i))}return 0===o.length?p.createElement(R.Z,{variant:"flush"},p.createElement(R.Z.Item,null,a("common:none"))):p.createElement(R.Z,{variant:"flush",style:{fontSize:"0.8em"}},o.length>0?o:p.createElement(R.Z.Item,null,a("common:none")))},G=function(e){for(var t=e.roles,n=e.askToDeleteSelectedRoleFactory,a=e.toggleEditModalFactory,l=e.t,o=[],r=0;r<t.length;r++){var s=t[r],c=p.createElement("tr",{key:r},p.createElement("td",null,p.createElement("b",null,s.title)),p.createElement("td",null,s.createdBy?"".concat(s.createdBy.name," (").concat(s.createdBy.email,")"):""),p.createElement("td",null,p.createElement(w.Z,{placement:"left",delay:{show:250,hide:400},overlay:p.createElement(k.Z,{id:"popover-allowed-".concat(r)},p.createElement(k.Z.Title,{as:"h3"},l("allowed-permissions")),p.createElement(k.Z.Content,{style:{maxHeight:"40vh",overflowY:"auto"}},p.createElement(A,{status:"allowed",permissions:s.permissions,t:l}))),trigger:"click"},p.createElement(y.Z,{"aria-label":l("show-allowed-permissions"),variant:"success",style:{marginRight:8}},p.createElement("i",{className:"fas fa-check-circle"}))),p.createElement(w.Z,{placement:"right",delay:{show:250,hide:400},overlay:p.createElement(k.Z,{id:"popover-disallowed-".concat(r)},p.createElement(k.Z.Title,{as:"h3"},l("disallowed-permissions")),p.createElement(k.Z.Content,{style:{maxHeight:"40vh",overflowY:"auto"}},p.createElement(A,{status:"disallowed",permissions:s.permissions,t:l}))),trigger:"click"},p.createElement(y.Z,{"aria-label":l("show-disallowed-permissions"),variant:"danger"},p.createElement("i",{className:"far fa-times-circle"})))),p.createElement("td",null,s.searchContext),p.createElement("td",null,s.authorizedRoles.map((function(e){return e.title})).join(", ")),p.createElement("td",null,p.createElement(y.Z,{"aria-label":l("common:edit"),size:"sm",onClick:a(s),style:{marginRight:6}},p.createElement("i",{className:"fas fa-edit"})),p.createElement(y.Z,{"aria-label":l("common:delete"),variant:"danger",size:"sm",onClick:n(s)},p.createElement("i",{className:"fas fa-trash"}))));o.push(c)}return o},P=function(e){(0,r.Z)(n,e);var t=(0,s.Z)(n);function n(e){var l;return(0,a.Z)(this,n),l=t.call(this,e),(0,c.Z)((0,o.Z)(l),"toggleEditModalFactory",(function(e){return function(){l.setState({modal:l.state.modal?null:"edit",selectedRole:l.state.modal?null:e})}})),(0,c.Z)((0,o.Z)(l),"toggleCreateModal",(function(){l.setState({modal:l.state.modal?null:"create",selectedRole:null})})),(0,c.Z)((0,o.Z)(l),"toggleDeleteModal",(function(){l.setState({showDeleteModal:!l.state.showDeleteModal})})),(0,c.Z)((0,o.Z)(l),"askToDeleteSelectedRoleFactory",(function(e){return function(){l.setState({showDeleteModal:!l.state.showDeleteModal,selectedRole:e})}})),(0,c.Z)((0,o.Z)(l),"deleteSelectedRole",(function(){l.setState({showDeleteModal:!1},(0,u.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.props.deleteRole(l.state.selectedRole._id);case 2:case"end":return e.stop()}}),e)}))))})),l.state={modal:null,selectedRole:null,showDeleteModal:!1},l}return(0,l.Z)(n,[{key:"componentDidMount",value:function(){this.props.getAllRoles()}},{key:"render",value:function(){var e=this.props,t=e.admin,n=e.t;return p.createElement(p.Fragment,null,p.createElement("div",{className:"admin-settings-outer-container"},p.createElement("h1",null,n("roles")),p.createElement(v.Z,{striped:!0,bordered:!0,hover:!0},p.createElement("thead",null,p.createElement("tr",null,p.createElement("th",null,n("common:name")),p.createElement("th",null,n("common:created-by")),p.createElement("th",null,n("common:permissions")),p.createElement("th",null,n("search-context")),p.createElement("th",null,n("authorized-roles")),p.createElement("th",null,n("common:actions")))),p.createElement("tbody",null,p.createElement(G,{roles:t.roles||[],toggleEditModalFactory:this.toggleEditModalFactory,askToDeleteSelectedRoleFactory:this.askToDeleteSelectedRoleFactory,t:n}))),p.createElement(y.Z,{size:"lg",onClick:this.toggleCreateModal},p.createElement("i",{className:"fas fa-plus",style:{marginRight:12}}),n("create-role"))),null!==this.state.modal?p.createElement(I,{key:this.state.selectedRole?this.state.selectedRole.title:"new-role",onHide:this.toggleCreateModal,modal:this.state.modal,t:n,createRole:this.props.createRole,updateRole:this.props.updateRole,roles:this.props.admin.roles,selectedRole:this.state.selectedRole}):null,this.state.showDeleteModal?p.createElement(T.Z,{title:"".concat(n("common:delete-role"),"?"),message:p.createElement("div",null,p.createElement("p",null,n("common:delete-role-confirm")),p.createElement("span",{style:{color:"red"}},this.state.selectedRole.title)),close:this.toggleDeleteModal,show:this.state.showDeleteModal,onConfirm:this.deleteSelectedRole}):null)}}]),n}(p.Component),V=(0,E.Z)(["admin_settings","common"])(P)},42263:function(e,t,n){var a=n(41488),l=n(25472),o=n(70048),r=n(3252),s=function(e){return a.createElement(r.Z,{show:e.show,onHide:e.close},a.createElement(r.Z.Header,null,a.createElement(r.Z.Title,{as:"h3"},e.title)),a.createElement(r.Z.Body,null,e.message),a.createElement(r.Z.Footer,null,a.createElement(o.Z,{onClick:e.close},e.t("cancel")),a.createElement(o.Z,{variant:"danger",onClick:e.onConfirm},e.t("confirm"))))};s.defaultProps={close:function(){},message:"",onConfirm:function(){},show:!1,title:""},t.Z=(0,l.Z)(["common"])(s)},5557:function(e,t,n){var a=n(1413),l=n(41488),o=n(25472),r=n(73230),s=n(75018),c=n(33226),i=n(70048);t.Z=(0,o.Z)(["header_bar","common"])((function(e){return l.createElement(r.Z,{style:(0,a.Z)({width:"14vw",minWidth:"120px",float:"left",marginBottom:"4px",marginRight:"5px"},e.style)},l.createElement(c.Z,null,l.createElement(s.Z,{className:"header-bar-search",type:"text",placeholder:e.placeholder,value:e.value,onChange:e.onChange,"aria-label":e.t("search-field"),style:{height:"38px"}}),l.createElement(c.Z.Append,null,l.createElement(i.Z,{"aria-label":e.t("search-field-icon"),disabled:!0,variant:"secondary",style:{cursor:"auto"}},l.createElement("i",{className:"fa fa-search"})))))}))}}]);
//# sourceMappingURL=2729.6c9a5e3d.chunk.js.map