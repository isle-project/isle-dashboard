"use strict";(self.webpackChunkisle_dashboard=self.webpackChunkisle_dashboard||[]).push([[6815],{13222:function(e,t,s){s.d(t,{Ib:function(){return p},Ll:function(){return h},kC:function(){return f},J3:function(){return E},qw:function(){return v},Tm:function(){return w},hA:function(){return Z},Vw:function(){return C}});var a=s(98816),n=s.n(a),r=s(14065),o=s(67361),l=s(63163),i=s(63022),c=s(76417),m=s(39285),d=s(1209);function p({title:e,owners:t,announcements:s=[],cohorts:a=[],description:n,enableTicketing:r,_id:o}){return{type:d.WF,payload:{title:e,announcements:s,cohorts:a,description:n,enableTicketing:r,owners:t,_id:o}}}const u=async(e,{title:t,description:s,owners:a,props:r})=>{try{const o=await n().post(i.ZP+"/create_namespace",{title:t,description:s,owners:a});if(!o.data.successful)return(0,c.EG)(e,new Error(o.data.message));const l=o.data.namespace;r.onNamespace(l),e(function(e){return{type:d.$8,payload:{namespace:e}}}(l)),r.history.replace("/lessons"),(0,c.wN)(e,{message:o.data.message,level:o.data.successful?"success":"error"})}catch(o){(0,c.EG)(e,o)}},h=e=>async({title:t,description:s,owners:a,props:n})=>{await u(e,{title:t,description:s,owners:a,props:n})},g=async(e,t,s)=>{try{const a=await n().post(i.ZP+"/delete_namespace",{id:t});s&&s.replace("/lessons"),e(function(e){return{type:d.ke,payload:{id:e}}}(t)),(0,c.wN)(e,{message:a.data.message,level:"success"})}catch(a){return(0,c.EG)(e,a)}},f=e=>async(t,s)=>{await g(e,t,s)},b=async(e,t)=>{try{const s=await n().post(i.ZP+"/update_namespace",{ns:t});e(p(s.data.namespace)),e(function({title:e,owners:t,description:s,enableTicketing:a,_id:n}){return{type:d.Rg,payload:{title:e,description:s,owners:t,enableTicketing:a,_id:n}}}(s.data.namespace)),(0,c.wN)(e,{message:s.data.message,level:"success"}),(0,m.k$)(e,{namespaceID:t._id})}catch(s){(0,c.EG)(e,s)}},E=e=>async(t,s)=>{await b(e,t)},v=e=>async({namespaceID:t,namespaceTitle:s})=>{await(async(e,{namespaceID:t,namespaceTitle:s})=>{try{const e=await n().get(i.ZP+"/get_namespace_actions?"+r.stringify({namespaceID:t})),a=new Blob([e.data],{type:"application/json"}),o=`actions_${s}.json`;(0,l.Z)(a,o)}catch(a){(0,c.EG)(e,a)}})(e,{namespaceID:t,namespaceTitle:s})},y=async(e,{email:t,lessonID:s,namespaceID:a,progress:r,cohort:l})=>{const m=await n().post(i.ZP+"/user_adjust_progress",{email:t,lessonID:s,namespaceID:a,progress:r});(0,c.wN)(e,{title:o.Z.t("common:updated"),message:m.data.message,level:"success"}),e(function({email:e,lessonID:t,progress:s,cohort:a}){return{type:d.LX,payload:{email:e,lessonID:t,progress:s,cohort:a}}}({email:t,lessonID:s,progress:r,cohort:l}))},w=e=>async({email:t,lessonID:s,namespaceID:a,progress:n,cohort:r})=>{await y(e,{email:t,lessonID:s,namespaceID:a,progress:n,cohort:r})},Z=e=>async()=>{await(async e=>{try{const t=await n().get(i.ZP+"/get_all_namespaces");e({type:d.XM,payload:{namespaces:t.data.namespaces}})}catch(t){return(0,c.EG)(e,t)}})(e)},C=e=>async({lessons:t,id:s})=>{await(async(e,{lessons:t,id:s})=>{try{await n().post(i.ZP+"/set_lesson_order",{lessons:t,id:s})}catch(a){return(0,c.EG)(e,a)}})(e,{lessons:t,id:s})}},37933:function(e,t,s){var a=s(38603),n=s(91532),r=s.n(n),o=s(58651),l=s(12630),i=s(14704);const c=e=>a.createElement(i.Z,{show:e.show,onHide:e.close},a.createElement(i.Z.Header,null,a.createElement(i.Z.Title,{as:"h3"},e.title)),a.createElement(i.Z.Body,null,e.message),a.createElement(i.Z.Footer,null,a.createElement(l.Z,{onClick:e.close},e.t("cancel")),a.createElement(l.Z,{variant:"danger",onClick:e.onConfirm},e.t("confirm"))));c.propTypes={close:r().func,message:r().node,onConfirm:r().func,show:r().bool,title:r().string},c.defaultProps={close(){},message:"",onConfirm(){},show:!1,title:""},t.Z=(0,o.Z)(["common"])(c)},31617:function(e,t,s){s.d(t,{Z:function(){return u}});var a=s(38603),n=s(91532),r=s.n(n),o=s(90037),l=s(12630),i=s(60805),c=s(12908),m=s(69977);s(3100);function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},d.apply(this,arguments)}class p extends a.Component{constructor(...e){var t,s,a;super(...e),a=()=>({id:this.props.id||"dashboard-table"}),(s="getProps")in(t=this)?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a}render(){const{t:e}=this.props;return a.createElement(a.Fragment,null,a.createElement(o.Z,d({},this.props,{filterable:!0,className:`dashboard-table ${this.props.className}`,data:this.props.data,columns:this.props.columns,previousText:e("common:previous"),nextText:e("common:next"),loadingText:e("common:loading"),noDataText:e("common:no-rows-found"),pageText:e("common:page"),ofText:e("common:of"),rowsText:e("common:rows"),ref:e=>{this.table=e},getProps:this.getProps})),this.props.onButtonClick?a.createElement(i.Z,{vertical:!0,style:{float:"right",marginRight:-9}},a.createElement(c.Z,{placement:"left",overlay:a.createElement(m.Z,{id:"explorer-tooltip"},e("common:data-explorer"))},a.createElement(l.Z,{"aria-label":e("common:data-explorer"),variant:"primary",style:{marginBottom:8},onClick:this.props.onButtonClick},a.createElement("i",{className:"fas fa-chart-bar"})))):null)}}p.propTypes={className:r().string,columns:r().array.isRequired,data:r().oneOfType([r().object,r().array]).isRequired,onButtonClick:r().func.isRequired,t:r().func},p.defaultProps={className:"",t(){}};var u=p},4526:function(e,t,s){s.r(t),s.d(t,{default:function(){return St}});var a=s(38603),n=s(30322),r=s(22109),o=s(91532),l=s.n(o),i=s(2561),c=s.n(i),m=s(58651),d=s(35711),p=s(65678),u=s(95230),h=s.n(u),g=s(60805),f=s(12630),b=s(47331),E=s(56233),v=s(12908),y=s(69977),w=s(85480),Z=s(74360),C=s.n(Z),N=s(21598),k=s.n(N),D=s(73130),x=s.n(D),S=s(51530),_=s.n(S),T=s(89506),M=s.n(T),A=s(64817),P=s.n(A),I=s(64300),R=s.n(I),F=s(34668),O=s(76470),q=s(31617),L=s(37933),j=s(63022),z=s(63163),H=s(65307),$=s(76282),W=s(33547);s(5541);function B(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const U=["name","email","lesson","title","filename","type","createdAt","updatedAt"],V=c()("isle:files-page"),K=e=>e.substring(e.indexOf("/media/")+7),G=e=>{for(let t=0;t<e.length;t++){const s=_()(e[t],U);s.lesson=s.lesson.title,s.filename=j.ZP+"/"+s.filename,e[t]=s}return e};class J extends a.Component{constructor(e){super(e),B(this,"handleDelete",(()=>{this.props.handleFileDeletion(this.state.deletionID,this.props.ownerFiles),this.toggleDeleteModal()})),B(this,"toggleDeleteModal",(()=>{this.setState({showDeleteModal:!this.state.showDeleteModal})})),B(this,"createColumns",(()=>{const{t:e}=this.props;return[(0,$.Z)({Header:e("common:filename"),accessor:"title",minWidth:250,filterMethod:(e,t)=>M()(P()(t[e.id]),P()(e.value))}),{Header:e("common:open"),accessor:"path",Cell:t=>a.createElement(v.Z,{placement:"left",overlay:a.createElement(y.Z,{id:"external-link-tooltip"},e("open-file"))},a.createElement("a",{"aria-label":e("open-file"),href:j.ZP+"/"+K(t.value),target:"_blank",rel:"noopener noreferrer"},a.createElement(f.Z,{"aria-label":e("open-file"),size:"sm",variant:"outline-secondary"},a.createElement("i",{className:"fa fa-external-link-alt"})))),resizable:!1,filterable:!1,sortable:!1,width:45},{Header:e("common:copy"),id:"copy-path",accessor:"path",Cell:t=>a.createElement(v.Z,{placement:"right",overlay:a.createElement(y.Z,{id:"copy-clipboard-tooltip"},e("common:copy-link"))},a.createElement(f.Z,{"aria-label":e("common:copy-link"),variant:"outline-secondary",size:"sm",onClick:()=>{C()(j.ZP+"/"+K(t.value)),this.props.addNotification({title:"Copied",message:"Link copied to clipboard",level:"success",position:"tl"})}},a.createElement("i",{className:"fa fa-clipboard"}))),resizable:!1,filterable:!1,sortable:!1,width:45},(0,$.Z)({Header:e("common:lesson"),accessor:"lesson",maxWidth:160,Cell:t=>t.row.lesson?a.createElement(v.Z,{placement:"right",overlay:a.createElement(y.Z,{id:"open-lesson-tooltip"},e("open-lesson-new-tab"))},a.createElement("div",{style:{width:"100%",height:"100%"}},a.createElement("a",{"aria-label":e("open-lesson-new-tab"),href:t.row.lesson.url,target:"_blank",rel:"noopener noreferrer"},t.row.lesson.title))):a.createElement("span",null,e("no-lesson")),filterMethod:(e,t)=>t[e.id].title.startsWith(e.value)}),(0,$.Z)({Header:e("first-name"),id:"first_name",accessor:e=>{const t=R()(e.name).split(" ");return t.length>1?(t.pop(),t.join(" ")):t[0]},maxWidth:75,filterMethod:(e,t)=>M()(P()(t[e.id]),P()(e.value))}),(0,$.Z)({Header:e("last-name"),id:"last_name",accessor:e=>{const t=R()(e.name).split(" ");return t.length>1?t[t.length-1]:""},maxWidth:75,filterMethod:(e,t)=>M()(P()(t[e.id]),P()(e.value))}),(0,$.Z)({Header:e("common:email"),accessor:"email",maxWidth:160,filterMethod:(e,t)=>M()(P()(t[e.id]),P()(e.value))}),(0,$.Z)({Header:e("type"),accessor:"type",filterMethod:(e,t)=>M()(t[e.id],e.value)}),(0,W.Z)({Header:e("common:size"),accessor:"size",Cell:e=>e.value?`${k()(e.value,-3)}mb`:"NA",filterMethod:(e,t)=>{const s=t[e.pivotId||e.id];return s>=e.value.min&&s<=e.value.max},formatLabel:e=>k()(e,-2),maxValue:x()(this.state.fileMaxSize)||1,minValue:0}),(0,H.Z)({Header:e("common:date"),accessor:"updatedAt",Cell:e=>e.value&&e.value.toLocaleDateString?e.value.toLocaleDateString("en-US"):"",maxWidth:120,t:e}),{Header:"Del",accessor:"_id",Cell:t=>a.createElement(v.Z,{placement:"left",overlay:a.createElement(y.Z,{id:"delete-file-tooltip"},e("delete-file-tooltip"))},a.createElement(f.Z,{"aria-label":e("delete-file-tooltip"),size:"sm",variant:"outline-secondary",onClick:()=>{this.setState({deletionID:t.value,showDeleteModal:!0})}},a.createElement("div",{className:"fa fa-trash-alt"}))),resizable:!1,filterable:!1,sortable:!1,width:45}]})),B(this,"saveJSON",(()=>{const e=this.dashboardTable.table.getResolvedState().sortedData;let t=G(e);const s=new Blob([JSON.stringify(t)],{type:"application/json"}),a=`files_${this.props.namespace.title}.json`;(0,z.Z)(s,a)})),B(this,"saveCSV",(()=>{const e=this.dashboardTable.table.getResolvedState().sortedData;let t=G(e);h()(t,{header:!0},((e,t)=>{if(e)return this.props.addNotification({title:"Error encountered",message:"Encountered an error while creating CSV: "+e.message,level:"error",position:"tl"});const s=new Blob([t],{type:"text/plain"}),a=`files_${this.props.namespace.title}.csv`;(0,z.Z)(s,a)}))})),B(this,"toggleExplorer",(()=>{this.setState({showExplorer:!this.state.showExplorer})})),this.state={showDeleteModal:!1,deletionID:null,fileMaxSize:0,fileInputKey:0,showExplorer:!1},this.columns=this.createColumns()}componentDidMount(){V("Component did mount..."),this.props.getFiles({namespaceName:this.props.namespace.title})}componentDidUpdate(e){if(e.files!==this.props.files){const e=this.props.files;let t=0;for(let s=0;s<e.length;s++){const a=e[s].size;a&&a>t&&(t=a)}this.setState({fileMaxSize:t,fileInputKey:this.state.fileInputKey+1})}}render(){const{t:e}=this.props;if(this.state.showExplorer){const t=this.props.files;let s=[];for(let e=0;e<t.length;e++){const a=t[e],n={};n.title=a.title,n.type=a.type,n.lesson=a.lesson?a.lesson.title:null,n.size=a.size?a.size:null,n.email=a.email,n.createdAt=a.createdAt,n.updatedAt=a.updatedAt,s.push(n)}s=(0,O.Z)(s);const n=["size"],r=["title","type","lesson","email","createdAt","updatedAt"];return a.createElement(F.Z,{title:e("explorer-files-title"),data:s,categorical:r,quantitative:n,close:this.toggleExplorer})}return a.createElement("div",{className:"namespace-data-page"},a.createElement("div",{className:"namespace-data-buttons"},a.createElement(g.Z,{className:"files-export-button-group"},a.createElement(v.Z,{placement:"bottom",overlay:a.createElement(y.Z,{id:"csvTooltip"},e("save-as-csv"))},a.createElement(f.Z,{size:"sm",variant:"secondary",onClick:this.saveCSV},a.createElement("i",{className:"fas fa-download"})," CSV")),a.createElement(v.Z,{placement:"bottom",overlay:a.createElement(y.Z,{id:"jsonTooltip"},e("save-as-json"))},a.createElement(f.Z,{size:"sm",variant:"secondary",onClick:this.saveJSON},a.createElement("i",{className:"fas fa-download"})," JSON"))),this.props.ownerFiles?a.createElement(E.Z,{className:"file-upload-button"},a.createElement(b.Z,{htmlFor:"fileUpload",style:{cursor:"pointer"}},a.createElement(w.Z,{id:"file-upload-badge",variant:"success"},e("upload-file")),a.createElement("input",{id:"fileUpload",key:this.state.fileInputKey,type:"file",accept:".pdf,.html,.md,image/*,video/*,audio/*,.json,.csv",onChange:this.props.handleUpload,style:{display:"none"}}))):null),a.createElement(q.Z,{data:this.props.files,columns:this.columns,t:e,ref:e=>{this.dashboardTable=e},onButtonClick:this.toggleExplorer}),a.createElement(L.Z,{show:this.state.showDeleteModal,close:this.toggleDeleteModal,message:e("delete-file"),title:`${e("common:delete")}?`,onConfirm:this.handleDelete}))}}J.propTypes={addNotification:l().func.isRequired,files:l().array.isRequired,getFiles:l().func.isRequired,handleFileDeletion:l().func.isRequired,handleUpload:l().func.isRequired,namespace:l().object.isRequired,ownerFiles:l().bool},J.defaultProps={ownerFiles:!1};var X=(0,m.Z)(["namespace_data","common"])(J),Y=s(14224),Q=s(87078),ee=s(72454);s(87196);function te(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class se extends a.Component{constructor(e){super(e),te(this,"deleteSelectedMessage",(()=>{const e=this.state.editItem,t=this.props.namespace.announcements[e];this.props.deleteAnnouncement(t.createdAt,e),this.clear(),this.closeDeleteModal()})),te(this,"createMessage",(()=>{const e=(new Date).getTime(),t={title:this.state.title,body:this.state.body,author:this.props.user.name,email:this.props.user.email,picture:this.props.user.picture};if(null===this.state.editItem)t.createdAt=e,this.props.addAnnouncement(t);else{const e=this.props.namespace.announcements[this.state.editItem];t.createdAt=e.createdAt,this.props.editAnnouncement(t)}this.clear()})),te(this,"handleInputChange",(e=>{const t=e.target,s=t.name;let a=t.value;this.setState({[s]:a})})),te(this,"clear",(()=>{this.setState({title:"",body:"",mode:"new-announcement",editItem:null})})),te(this,"closeDeleteModal",(()=>{this.setState({editItem:null,showDeleteModal:!1})})),this.state={title:"",body:"",mode:"new-announcement",editItem:null,showDeleteModal:!1}}renderModals(){return null}editMessage(e){const t=this.props.namespace.announcements[e];this.setState({mode:"edit-announcement",editItem:e,title:t.title,body:t.body})}renderMessages(){const{t:e}=this.props;return a.createElement("div",null,this.props.namespace.announcements.map(((t,s)=>{const n=new Date(t.createdAt),r=n.toLocaleDateString()+"  -  "+n.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"});return a.createElement("div",{key:s},a.createElement("div",{className:"message-container"},a.createElement("div",{className:"message-data"},a.createElement("div",{className:"message-profile-pic"},a.createElement("img",{src:t.picture,alt:"User Profile Pic"})),a.createElement("div",{className:"message-author-line"},a.createElement("span",{className:"message-author"},t.author),"\xa0",e("common:wrote-on",{date:r}))),a.createElement("div",{className:"message-title"},t.title),a.createElement("div",{className:"message-body"},t.body)),a.createElement("div",{className:"message-manip"},a.createElement("button",{onClick:()=>{this.setState({editItem:s,showDeleteModal:!0})},className:"message-delete"},e("common:delete")),a.createElement("button",{onClick:()=>{this.editMessage(s)},className:"message-edit"},e("common:edit"))))})))}render(){const{t:e}=this.props,t=this.state.title.length<3||this.state.body.length<3,s=0===this.state.title.length&&0===this.state.body.length;return a.createElement("div",{className:"namespace-data-page"},a.createElement("div",{className:"messages"},this.renderMessages()),a.createElement("div",{className:"new_message"},a.createElement(Y.Z,null,a.createElement(Y.Z.Header,null,a.createElement(Y.Z.Title,{as:"h3"},e(this.state.mode))),a.createElement(Y.Z.Body,null,a.createElement(ee.Z,{style:{padding:"20px"}},a.createElement(v.Z,{placement:"bottom",overlay:a.createElement(y.Z,{id:"titleTooltip"},e("announcement-title"))},a.createElement(E.Z,{controlId:"form-title"},a.createElement(b.Z,null,e("common:title")),a.createElement(Q.Z,{name:"title",type:"text",value:this.state.title,onChange:this.handleInputChange}))),a.createElement(E.Z,{controlId:"form-text"},a.createElement(b.Z,null,e("announcement-text")),a.createElement(Q.Z,{name:"body",type:"text",as:"textarea",rows:"10",value:this.state.body,onChange:this.handleInputChange}))),a.createElement(g.Z,null,a.createElement(f.Z,{type:"submit",disabled:t,onClick:this.createMessage},"new-announcement"===this.state.mode?e("common:create"):e("common:update")),a.createElement(f.Z,{onClick:this.clear,disabled:s,variant:"danger"},e("common:clear")))))),a.createElement(L.Z,{show:this.state.showDeleteModal,close:this.closeDeleteModal,message:e("delete-announcement"),title:`${e("common:delete")}?`,onConfirm:this.deleteSelectedMessage}))}}se.propTypes={addAnnouncement:l().func.isRequired,deleteAnnouncement:l().func.isRequired,editAnnouncement:l().func.isRequired,namespace:l().object.isRequired,user:l().object.isRequired},se.defaultProps={};var ae=(0,m.Z)(["namespace_data","common"])(se),ne=s(94688),re=s.n(ne),oe=s(550),le=s(45234),ie=s(70658),ce=s.n(ie),me=s(2078),de=s.n(me),pe=s(22949),ue=s.n(pe),he=s(80386),ge=s.n(he),fe=s(92639),be=s(90591),Ee=s.n(be);function ve(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class ye extends a.Component{constructor(e){super(e),ve(this,"toggleEditing",(()=>{this.setState({isEditing:!this.state.isEditing,newProgress:this.props.progress})})),ve(this,"handleChange",(e=>{this.setState({newProgress:Ee()(e.target.value,0,100),hasChanged:!0})})),ve(this,"handleSubmit",(()=>{this.setState({isEditing:!1,hasChanged:!1}),this.props.onSubmit(this.state.newProgress)})),this.state={isEditing:!1,hasChanged:!1,newProgress:e.progress,originalProgress:e.progress}}static getDerivedStateFromProps(e,t){return e.progress!==t.originalProgress?{newProgress:e.progress,originalProgress:e.progress}:null}render(){return this.state.isEditing?a.createElement(a.Fragment,null,a.createElement("input",{type:"number",value:this.state.newProgress,min:0,max:100,onChange:this.handleChange,className:"editable-progress-input"}),a.createElement("i",{role:"button",tabIndex:0,onClick:this.toggleEditing,onKeyPress:this.toggleEditing,className:"fas fa-window-close editable-progress-close"}),a.createElement("span",{className:"editable-progress-submit",style:{display:this.state.hasChanged?"inline":"none"}},a.createElement("i",{role:"button",tabIndex:0,onClick:this.handleSubmit,onKeyPress:this.handleSubmit,className:"fas fa-check-square"}))):a.createElement(fe.Z,{"aria-label":"new-progress",style:{fontSize:"10px",height:"12px"},now:this.state.newProgress,label:`${this.state.newProgress}%`,onClick:this.toggleEditing})}}var we=ye,Ze=s(34980);function Ce(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Ne=c()("isle:progress-page");function ke(e,t){return(s,a)=>{const n=a[s.id][e[t]._id];if(ge()(n))return 0===s.value.min;const r=de()(ce()(100*n.progress),100);return r>=s.value.min&&r<=s.value.max}}function De(e,t){return(s,a)=>(s=s[e[t]._id],a=a[e[t]._id],s||a?s&&!a?1:!s&&a?-1:s.progress>a.progress?1:s.progress<a.progress?-1:0:0)}function xe(e,t){if("all"===e.value)return!0;const s=e.pivotId||e.id;return void 0===t[s]||(ue()(e.value)?M()(e.value,String(t[s])):String(t[s])===e.value)}class Se extends a.Component{constructor(e){super(e),Ce(this,"accessorFactory",((e,t)=>{const{t:s}=this.props;return n=>{let r=n.original.lessonData;const o=e[t]._id;if(r=r[o],r){const e=de()(ce()(100*r.progress),100);return a.createElement("span",{style:{fontSize:"12px",fontWeight:800}},a.createElement(v.Z,{placement:"bottom",overlay:a.createElement(y.Z,{id:"durationTooltip"},s("hours-minutes-seconds"))},a.createElement("span",null,s("duration"),": ",(0,Ze.Z)(r.spentTime))),a.createElement(v.Z,{placement:"bottom",overlay:a.createElement(y.Z,{id:"startTooltip"},s("first-accessed"))},a.createElement("span",null," | ",new Date(r.createdAt).toLocaleString())),a.createElement(v.Z,{placement:"bottom",overlay:a.createElement(y.Z,{id:"startTooltip"},s("last-accessed"))},a.createElement("span",null," - ",new Date(r.updatedAt).toLocaleString())),a.createElement("br",null),a.createElement(we,{progress:e,email:n.original.email,lessonID:o,onSubmit:e=>{this.props.adjustProgress({email:n.original.email,lessonID:o,namespaceID:this.props.namespace._id,cohort:n.original.cohort,progress:e})}}))}return a.createElement("span",null)}})),Ce(this,"saveJSON",(()=>{const e=this.assembleData(),t=new Blob([JSON.stringify(e)],{type:"application/json"}),s=`completion_${this.props.namespace.title}.json`;(0,z.Z)(t,s)})),Ce(this,"saveCSV",(()=>{const e=this.assembleData();h()(e,{header:!0},((e,t)=>{if(e)return this.props.addNotification({title:"Error encountered",message:"Encountered an error while creating CSV: "+e.message,level:"error",position:"tl"});const s=new Blob([t],{type:"text/plain"}),a=`completion_${this.props.namespace.title}.csv`;(0,z.Z)(s,a)}))})),Ce(this,"toggleExplorer",(()=>{this.setState({showExplorer:!this.state.showExplorer})})),this.columns=this.createColumns(e.lessons,e.cohorts),this.state={displayedMembers:[],lessonSortDirection:"ascending",lessonOrder:"createdAt",showExplorer:!1}}componentDidMount(){this.createDisplayedMembers()}componentDidUpdate(e){this.props.cohorts===e.cohorts&&this.props.lessons===e.lessons||(this.createDisplayedMembers(),this.columns=this.createColumns(this.props.lessons,this.props.cohorts))}createDisplayedMembers(){let e=[];for(let t=0;t<this.props.cohorts.length;t++){const s=this.props.cohorts[t].members;for(let e=0;e<s.length;e++)s[e].cohort=this.props.cohorts[t].title,s[e].lessonData||(s[e].lessonData={});e=e.concat(this.props.cohorts[t].members)}for(let t=0;t<e.length;t++){const s=e[t],a=R()(s.name).split(" ");a.length>1?(s.lastName=a.pop(),s.firstName=a.join(" ")):(s.firstName=a[0],s.lastName="")}this.setState({displayedMembers:e})}createColumns(e,t){const{t:s}=this.props,n=[{Header:"Pic",accessor:"picture",Cell:e=>a.createElement("img",{className:"table-pic",src:`${j.ZP}/thumbnail/${e.original.picture}`,alt:"Profile Pic"}),maxWidth:46,minWidth:46,filterable:!1,resizable:!1,sortable:!1,style:{color:"darkslategrey"}},(0,$.Z)({Header:s("first-name"),id:"first_name",accessor:"firstName",maxWidth:75,filterMethod:(e,t)=>M()(P()(t[e.id]),P()(e.value))}),(0,$.Z)({Header:s("last-name"),id:"last_name",accessor:"lastName",maxWidth:75,filterMethod:(e,t)=>M()(P()(t[e.id]),P()(e.value))}),(0,$.Z)({Header:s("common:email"),accessor:"email",maxWidth:200,filterMethod:(e,t)=>M()(P()(t[e.id]),P()(e.value))}),{Header:s("common:cohort"),accessor:"cohort",style:{marginTop:"8px",color:"darkslategrey"},filterMethod:xe,Filter:({filter:e,onChange:s})=>{const n=e=>{const t=e.target.value;s(t)};let r;return r=e?ue()(e.value)?e.value.join(", "):e.value:"all",a.createElement("select",{onBlur:n,onChange:n,style:{width:"100%",backgroundColor:"ghostwhite"},value:r},a.createElement("option",{value:"all"},"Show All"),t.map(((e,t)=>a.createElement("option",{key:t,value:`${e.title}`},e.title))))}}];for(let r=0;r<e.length;r++){const t="lesson_"+r;n.push({id:t,Header:a.createElement("span",{id:t},e[r].title),_lesson:e[r],Cell:this.accessorFactory(e,r),accessor:"lessonData",sortMethod:De(e,r),filterMethod:ke(e,r),Filter:({filter:e,onChange:s})=>a.createElement("div",{style:{paddingLeft:"4px",paddingRight:"4px",paddingTop:"8px"}},a.createElement(re(),{ariaLabelledby:t,ariaControls:"dashboard-table",allowSameValues:!0,maxValue:100,minValue:0,value:e?e.value:{max:100,min:0},onChange:e=>{s(e)}}))})}return n}assembleData(){const e=this.dashboardTable.table.getResolvedState().sortedData,t=e.length,s=new Array(t),a=this.props.lessons;for(let n=0;n<t;n++){const t=e[n]._original;s[n]={name:t.name,firstName:t.firstName,lastName:t.lastName,email:t.email,cohort:t.cohort};const r=this.props.user.availableCustomFields;for(let e=0;e<r.length;e++){const a=r[e].name;t.customFields?s[n][a]=t.customFields[a]:s[n][a]=null}for(let e=0;e<a.length;e++){const r=a[e]._id;let o=t.lessonData;o&&o[r]?(o=o[r],s[n][a[e].title+"_question_progress"]=de()(ce()(100*o.progress),100),s[n][a[e].title+"_time"]=ce()(o.spentTime/6e4),s[n][a[e].title+"_first_accessed"]=new Date(o.createdAt).toLocaleString(),s[n][a[e].title+"_last_accessed"]=new Date(o.updatedAt).toLocaleString()):(s[n][a[e].title+"_question_progress"]=0,s[n][a[e].title+"_time"]=0,s[n][a[e].title+"_first_accessed"]="",s[n][a[e].title+"_last_accessed"]="")}}return s}reorderColumns(e,t){return Ne("Sort columns by "+e+" in "+t+" order"),"ascending"===t?this.columns.slice().sort(((t,s)=>t._lesson&&s._lesson?"title"===e?t._lesson.title.localeCompare(s._lesson.title):t._lesson[e]>s._lesson[e]?1:-1:1)):this.columns.slice().sort(((t,s)=>t._lesson&&s._lesson?"title"===e?s._lesson.title.localeCompare(t._lesson.title):t._lesson[e]<s._lesson[e]?1:-1:1))}renderSortButton(){const{t:e}=this.props;let t;switch(this.state.lessonOrder){case"title":t=e("common:sort-alphabetically");break;case"createdAt":t=e("common:sort-create-date");break;case"updatedAt":t=e("common:sort-update-date")}return a.createElement(g.Z,{className:"sort-button-group"},a.createElement(oe.Z,{size:"sm",variant:"secondary",onSelect:e=>{this.columns=this.reorderColumns(e,this.state.lessonSortDirection),this.setState({lessonOrder:e})},id:"dropdown",title:a.createElement("small",null,t)},a.createElement(le.Z.Item,{eventKey:"title"},a.createElement("small",null,e("common:sort-alphabetically"))),a.createElement(le.Z.Item,{eventKey:"createdAt"},a.createElement("small",null,e("common:sort-create-date"))),a.createElement(le.Z.Item,{eventKey:"updatedAt"},a.createElement("small",null,e("common:sort-update-date")))),a.createElement(f.Z,{size:"sm",variant:"secondary",style:{marginLeft:2},onClick:()=>{"ascending"===this.state.lessonSortDirection?(this.columns=this.reorderColumns(this.state.lessonOrder,"descending"),this.setState({lessonSortDirection:"descending"})):(this.columns=this.reorderColumns(this.state.lessonOrder,"ascending"),this.setState({lessonSortDirection:"ascending"}))},"aria-label":"ascending"===this.state.lessonSortDirection?e("common:sort-descending"):e("common:sort-ascending")},"ascending"===this.state.lessonSortDirection?a.createElement("i",{className:"fas fa-arrow-right"}):a.createElement("i",{className:"fas fa-arrow-left"})))}render(){const{t:e}=this.props;if(this.state.showExplorer){let t=this.assembleData();t=(0,O.Z)(t);const s=[],n=["name","email","cohort"];for(let e=0;e<this.props.lessons.length;e++){const t=this.props.lessons[e].title;s.push(`${t}_question_progress`),s.push(`${t}_time`),n.push(`${t}_first_accessed`),n.push(`${t}_last_accessed`)}const r=this.props.user.availableCustomFields;for(let e=0;e<r.length;e++)n.push(r[e].name);return a.createElement(F.Z,{title:e("explorer-progress-title"),data:t,categorical:n,quantitative:s,close:this.toggleExplorer})}return a.createElement(a.Fragment,null,a.createElement("div",{className:"namespace-data-buttons"},this.renderSortButton(),a.createElement(g.Z,{className:"progress-button-group"},a.createElement(v.Z,{placement:"bottom",overlay:a.createElement(y.Z,{id:"csvTooltip"},e("save-as-csv"))},a.createElement(f.Z,{size:"sm",variant:"secondary",onClick:this.saveCSV},a.createElement("i",{className:"fas fa-download"})," CSV")),a.createElement(v.Z,{placement:"bottom",overlay:a.createElement(y.Z,{id:"jsonTooltip"},e("save-as-json"))},a.createElement(f.Z,{size:"sm",variant:"secondary",onClick:this.saveJSON},a.createElement("i",{className:"fas fa-download"})," JSON")))),a.createElement("div",{className:"namespace-data-page"},a.createElement(q.Z,{className:"progress-table",data:this.state.displayedMembers,columns:this.columns,t:e,ref:e=>{this.dashboardTable=e},onButtonClick:this.toggleExplorer})))}}Se.propTypes={addNotification:l().func.isRequired,adjustProgress:l().func.isRequired,cohorts:l().array.isRequired,lessons:l().array.isRequired,namespace:l().object.isRequired,user:l().object.isRequired},Se.defaultProps={};var _e=(0,m.Z)(["namespace_data","common"])(Se),Te=s(67289);function Me(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ae extends a.Component{constructor(e){super(e),Me(this,"handleCohortChange",(e=>{let t=[];if(e)for(let s=0;s<e.length;s++)t=t.concat(e[s].data.members);this.setState({selectedCohorts:e,displayedMembers:t})})),Me(this,"showUser",(e=>{this.setState({actualMember:e})})),Me(this,"closeActualMember",(()=>{this.setState({actualMember:null})}));const t=e.cohorts.map((e=>({label:e.title,value:e.title,data:e})));let s=[];for(let a=0;a<e.cohorts.length;a++)s=s.concat(e.cohorts[a].members);this.state={cohortOptions:t,selectedCohorts:t,displayedMembers:s,actualMember:null}}componentDidUpdate(e){if(this.props.cohorts!==e.cohorts){const e=this.props.cohorts.map((e=>({label:e.title,value:e.title,data:e})));let t=[];for(let s=0;s<this.props.cohorts.length;s++)t=t.concat(this.props.cohorts[s].members);this.setState({cohortOptions:e,selectedCohorts:e,displayedMembers:t,actualMember:null})}}renderMember(e,t){let s="scale-up "+(.3+.05*t)+"s";return a.createElement(a.Fragment,{key:t},a.createElement("div",{className:"cohort-member",role:"button",onClick:()=>this.showUser(e),onKeyPress:()=>this.showUser(e),style:{animation:s},tabIndex:0},a.createElement("div",{className:"cohort-member-name"},e.name),a.createElement("img",{src:j.ZP+"/thumbnail/"+e.picture,alt:"Member Profile Pic"}),a.createElement("div",{className:"cohort-member-email"},a.createElement("a",{href:"mailto:"+e.email},e.email))))}renderCohort(){const e=this.state.displayedMembers,t=[];for(let s=0;s<e.length;s++)t.push(this.renderMember(e[s],s));return t}renderMemberLessons(e){const t=this.props.lessons,s=[];let n=0,r=0,o=0;for(let l=0;l<t.length;l++){let i=t[l]._id;if(e.lessonData&&e.lessonData[i]){const t=e.lessonData[i];n=de()(ce()(100*t.progress),100),r=(0,Ze.Z)(t.spentTime),o+=t.spentTime}else n=0,r=(0,Ze.Z)(0);s.push(a.createElement("div",{key:l},a.createElement("div",{className:"cohort-actual-member-lesson-title"},t[l].title),a.createElement(fe.Z,{"aria-label":"lesson-progress",className:"cohort-actual-member-lesson-progress",style:{float:"left",fontSize:"10px",height:"12px"},now:n,label:`${n}%`}),a.createElement("span",{className:"cohort-actual-member-lesson-time"},r)))}return o=(0,Ze.Z)(o),a.createElement(a.Fragment,null,a.createElement("hr",null),a.createElement("div",{className:"cohort-actual-member-lesson-header"},"COURSE INFO"),a.createElement("div",{className:"cohort-actual-member-lesson-total"},"COURSE TOTAL TIME: ",o),a.createElement("div",{className:"lessons-area"},s))}renderMemberBadges(e){const t=this.props.badges,s=(0,Ze.Z)(e.spentTime),n=[];for(let r=0;r<t.length;r++)M()(e.badges,t[r].name)&&n.push(a.createElement(a.Fragment,null,a.createElement(v.Z,{placement:"bottom",overlay:a.createElement(y.Z,{id:"isleTime"},t[r].description)},a.createElement("div",{className:"cohort-user-badge"},a.createElement("img",{src:j.ZP+"/badges/"+t[r].picture,alt:"User Badge"})))));return a.createElement(a.Fragment,null,a.createElement("div",null,"General User Info"),a.createElement(v.Z,{placement:"bottom",overlay:a.createElement(y.Z,{id:"isleTime"},"the time the user spent with ISLE")},a.createElement("span",{className:"user-info-time"},"ISLE TIME: ",s)),a.createElement(v.Z,{placement:"bottom",overlay:a.createElement(y.Z,{id:"isleTime"},"user score")},a.createElement("span",{className:"user-info-score"},"SCORE: ",e.score)),a.createElement("div",null),a.createElement("div",{className:"user-info-badges"},a.createElement("div",{className:"user-info-separator"},"Badges"),n))}renderActualMember(){const e=this.state.actualMember;let t=null;return e.createdAt&&(t=new Date(e.createdAt).toLocaleDateString()),a.createElement("div",{className:"cohort-actual-member"},a.createElement("button",{onClick:this.closeActualMember,className:"cohort-actual-member-exit empty-button"},"\u2715"),a.createElement("img",{className:"cohort-actual-member-portrait",src:j.ZP+"/avatar/"+e.picture,alt:"User Profile Pic"}),a.createElement("div",{className:"cohort-actual-member-portrait-shadow"}),t?a.createElement("div",{className:"cohort-actual-member-registered"},"registered since ",t):null,a.createElement("div",{className:"cohort-actual-member-name"},a.createElement("h3",null,e.name),a.createElement("div",null,e.email)),a.createElement("div",{className:"cohort-actual-member-info"},this.renderMemberLessons(e)),a.createElement("div",{className:"cohort-actual-member-badges"},this.renderMemberBadges(e)))}render(){return a.createElement("div",{className:"namespace-data-page"},a.createElement("div",{style:{width:"100%",height:"40px"}},a.createElement(Te.ZP,{value:this.state.selectedCohorts,isMulti:!0,name:"cohorts","aria-label":"Select cohorts",placeholder:"Select cohorts to display",options:this.state.cohortOptions,onChange:this.handleCohortChange})),a.createElement("div",{className:"cohort-page"},this.renderCohort()),this.state.actualMember?this.renderActualMember():null)}}Ae.propTypes={badges:l().array.isRequired,cohorts:l().array.isRequired,lessons:l().array.isRequired},Ae.defaultProps={};var Pe=Ae,Ie=s(74802),Re=s.n(Ie);function Fe(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Oe=c()("isle:progress-page");function qe(e,t){return(s,a)=>{const n=a[s.id][e[t]._id];if(ge()(n))return 0===s.value.min;const r=n._sumPoints;return r>=s.value.min&&r<=s.value.max}}function Le(e,t){if("all"===e.value)return!0;const s=e.pivotId||e.id;return void 0===t[s]||(ue()(e.value)?M()(e.value,String(t[s])):String(t[s])===e.value)}function je(e,t){return(s,a)=>(s=s[e[t]._id],a=a[e[t]._id],s||a?s&&!a?1:!s&&a?-1:s._sumPoints>a._sumPoints?1:s._sumPoints<a._sumPoints?-1:0:0)}class ze extends a.Component{constructor(e){super(e),Fe(this,"accessorFactory",((e,t)=>s=>{let n=s.original.lessonGrades||{};const r=e[t],o=r._id;let l="";if(r.metadata&&r.metadata.grades&&(l+=` / ${e[t].metadata.grades.maxPoints}`),n=n[o],n){let e=[];for(let t in n)Re()(n,t)&&"_sumPoints"!==t&&e.push(a.createElement("p",{style:{margin:0},key:t},t,": ",a.createElement("b",{style:{float:"right",marginLeft:12}},n[t])));return a.createElement(v.Z,{placement:"top",overlay:a.createElement(Y.Z,{className:"tickets-description-overlay",body:!0,id:"description-tooltip"},e)},a.createElement("p",null,n._sumPoints,l))}return a.createElement("span",null)})),Fe(this,"saveJSON",(()=>{const e=this.assembleData(),t=new Blob([JSON.stringify(e)],{type:"application/json"}),s=`grades_${this.props.namespace.title}.json`;(0,z.Z)(t,s)})),Fe(this,"saveCSV",(()=>{const e=this.assembleData();h()(e,{header:!0},((e,t)=>{if(e)return this.props.addNotification({title:"Error encountered",message:"Encountered an error while creating CSV: "+e.message,level:"error",position:"tl"});const s=new Blob([t],{type:"text/plain"}),a=`grades_${this.props.namespace.title}.csv`;(0,z.Z)(s,a)}))})),Fe(this,"toggleExplorer",(()=>{this.setState({showExplorer:!this.state.showExplorer})})),this.columns=this.createColumns(e.lessons,e.cohorts),this.state={displayedMembers:[],lessonSortDirection:"ascending",lessonOrder:"createdAt",showExplorer:!1}}componentDidMount(){this.createDisplayedMembers()}componentDidUpdate(e){this.props.cohorts===e.cohorts&&this.props.lessons===e.lessons||(this.createDisplayedMembers(),this.columns=this.createColumns(this.props.lessons,this.props.cohorts))}createDisplayedMembers(){let e=[];for(let t=0;t<this.props.cohorts.length;t++){const s=this.props.cohorts[t].members;for(let e=0;e<s.length;e++)s[e].cohort=this.props.cohorts[t].title,s[e].lessonGrades||(s[e].lessonGrades={});e=e.concat(this.props.cohorts[t].members)}for(let t=0;t<e.length;t++){const s=e[t],a=R()(s.name).split(" ");a.length>1?(s.lastName=a.pop(),s.firstName=a.join(" ")):(s.firstName=a[0],s.lastName="")}this.setState({displayedMembers:e})}createColumns(e,t){const{t:s}=this.props,n=[{Header:"Pic",accessor:"picture",Cell:e=>a.createElement("img",{className:"table-pic",src:`${j.ZP}/thumbnail/${e.original.picture}`,alt:"Profile Pic"}),maxWidth:46,minWidth:46,filterable:!1,resizable:!1,sortable:!1,style:{color:"darkslategrey"}},(0,$.Z)({Header:s("first-name"),id:"first_name",accessor:"firstName",maxWidth:75,filterMethod:(e,t)=>M()(P()(t[e.id]),P()(e.value))}),(0,$.Z)({Header:s("last-name"),id:"last_name",accessor:"lastName",maxWidth:75,filterMethod:(e,t)=>M()(P()(t[e.id]),P()(e.value))}),(0,$.Z)({Header:s("common:email"),accessor:"email",maxWidth:200,filterMethod:(e,t)=>M()(P()(t[e.id]),P()(e.value))}),{Header:s("common:cohort"),accessor:"cohort",style:{marginTop:"8px",color:"darkslategrey"},filterMethod:Le,Filter:({filter:e,onChange:s})=>{const n=e=>{const t=e.target.value;s(t)};let r;return r=e?ue()(e.value)?e.value.join(", "):e.value:"all",a.createElement("select",{onBlur:n,onChange:n,style:{width:"100%",backgroundColor:"ghostwhite"},value:r},a.createElement("option",{value:"all"},"Show All"),t.map(((e,t)=>a.createElement("option",{key:t,value:`${e.title}`},e.title))))}}];for(let r=0;r<e.length;r++){const t="lesson_"+r;n.push({id:t,Header:a.createElement("span",{id:t},e[r].title),_lesson:e[r],Cell:this.accessorFactory(e,r),sortMethod:je(e,r),filterMethod:qe(e,r),Filter:({filter:s,onChange:n})=>{let o=0;e[r].metadata&&e[r].metadata.grades&&(o=e[r].metadata.grades.maxPoints);const l={max:o,min:0};return a.createElement("div",{style:{paddingLeft:"4px",paddingRight:"4px",paddingTop:"8px"}},a.createElement(re(),{ariaLabelledby:t,ariaControls:"dashboard-table",allowSameValues:!0,maxValue:o,minValue:0,value:s?s.value:l,onChange:e=>{n(e)}}))},accessor:"lessonGrades"})}return n}reorderColumns(e,t){return Oe("Sort columns by "+e+" in "+t+" order"),"ascending"===t?this.columns.slice().sort(((t,s)=>t._lesson&&s._lesson?"title"===e?t._lesson.title.localeCompare(s._lesson.title):t._lesson[e]>s._lesson[e]?1:-1:1)):this.columns.slice().sort(((t,s)=>t._lesson&&s._lesson?"title"===e?s._lesson.title.localeCompare(t._lesson.title):t._lesson[e]<s._lesson[e]?1:-1:1))}assembleData(){const e=this.dashboardTable.table.getResolvedState().sortedData,t=e.length,s=new Array(t),a=this.props.lessons;for(let n=0;n<t;n++){const t=e[n]._original;s[n]={name:t.name,firstName:t.firstName,lastName:t.lastName,email:t.email,cohort:t.cohort};const r=this.props.user.availableCustomFields;for(let e=0;e<r.length;e++){const a=r[e].name;t.customFields?s[n][a]=t.customFields[a]:s[n][a]=null}for(let e=0;e<a.length;e++){const r=a[e]._id;let o=t.lessonGrades;o&&o[r]?(o=o[r],s[n][a[e].title]=o._sumPoints):s[n][a[e].title]=""}}return s}renderSortButton(){const{t:e}=this.props;let t;switch(this.state.lessonOrder){case"title":t=e("common:sort-alphabetically");break;case"createdAt":t=e("common:sort-create-date");break;case"updatedAt":t=e("common:sort-update-date")}return a.createElement(g.Z,{className:"sort-button-group"},a.createElement(oe.Z,{size:"sm",variant:"secondary",onSelect:e=>{this.columns=this.reorderColumns(e,this.state.lessonSortDirection),this.setState({lessonOrder:e})},id:"dropdown",title:a.createElement("small",null,t)},a.createElement(le.Z.Item,{eventKey:"title"},a.createElement("small",null,e("common:sort-alphabetically"))),a.createElement(le.Z.Item,{eventKey:"createdAt"},a.createElement("small",null,e("common:sort-create-date"))),a.createElement(le.Z.Item,{eventKey:"updatedAt"},a.createElement("small",null,e("common:sort-update-date")))),a.createElement(f.Z,{size:"sm",variant:"secondary",style:{marginLeft:2},onClick:()=>{"ascending"===this.state.lessonSortDirection?(this.columns=this.reorderColumns(this.state.lessonOrder,"descending"),this.setState({lessonSortDirection:"descending"})):(this.columns=this.reorderColumns(this.state.lessonOrder,"ascending"),this.setState({lessonSortDirection:"ascending"}))},"aria-label":"ascending"===this.state.lessonSortDirection?e("common:sort-descending"):e("common:sort-ascending")},"ascending"===this.state.lessonSortDirection?a.createElement("i",{className:"fas fa-arrow-right"}):a.createElement("i",{className:"fas fa-arrow-left"})))}render(){const{t:e}=this.props;if(this.state.showExplorer){let t=this.assembleData();t=(0,O.Z)(t);const s=[],n=["name","email","cohort"];for(let e=0;e<this.props.lessons.length;e++)s.push(this.props.lessons[e].title);const r=this.props.user.availableCustomFields;for(let e=0;e<r.length;e++)n.push(r[e].name);return a.createElement(F.Z,{title:e("explorer-grades-title"),data:t,categorical:n,quantitative:s,close:this.toggleExplorer})}return a.createElement(a.Fragment,null,a.createElement("div",{className:"namespace-data-buttons"},this.renderSortButton(),a.createElement(g.Z,{className:"progress-button-group"},a.createElement(v.Z,{placement:"bottom",overlay:a.createElement(y.Z,{id:"csvTooltip"},e("save-as-csv"))},a.createElement(f.Z,{size:"sm",variant:"secondary",onClick:this.saveCSV},a.createElement("i",{className:"fas fa-download"})," CSV")),a.createElement(v.Z,{placement:"bottom",overlay:a.createElement(y.Z,{id:"jsonTooltip"},e("save-as-json"))},a.createElement(f.Z,{size:"sm",variant:"secondary",onClick:this.saveJSON},a.createElement("i",{className:"fas fa-download"})," JSON")))),a.createElement("div",{className:"namespace-data-page"},a.createElement(q.Z,{className:"grades-table",data:this.state.displayedMembers,columns:this.columns,t:e,ref:e=>{this.dashboardTable=e},onButtonClick:this.toggleExplorer})))}}ze.propTypes={addNotification:l().func.isRequired,cohorts:l().array.isRequired,lessons:l().array.isRequired,namespace:l().object.isRequired,user:l().object.isRequired},ze.defaultProps={};var He=(0,m.Z)(["namespace_data","common"])(ze),$e=s(51816),We=s(64705);function Be(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Ue=c()("isle-dashboard:namespace-data:actions-page");class Ve extends a.Component{constructor(e){super(e),Be(this,"retrieveActions",(()=>{this.props.getNamespaceActions({namespaceID:this.props.namespace._id,namespaceTitle:this.props.namespace.title})})),Be(this,"handleRadioChange",(e=>{this.setState({anonymized:!this.state.anonymized})})),Be(this,"handleCohortChange",(e=>{let t=[];for(let s=0;s<e.length;s++)t=t.concat(e[s].value.members);this.setState({selectedCohorts:e,displayedMembers:t},(()=>{Ue("New number of displayed members: "+this.state.displayedMembers.length)}))})),Be(this,"hideLessonActions",(()=>{this.setState({lessonActionsPage:!1})})),Be(this,"showLessonActions",(e=>{this.setState({lessonActionsPage:!0,actualLesson:e})}));const t=e.cohorts.map((e=>({label:e.title,value:e})));let s=[];for(let a=0;a<e.cohorts.length;a++)s=s.concat(e.cohorts[a].members);this.state={cohortOptions:t,selectedCohorts:t,displayedMembers:s,lessonActionsPage:!1,actualLesson:null,anonymized:!0}}renderCohorts(){return a.createElement(a.Fragment,null,a.createElement("div",{className:"actions-page-cohorts"},a.createElement("div",{style:{width:"400px",height:"40px"}},a.createElement(Te.ZP,{value:this.state.selectedCohorts,isMulti:!0,name:"cohorts",options:this.state.cohortOptions,onChange:this.handleCohortChange}))))}renderLessonActionsPage(){return a.createElement("div",{className:"actions-page-lesson-action-page"},a.createElement("div",{className:"lesson-action-page-resize"}," \ud83d\uddd6"),a.createElement("button",{onClick:this.hideLessonActions,className:"lesson-action-page-exit empty-button"},"\u2715"),a.createElement("div",{className:"lesson-action-page-title"},this.state.actualLesson.title),a.createElement("div",{className:"lesson-action-page-filter"},this.renderCohorts()))}renderLessons(){const e=this.props.namespace.lessons,t=[];for(let s=0;s<e.length;s++)t.push(a.createElement("button",{key:s,onClick:()=>this.showLessonActions(e[s]),className:"actions-page-lesson"},a.createElement("div",{className:"actions-page-lesson-title"},e[s].title)));return a.createElement("div",{className:"actions-page"},a.createElement("div",{className:"actions-page-export"},this.renderExportSection()),a.createElement("div",{className:"actions-page-lessons"},t))}renderExportSection(){return a.createElement(a.Fragment,null,a.createElement("div",{className:"actions-page-export-title"},"Export Actions"),a.createElement($e.Z,{name:"options",onChange:this.handleRadioChange,type:"radio",size:"small",value:this.state.anonymized},a.createElement(We.Z,{size:"sm",variant:"light",value:!1,style:{fontSize:"12px",color:this.state.anonymized?"#A9A9A9":"black"}},"Original"),a.createElement(We.Z,{size:"sm",variant:"light",value:!0,style:{fontSize:"12px",color:this.state.anonymized?"black":"#A9A9A9"}},"Anonymized")),a.createElement(f.Z,{onClick:this.retrieveActions},"Save all namespace actions"))}render(){return a.createElement("div",{className:"namespace-data-page"},this.renderLessons(),this.state.lessonActionsPage?this.renderLessonActionsPage():null)}}Ve.propTypes={cohorts:l().array.isRequired,getNamespaceActions:l().func.isRequired,namespace:l().object.isRequired},Ve.defaultProps={};var Ke=Ve,Ge=s(53697),Je=s.n(Ge),Xe=s(88928),Ye=s.n(Xe),Qe=s(67196),et=s.n(Qe),tt=s(5610),st=s(73745),at=s(27925),nt=s(77536);function rt(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ot=c()("isle:files-page"),lt=/ticket=([^&]*)/;class it extends a.Component{constructor(e){super(e),rt(this,"toggleTicketModal",(()=>{this.setState({showTicketModal:!this.state.showTicketModal})})),rt(this,"createColumns",(()=>{const{t:e}=this.props,t=this.props.tickets||[];let s=Ye(),n=0;for(let a=0;a<t.length;a++)t[a].createdAt>n&&(n=t[a].createdAt),t[a].updatedAt>n&&(n=t[a].updatedAt),t[a].createdAt<s&&(s=t[a].createdAt),t[a].updatedAt<s&&(s=t[a].updatedAt);return n=Je()(n),s=Je()(s),[{Header:"Pic",accessor:"user.picture",Cell:e=>a.createElement("img",{className:"table-pic",src:`${j.ZP}/thumbnail/${e.value}`,alt:"Profile Pic"}),style:{marginTop:"8px",color:"darkslategrey"},maxWidth:46,minWidth:46,filterable:!1,resizable:!1,sortable:!1},(0,$.Z)({Header:e("common:name"),accessor:"user.name",style:{marginTop:"8px",color:"darkslategrey"}}),(0,$.Z)({Header:e("common:email"),accessor:"user.email",style:{marginTop:"8px",color:"darkslategrey"}}),(0,$.Z)({Header:e("common:title"),accessor:"title",minWidth:200}),{Header:e("common:description"),accessor:"description",Cell:e=>a.createElement(v.Z,{placement:"top",overlay:a.createElement(Y.Z,{className:"tickets-description-overlay",body:!0,id:"description-tooltip"},e.value)},a.createElement("p",{className:"tickets-description"},e.value)),style:{marginTop:"8px",color:"darkslategrey"},minWidth:300},(0,$.Z)({Header:e("common:component"),accessor:"component"}),{Header:"Reply",accessor:"_id",Cell:t=>a.createElement(v.Z,{placement:"left",overlay:a.createElement(y.Z,{id:"open-ticket-tooltip"},e("common:open-ticket-tooltip"))},a.createElement(f.Z,{size:"sm",variant:"outline-secondary",onClick:()=>{this.setState({selectedTicket:t.original},this.toggleTicketModal)}},a.createElement("i",{className:"fas fa-reply"}))),resizable:!1,filterable:!1,sortable:!1,width:45},(0,st.Z)({Header:e("common:priority"),accessor:"priority",labels:["Low","Middle","High"],maxWidth:200,Cell:e=>{if(!e.value)return null;let t,s,n;switch(e.value){case"Low":t="secondary",s="Middle";break;case"Middle":t="warning",s="High",n="Low";break;case"High":t="danger",n="Middle"}return a.createElement("div",null,a.createElement(w.Z,{variant:t,style:{marginRight:6,fontSize:"1em"}},e.value),a.createElement(f.Z,{size:"sm",variant:"outline-secondary",onClick:()=>{this.props.updatePriority(e.original._id,s)},disabled:!s},a.createElement("i",{className:"fas fa-arrow-up"})),a.createElement(f.Z,{size:"sm",variant:"outline-secondary",onClick:()=>{this.props.updatePriority(e.original._id,n)},disabled:!n},a.createElement("i",{className:"fas fa-arrow-down"})))}}),(0,$.Z)({Header:e("common:lesson"),accessor:"lesson.title",maxWidth:140,Cell:t=>{if(!t.value)return null;const s=`${j.ZP}/${this.props.namespace.title}/${t.value}`;return a.createElement(v.Z,{placement:"right",overlay:a.createElement(y.Z,{id:"open-lesson-tooltip"},e("namespace_data:open-lesson-new-tab"))},a.createElement(w.Z,{variant:"light",style:{fontSize:"1em"}},a.createElement("a",{href:s,target:"_blank",rel:"noopener noreferrer"},t.value)))}}),(0,at.Z)({Header:e("common:done"),accessor:"done",trueLabel:e("common:done"),falseLabel:e("common:not-done")}),{Header:e("common:platform"),accessor:"platform",style:{marginTop:"2px",color:"darkslategrey",fontSize:24,textAlign:"center",cursor:"pointer"},Cell:e=>{if(e.value){const t=a.createElement(tt.Z,{id:"popover-data",style:{maxWidth:500,maxHeight:"80vh",overflowY:"auto"},arrowProps:{display:"none"}},a.createElement(tt.Z.Title,{as:"h3"},e.row._original.title),a.createElement(tt.Z.Content,{style:{backgroundColor:"lightblue"}},a.createElement("pre",null,JSON.stringify(et()(e.value,["description"]),null,2))));return a.createElement(v.Z,{trigger:"click",placement:"left",overlay:t},a.createElement("i",{className:"data-icon fas fa-tablet-alt"}))}return null},maxWidth:75,resizable:!1,filterable:!1,sortable:!1},(0,H.Z)({Header:e("created-at"),accessor:"createdAt",startDate:s,endDate:n,t:e})]})),rt(this,"toggleExplorer",(()=>{this.setState({showExplorer:!this.state.showExplorer})})),rt(this,"assembleExplorerData",(()=>{let e=this.props.tickets,t=[];for(let s=0;s<e.length;s++){const a=e[s],n={};n.component=a.component,n.title=a.title,n.description=a.description,n.lesson=a.lesson?a.lesson.title:null,n.messages=a.messages.length,n.attachments=a.attachments.length,n.user=a.user.email,n.done=a.done,n.priority=a.priority,n.browser=`${a.platform.name} ${a.platform.version}`;const r=a.platform.os;n.os=`${r.family} ${r.version?r.version:""} ${r.architecture}bit`,n.createdAt=a.createdAt,n.updatedAt=a.updatedAt,t.push(n)}return t=(0,O.Z)(t),t})),this.state={showTicketModal:!1,selectedTicket:null,showExplorer:!1},this.columns=this.createColumns()}async componentDidMount(){if(ot("Component did mount..."),await this.props.getCourseTickets(this.props.namespace._id),this.props.history.location.search){const e=lt.exec(this.props.history.location.search);if(e&&e[1]){const t=this.props.tickets;for(let s=0;s<t.length;s++){const a=t[s];if(a._id===e[1]){this.setState({selectedTicket:a,showTicketModal:!0});break}}}}}render(){const{t:e}=this.props;return this.state.showExplorer?a.createElement(F.Z,{title:e("explorer-tickets-title"),data:this.assembleExplorerData(),categorical:["component","lesson","done","createdAt","updatedAt","priority","browser","os"],quantitative:["messages","attachments"],close:this.toggleExplorer}):a.createElement("div",{className:"namespace-data-page"},a.createElement(q.Z,{data:this.props.tickets,columns:this.columns,t:e,onButtonClick:this.toggleExplorer}),this.state.showTicketModal?a.createElement(nt.Z,{show:this.state.showTicketModal,onHide:this.toggleTicketModal,ticket:this.state.selectedTicket,submitTicketMessage:this.props.submitTicketMessage,openTicket:this.props.openTicket,closeTicket:this.props.closeTicket}):null)}}it.propTypes={closeTicket:l().func.isRequired,getCourseTickets:l().func.isRequired,namespace:l().object.isRequired,openTicket:l().func.isRequired,submitTicketMessage:l().func.isRequired,tickets:l().array,updatePriority:l().func.isRequired},it.defaultProps={tickets:[]};var ct=(0,m.Z)(["namespace_data","common"])(it);function mt(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const dt=c()("isle-dashboard:namespace-data");class pt extends a.Component{constructor(e){super(e),mt(this,"handleUpload",(e=>{dt("Uploading file...");const t=e.target.files[0],s=new FormData;s.append("file",t,t.name),s.append("namespaceName",this.props.namespace.title),s.append("owner","true"),this.props.uploadFile({formData:s,user:this.props.user})})),mt(this,"handleAnnouncementDeletion",((e,t)=>{this.props.deleteAnnouncement({namespaceName:this.props.namespace.title,index:t,createdAt:e})})),mt(this,"handleAnnouncementEdit",(e=>{this.props.editAnnouncement({namespaceName:this.props.namespace.title,announcement:e})})),mt(this,"handleAnnouncementCreation",(e=>{this.props.addAnnouncement({namespaceName:this.props.namespace.title,announcement:e})})),mt(this,"handleFileDeletion",((e,t)=>{this.props.deleteFile(e,this.props.namespace.title,t)})),mt(this,"submitTicketMessage",(({message:e,ticketID:t})=>{this.props.sendTicketMessage({message:e,ticketID:t,user:this.props.user})})),mt(this,"handleSelect",(e=>{e=Number(e);const t=this.props.namespace.title;switch(e){case 1:this.props.history.replace(`/namespace-data/${t}/announcements`);break;case 2:this.props.history.replace(`/namespace-data/${t}/progress`);break;case 3:this.props.history.replace(`/namespace-data/${t}/grades`);break;case 4:this.props.history.replace(`/namespace-data/${t}/cohorts`);break;case 5:this.props.history.replace(`/namespace-data/${t}/owner-files`);break;case 6:this.props.history.replace(`/namespace-data/${t}/student-files`);break;case 7:this.props.history.replace(`/namespace-data/${t}/tickets`);break;case 8:this.props.history.replace(`/namespace-data/${t}/actions`)}this.setState({activePage:e})}));let t;switch(e.match.params.subpage){default:t=1;break;case"progress":t=2;break;case"grades":t=3;break;case"cohorts":t=4;break;case"owner-files":t=5;break;case"student-files":t=6;break;case"tickets":t=7;break;case"actions":t=8}this.state={activePage:t}}componentDidMount(){this.props.getBadges()}renderPage(){switch(this.state.activePage){case 1:return a.createElement(ae,{namespace:this.props.namespace,editAnnouncement:this.handleAnnouncementEdit,deleteAnnouncement:this.handleAnnouncementDeletion,addAnnouncement:this.handleAnnouncementCreation,user:this.props.user});case 2:return a.createElement(_e,{adjustProgress:this.props.adjustProgress,addNotification:this.props.addNotification,namespace:this.props.namespace,cohorts:this.props.namespace.cohorts,lessons:this.props.namespace.lessons,user:this.props.user});case 3:return a.createElement(He,{addNotification:this.props.addNotification,namespace:this.props.namespace,cohorts:this.props.namespace.cohorts,lessons:this.props.namespace.lessons,user:this.props.user});case 4:return a.createElement(Pe,{badges:this.props.badges,cohorts:this.props.namespace.cohorts,lessons:this.props.namespace.lessons});case 5:return a.createElement(X,{ownerFiles:!0,files:this.props.namespace.ownerFiles,namespace:this.props.namespace,handleUpload:this.handleUpload,handleFileDeletion:this.handleFileDeletion,addNotification:this.props.addNotification,getFiles:this.props.getOwnerFiles});case 6:return a.createElement(X,{files:this.props.namespace.files,namespace:this.props.namespace,handleUpload:this.handleUpload,handleFileDeletion:this.handleFileDeletion,addNotification:this.props.addNotification,getFiles:this.props.getFiles});case 7:return a.createElement(ct,{tickets:this.props.namespace.tickets,namespace:this.props.namespace,getCourseTickets:this.props.getCourseTickets,submitTicketMessage:this.submitTicketMessage,openTicket:this.props.openTicket,closeTicket:this.props.closeTicket,updatePriority:this.props.updatePriority,history:this.props.history});case 8:return a.createElement(Ke,{namespace:this.props.namespace,getNamespaceActions:this.props.getNamespaceActions,user:this.props.user,cohorts:this.props.namespace.cohorts})}}render(){const{t:e}=this.props;if(!this.props.namespace._id)return a.createElement("div",{className:"namespace-data-div"},a.createElement(d.Z,{variant:"danger"},e("common:no-course-selected")));const t=this.renderPage();return a.createElement("div",{className:"namespace-data-div"},a.createElement("div",{className:"namespace-data-navbar"},a.createElement(p.Z,{variant:"pills",className:"namespace-data-navbar-pills",activeKey:this.state.activePage,onSelect:this.handleSelect},a.createElement(p.Z.Item,null,a.createElement(p.Z.Link,{eventKey:"1",title:"Announcements"},e("common:announcements"))),a.createElement(p.Z.Item,null,a.createElement(p.Z.Link,{eventKey:"2",title:"Progress"},e("common:progress"))),a.createElement(p.Z.Item,null,a.createElement(p.Z.Link,{eventKey:"3",title:"Grades"},e("grades"))),a.createElement(p.Z.Item,null,a.createElement(p.Z.Link,{eventKey:"4",title:"Cohorts"},e("common:cohorts"))),a.createElement(p.Z.Item,null,a.createElement(p.Z.Link,{eventKey:"5",title:"Owner Files"},e("owner-files"))),a.createElement(p.Z.Item,null,a.createElement(p.Z.Link,{eventKey:"6",title:"Student Files"},e("student-files"))),a.createElement(p.Z.Item,null,a.createElement(p.Z.Link,{eventKey:"7",title:"Tickets",disabled:!this.props.namespace.enableTicketing},e("common:tickets"))),a.createElement(p.Z.Item,null,a.createElement(p.Z.Link,{eventKey:"8",title:"Actions",disabled:!0},e("common:actions"))))),a.createElement("div",{className:"namespace-data-page-container",style:{overflowY:"auto"}},t))}}pt.propTypes={addAnnouncement:l().func.isRequired,addNotification:l().func.isRequired,adjustProgress:l().func.isRequired,badges:l().array,closeTicket:l().func.isRequired,deleteAnnouncement:l().func.isRequired,deleteFile:l().func.isRequired,editAnnouncement:l().func.isRequired,getBadges:l().func.isRequired,getCourseTickets:l().func.isRequired,getFiles:l().func.isRequired,getNamespaceActions:l().func.isRequired,getOwnerFiles:l().func.isRequired,match:l().object.isRequired,namespace:l().object.isRequired,openTicket:l().func.isRequired,sendTicketMessage:l().func.isRequired,updatePriority:l().func.isRequired,uploadFile:l().func.isRequired,user:l().object.isRequired},pt.defaultProps={badges:null};var ut=(0,m.Z)(["namespace_data","common"])(pt),ht=s(1209),gt=s(76417),ft=s(94883);const bt=async(e,{namespaceName:t,announcement:s})=>{try{const a=await ft.eC.post(j.ZP+"/new_announcement",{namespaceName:t,announcement:s});(0,gt.wN)(e,{message:a.data.message,level:"success"}),e(function(e,t){return{type:ht.H0,payload:{announcement:e,namespaceName:t}}}(s,t))}catch(a){(0,gt.EG)(e,a)}},Et=e=>async({namespaceName:t,announcement:s})=>{await bt(e,{namespaceName:t,announcement:s})},vt=async(e,{namespaceName:t,createdAt:s,index:a})=>{try{const n=await ft.eC.post(j.ZP+"/delete_announcement",{namespaceName:t,createdAt:s});(0,gt.wN)(e,{message:n.data.message,level:"success"}),e(function(e,t){return{type:ht.wd,payload:{index:e,namespaceName:t}}}(a,t))}catch(n){(0,gt.EG)(e,n)}},yt=e=>async({namespaceName:t,createdAt:s,index:a})=>{await vt(e,{namespaceName:t,createdAt:s,index:a})},wt=async(e,{namespaceName:t,announcement:s})=>{try{const a=await ft.eC.post(j.ZP+"/edit_announcement",{namespaceName:t,announcement:s});(0,gt.wN)(e,{message:a.data.message,level:"success"}),e(function(e,t){return{type:ht.wx,payload:{announcement:e,namespaceName:t}}}(s,t))}catch(a){(0,gt.EG)(e,a)}},Zt=e=>async({namespaceName:t,announcement:s})=>{await wt(e,{namespaceName:t,announcement:s})};var Ct=s(64193),Nt=s(40024),kt=s(13222),Dt=s(44804);const xt=(0,n.$j)((function(e){return{badges:e.badges,user:e.user,namespace:e.namespace}}),(function(e){return{adjustProgress:(0,kt.Tm)(e),getBadges:(0,Ct.Zl)(e),getCourseTickets:(0,Dt.P3)(e),getFiles:(0,Nt.TK)(e),getOwnerFiles:(0,Nt.Ru)(e),getNamespaceActions:(0,kt.qw)(e),addNotification:(0,gt.pP)(e),deleteFile:(0,Nt.ns)(e),deleteAnnouncement:yt(e),editAnnouncement:Zt(e),addAnnouncement:Et(e),sendTicketMessage:(0,Dt.fG)(e),closeTicket:(0,Dt.xG)(e),openTicket:(0,Dt.mJ)(e),uploadFile:(0,Nt.E8)(e),updatePriority:(0,Dt.Cq)(e)}}))(ut);var St=(0,r.EN)(xt)},34668:function(e,t,s){const a=(0,s(221).Z)((()=>Promise.all([s.e(8504),s.e(6351)]).then(s.bind(s,27248))));t.Z=a},27925:function(e,t,s){var a=s(38603);t.Z=function({Header:e,accessor:t,trueLabel:s,falseLabel:n,printLabels:r=!1,maxWidth:o=150}){let l,i;return r?(l=e=>!0===e.value?s:!1===e.value?n:null,i={marginTop:"8px",color:"darkslategrey"}):(l=e=>e.value?a.createElement("i",{className:"far fa-check-square"}):null,i={marginTop:"2px",color:"darkslategrey",fontSize:24,textAlign:"center"}),{Header:e,accessor:t,style:i,Cell:l,filterMethod:(e,t)=>{if("all"===e.value)return!0;const s=e.pivotId||e.id;return void 0===t[s]||String(t[s])===e.value},Filter:({filter:e,onChange:t})=>{const r=e=>{const s=e.target.value;t(s)};let o;return o=e?e.value:"all",a.createElement("select",{onBlur:r,onChange:r,style:{width:"100%",backgroundColor:"ghostwhite"},value:o},a.createElement("option",{value:"all"},"Show All"),a.createElement("option",{value:!0},s),a.createElement("option",{value:!1},n))},maxWidth:o}}},73745:function(e,t,s){var a=s(38603);t.Z=function({Header:e,Cell:t,accessor:s,labels:n,maxWidth:r=150}){return{Header:e,accessor:s,style:undefined,Cell:t,filterMethod:(e,t)=>{if("all"===e.value)return!0;const s=e.pivotId||e.id;return void 0===t[s]||String(t[s])===e.value},Filter:({filter:e,onChange:t})=>{const s=e=>{const s=e.target.value;t(s)};let r;return r=e?e.value:"all",a.createElement("select",{onBlur:s,onChange:s,style:{width:"100%",backgroundColor:"ghostwhite"},value:r},a.createElement("option",{value:"all"},"Show All"),n.map(((e,t)=>a.createElement("option",{value:e,key:t},e))))},maxWidth:r}}},65307:function(e,t,s){var a=s(38603),n=s(52089),r=s(12908),o=s(5610),l=s(12630);s(77511);function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class c extends a.Component{constructor(e){super(e),i(this,"handleDatesChange",(({startDate:e,endDate:t})=>{this.setState({startDate:e,endDate:t},(()=>{this.props.onDatesChange(this.state)}))})),i(this,"handleReset",(()=>{this.setState({startDate:this.props.minDate,endDate:this.props.maxDate},(()=>{this.props.onDatesChange(this.state)}))})),this.state={startDate:e.startDate,endDate:e.endDate}}componentDidUpdate(e){this.props.startDate===e.startDate&&this.props.endDate===e.endDate||this.setState({startDate:this.props.startDate,endDate:this.props.endDate})}render(){return a.createElement(a.Fragment,null,a.createElement(n.DateRangePicker,{startDate:this.state.startDate,endDate:this.state.endDate,startDateId:"start_date_input",endDateId:"end_date_input",onDatesChange:this.handleDatesChange,focusedInput:this.state.focusedInput,onFocusChange:e=>this.setState({focusedInput:e}),isOutsideRange:()=>!1}),a.createElement(l.Z,{"aria-label":this.props.t("common:close"),variant:"warning",onClick:this.handleReset,style:{paddingTop:8,paddingLeft:16,paddingRight:16,paddingBottom:8,fontSize:20}},"x"))}}const m=e=>new Date(e.value).toLocaleString();t.Z=function({Header:e,accessor:t,Cell:s,style:n,startDate:i,endDate:d,t:p,maxWidth:u=150}){return{Header:e,accessor:t,style:n,Cell:s||m,filterMethod:(e,t)=>{if(!e.value)return!0;const{startDate:s,endDate:a}=e.value,n=t[e.pivotId||e.id].getTime();return s&&a?n>=s.valueOf()&&n<=a.valueOf():s?n>=s.valueOf():!a||n<=a.valueOf()},Filter:({filter:e,onChange:t})=>{const s=e&&e.value||{},n=a.createElement(o.Z,{id:"popover-data",style:{maxWidth:400}},a.createElement(o.Z.Title,{as:"h3"},p("common:dates")),a.createElement(o.Z.Content,{style:{backgroundColor:"grey"}},a.createElement(c,{startDate:s.startDate||i,minDate:i,maxDate:d,endDate:s.endDate||d,onDatesChange:({startDate:e,endDate:s})=>{t({startDate:e,endDate:s})},t:p})));return a.createElement(r.Z,{trigger:"click",placement:"right",overlay:n},a.createElement(l.Z,{"aria-label":p("common:toggle-calendar"),size:"sm",style:{float:"left",marginLeft:6},variant:"secondary"},a.createElement("i",{className:"far fa-calendar-alt"})))},maxWidth:u}}},33547:function(e,t,s){var a=s(38603),n=s(94688),r=s.n(n),o=s(83087),l=s.n(o),i=s(64817),c=s.n(i),m=s(21598),d=s.n(m);s(5541);const p=(e,t)=>{const s=t[e.pivotId||e.id];return s>=e.value.min&&s<=e.value.max},u=e=>d()(e,-2);t.Z=function({Header:e,accessor:t,Cell:s,minValue:n=0,maxValue:o=1,maxWidth:i=150,filterMethod:m,formatLabel:h}){const g=`header-${c()(l()(e," ","-"))}`;return{Header:a.createElement("span",{id:g},e),accessor:t,Cell:s||(e=>e.value?`${d()(e.value,-3)}`:"NA"),filterMethod:m||p,Filter:({filter:e,onChange:t})=>{n===o&&(o=n+=1);const s={max:o,min:n};return a.createElement("div",{style:{paddingLeft:"4px",paddingRight:"4px",paddingTop:"8px"}},a.createElement(r(),{ariaLabelledby:g,ariaControls:"dashboard-table",allowSameValues:!0,maxValue:o,minValue:n,step:.1,value:e?e.value:s,onChange:e=>{t(e)},formatLabel:h||u}))},maxWidth:i}}},76282:function(e,t,s){var a=s(38603),n=s(87078),r=s(72868);t.Z=function({id:e,Header:t,Cell:s,accessor:o,maxWidth:l=150,minWidth:i,filterMethod:c}){i>l&&(l=i);const m={id:e,Header:t,accessor:o,Cell:s,filterMethod:c||r.Z,Filter:({filter:e,onChange:s})=>a.createElement(n.Z,{"aria-label":t,autoComplete:"none",onChange:e=>{s(e.target.value)}})};return l&&(m.maxWidth=l),i&&(m.minWidth=i),m}},63163:function(e,t){const s=/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i;function a(e){setImmediate((function(){throw e}),0)}function n(e){return s.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}const r=function(e){if("undefined"===typeof e||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))return;function t(){return e.URL||e.webkitURL||e}function s(e){setTimeout((function(){"string"===typeof e?t().revokeObjectURL(e):e.remove()}),4e4)}const r=e.document.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,l=/constructor/i.test(e.HTMLElement)||e.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent),c=e.setImmediate||e.setTimeout;function m(m,d,p){p||(m=n(m));const u=this,h="application/octet-stream"===m.type;let g;function f(){!function(e,t,s){let n=(t=[].concat(t)).length;for(;n--;){let o=e["on"+t[n]];if("function"===typeof o)try{o.call(e,s||e)}catch(r){a(r)}}}(u,"writestart progress write writeend".split(" "))}if(u.readyState=u.INIT,o)return g=t().createObjectURL(m),void c((function(){r.href=g,r.download=d,function(e){const t=new MouseEvent("click");e.dispatchEvent(t)}(r),f(),s(g),u.readyState=u.DONE}),0);!function(){if((i||h&&l)&&e.FileReader){const t=new FileReader;return t.onloadend=function(){let s=i?t.result:t.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(s,"_blank")||(e.location.href=s),s=void 0,u.readyState=u.DONE,f()},t.readAsDataURL(m),void(u.readyState=u.INIT)}if(g||(g=t().createObjectURL(m)),h)e.location.href=g;else{e.open(g,"_blank")||(e.location.href=g)}u.readyState=u.DONE,f(),s(g)}()}const d=m.prototype;return"undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,s){return t=t||e.name||"download",s||(e=n(e)),navigator.msSaveOrOpenBlob(e,t)}:(d.abort=function(){},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=null,d.onwritestart=null,d.onprogress=null,d.onwrite=null,d.onabort=null,d.onerror=null,d.onwriteend=null,function(e,t,s){return new m(e,t||e.name||"download",s)})}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||(void 0).content);t.Z=r},72868:function(e,t,s){var a=s(89506),n=s.n(a),r=s(64817),o=s.n(r);t.Z=(e,t)=>{const s=t[e.id]||"";return n()(o()(s),o()(e.value))}},5541:function(){}}]);
//# sourceMappingURL=6815.cc89c4ef.chunk.js.map