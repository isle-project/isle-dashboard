{"version":3,"sources":["../node_modules/@isle-project/components/image/index.js","../node_modules/@isle-project/components/input/checkbox/main.js","../node_modules/@isle-project/components/input/checkbox/index.js","../node_modules/@isle-project/components/internal/delete-modal/index.js","../node_modules/@isle-project/utils/is-user-in-cohort/index.js","../node_modules/@isle-project/components/chat-button/index.js","../node_modules/@isle-project/components/video-chat-button/index.js","../node_modules/@isle-project/components/internal/text-clustering/worker.js","../node_modules/@isle-project/components/internal/text-clustering/cluster_modal.js","../node_modules/@isle-project/components/internal/text-clustering/index.js","../node_modules/@isle-project/components/switch/main.js","../node_modules/@isle-project/components/switch/index.js","../node_modules/@isle-project/components/word-cloud/index.js","../node_modules/@isle-project/components/internal/response-visualizer/search.js","../node_modules/@isle-project/components/internal/response-visualizer/single_action_modal.js","../node_modules/@isle-project/components/range-picker/index.js","../node_modules/@isle-project/components/internal/response-visualizer/fullscreen_header.js","../node_modules/@isle-project/components/internal/response-visualizer/fullscreen_action_display.js","../node_modules/@isle-project/components/internal/response-visualizer/extract_value.js","../node_modules/@isle-project/components/internal/response-visualizer/main.js","../node_modules/@isle-project/components/node_modules/react-bootstrap/esm/ProgressBar.js","../node_modules/@isle-project/components/node_modules/react-bootstrap/esm/ElementChildren.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/assert/is-empty-string/lib/index.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/assert/is-empty-string/lib/main.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/assert/is-empty-string/lib/object.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/assert/is-empty-string/lib/primitive.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/nlp/tokenize/lib/index.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/nlp/tokenize/lib/tokenize.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/string/remove-last/lib/index.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/string/remove-last/lib/remove_last.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/string/uncapitalize/lib/index.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/string/uncapitalize/lib/uncapitalize.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/utils/tabulate/lib/index.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/utils/tabulate/lib/tabulate.js","../node_modules/react-innertext/index.js"],"names":["Image","Loadable","CheckboxInput","props","context","newValue","setState","value","bind","global","lesson","event","target","checked","onChange","updateValue","state","session","defaultValue","this","globalVal","input","className","type","handleChange","disabled","aria-label","tooltip","inline","placement","tooltipPlacement","style","marginLeft","role","tabIndex","color","onClick","handleSpanChange","onKeyPress","legend","onSpanChange","noop","nextProps","prevState","newState","isEmptyObject","Input","defaultProps","propTypes","PropTypes","contextType","SessionContext","cohort","userEmail","members","i","length","email","addResources","Worker_fn","Worker","Plot","createPlotlyComponent","Plotly","CLUSTER_LABELS","modelIndex","parseInt","changeClusterCount","selectedCluster","arr","clusterCoordinates","nClusters","clusterSizes","data","x","map","y","text","t","marker","size","COLORS","mode","hoverinfo","height","window","innerHeight","layout","hovermode","useResizeHandler","width","zIndex","config","displayModeBar","point","points","pointIndex","onPointClick","docDisplay","isNumber","Fragment","padding","overflowY","ListGroup","representativeDocs","idx","key","Modal","show","onHide","dialogClassName","closeButton","as","title","handleClusterCountChange","onBlur","v","minHeight","Row","Col","md","maxWidth","renderClusterPlot","Button","Component","debug","logger","CLUSTER_SIZES","worker","onmessage","onClusters","clusters","_buffer","coordinates","representative","docs","push","texts","postMessage","isClustering","showClusterModal","terminate","actionLabel","ButtonGroup","variant","clusterDocuments","toggleClusterModal","cluster","Switch","active","tooltipPos","children","useState","pos","setPos","mappedChildren","React","elem","display","handleClick","isArray","newPos","fullClassName","content","Search","extended","search","setSearch","caseSensitive","setCaseSensitive","exact","setExact","useEffect","FormGroup","innerWidth","marginBottom","InputGroup","FormControl","placeholder","charCode","float","margin","fontSize","backdropClassName","boxShadow","removeLast","showExtended","modalContent","name","absoluteTime","date","Date","toLocaleDateString","toLocaleTimeString","maxHeight","origin","select","cohorts","backgroundColor","onCohortChange","selectedCohort","nActions","actions","paddingBottom","componentID","onPeriodChange","RE_NEWLINE","wordWrap","str","n","floor","RE_LINE_BREAKS","RegExp","replace","generateValueLabel","levels","rows","cols","forEach","isString","a","b","j","rv","cv","isEmptyString","FullscreenActionDisplay","isStrictEqual","filtered","searchwords","newFilter","expr","action","actionValue","test","String","index","lines","noLines","match","showModal","seenEmails","Set","handleMultipleResponses","slice","sort","filter","has","add","chatName","_","opened","inviteToChat","canLeave","closeChatForAll","inviteToVideo","highlighter","src","searchWords","autoEscape","textToHighlight","col","rgba","substring","background","border","ListGroupItem","textAlign","userProgress","for","user","subject","videoChatInviteFactory","buttonVariant","buttonLabel","chatInviteFactory","showModalFactory","deleteFactory","halfWidth","values","midpoints","indices","getActions","JSON","parse","error_y","array","visible","orientation","fit","editable","xaxis","showticklabels","showline","yaxis","removeQuestionWords","stopwords","question","tokenize","rotate","triggerRender","d","contains","searchFilter","marginTop","left","bottom","position","maxLength","out","innerText","leftMargin","max","counts","table","maxVal","NINF","Array","tabulateValues","val","categoryorder","categoryarray","l","right","labels","concat","paths","keys","objectKeys","source","elems","split","indexOf","node","pad","thickness","line","label","link","freqs","tabulate","toFixed","nRows","nCols","ndarray","k","set","Number","get","c","r","row","plot","Alert","renderWordCloud","renderBarchart","renderHistogram","renderTable","renderNestedTable","renderSankeyDiagram","renderRangePlot","lowercase","Trans","i18nKey","ns","toggleActions","initialIndex","itemRenderer","renderListGroupItem","pageSize","minSize","itemSizeGetter","Card","body","renderPlot","Badge","uncapitalize","toggleExtended","hideModal","dataType","absdiff","json","USER_FEEDBACK_FORM","copy","isObjectLike","comments","noUnderstanding","needsExplanation","noLogic","MULTIPLE_CHOICE_MATRIX_SUBMISSION","MATCH_LIST_SUBMISSION","extractSubstr","substr","lastIndexOf","usersWithFocus","userFocuses","usersWithActions","id","hasOwnProperty","ResponseVisualizer","log","RESPONSE_VISUALIZER_TOGGLE","showActions","addSessionActions","period","RESPONSE_VISUALIZER_EXTENDED","newPeriod","selectCohort","extractValue","from","to","unshift","emailHash","success","nSuccess","danger","nDanger","info","nInfo","socketActions","isUserInCohort","users","userList","update","UPDATED_VISUALIZER","showDeleteModal","selectedAction","removeSessionElementFromDB","sessiondataID","err","closeDeleteModal","registerInSession","unsubscribe","subscribe","RETRIEVED_USER_ACTIONS","SELECTED_COHORT","MEMBER_ACTION","FOCUS_ELEMENT","LOSE_FOCUS_ELEMENT","forceUpdate","pushSessionAction","responseVisualizers","responseVisualizerIds","noSessionRegistration","ref","ids","debouncedInitializeProgress","document","getElementById","compareDocumentPosition","nUsers","activeCohortMembers","focusUsers","Popover","join","optionalProps","owner","successRate","dangerRate","infoRate","focusRate","renderFullscreenModal","vertical","verticalAlign","showID","buttonStyle","marginRight","pointerEvents","trigger","overlay","renderTooltip","ProgressBar","now","min","onDelete","deleteSelectedAction","onClose","withTranslation","getPercentage","percentage","Math","round","renderProgressBar","_ref","_classNames","srOnly","striped","animated","bsPrefix","_objectWithoutPropertiesLoose","_extends","classNames","_ref2","isChild","useBootstrapPrefix","wrapperProps","func","child","cloneElement","displayName","setReadOnly","isPrimitive","isObject","module","exports","valueOf","isBoolean","hasOwnProp","ABBRS","EMOJIS","CONTRACT","REGEXP_PREFIXES","REGEXP_SUFFIXES","extend","ext","tokenizeSubstring","done","res","prefixes","suffixes","keepWhitespace","subtkns","substrs","tokens","cache","TypeError","arguments","charAt","toLowerCase","isCollection","collection","count","tmp","len","reduceJsxToString","previous","current","jsx","toString","reduce","Object","prototype","call","hasProps","default"],"mappings":"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","file":"static/js/96791.702ee3cf.chunk.js","sourcesContent":["// MODULES //\n\nimport Loadable from '@isle-project/components/internal/loadable';\n\n\n// MAIN //\n\nconst Image = Loadable( () => import( /* webpackChunkName: \"Image\" */ './main.js' ) );\n\n\n// EXPORTS //\n\nexport default Image;\n","// MODULES //\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport isEmptyObject from '@stdlib/assert/is-empty-object';\nimport noop from '@stdlib/utils/noop';\nimport Input from '@isle-project/components/input/base';\nimport Tooltip from '@isle-project/components/tooltip';\nimport SessionContext from '@isle-project/session/context.js';\nimport './checkbox.css';\n\n\n// MAIN //\n\n/**\n* A checkbox input component. Can be used as part of an ISLE dashboard or standalone. In the latter case, you want to handle changes via the `onChange` attribute or bind the value to a global variable via the `bind` attribute.\n*\n* @property {string} bind - name of global variable for the checkbox value to be assigned to\n* @property {boolean} defaultValue - boolean value indicating the default value of the checkbox\n* @property {boolean} value - checkbox value (for controlled component)\n* @property {boolean} disabled - indicates whether the input is active or not\n* @property {boolean} inline - indicates whether the checkbox is displayed inline\n* @property {string} legend - text displayed next to the checkbox\n* @property {string} tooltip - text displayed when hovering over checkbox\n* @property {string} tooltipPlacement - position of button tooltip\n* @property {Object} style - CSS inline styles\n* @property {Function} onChange - callback function to be invoked when checkbox is clicked. The function is called with the current checkbox value\n*/\nclass CheckboxInput extends Input {\n\tconstructor( props, context ) {\n\t\tsuper( props );\n\n\t\tconst session = context;\n\t\tthis.state = {\n\t\t\tvalue: props.bind && session.state ?\n\t\t\t\tsession.state[ props.bind ]:\n\t\t\t\tprops.defaultValue,\n\t\t\tbind: props.bind,\n\t\t\tdefaultValue: props.defaultValue\n\t\t};\n\t}\n\n\tstatic getDerivedStateFromProps( nextProps, prevState ) {\n\t\tlet newState = {};\n\t\tif ( nextProps.defaultValue !== prevState.defaultValue ) {\n\t\t\tnewState.value = nextProps.defaultValue;\n\t\t\tnewState.defaultValue = nextProps.defaultValue;\n\t\t}\n\t\telse if ( nextProps.bind !== prevState.bind ) {\n\t\t\tnewState.value = global.lesson.state[ nextProps.bind ];\n\t\t\tnewState.bind = nextProps.bind;\n\t\t}\n\t\tif ( !isEmptyObject( newState ) ) {\n\t\t\treturn newState;\n\t\t}\n\t\treturn null;\n\t}\n\n\tcomponentDidUpdate() {\n\t\tif ( this.props.bind ) {\n\t\t\tlet globalVal = global.lesson.state[ this.props.bind ];\n\t\t\tif ( globalVal !== this.state.value ) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tvalue: globalVal\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateValue = ( newValue ) => {\n\t\tthis.setState({\n\t\t\tvalue: newValue\n\t\t}, () => {\n\t\t\tif ( this.props.bind ) {\n\t\t\t\tglobal.lesson.setState({\n\t\t\t\t\t[ this.props.bind ]: newValue\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\thandleChange = ( event ) => {\n\t\tconst newValue = event.target.checked;\n\t\tthis.props.onChange( newValue );\n\t\tthis.updateValue( newValue );\n\t}\n\n\thandleSpanChange = ( event ) => {\n\t\tconst newValue = this.props.value !== null ? !this.props.value : !this.state.value;\n\t\tthis.props.onChange( newValue );\n\t\tthis.updateValue( newValue );\n\t}\n\n\trender() {\n\t\tlet { value } = this.state;\n\t\tif ( this.props.value !== null ) {\n\t\t\tvalue = this.props.value;\n\t\t}\n\t\tconst input = <input\n\t\t\tclassName=\"checkbox-input\"\n\t\t\ttype=\"checkbox\"\n\t\t\tchecked={value}\n\t\t\tvalue=\"checkbox\"\n\t\t\tonChange={this.handleChange}\n\t\t\tdisabled={this.props.disabled}\n\t\t\taria-label={this.props.tooltip}\n\t\t></input>;\n\t\tif ( this.props.inline === true ) {\n\t\t\treturn (\n\t\t\t\t<Tooltip tooltip={this.props.tooltip} placement={this.props.tooltipPlacement} >\n\t\t\t\t\t<span style={{ marginLeft: '8px', ...this.props.style }}>\n\t\t\t\t\t\t{input}\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\trole=\"button\" tabIndex={0}\n\t\t\t\t\t\t\tclassName=\"checkbox-legend\"\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tcolor: this.props.disabled ? 'darkgray' : null\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonClick={this.handleSpanChange} onKeyPress={this.handleSpanChange}\n\t\t\t\t\t\t>{this.props.legend}</span>\n\t\t\t\t\t</span>\n\t\t\t\t</Tooltip>\n\t\t\t);\n\t\t}\n\t\tconst onSpanChange = this.props.disabled ? noop : this.handleSpanChange;\n\t\treturn (\n\t\t\t<Tooltip tooltip={this.props.tooltip} placement={this.props.tooltipPlacement} >\n\t\t\t\t<div className=\"input checkbox-input-div\" style={this.props.style}>\n\t\t\t\t\t{input}\n\t\t\t\t\t<span\n\t\t\t\t\t\trole=\"button\" tabIndex={0}\n\t\t\t\t\t\tclassName=\"checkbox-legend\"\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tcolor: this.props.disabled ? 'darkgray' : null\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonClick={onSpanChange} onKeyPress={onSpanChange}\n\t\t\t\t\t>{this.props.legend}</span>\n\t\t\t\t</div>\n\t\t\t</Tooltip>\n\t\t);\n\t}\n}\n\n\n// PROPERTIES //\n\nCheckboxInput.defaultProps = {\n\tbind: '',\n\tonChange() {},\n\tdefaultValue: false,\n\tvalue: null,\n\tdisabled: false,\n\tinline: false,\n\tlegend: '',\n\ttooltip: '',\n\ttooltipPlacement: 'right',\n\tstyle: {}\n};\n\nCheckboxInput.propTypes = {\n\tbind: PropTypes.string,\n\tdefaultValue: PropTypes.bool,\n\tvalue: PropTypes.bool,\n\tdisabled: PropTypes.bool,\n\tinline: PropTypes.bool,\n\tonChange: PropTypes.func,\n\tlegend: PropTypes.oneOfType([\n\t\tPropTypes.string,\n\t\tPropTypes.node\n\t]),\n\ttooltip: PropTypes.string,\n\ttooltipPlacement: PropTypes.oneOf([ 'left', 'top', 'right', 'bottom' ]),\n\tstyle: PropTypes.object\n};\n\nCheckboxInput.contextType = SessionContext;\n\n\n// EXPORTS //\n\nexport default CheckboxInput;\n","// MODULES //\n\nimport CheckboxInput from './main.js';\n\n\n// EXPORTS //\n\nexport default CheckboxInput;\n","// MODULES //\n\nimport Loadable from '@isle-project/components/internal/loadable';\n\n\n// MAIN //\n\nconst DeleteModal = Loadable( () => import( /* webpackChunkName: \"DeleteModal\" */ './main.js' ) );\n\n\n// EXPORTS //\n\nexport default DeleteModal;\n","// MAIN //\n\nfunction isUserInCohort( cohort, userEmail ) {\n\tconst members = cohort.members;\n\tfor ( let i = 0; i < members.length; i++ ) {\n\t\tconst member = members[ i ];\n\t\tif ( member.email === userEmail ) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\n\n// EXPORTS //\n\nexport default isUserInCohort;\n","// MODULES //\n\nimport Loadable from '@isle-project/components/internal/loadable';\n\n\n// MAIN //\n\nconst ChatButton = Loadable( () => import( /* webpackChunkName: \"ChatButton\" */ './main.js' ) );\n\n\n// EXPORTS //\n\nexport default ChatButton;\n","// MODULES //\n\nimport Loadable from '@isle-project/components/internal/loadable';\nimport { addResources } from '@isle-project/locales';\n\n\n// VARIABLES //\n\naddResources( 'Video' );\n\n\n// MAIN //\n\nconst VideoChatButton = Loadable( () => import( /* webpackChunkName: \"VideoChatButton\" */ './main.js' ) );\n\n\n// EXPORTS //\n\nexport default VideoChatButton;\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"static/js/worker.7375dcc0.worker.js\");\n}\n","// MODULES //\n\n\nimport React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport Button from 'react-bootstrap/Button';\nimport Modal from 'react-bootstrap/Modal';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport Plotly from 'plotly.js';\nimport createPlotlyComponent from 'react-plotly.js/factory';\nconst Plot = createPlotlyComponent( Plotly );\nimport { isPrimitive as isNumber } from '@stdlib/assert/is-number';\nimport { CAT20 as COLORS } from '@isle-project/constants/colors';\n\n\n// VARIABLES //\n\nconst CLUSTER_LABELS = [ 'few-clusters', 'some-clusters', 'many-clusters' ];\n\n\n// MAIN //\n\nclass ClusterModal extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\t\tthis.state = {\n\t\t\tselectedCluster: null,\n\t\t\tmodelIndex: props.modelIndex\n\t\t};\n\t}\n\n\trenderClusterPlot() {\n\t\tconst arr = this.props.clusterCoordinates;\n\t\tconst nClusters = this.props.clusterSizes[ this.state.modelIndex ];\n\t\tconst data = [\n\t\t\t{\n\t\t\t\tx: arr.map( x => x[ 0 ] ),\n\t\t\t\ty: arr.map( x => x[ 1 ] ),\n\t\t\t\ttext: arr.map( ( x, i ) => `${this.props.t('cluster')} ${i+1}` ),\n\t\t\t\tmarker: {\n\t\t\t\t\tsize: 40,\n\t\t\t\t\tcolor: COLORS.slice( 0, nClusters )\n\t\t\t\t},\n\t\t\t\tmode: 'markers',\n\t\t\t\thoverinfo: 'text',\n\t\t\t\ttype: 'scatter'\n\t\t\t}\n\t\t];\n\t\treturn (\n\t\t\t<div style={{ height: 0.75 * window.innerHeight }}>\n\t\t\t\t<Plot\n\t\t\t\t\tdata={data}\n\t\t\t\t\tlayout={{\n\t\t\t\t\t\thovermode: 'closest'\n\t\t\t\t\t}}\n\t\t\t\t\tuseResizeHandler\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\theight: '100%',\n\t\t\t\t\t\tzIndex: 1\n\t\t\t\t\t}}\n\t\t\t\t\tconfig={{\n\t\t\t\t\t\tdisplayModeBar: false\n\t\t\t\t\t}}\n\t\t\t\t\tonClick={( data ) => {\n\t\t\t\t\t\tconst point = data.points[ data.points.length-1 ];\n\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\tselectedCluster: point.pointIndex\n\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\tthis.props.onPointClick( this.state.selectedCluster );\n\t\t\t\t\t\t});\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\thandleClusterCountChange = ( event ) => {\n\t\tconst modelIndex = parseInt( event.target.value, 10 );\n\t\tif ( this.state.modelIndex !== modelIndex ) {\n\t\t\tthis.setState({\n\t\t\t\tmodelIndex\n\t\t\t});\n\t\t\tthis.props.changeClusterCount( modelIndex );\n\t\t}\n\t}\n\n\trender() {\n\t\tlet docDisplay;\n\t\tif ( isNumber( this.state.selectedCluster ) ) {\n\t\t\tdocDisplay = <Fragment>\n\t\t\t\t<h4\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tpadding: 10,\n\t\t\t\t\t\tcolor: COLORS[ this.state.selectedCluster ]\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{this.props.t('representative-documents')} {this.state.selectedCluster+1}\n\t\t\t\t</h4>\n\t\t\t\t<div style={{ marginLeft: 0, overflowY: 'scroll', height: 0.70 * window.innerHeight }}>\n\t\t\t\t\t<ListGroup className=\"cluster-list\">\n\t\t\t\t\t{this.props.representativeDocs.map( ( x, idx ) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<ListGroup.Item className=\"cluster-list-item\" key={`${this.state.selectedCluster}-${idx}`} >\n\t\t\t\t\t\t\t\t{x}\n\t\t\t\t\t\t\t</ListGroup.Item>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t\t</ListGroup>\n\t\t\t\t</div>\n\t\t\t</Fragment>;\n\t\t} else {\n\t\t\tdocDisplay = <h4 className=\"cluster-directive\">{this.props.t('select-cluster-representative')}</h4>;\n\t\t}\n\t\treturn ( <Modal\n\t\t\tshow={this.props.show}\n\t\t\tonHide={this.props.onHide}\n\t\t\tdialogClassName=\"modal-100w\"\n\t\t>\n\t\t\t<Modal.Header closeButton>\n\t\t\t\t<Modal.Title as=\"h3\" >\n\t\t\t\t\t{this.props.t('clustering-results')}\n\t\t\t\t</Modal.Title>\n\t\t\t\t<span className=\"cluster-modal-select-wrapper\">\n\t\t\t\t\t<select\n\t\t\t\t\t\ttitle={this.props.t('cluster-select')}\n\t\t\t\t\t\tclassName=\"cluster-select\"\n\t\t\t\t\t\tonChange={this.handleClusterCountChange}\n\t\t\t\t\t\tonBlur={this.handleClusterCountChange}\n\t\t\t\t\t\tvalue={this.state.modelIndex}\n\t\t\t\t\t>\n\t\t\t\t\t\t{CLUSTER_LABELS.map( ( v, key ) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\tkey={key}\n\t\t\t\t\t\t\t\t\tvalue={key}\n\t\t\t\t\t\t\t\t>{this.props.t( v )}</option>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t</select>\n\t\t\t\t</span>\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Body style={{ minHeight: 0.75 * window.innerHeight, padding: 0 }} >\n\t\t\t\t<Row>\n\t\t\t\t\t<Col md={8}>\n\t\t\t\t\t\t{docDisplay}\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col md={4} style={{ overflowY: 'auto', maxWidth: '30%' }} >\n\t\t\t\t\t\t{this.props.clusterCoordinates ? this.renderClusterPlot() : null}\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t</Modal.Body>\n\t\t\t<Modal.Footer>\n\t\t\t\t<Button onClick={this.props.onHide}>{this.props.t('close')}</Button>\n\t\t\t</Modal.Footer>\n\t\t</Modal> );\n\t}\n}\n\n\n// PROPERTIES //\n\nClusterModal.propTypes = {\n\tclusterSizes: PropTypes.array.isRequired,\n\tmodelIndex: PropTypes.number.isRequired,\n\tshow: PropTypes.bool.isRequired,\n\tonPointClick: PropTypes.func.isRequired,\n\tonHide: PropTypes.func.isRequired,\n\tclusterCoordinates: PropTypes.array.isRequired,\n\tchangeClusterCount: PropTypes.func.isRequired,\n\trepresentativeDocs: PropTypes.array.isRequired\n};\n\n\n// EXPORT //\n\nexport default ClusterModal;\n","// MODULES //\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport logger from 'debug';\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\nimport Button from 'react-bootstrap/Button';\nimport Worker from 'worker-loader!./worker.js';\nimport ClusterModal from './cluster_modal.js';\nimport './text_clustering.css';\n\n\n// VARIABLES //\n\nconst debug = logger( 'isle:response-visualizer:text-clustering' );\nconst CLUSTER_SIZES = [ 3, 5, 7 ];\nconst CLUSTER_LABELS = [ 'few-clusters', 'some-clusters', 'many-clusters' ];\n\n\n// MAIN //\n\nclass TextClustering extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tthis.state = {\n\t\t\tisClustering: false,\n\t\t\tshowClusterModal: false,\n\t\t\tmodelIndex: 0,\n\t\t\tclusterCoordinates: null,\n\t\t\trepresentativeDocs: []\n\t\t};\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif ( this.worker ) {\n\t\t\tthis.worker.terminate();\n\t\t}\n\t}\n\n\tclusterDocuments = () => {\n\t\tthis.worker = new Worker();\n\t\tthis.worker.onmessage = ( event ) => {\n\t\t\tconst data = event.data;\n\t\t\tswitch ( data.type ) {\n\t\t\t\tcase 'CLUSTERS':\n\t\t\t\t\tthis.props.onClusters( data.value.clusters._buffer );\n\t\t\t\tbreak;\n\t\t\t\tcase 'CLUSTER_COORDINATES':\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tclusterCoordinates: data.value.coordinates,\n\t\t\t\t\t\tmodelIndex: data.value.modelIndex\n\t\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t\tcase 'REPRESENTATIVE_DOCUMENTS': {\n\t\t\t\t\tconst representative = data.value;\n\t\t\t\t\tconst docs = [];\n\t\t\t\t\tfor ( let i = 0; i < representative.length; i++ ) {\n\t\t\t\t\t\tdocs.push( this.props.texts[ representative[ i ].idx ] );\n\t\t\t\t\t}\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\trepresentativeDocs: docs\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tthis.worker.postMessage({\n\t\t\ttype: 'ADD_DOCUMENTS',\n\t\t\tvalue: this.props.texts\n\t\t});\n\t\tthis.worker.postMessage({\n\t\t\ttype: 'ITERATE',\n\t\t\tvalue: 1\n\t\t});\n\t\tthis.worker.postMessage({\n\t\t\ttype: 'GET_CLUSTERS',\n\t\t\tvalue: this.state.modelIndex\n\t\t});\n\t\tthis.worker.postMessage({\n\t\t\ttype: 'GET_CLUSTER_COORDINATES',\n\t\t\tvalue: this.state.modelIndex\n\t\t});\n\t\tthis.setState({\n\t\t\tisClustering: true\n\t\t});\n\t}\n\n\thandleClusterCountChange = ( event ) => {\n\t\tconst modelIndex = parseInt( event.target.value, 10 );\n\t\tif ( this.state.modelIndex !== modelIndex ) {\n\t\t\tthis.changeClusterCount( modelIndex );\n\t\t\tthis.setState({\n\t\t\t\tmodelIndex\n\t\t\t});\n\t\t}\n\t}\n\n\tchangeClusterCount = ( modelIndex ) => {\n\t\tif ( this.worker ) {\n\t\t\tthis.worker.postMessage({\n\t\t\t\ttype: 'GET_CLUSTERS',\n\t\t\t\tvalue: modelIndex\n\t\t\t});\n\t\t\tthis.worker.postMessage({\n\t\t\t\ttype: 'GET_CLUSTER_COORDINATES',\n\t\t\t\tvalue: modelIndex\n\t\t\t});\n\t\t}\n\t}\n\n\ttoggleClusterModal = () => {\n\t\tthis.setState({\n\t\t\tshowClusterModal: !this.state.showClusterModal\n\t\t});\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"cluster-wrapper\">\n\t\t\t\t<label>{this.props.t('cluster')} {this.props.actionLabel}</label>\n\t\t\t\t<span className=\"cluster-select-wrapper\">\n\t\t\t\t\t<select\n\t\t\t\t\t\ttitle={this.props.t('select-size')}\n\t\t\t\t\t\tclassName=\"cluster-select\"\n\t\t\t\t\t\tonChange={this.handleClusterCountChange}\n\t\t\t\t\t\tonBlur={this.handleClusterCountChange}\n\t\t\t\t\t\tvalue={this.state.modelIndex}\n\t\t\t\t\t>\n\t\t\t\t\t\t{CLUSTER_LABELS.map( ( v, key ) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\tkey={key}\n\t\t\t\t\t\t\t\t\tvalue={key}\n\t\t\t\t\t\t\t\t>{this.props.t( v )}</option>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t</select>\n\t\t\t\t</span>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button variant=\"secondary\" onClick={this.clusterDocuments}>{this.props.t('start')}</Button>\n\t\t\t\t\t<Button variant=\"secondary\" disabled={!this.state.isClustering} onClick={this.toggleClusterModal}>{this.props.t('show-clusters')}</Button>\n\t\t\t\t\t{ this.state.showClusterModal ? <ClusterModal\n\t\t\t\t\t\tshow={this.state.showClusterModal}\n\t\t\t\t\t\tonHide={this.toggleClusterModal}\n\t\t\t\t\t\tclusterSizes={CLUSTER_SIZES}\n\t\t\t\t\t\tclusterCoordinates={this.state.clusterCoordinates}\n\t\t\t\t\t\trepresentativeDocs={this.state.representativeDocs}\n\t\t\t\t\t\tmodelIndex={this.state.modelIndex}\n\t\t\t\t\t\tchangeClusterCount={this.changeClusterCount}\n\t\t\t\t\t\tonPointClick={( selectedCluster ) => {\n\t\t\t\t\t\t\tdebug( 'Retrieve representative documents...' );\n\t\t\t\t\t\t\tthis.worker.postMessage({\n\t\t\t\t\t\t\t\ttype: 'GET_REPRESENTATIVE_DOCUMENTS',\n\t\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\t\tcluster: selectedCluster,\n\t\t\t\t\t\t\t\t\tmodelIndex: this.state.modelIndex\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tt={this.props.t}\n\t\t\t\t\t/> : null }\n\t\t\t\t</ButtonGroup>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\n\n// PROPERTIES //\n\nTextClustering.propTypes = {\n\tactionLabel: PropTypes.string.isRequired,\n\ttexts: PropTypes.array.isRequired,\n\tonClusters: PropTypes.func.isRequired\n};\n\n\n// EXPORTS //\n\nexport default TextClustering;\n","// MODULES //\n\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport logger from 'debug';\nimport isArray from '@stdlib/assert/is-array';\nimport Tooltip from '@isle-project/components/tooltip';\nimport './switch.css';\n\n\n// VARIABLES //\n\nconst debug = logger( 'isle:switch' );\n\n\n// MAIN //\n\n/**\n* The Switch component allows the display of one element out of a list of several elements. Users can cycle through the different children of the Switch tag by clicking on the currently displayed one.\n*\n* @property {boolean} active - controls whether the switch is active or not\n* @property {string} tooltip - tooltip displayed when hovering over the switch element\n* @property {string} tooltipPos - placement of the tooltip (either `top`, `left`, `right`, or `bottom`)\n* @property {string} className - class name for the enclosing span element\n* @property {Object} style - CSS inline styles\n* @property {Function} onChange - callback invoked when elements are switched. Receives as its first argument the index of the currently displayed child\n*/\nconst Switch = ({ active, tooltip, tooltipPos, className, style, onChange, children }) => {\n\tconst [ pos, setPos ] = useState( 0 );\n\n\tconst mappedChildren = React.Children.map( children, ( elem, idx ) => {\n\t\tconst props = { style: {}};\n\n\t\tdebug( `Check whether idx = ${idx} is equal to pos = ${pos}` );\n\t\tif ( idx !== pos ) {\n\t\t\tprops.style.display = 'none';\n\t\t} else {\n\t\t\tprops.style.display = 'inline';\n\t\t}\n\t\treturn React.cloneElement( elem, props );\n\t});\n\tconst handleClick = () => {\n\t\tif ( !isArray( children ) ) {\n\t\t\treturn null;\n\t\t}\n\t\tconst newPos = pos + 1;\n\n\t\tdebug( 'Handle click: New position is '+ newPos );\n\t\tif ( newPos >= children.length ) {\n\t\t\tsetPos( 0 );\n\t\t\tonChange( 0 );\n\t\t} else {\n\t\t\tsetPos( newPos );\n\t\t\tonChange( newPos );\n\t\t}\n\t};\n\tlet fullClassName = active ? 'switch active' : 'switch';\n\tif ( className ) {\n\t\tfullClassName += ' '+className;\n\t}\n\tif ( !active ) {\n\t\treturn ( <span\n\t\t\tclassName={fullClassName}\n\t\t\tstyle={style}\n\t\t>\n\t\t\t{mappedChildren}\n\t\t</span> );\n\t}\n\tconst content =\n\t\t<span\n\t\t\trole=\"button\" tabIndex={0}\n\t\t\tclassName={fullClassName}\n\t\t\tonClick={handleClick}\n\t\t\tonKeyPress={handleClick}\n\t\t\tstyle={style}\n\t\t>\n\t\t\t{mappedChildren}\n\t\t</span>;\n\n\tif ( tooltip === '' || !active ) {\n\t\treturn content;\n\t}\n\treturn (\n\t\t<Tooltip\n\t\t\tplacement={tooltipPos}\n\t\t\ttooltip={tooltip}\n\t\t>\n\t\t\t{content}\n\t\t</Tooltip>\n\t);\n};\n\n\n// PROPERTIES //\n\nSwitch.propTypes = {\n\tactive: PropTypes.bool,\n\ttooltip: PropTypes.string,\n\ttooltipPos: PropTypes.string,\n\tclassName: PropTypes.string,\n\tstyle: PropTypes.object,\n\tonChange: PropTypes.func\n};\n\nSwitch.defaultProps = {\n\tactive: true,\n\ttooltip: 'Click to cycle through available options.',\n\ttooltipPos: 'top',\n\tclassName: '',\n\tstyle: {},\n\tonChange() {}\n};\n\n\n// EXPORTS //\n\nexport default Switch;\n","// MODULES //\n\nimport Switch from './main.js';\n\n\n// EXPORTS //\n\nexport default Switch;\n","// MODULES //\n\nimport Loadable from '@isle-project/components/internal/loadable';\n\n\n// MAIN //\n\nconst WordCloud = Loadable( () => import( /* webpackChunkName: \"WordCloud\" */ './main.js' ) );\n\n\n// EXPORTS //\n\nexport default WordCloud;\n","// MODULES //\n\nimport React, { Fragment, useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport Button from 'react-bootstrap/Button';\nimport InputGroup from 'react-bootstrap/InputGroup';\nimport FormControl from 'react-bootstrap/FormControl';\nimport FormGroup from 'react-bootstrap/FormGroup';\nimport Checkbox from '@isle-project/components/input/checkbox';\n\n\n// MAIN //\n\nconst Search = ({ extended, onClick, t }) => {\n\tconst [ search, setSearch ] = useState( '' );\n\tconst [ caseSensitive, setCaseSensitive ] = useState( false );\n\tconst [ exact, setExact ] = useState( false );\n\n\tconst handleSearch = ( event ) => {\n\t\tsetSearch( event.target.value );\n\t};\n\tuseEffect( () => {\n\t\tonClick( search, caseSensitive, exact );\n\t}, [ caseSensitive, exact, search, onClick ]);\n\n\tconst handleKeyPress = ( event ) => {\n\t\tif ( event.charCode === 13 ) {\n\t\t\tonClick( search, caseSensitive, exact );\n\t\t}\n\t};\n\tconst handleReset = () => {\n\t\tsetSearch( '' );\n\t\tonClick( '' );\n\t};\n\treturn (\n\t\t<Fragment>\n\t\t\t<FormGroup style={{ width: window.innerWidth * 0.3, padding: '0px', marginBottom: '0px' }} >\n\t\t\t\t<InputGroup size=\"small\" >\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tplaceholder={t('enter-text')}\n\t\t\t\t\t\tonChange={handleSearch}\n\t\t\t\t\t\tonKeyPress={handleKeyPress}\n\t\t\t\t\t\tvalue={search}\n\t\t\t\t\t/>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tonClick( search, caseSensitive, exact );\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('search')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button style={{ float: 'left' }} size=\"small\" onClick={handleReset} >\n\t\t\t\t\t\t{t('reset')}\n\t\t\t\t\t</Button>\n\t\t\t\t</InputGroup>\n\t\t\t</FormGroup>\n\t\t\t<FormGroup style={{ float: 'left', margin: '4px' }} >\n\t\t\t\t<Checkbox\n\t\t\t\t\ttooltip={t('whole-word-tooltip')}\n\t\t\t\t\ttooltipPlacement=\"top\"\n\t\t\t\t\tsize=\"small\" inline\n\t\t\t\t\tlegend={t('whole-word')}\n\t\t\t\t\tstyle={{ fontSize: '0.9rem' }}\n\t\t\t\t\tonChange={( value ) => {\n\t\t\t\t\t\tsetExact( value );\n\t\t\t\t\t\tonClick( search, caseSensitive, value );\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t\t<Checkbox\n\t\t\t\t\ttooltip={t('toggle-sensitivity')} tooltipPlacement=\"top\"\n\t\t\t\t\tsize=\"small\" inline\n\t\t\t\t\tlegend={t('case-sensitive')}\n\t\t\t\t\tstyle={{ fontSize: '0.9rem' }}\n\t\t\t\t\tonChange={( value ) => {\n\t\t\t\t\t\tsetCaseSensitive( value );\n\t\t\t\t\t\tonClick( search, value, exact );\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</FormGroup>\n\t\t</Fragment>\n\t);\n};\n\n\n// PROPERTIES //\n\nSearch.propTypes = {\n\textended: PropTypes.string,\n\tonClick: PropTypes.func\n};\n\nSearch.defaultProps = {\n\textended: false,\n\tonClick() {}\n};\n\n\n// EXPORTS //\n\nexport default Search;\n","// MODULES //\n\nimport React from 'react';\nimport Modal from 'react-bootstrap/Modal';\nimport removeLast from '@stdlib/string/remove-last';\n\n\n// FUNCTIONS //\n\nfunction toTimeString( absoluteTime ) {\n\tconst date = new Date( absoluteTime );\n\treturn `${date.toLocaleDateString()}, ${date.toLocaleTimeString()}`;\n}\n\n\n// MAIN //\n\nconst SingleActionModal = ( props ) => {\n\treturn (\n\t\t<Modal\n\t\t\tshow={props.show}\n\t\t\tonHide={props.onHide}\n\t\t\tdialogClassName=\"modal-75w\"\n\t\t\tbackdropClassName=\"modal-backdrop-second-order\"\n\t\t\tstyle={{\n\t\t\t\tminHeight: '300px',\n\t\t\t\tboxShadow: '0 0 10px black',\n\t\t\t\tfontSize: '2em',\n\t\t\t\tzIndex: 2000\n\t\t\t}}\n\t\t>\n\t\t\t<Modal.Header closeButton>\n\t\t\t\t<Modal.Title as=\"h3\">\n\t\t\t\t\t{removeLast( props.actionLabel) }\n\t\t\t\t\t{ props.showExtended ? ` ${props.t('from')} ${props.modalContent.name}`: ''}\n\t\t\t\t\t{props.t('on')}\n\t\t\t\t\t{toTimeString( props.modalContent.absoluteTime )}\n\t\t\t\t</Modal.Title>\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Body style={{ overflowY: 'scroll', maxHeight: 0.8 * window.innerHeight }} >\n\t\t\t\t<span className=\"response-visualizer-action-model-text\">\n\t\t\t\t\t{props.modalContent.value}\n\t\t\t\t</span>\n\t\t\t</Modal.Body>\n\t\t</Modal>\n\t);\n};\n\n\n// EXPORTS //\n\nexport default SingleActionModal;\n","// MODULES //\n\nimport Loadable from '@isle-project/components/internal/loadable';\nimport 'react-dates/initialize';\nimport 'react-dates/lib/css/_datepicker.css';\n\n\n// MAIN //\n\nconst RangePicker = Loadable( () => import( /* webpackChunkName: \"RangePicker\" */ './main.js' ) );\n\n\n// EXPORTS //\n\nexport default RangePicker;\n","// MODULES //\n\nimport React from 'react';\nimport RangePicker from '@isle-project/components/range-picker';\nimport Modal from 'react-bootstrap/Modal';\nimport isArray from '@stdlib/assert/is-array';\n\n\n// MAIN //\n\nconst FullscreenHeader = ( props ) => {\n\tlet select = null;\n\tif ( isArray( props.cohorts ) ) {\n\t\tselect = ( <select\n\t\t\ttitle=\"Cohort\"\n\t\t\tstyle={{ width: '150px', backgroundColor: 'ghostwhite', padding: '2px' }}\n\t\t\tonChange={props.onCohortChange} onBlur={props.onCohortChange}\n\t\t\tvalue={props.selectedCohort ? props.selectedCohort.title : 'all'}\n\t\t>\n\t\t\t<option value=\"all\">{props.t('all-cohorts')}</option>\n\t\t\t{props.cohorts.map( ( v, key ) => {\n\t\t\t\treturn (\n\t\t\t\t\t<option\n\t\t\t\t\t\tkey={key}\n\t\t\t\t\t\tvalue={v.title}\n\t\t\t\t\t>{v.title}</option>\n\t\t\t\t);\n\t\t\t})}\n\t\t</select> );\n\t}\n\tlet origin;\n\tconst nActions = props.actions.length;\n\tif ( nActions > 0 ) {\n\t\torigin = props.actions[ nActions-1 ].absoluteTime;\n\t} else {\n\t\torigin = 0;\n\t}\n\treturn (\n\t\t<Modal.Header style={{ paddingBottom: '5px' }} closeButton >\n\t\t\t<h4 style={{ float: 'left', margin: '2px 14px 2px 2px' }} >{props.actionLabel} {props.t('for')} {props.componentID}</h4>\n\t\t\t{select}\n\t\t\t<RangePicker\n\t\t\t\tstyle={{ float: 'left' }}\n\t\t\t\tsize=\"sm\"\n\t\t\t\tonChange={props.onPeriodChange}\n\t\t\t\torigin={origin}\n\t\t\t/>\n\t\t</Modal.Header>\n\t);\n};\n\n\n// EXPORTS //\n\nexport default FullscreenHeader;\n","// MODULES //\n\nimport React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport logger from 'debug';\nimport { Trans } from 'react-i18next';\nimport tokenize from '@stdlib/nlp/tokenize';\nimport contains from '@stdlib/assert/contains';\nimport isStrictEqual from '@stdlib/assert/is-strict-equal';\nimport isArray from '@stdlib/assert/is-array';\nimport { isPrimitive as isString } from '@stdlib/assert/is-string';\nimport isEmptyString from '@stdlib/assert/is-empty-string';\nimport uncapitalize from '@stdlib/string/uncapitalize';\nimport lowercase from '@stdlib/string/lowercase';\nimport removeLast from '@stdlib/string/remove-last';\nimport ndarray from '@stdlib/ndarray/array';\nimport objectKeys from '@stdlib/utils/keys';\nimport tabulate from '@stdlib/utils/tabulate';\nimport indexOf from '@stdlib/utils/index-of';\nimport floor from '@stdlib/math/base/special/floor';\nimport max from '@stdlib/math/base/special/max';\nimport absdiff from '@stdlib/math/base/utils/absolute-difference';\nimport NINF from '@stdlib/constants/math/float64-ninf';\nimport Alert from 'react-bootstrap/Alert';\nimport Table from '@isle-project/components/table';\nimport Image from '@isle-project/components/image';\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\nimport Button from 'react-bootstrap/Button';\nimport Badge from 'react-bootstrap/Badge';\nimport Col from 'react-bootstrap/Col';\nimport Card from 'react-bootstrap/Card';\nimport Row from 'react-bootstrap/Row';\nimport ListGroupItem from 'react-bootstrap/ListGroupItem';\nimport Modal from 'react-bootstrap/Modal';\nimport ReactList from 'react-list';\nimport innerText from 'react-innertext';\nimport Highlighter from 'react-highlight-words';\nimport ChatButton from '@isle-project/components/chat-button';\nimport VideoChatButton from '@isle-project/components/video-chat-button';\nimport TextClustering from '@isle-project/components/internal/text-clustering';\nimport Checkbox from '@isle-project/components/input/checkbox';\nimport Plotly from '@isle-project/components/plotly';\nimport Switch from '@isle-project/components/switch';\nimport WordCloud from '@isle-project/components/word-cloud';\nimport SessionContext from '@isle-project/session/context.js';\nimport { CAT20 as COLORS } from '@isle-project/constants/colors';\nimport Search from './search.js';\nimport SingleActionModal from './single_action_modal.js';\nimport FullscreenHeader from './fullscreen_header';\nimport './fullscreen_action_display.css';\n\n\n// VARIABLES //\n\nconst debug = logger( 'isle:response-visualizer' );\nconst LINE_HEIGHT = 15;\nconst TEXT_LINE_HEIGHT = 23;\nconst RE_NEWLINE = /\\r?\\n/g;\nconst UPDATE_THRESHOLD = 5;\n\n\n// FUNCTIONS //\n\nconst wordWrap = ( str ) => {\n\tconst n = floor( ( window.innerWidth * 0.5 ) / ( 16*0.575 ) );\n\tconst RE_LINE_BREAKS = new RegExp(`(?![^\\\\n]{1,${n}}$)([^\\\\n]{1,${n}})\\\\s`, 'g' );\n\treturn str.replace( RE_LINE_BREAKS, '$1\\n' );\n};\n\nconst tabulateValues = ( actions, levels ) => {\n\tif ( !actions ) {\n\t\treturn [];\n\t}\n\tconst table = {};\n\tfor ( let i = 0; i < actions.length; i++ ) {\n\t\tconst v = actions[ i ];\n\t\tif ( isArray( v.value ) ) {\n\t\t\tfor ( let j = 0; j < v.value.length; j++ ) {\n\t\t\t\tconst bool = v.value[ j ];\n\t\t\t\tif ( bool ) {\n\t\t\t\t\tconst key = levels[ j ];\n\t\t\t\t\tif ( !table[ key ] ) {\n\t\t\t\t\t\ttable[ key ] = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttable[ key ] += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst key = isString( v.value ) ? v.value : levels[ v.value ];\n\t\t\tif ( !table[ key ] ) {\n\t\t\t\ttable[ key ] = 1;\n\t\t\t} else {\n\t\t\t\ttable[ key ] += 1;\n\t\t\t}\n\t\t}\n\t}\n\tlet maxVal = NINF;\n\tconst counts = new Array( levels.length );\n\tfor ( let i = 0; i < levels.length; i++ ) {\n\t\tif ( table[ levels[ i ] ] > maxVal ) {\n\t\t\tmaxVal = table[ levels[ i ] ];\n\t\t}\n\t\tcounts[ i ] = table[ levels[ i ] ];\n\t}\n\treturn counts;\n};\n\nconst generateValueLabel = ({ value, type, levels, rows, cols }) => {\n\tif ( type === 'factor' ) {\n\t\tif ( isArray( value ) ) {\n\t\t\tlet str = '';\n\t\t\tvalue.forEach( ( v, idx ) => {\n\t\t\t\tif ( v ) {\n\t\t\t\t\tif ( str ) {\n\t\t\t\t\t\tstr += ', ';\n\t\t\t\t\t}\n\t\t\t\t\tstr += levels[ idx ];\n\t\t\t\t}\n\t\t\t});\n\t\t\tvalue = str || 'None';\n\t\t} else if ( !isString( value ) ) {\n\t\t\tvalue = levels[ value ] || 'None';\n\t\t}\n\t}\n\telse if ( type === 'matches' ) {\n\t\tlet str = '';\n\t\tif ( isArray( value ) ) {\n\t\t\tfor ( let i = 0; i < value.length; i++ ) {\n\t\t\t\tstr += value[ i ].a + ' - '+value[ i ].b+'; ';\n\t\t\t}\n\t\t}\n\t\tvalue = str || 'None';\n\t}\n\telse if ( type === 'matrix' ) {\n\t\tlet str = '';\n\t\tfor ( let i = 0; i < rows.length; i++ ) {\n\t\t\tfor ( let j = 0; j < cols.length; j++ ) {\n\t\t\t\tif ( value[ i ][ j ] ) {\n\t\t\t\t\tstr += rows[ i ] + ' - '+cols[ j ]+'; ';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvalue = str || 'None';\n\t}\n\telse if ( type === 'tensor' ) {\n\t\tlet str = '';\n\t\tfor ( let i = 0; i < rows.length; i++ ) {\n\t\t\tfor ( let j = 0; j < cols.length; j++ ) {\n\t\t\t\tconst rv = rows[ i ];\n\t\t\t\tconst cv = cols[ j ];\n\t\t\t\tstr += isString( rv ) && !isEmptyString( rv ) ? rv : i;\n\t\t\t\tstr += '-';\n\t\t\t\tstr += isString( cv ) && !isEmptyString( cv ) ? cv : j;\n\t\t\t\tstr += ': ';\n\t\t\t\tstr += ( value ? value[ i+':'+j ] : 'NA' ) + '; ';\n\t\t\t}\n\t\t}\n\t\tvalue = str || 'None';\n\t}\n\treturn value;\n};\n\n\n// MAIN //\n\nclass FullscreenActionDisplay extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tthis.state = {\n\t\t\tfiltered: props.actions.slice( 0 ),\n\t\t\tsearchwords: [],\n\t\t\tactions: props.actions.slice( 0 ),\n\t\t\tshowModal: false,\n\t\t\tmodalContent: {},\n\t\t\tclusters: [],\n\t\t\thandleMultipleResponses: 'first',\n\t\t\tremoveQuestionWords: true\n\t\t};\n\t}\n\n\tstatic getDerivedStateFromProps( nextProps, prevState ) {\n\t\tconst newState = {};\n\t\tconst diff = absdiff( nextProps.actions.length, prevState.actions.length );\n\t\tif ( diff >= UPDATE_THRESHOLD || nextProps.actions.length === prevState.actions.length - 1 ) {\n\t\t\tnewState.filtered = nextProps.actions.slice();\n\t\t\tnewState.actions = nextProps.actions.slice();\n\t\t\tnewState.clusters = [];\n\t\t\treturn newState;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsearchFilter = ( value, caseSensitive, exact ) => {\n\t\tconst { actions } = this.props;\n\t\tif ( isStrictEqual( value, '' ) ) {\n\t\t\tthis.setState({\n\t\t\t\tfiltered: this.props.actions,\n\t\t\t\tsearchwords: [],\n\t\t\t\tclusters: []\n\t\t\t});\n\t\t} else {\n\t\t\tconst newFilter = [];\n\t\t\tif ( !exact ) {\n\t\t\t\tfor ( let i = 0; i < actions.length; i++ ) {\n\t\t\t\t\tconst action = actions[ i ];\n\t\t\t\t\tconst flags = caseSensitive ? '' : 'i';\n\t\t\t\t\tconst expr = new RegExp( value, flags );\n\t\t\t\t\tconst actionValue = generateValueLabel({ value: action.value, ...this.props.data });\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.props.showExtended &&\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tString( actionValue ).search( expr ) !== -1 ||\n\t\t\t\t\t\t\tString( action.email ).search( expr ) !== -1 ||\n\t\t\t\t\t\t\tString( action.name ).search( expr ) !== -1\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\tnewFilter.push( this.props.actions[ i ] );\n\t\t\t\t\t} else if ( String( actionValue ).search( expr ) !== -1 ) {\n\t\t\t\t\t\tnewFilter.push( this.props.actions[ i ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst flags = caseSensitive ? '' : 'i';\n\t\t\t\tconst expr = new RegExp( '(?:^|[^\\\\w])' + value + '(?:$|[^\\\\w])', flags );\n\t\t\t\tfor ( let i = 0; i < actions.length; i++ ) {\n\t\t\t\t\tconst action = actions[ i ];\n\t\t\t\t\tconst actionValue = generateValueLabel({ value: action.value, ...this.props.data });\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.props.showExtended &&\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\texpr.test( actionValue ) ||\n\t\t\t\t\t\t\texpr.test( action.email ) ||\n\t\t\t\t\t\t\texpr.test( action.name )\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\tnewFilter.push( action );\n\t\t\t\t\t} else if ( expr.test( actionValue ) ) {\n\t\t\t\t\t\tnewFilter.push( action );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.setState({\n\t\t\t\tfiltered: newFilter,\n\t\t\t\tsearchwords: [ value ],\n\t\t\t\tclusters: []\n\t\t\t});\n\t\t}\n\t}\n\n\titemSizeGetter = ( index ) => {\n\t\tlet lines = 2.0 * LINE_HEIGHT;\n\t\tconst action = this.state.actions[ index ];\n\t\tif ( !action ) {\n\t\t\treturn 0;\n\t\t}\n\t\tconst value = wordWrap( String( action.value ) );\n\t\tconst noLines = ( value.match( RE_NEWLINE ) || '' ).length + 1;\n\t\tlines += noLines * TEXT_LINE_HEIGHT;\n\t\tdebug( `Element at position ${index} is estimated to have ${noLines} lines.` );\n\t\treturn lines;\n\t}\n\n\tshowModalFactory = ( elem ) => {\n\t\treturn () => {\n\t\t\tdebug( 'Show model for prominently displaying a single answer...' );\n\t\t\tthis.setState({\n\t\t\t\tmodalContent: elem,\n\t\t\t\tshowModal: true\n\t\t\t});\n\t\t};\n\t}\n\n\thideModal = () => {\n\t\tthis.setState({\n\t\t\tshowModal: false\n\t\t});\n\t}\n\n\tgetActions = () => {\n\t\tlet actions;\n\t\tconst seenEmails = new Set();\n\t\tif ( this.state.handleMultipleResponses === 'last' ) {\n\t\t\tactions = this.props.actions.slice();\n\t\t\tactions.sort( ( a, b ) => b.absoluteTime - a.absoluteTime );\n\t\t\tactions = actions.filter( x => {\n\t\t\t\tif ( !seenEmails.has( x.email ) ) {\n\t\t\t\t\tseenEmails.add( x.email );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t\telse if ( this.state.handleMultipleResponses === 'first' ) {\n\t\t\tactions = this.props.actions.slice();\n\t\t\tactions.sort( ( a, b ) => a.absoluteTime - b.absoluteTime );\n\t\t\tactions = actions.filter( x => {\n\t\t\t\tif ( !seenEmails.has( x.email ) ) {\n\t\t\t\t\tseenEmails.add( x.email );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tactions = this.props.actions;\n\t\t}\n\t\treturn actions;\n\t}\n\n\trenderWordCloud() {\n\t\tdebug( 'Rendering word cloud...' );\n\t\tconst actions = this.getActions();\n\t\tconst texts = actions.map( x => x.value );\n\t\tlet stopwords = [];\n\t\tif (\n\t\t\tthis.state.removeQuestionWords &&\n\t\t\tisString( this.props.data.question )\n\t\t) {\n\t\t\tstopwords = tokenize( this.props.data.question );\n\t\t}\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<WordCloud\n\t\t\t\t\tdata={texts}\n\t\t\t\t\theight={0.65 * window.innerHeight}\n\t\t\t\t\twidth={0.45*window.innerWidth}\n\t\t\t\t\trotate={0}\n\t\t\t\t\ttriggerRender={true}\n\t\t\t\t\tonClick={( d ) => {\n\t\t\t\t\t\tif ( contains( this.state.searchwords, d.text ) ) {\n\t\t\t\t\t\t\tthis.searchFilter( '' );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.searchFilter( d.text );\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tmarginTop: 20\n\t\t\t\t\t}}\n\t\t\t\t\tstopwords={stopwords}\n\t\t\t\t/>\n\t\t\t\t<TextClustering\n\t\t\t\t\ttexts={this.state.filtered.map( x => x.value )}\n\t\t\t\t\tactionLabel={this.props.actionLabel || this.props.t('action-label')}\n\t\t\t\t\tonClusters={( data ) => {\n\t\t\t\t\t\tdebug( 'Received clusters...' );\n\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\tclusters: data\n\t\t\t\t\t\t});\n\t\t\t\t\t}}\n\t\t\t\t\tt={this.props.t}\n\t\t\t\t/>\n\t\t\t\t<Checkbox\n\t\t\t\t\ttooltip={this.props.t('remove-question-words-tooltip')}\n\t\t\t\t\ttooltipPlacement=\"top\"\n\t\t\t\t\tsize=\"small\" inline legend={this.props.t('remove-question-words')}\n\t\t\t\t\tdefaultValue={this.state.removeQuestionWords}\n\t\t\t\t\tonChange={( value ) => {\n\t\t\t\t\t\tthis.setState({ removeQuestionWords: value });\n\t\t\t\t\t}}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tleft: '5px',\n\t\t\t\t\t\tbottom: '85px',\n\t\t\t\t\t\tposition: 'absolute'\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</Fragment>\n\t\t);\n\t}\n\n\trenderBarchart() {\n\t\tconst actions = this.getActions();\n\t\tlet maxLength = 0;\n\t\tlet levels = this.props.data.levels.map( ( x, i ) => {\n\t\t\tlet out = isString( x ) ? x : innerText( x );\n\t\t\tif ( !out ) {\n\t\t\t\tout = `${this.props.t('choice')} ${i+1}`;\n\t\t\t}\n\t\t\tif ( out.length > maxLength ) {\n\t\t\t\tmaxLength = out.length;\n\t\t\t}\n\t\t\treturn out;\n\t\t});\n\t\tlet leftMargin = max( 250, maxLength * 7.5 );\n\t\tlet counts = tabulateValues( actions, levels );\n\t\tif ( levels.length > 7 ) {\n\t\t\t// Drop empty labels in case of many levels for readability of plot:\n\t\t\tlevels = levels.filter( ( _, idx ) => counts[ idx ] > 0 );\n\t\t\tcounts = counts.filter( val => val > 0 );\n\t\t}\n\t\treturn (\n\t\t\t<div style={{ height: 0.75 * window.innerHeight }}>\n\t\t\t\t<Plotly\n\t\t\t\t\tdata={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ty: levels,\n\t\t\t\t\t\t\tx: counts,\n\t\t\t\t\t\t\ttype: 'bar',\n\t\t\t\t\t\t\torientation: 'h'\n\t\t\t\t\t\t}\n\t\t\t\t\t]}\n\t\t\t\t\tfit editable\n\t\t\t\t\tlayout={{\n\t\t\t\t\t\txaxis: {\n\t\t\t\t\t\t\ttitle: this.props.t('count')\n\t\t\t\t\t\t},\n\t\t\t\t\t\tyaxis: {\n\t\t\t\t\t\t\ttitle: this.props.t('value'),\n\t\t\t\t\t\t\tcategoryorder: 'array',\n\t\t\t\t\t\t\tcategoryarray: levels\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmargin: {\n\t\t\t\t\t\t\tl: leftMargin\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderSankeyDiagram() {\n\t\tconst { left, right } = this.props.data;\n\t\tconst labels = left.concat( right );\n\t\tconst actions = this.getActions();\n\t\tconst paths = {};\n\t\tfor ( let i = 0; i < actions.length; i++ ) {\n\t\t\tconst arr = actions[ i ].value;\n\t\t\tif ( isArray( arr ) ) {\n\t\t\t\tfor ( let j = 0; j < arr.length; j++ ) {\n\t\t\t\t\tconst { a, b } = arr[ j ];\n\t\t\t\t\tif ( paths[ a+'-'+b ] ) {\n\t\t\t\t\t\tpaths[ a+'-'+b ] += 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpaths[ a+'-'+b ] = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst keys = objectKeys( paths );\n\t\tconst source = new Array( keys.length );\n\t\tconst target = new Array( keys.length );\n\t\tconst value = new Array( keys.length );\n\t\tfor ( let i = 0; i < keys.length; i++ ) {\n\t\t\tconst elems = keys[ i ].split( '-' );\n\t\t\tsource[ i ] = indexOf( left, elems[ 0 ] );\n\t\t\ttarget[ i ] = left.length + indexOf( right, elems[ 1 ] );\n\t\t\tvalue[ i ] = paths[ keys[ i ] ];\n\t\t}\n\t\treturn (\n\t\t\t<div style={{ height: 0.75 * window.innerHeight }}>\n\t\t\t\t<Plotly\n\t\t\t\t\tdata={[{\n\t\t\t\t\t\ttype: 'sankey',\n\t\t\t\t\t\torientation: 'h',\n\t\t\t\t\t\tnode: {\n\t\t\t\t\t\t\tpad: 15,\n\t\t\t\t\t\t\tthickness: 30,\n\t\t\t\t\t\t\tline: {\n\t\t\t\t\t\t\t\tcolor: 'black',\n\t\t\t\t\t\t\t\twidth: 0.5\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tlabel: labels,\n\t\t\t\t\t\t\tcolor: 'blue'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlink: {\n\t\t\t\t\t\t\tsource,\n\t\t\t\t\t\t\ttarget,\n\t\t\t\t\t\t\tvalue\n\t\t\t\t\t\t}\n\t\t\t\t\t}]}\n\t\t\t\t\tfit editable\n\t\t\t\t\tlayout={{\n\t\t\t\t\t\tfontSize: 10\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderHistogram() {\n\t\tconst actions = this.getActions();\n\t\tconst values = actions.map( x => x.value );\n\t\tlet freqs = tabulate( values );\n\t\tfreqs = freqs.sort( ( a, b ) => {\n\t\t\treturn b[ 2 ] - a[ 2 ];\n\t\t});\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div className=\"scrollable-table\" style={{ height: 0.3 * window.innerHeight }} >\n\t\t\t\t\t<Table>\n\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th>{this.props.t('value')}</th>\n\t\t\t\t\t\t\t\t<th>{this.props.t('absolute')}</th>\n\t\t\t\t\t\t\t\t<th>{this.props.t('relative')}</th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t<tbody >\n\t\t\t\t\t\t\t{freqs.map( ( val, idx ) => {\n\t\t\t\t\t\t\t\treturn ( <tr key={idx} >\n\t\t\t\t\t\t\t\t\t<td>{val[ 0 ]}</td>\n\t\t\t\t\t\t\t\t\t<td>{val[ 1 ]}</td>\n\t\t\t\t\t\t\t\t\t<td>{val[ 2 ].toFixed( 3 )}</td>\n\t\t\t\t\t\t\t\t</tr> );\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</Table>\n\t\t\t\t</div>\n\t\t\t\t<div style={{ height: 0.4 * window.innerHeight }}>\n\t\t\t\t\t<Plotly\n\t\t\t\t\t\tdata={[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tx: values,\n\t\t\t\t\t\t\t\ttype: 'histogram',\n\t\t\t\t\t\t\t\tname: 'histogram'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]}\n\t\t\t\t\t\tfit editable\n\t\t\t\t\t\tlayout={{\n\t\t\t\t\t\t\txaxis: {\n\t\t\t\t\t\t\t\ttitle: this.props.t('value')\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tyaxis: {\n\t\t\t\t\t\t\t\ttitle: this.props.t('count')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderTable() {\n\t\tconst nRows = this.props.data.rows.length;\n\t\tconst nCols = this.props.data.cols.length;\n\t\tconst counts = ndarray({\n\t\t\t'shape': [ nRows, nCols ],\n\t\t\t'dtype': 'int32'\n\t\t});\n\t\tconst actions = this.getActions();\n\t\tfor ( let i = 0; i < actions.length; i++ ) {\n\t\t\tconst elem = actions[ i ].value;\n\t\t\tfor ( let j = 0; j < nRows; j++ ) {\n\t\t\t\tfor ( let k = 0; k < nCols; k++ ) {\n\t\t\t\t\tif ( elem[ j ][ k ] === true ) {\n\t\t\t\t\t\tcounts.set( j, k, Number( counts.get( j, k ) ) + 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst table = <table className=\"table table-bordered\" >\n\t\t\t<thead>\n\t\t\t\t<th></th>\n\t\t\t\t{this.props.data.cols.map( ( c, i ) => <th key={i} >{c}</th> )}\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t{this.props.data.rows.map( ( r, idx ) => {\n\t\t\t\t\tconst row = new Array( nCols+1 );\n\t\t\t\t\trow[ 0 ] = <th>{r}</th>;\n\t\t\t\t\tfor ( let i = 0; i < nCols; i++ ) {\n\t\t\t\t\t\trow.push( <td>{counts.get( idx, i )}</td> );\n\t\t\t\t\t}\n\t\t\t\t\treturn <tr key={idx}>{row}</tr>;\n\t\t\t\t})}\n\t\t\t</tbody>\n\t\t</table>;\n\t\treturn (\n\t\t\t<div style={{ height: 0.75 * window.innerHeight }} >\n\t\t\t\t{table}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderNestedTable = () => {\n\t\treturn null;\n\t}\n\n\tchatInviteFactory = ( chatName, email ) => {\n\t\tconst session = this.context;\n\t\treturn ( _, opened ) => {\n\t\t\tdebug( 'Invite '+email+' to personal chat...' );\n\t\t\tif ( opened ) {\n\t\t\t\tsession.inviteToChat({\n\t\t\t\t\tname: chatName,\n\t\t\t\t\tcanLeave: false\n\t\t\t\t}, email );\n\t\t\t} else {\n\t\t\t\tsession.closeChatForAll( chatName );\n\t\t\t}\n\t\t};\n\t}\n\n\tvideoChatInviteFactory = ( data, email ) => {\n\t\tconst session = this.context;\n\t\treturn ( _, opened ) => {\n\t\t\tdebug( 'Invite '+email+' to video chat...' );\n\t\t\tif ( opened ) {\n\t\t\t\tsession.inviteToVideo( data, email );\n\t\t\t}\n\t\t};\n\t}\n\n\trenderListGroupItem = ( index, key ) => {\n\t\tdebug( `Rendering item at position ${index}...` );\n\t\tconst { filtered, clusters, searchwords } = this.state;\n\t\tconst elem = filtered[ index ];\n\t\tconst value = generateValueLabel({ value: elem.value, ...this.props.data });\n\t\tlet highlighter;\n\t\tif ( this.props.data.type === 'image' ) {\n\t\t\thighlighter = <Image src={value} width=\"50%\" />;\n\t\t} else {\n\t\t\thighlighter = isString( value ) ? <Highlighter\n\t\t\t\tclassName=\"response-visualizer-text\"\n\t\t\t\tsearchWords={searchwords}\n\t\t\t\tautoEscape={true}\n\t\t\t\ttextToHighlight={wordWrap( String( value ) )}\n\t\t\t/> : value;\n\t\t}\n\t\tconst name = elem.name;\n\t\tconst style = {\n\t\t\tpadding: '0.75rem'\n\t\t};\n\t\tif ( clusters.length > 0 ) {\n\t\t\tconst opacity = 0.1;\n\t\t\tconst col = COLORS[ clusters[ index ] % COLORS.length ] || '#D3D3D3';\n\t\t\tlet rgba = 'rgba(' + parseInt( col.substring( 1, 3 ), 16 ) + ','+ parseInt( col.substring( 3, 5 ), 16 );\n\t\t\trgba += ',' + parseInt( col.substring( 5, 7 ), 16 ) + ',' + opacity + ')';\n\t\t\tstyle.background = rgba;\n\t\t\tstyle.border = '1px solid '+col;\n\t\t}\n\t\tconst session = this.context;\n\t\tconst date = new Date( elem.absoluteTime );\n\t\treturn ( <ListGroupItem key={key} style={style}>\n\t\t\t{ this.props.showExtended ?\n\t\t\t\t<span style={{ textAlign: 'left' }}>\n\t\t\t\t\t<b style={{ marginBottom: 4 }}>{name} ({elem.email}) ({date.toLocaleTimeString() + ' ' + date.toLocaleDateString()}):</b>\n\t\t\t\t\t<br />\n\t\t\t\t\t{highlighter}\n\t\t\t\t</span> :\n\t\t\t\thighlighter\n\t\t\t}\n\t\t\t{ this.props.showExtended && session.userProgress[ elem.email ] ? <ButtonGroup className=\"chat-button-group\" >\n\t\t\t\t<VideoChatButton\n\t\t\t\t\tfor={`${session.user.name}-${name}`}\n\t\t\t\t\tsubject={this.props.t( 'video-chat-with', { name })}\n\t\t\t\t\tstyle={{ float: 'right' }}\n\t\t\t\t\tonClick={this.videoChatInviteFactory({\n\t\t\t\t\t\tname: `${session.user.name}-${name}`,\n\t\t\t\t\t\tsubject: this.props.t( 'video-chat-with', { name })\n\t\t\t\t\t}, elem.email )}\n\t\t\t\t\tbuttonVariant=\"outline-secondary\"\n\t\t\t\t\tbuttonLabel={<i className=\"fa fa-xs fa-video\"></i>}\n\t\t\t\t\ttooltipPlacement=\"bottom\"\n\t\t\t\t\ttooltip={this.props.t( 'video-chat' )}\n\t\t\t\t/>\n\t\t\t\t<ChatButton\n\t\t\t\t\tfor={this.props.t( 'chat-with', { name })}\n\t\t\t\t\tonClick={this.chatInviteFactory( this.props.t( 'chat-with', { name }), elem.email )}\n\t\t\t\t\tbuttonVariant=\"outline-secondary\"\n\t\t\t\t\tbuttonLabel={<i className=\"fas fa-comments\"></i>}\n\t\t\t\t\ttooltipPlacement=\"bottom\"\n\t\t\t\t\ttooltip={this.props.t( 'text-chat' )}\n\t\t\t\t\tstyle={{ float: 'right' }}\n\t\t\t\t/>\n\t\t\t</ButtonGroup> : null }\n\t\t\t<ButtonGroup className=\"action-display-button-group\">\n\t\t\t{ this.props.data.type !== 'image' ?\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"outline-secondary\"\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\tonClick={this.showModalFactory({ ...elem, value: value })}\n\t\t\t\t\taria-label={this.props.t('fullscreen-view')}\n\t\t\t\t>\n\t\t\t\t\t<span className=\"fa fa-search-plus\" />\n\t\t\t\t</Button> :\n\t\t\t\tnull\n\t\t\t}\n\t\t\t{ this.props.showExtended ?\n\t\t\t\t\t<Button\n\t\t\t\t\t\tvariant=\"outline-danger\"\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\tonClick={this.props.deleteFactory( index )}\n\t\t\t\t\t\taria-label={this.props.t('delete')}\n\t\t\t\t\t>\n\t\t\t\t\t\t<span className=\"fa fa-trash\" />\n\t\t\t\t\t</Button> :\n\t\t\t\tnull\n\t\t\t}\n\t\t\t</ButtonGroup>\n\t\t</ListGroupItem> );\n\t}\n\n\trenderRangePlot = () => {\n\t\tconst halfWidth = [];\n\t\tconst values = [];\n\t\tconst midpoints = [];\n\t\tconst indices = [];\n\t\tconst actions = this.getActions();\n\t\tfor ( let i = 0; i < actions.length; i++ ) {\n\t\t\tvalues.push( JSON.parse( actions[ i ].value ) );\n\t\t\tmidpoints.push( 0.5 * ( values[ i ][ 0 ] + values[ i ][ 1 ] ) );\n\t\t\thalfWidth.push( 0.5 * ( values[ i ][ 1 ] - values[ i ][ 0 ] ) );\n\t\t\tindices.push( i );\n\t\t}\n\t\treturn ( <div style={{ height: 0.75 * window.innerHeight }}>\n\t\t\t<Plotly\n\t\t\t\tdata={[\n\t\t\t\t\t{\n\t\t\t\t\t\ty: midpoints,\n\t\t\t\t\t\tx: indices,\n\t\t\t\t\t\ttext: indices.map( i => {\n\t\t\t\t\t\t\treturn `[${values[ i ][ 0 ]}, ${values[ i ][ 1 ]}]`;\n\t\t\t\t\t\t}),\n\t\t\t\t\t\terror_y: {\n\t\t\t\t\t\t\ttype: 'data',\n\t\t\t\t\t\t\tarray: halfWidth,\n\t\t\t\t\t\t\tvisible: true\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttype: 'scatter',\n\t\t\t\t\t\tmode: 'markers',\n\t\t\t\t\t\torientation: 'h'\n\t\t\t\t\t}\n\t\t\t\t]}\n\t\t\t\tfit editable\n\t\t\t\tlayout={{\n\t\t\t\t\txaxis: {\n\t\t\t\t\t\tshowticklabels: false,\n\t\t\t\t\t\tshowline: false\n\t\t\t\t\t},\n\t\t\t\t\tyaxis: {\n\t\t\t\t\t\ttitle: this.props.t('value')\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div> );\n\t}\n\n\trenderPlot() {\n\t\tlet plot;\n\t\tif ( this.props.actions.length === 0 ) {\n\t\t\treturn <Alert variant=\"warning\" >{this.props.t('no-data-available')}</Alert>;\n\t\t}\n\t\tswitch ( this.props.data.type ) {\n\t\t\tcase 'image':\n\t\t\t\tplot = null;\n\t\t\t\tbreak;\n\t\t\tcase 'text':\n\t\t\tdefault:\n\t\t\t\tplot = this.renderWordCloud();\n\t\t\t\tbreak;\n\t\t\tcase 'factor':\n\t\t\t\tplot = this.renderBarchart();\n\t\t\t\tbreak;\n\t\t\tcase 'number':\n\t\t\t\tplot = this.renderHistogram();\n\t\t\t\tbreak;\n\t\t\tcase 'matrix':\n\t\t\t\tplot = this.renderTable();\n\t\t\t\tbreak;\n\t\t\tcase 'tensor':\n\t\t\t\tplot = this.renderNestedTable();\n\t\t\t\tbreak;\n\t\t\tcase 'matches':\n\t\t\t\tplot = this.renderSankeyDiagram();\n\t\t\t\tbreak;\n\t\t\tcase 'range':\n\t\t\t\tplot = this.renderRangePlot();\n\t\t\t\tbreak;\n\t\t}\n\t\tif ( !plot ) {\n\t\t\treturn null;\n\t\t}\n\t\tconst label = removeLast( lowercase( this.props.actionLabel ) );\n\t\treturn ( <div>\n\t\t\t{plot}\n\t\t\t<Switch style={{ zIndex: 2000 }} onChange={( idx ) => {\n\t\t\t\tlet type;\n\t\t\t\tswitch ( idx ) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\ttype = 'first';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\ttype = 'all';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\ttype = 'last';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis.setState({ handleMultipleResponses: type });\n\t\t\t}}>\n\t\t\t\t<i>\n\t\t\t\t\t<Trans i18nKey=\"include-first\" ns=\"ResponseVisualizer\" >\n\t\t\t\t\t\t<b>Only</b> include first {label} for any student.\n\t\t\t\t\t</Trans>\n\t\t\t\t</i>\n\t\t\t\t<i>\n\t\t\t\t\t<Trans i18nKey=\"include-all\" ns=\"ResponseVisualizer\" >\n\t\t\t\t\t\tInclude <b>all</b> {label}s for any student.\n\t\t\t\t\t</Trans>\n\t\t\t\t</i>\n\t\t\t\t<i>\n\t\t\t\t\t<Trans i18nKey=\"include-latest\" ns=\"ResponseVisualizer\" >\n\t\t\t\t\t\t<b>Only</b> include latest {label} for any student.\n\t\t\t\t\t</Trans>\n\t\t\t\t</i>\n\t\t\t</Switch>\n\t\t</div> );\n\t}\n\n\trender() {\n\t\treturn ( <Fragment>\n\t\t\t<Modal\n\t\t\t\tshow={true}\n\t\t\t\tonHide={this.props.toggleActions}\n\t\t\t\tdialogClassName=\"modal-100w\"\n\t\t\t>\n\t\t\t\t<FullscreenHeader\n\t\t\t\t\tcomponentID={this.props.componentID}\n\t\t\t\t\tactionLabel={this.props.actionLabel}\n\t\t\t\t\tonPeriodChange={this.props.onPeriodChange}\n\t\t\t\t\tcohorts={this.context.cohorts}\n\t\t\t\t\tselectedCohort={this.props.selectedCohort}\n\t\t\t\t\tonCohortChange={this.props.onCohortChange}\n\t\t\t\t\tactions={this.props.actions}\n\t\t\t\t\tt={this.props.t}\n\t\t\t\t/>\n\t\t\t\t<Modal.Body style={{ minHeight: 0.75 * window.innerHeight, padding: 0 }} >\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col md={6}>\n\t\t\t\t\t\t\t{ this.state.filtered.length > 0 ?\n\t\t\t\t\t\t\t\t<div style={{ marginLeft: 0, overflowY: 'scroll', height: 0.75 * window.innerHeight }}>\n\t\t\t\t\t\t\t\t\t<ReactList\n\t\t\t\t\t\t\t\t\t\tinitialIndex={0}\n\t\t\t\t\t\t\t\t\t\titemRenderer={this.renderListGroupItem}\n\t\t\t\t\t\t\t\t\t\tlength={this.state.filtered.length}\n\t\t\t\t\t\t\t\t\t\ttype={this.props.data.type === 'image' ? 'uniform' : 'variable'}\n\t\t\t\t\t\t\t\t\t\tpageSize={50}\n\t\t\t\t\t\t\t\t\t\tminSize={10}\n\t\t\t\t\t\t\t\t\t\titemSizeGetter={this.itemSizeGetter}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div> :\n\t\t\t\t\t\t\t\t<Card body className=\"bg-light\">\n\t\t\t\t\t\t\t\t\t<h2>{this.props.t('no-matching-data')}</h2>\n\t\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col md={6} style={{ overflowY: 'auto', maxWidth: '49.2%' }}>\n\t\t\t\t\t\t\t{this.renderPlot()}\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t</Modal.Body>\n\t\t\t\t<Modal.Footer>\n\t\t\t\t\t<h4>\n\t\t\t\t\t\t<Badge variant=\"secondary\">\n\t\t\t\t\t\t\t{this.props.t( 'num-actions', { label: uncapitalize( this.props.actionLabel ), n: this.state.filtered.length })}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t</h4>\n\t\t\t\t\t<Search\n\t\t\t\t\t\tonClick={this.searchFilter}\n\t\t\t\t\t\textended={this.props.showExtended}\n\t\t\t\t\t\tt={this.props.t}\n\t\t\t\t\t/>\n\t\t\t\t\t<Button variant=\"secondary\" onClick={this.props.toggleExtended}>{ this.props.showExtended ? this.props.t('hide-extended') : this.props.t('show-extended') }</Button>\n\t\t\t\t\t<Button onClick={this.props.toggleActions}>{this.props.t('close')}</Button>\n\t\t\t\t</Modal.Footer>\n\t\t\t</Modal>\n\t\t\t<SingleActionModal\n\t\t\t\tshow={this.state.showModal} onHide={this.hideModal}\n\t\t\t\tmodalContent={this.state.modalContent}\n\t\t\t\tactionLabel={this.props.actionLabel}\n\t\t\t\tdataType={this.props.data.type}\n\t\t\t\tshowExtended={this.state.showExtended}\n\t\t\t\tt={this.props.t}\n\t\t\t/>\n\t\t</Fragment> );\n\t}\n}\n\n\n// PROPERTIES //\n\nFullscreenActionDisplay.propTypes = {\n\tactions: PropTypes.array.isRequired,\n\tactionLabel: PropTypes.string,\n\tdata: PropTypes.object.isRequired,\n\tcomponentID: PropTypes.string.isRequired,\n\tdeleteFactory: PropTypes.func.isRequired,\n\tonPeriodChange: PropTypes.func.isRequired,\n\tshowExtended: PropTypes.bool.isRequired,\n\ttoggleActions: PropTypes.func.isRequired,\n\ttoggleExtended: PropTypes.func.isRequired\n};\n\nFullscreenActionDisplay.defaultProps = {\n\tactionLabel: null\n};\n\nFullscreenActionDisplay.contextType = SessionContext;\n\n\n// EXPORTS //\n\n\nexport default FullscreenActionDisplay;\n","// MODULES //\n\nimport copy from '@stdlib/utils/copy';\nimport logger from 'debug';\nimport isObjectLike from '@stdlib/assert/is-object-like';\nimport { MATCH_LIST_SUBMISSION, MULTIPLE_CHOICE_MATRIX_SUBMISSION, USER_FEEDBACK_FORM } from '@isle-project/constants/actions.js';\n\n\n// VARIABLES //\n\nconst debug = logger( 'isle:response-visualizer' );\n\n\n// MAIN //\n\nfunction extractValue( action ) {\n\tif ( action.type === USER_FEEDBACK_FORM ) {\n\t\taction = copy( action );\n\t\tdebug( 'Received a feedback action...' );\n\t\tlet json;\n\t\tif ( isObjectLike( action.value ) ) {\n\t\t\tjson = action.value;\n\t\t} else {\n\t\t\tjson = JSON.parse( action.value );\n\t\t}\n\t\taction.value = '';\n\t\tif ( json.comments ) {\n\t\t\taction.value += json.comments + '. ';\n\t\t}\n\t\tif ( json.noUnderstanding ) {\n\t\t\taction.value += 'I do not understand this. ';\n\t\t}\n\t\tif ( json.needsExplanation ) {\n\t\t\taction.value += 'It needs a more detailed explanation. ';\n\t\t}\n\t\tif ( json.noLogic ) {\n\t\t\taction.value += 'I can\\'t follow the logic. ';\n\t\t}\n\t}\n\telse if (\n\t\taction.type === MULTIPLE_CHOICE_MATRIX_SUBMISSION ||\n\t\taction.type === MATCH_LIST_SUBMISSION\n\t) {\n\t\tif ( !isObjectLike( action.value ) ) {\n\t\t\taction.value = JSON.parse( action.value );\n\t\t}\n\t}\n\treturn action;\n}\n\n\n// EXPORTS //\n\nexport default extractValue;\n","// MODULES //\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport logger from 'debug';\nimport { withTranslation } from 'react-i18next';\nimport Badge from 'react-bootstrap/Badge';\nimport Button from 'react-bootstrap/Button';\nimport Popover from 'react-bootstrap/Popover';\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\nimport ProgressBar from 'react-bootstrap/ProgressBar';\nimport hasOwnProperty from '@stdlib/assert/has-own-property';\nimport uncapitalize from '@stdlib/string/uncapitalize';\nimport Gate from '@isle-project/components/gate';\nimport OverlayTrigger from '@isle-project/components/overlay-trigger';\nimport Tooltip from '@isle-project/components/tooltip';\nimport DeleteModal from '@isle-project/components/internal/delete-modal';\nimport SessionContext from '@isle-project/session/context.js';\nimport isUserInCohort from '@isle-project/utils/is-user-in-cohort';\nimport { RESPONSE_VISUALIZER_TOGGLE, RESPONSE_VISUALIZER_EXTENDED } from '@isle-project/constants/actions.js';\nimport { FOCUS_ELEMENT, LOSE_FOCUS_ELEMENT, MEMBER_ACTION,\n\tRETRIEVED_USER_ACTIONS, SELECTED_COHORT, UPDATED_VISUALIZER } from '@isle-project/constants/events.js';\nimport { addResources } from '@isle-project/locales';\nimport FullscreenActionDisplay from './fullscreen_action_display.js';\nimport extractValue from './extract_value.js';\nimport './response_visualizer.css';\n\n\n// VARIABLES //\n\nconst debug = logger( 'isle:response-visualizer' );\naddResources( 'ResponseVisualizer' );\n\n\n// FUNCTIONS //\n\n/**\n* Extracts the second to last word of an action type, as these should be most informative about the nature of the action (recall that project convention is to use `_` to separate words in action types)\n*\n* @private\n* @param {string} str - action type\n* @returns {string} substring of action type\n*/\nconst extractSubstr = ( str ) => {\n\treturn str.substr( str.lastIndexOf( '_', str.lastIndexOf( '_' ) - 1 ) + 1 );\n};\n\nconst usersWithFocus = ( userFocuses, usersWithActions, id ) => {\n\tconst out = [];\n\tfor ( let key in userFocuses ) {\n\t\tif (\n\t\t\thasOwnProperty( userFocuses, key ) && // user has component in focus\n\t\t\t!hasOwnProperty( usersWithActions, key ) // user has not already submitted an action\n\t\t) {\n\t\t\tconst elemID = userFocuses[ key ];\n\t\t\tif ( elemID === id ) {\n\t\t\t\tout.push( key );\n\t\t\t}\n\t\t}\n\t}\n\treturn out;\n};\n\n\n// MAIN //\n\n/**\n* Instructor panel for visualizing component responses.\n*\n* @property {string} buttonLabel - label of button to pull of action display\n* @property {Object} buttonStyle - button CSS styles\n* @property {Object} data - data type information to visualize\n* @property {string} showID - whether to display the component ID\n* @property {string} variant - button style variant\n* @property {string} info - action identifier for info\n* @property {string} success - action identifier for success\n* @property {string} danger - action identifier for danger\n* @property {boolean} noSessionRegistration - controls whether to register the component in the session (e.g., for progress calculations)\n*/\nclass ResponseVisualizer extends Component {\n\tconstructor( props, context ) {\n\t\tsuper( props );\n\n\t\tthis.state = {\n\t\t\tactions: [],\n\t\t\tnActions: 0,\n\t\t\tnSuccess: 0,\n\t\t\tnDanger: 0,\n\t\t\tnInfo: 0,\n\t\t\tshowActions: false,\n\t\t\tshowExtended: false,\n\t\t\tshowDeleteModal: false,\n\t\t\tselectedAction: null,\n\t\t\tperiod: null\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tconst session = this.context;\n\t\tthis.registerInSession();\n\t\tthis.addSessionActions();\n\t\tif ( session ) {\n\t\t\tthis.unsubscribe = session.subscribe( ( type, action ) => {\n\t\t\t\tif ( type === RETRIEVED_USER_ACTIONS || type === SELECTED_COHORT ) {\n\t\t\t\t\tthis.addSessionActions();\n\t\t\t\t}\n\t\t\t\telse if (\n\t\t\t\t\ttype === MEMBER_ACTION &&\n\t\t\t\t\taction.id === this.props.id\n\t\t\t\t) {\n\t\t\t\t\tif (\n\t\t\t\t\t\taction.type === FOCUS_ELEMENT ||\n\t\t\t\t\t\taction.type === LOSE_FOCUS_ELEMENT\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis.forceUpdate();\n\t\t\t\t\t} else if (\n\t\t\t\t\t\taction.type === this.props.info ||\n\t\t\t\t\t\taction.type === this.props.success ||\n\t\t\t\t\t\taction.type === this.props.danger\n\t\t\t\t\t) {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tsession.selectedCohort &&\n\t\t\t\t\t\t\t!isUserInCohort( session.selectedCohort, action.email )\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.pushSessionAction( action );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif ( this.unsubscribe ) {\n\t\t\tthis.unsubscribe();\n\t\t}\n\n\t\t// Unregister from session:\n\t\tconst session = this.context;\n\t\tdelete session.responseVisualizers[ this.props.id ];\n\t\tsession.responseVisualizerIds = session.responseVisualizerIds.filter( x => {\n\t\t\treturn x !== this.props.id;\n\t\t});\n\t}\n\n\tregisterInSession() {\n\t\tconst props = this.props;\n\t\tconst session = this.context;\n\t\tif ( props.info && props.id && !props.noSessionRegistration ) {\n\t\t\tdebug( `Register response visualizer for ${props.id} in session:` );\n\t\t\tsession.responseVisualizers[ props.id ] = {\n\t\t\t\ttype: props.info,\n\t\t\t\tref: this\n\t\t\t};\n\t\t\tconst ids = session.responseVisualizerIds;\n\t\t\tids.push( props.id );\n\t\t\tsession.debouncedInitializeProgress();\n\t\t\tids.sort( ( a, b ) => {\n\t\t\t\ta = document.getElementById( `${a}_response_visualizer` );\n\t\t\t\tb = document.getElementById( `${b}_response_visualizer` );\n\t\t\t\tif ( !a || !b ) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tif ( a === b ) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tconst comp = a.compareDocumentPosition( b );\n\t\t\t\tif ( comp & 2 ) {\n\t\t\t\t\t// `b` comes before `a`\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t});\n\t\t}\n\t}\n\n\ttoggleActions = () => {\n\t\tconst session = this.context;\n\t\tsession.log({\n\t\t\tid: this.props.id+'_response_visualizer',\n\t\t\ttype: RESPONSE_VISUALIZER_TOGGLE,\n\t\t\tvalue: !this.state.showActions\n\t\t});\n\t\tconst newState = {\n\t\t\tshowActions: !this.state.showActions\n\t\t};\n\t\tif ( newState.showActions ) {\n\t\t\tthis.addSessionActions();\n\t\t} else {\n\t\t\tnewState.period = null;\n\t\t}\n\t\tthis.setState( newState );\n\t}\n\n\ttoggleExtended = () => {\n\t\tthis.setState({\n\t\t\tshowExtended: !this.state.showExtended\n\t\t}, () => {\n\t\t\tconst session = this.context;\n\t\t\tsession.log({\n\t\t\t\tid: this.props.id+'_response_visualizer',\n\t\t\t\ttype: RESPONSE_VISUALIZER_EXTENDED,\n\t\t\t\tvalue: this.state.showExtended\n\t\t\t});\n\t\t});\n\t}\n\n\tonPeriodChange = ( newPeriod ) => {\n\t\tthis.setState({\n\t\t\tperiod: newPeriod\n\t\t}, this.addSessionActions );\n\t}\n\n\tonCohortChange = ( event ) => {\n\t\tdebug( 'Change the selected cohort...' );\n\t\tthis.context.selectCohort( event.target.value );\n\t}\n\n\tpushSessionAction = ( action ) => {\n\t\taction = extractValue( action );\n\t\tconst filtered = this.state.actions;\n\t\tif ( this.state.period ) {\n\t\t\tconst { from, to } = this.state.period;\n\t\t\tif ( action.absoluteTime > from && action.absoluteTime < to ) {\n\t\t\t\tfiltered.unshift( action );\n\t\t\t}\n\t\t} else {\n\t\t\tfiltered.unshift( action );\n\t\t}\n\t\tconst newState = {\n\t\t\tactions: filtered,\n\t\t\tnActions: this.state.nActions + 1\n\t\t};\n\t\tif ( !this.emailHash[ action.email ] ) {\n\t\t\tthis.emailHash[ action.email ] = action.type;\n\t\t\tif ( this.props.success && action.type === this.props.success ) {\n\t\t\t\tnewState.nSuccess = this.state.nSuccess + 1;\n\t\t\t} else if ( this.props.danger && action.type === this.props.danger ) {\n\t\t\t\tnewState.nDanger = this.state.nDanger + 1;\n\t\t\t} else if ( this.props.info && action.type === this.props.info ){\n\t\t\t\tnewState.nInfo = this.state.nInfo + 1;\n\t\t\t}\n\t\t}\n\t\tthis.setState( newState );\n\t}\n\n\taddSessionActions = () => {\n\t\tconst session = this.context;\n\t\tdebug( !session.selectedCohort ? 'Add session actions...' : 'Add session actions for cohort '+session.selectedCohort.title );\n\t\tconst actions = session.socketActions;\n\t\tconst filtered = [];\n\t\tthis.emailHash = {};\n\t\tfor ( let i = 0; i < actions.length; i++ ) {\n\t\t\tlet action = actions[ i ];\n\t\t\tif (\n\t\t\t\taction.id === this.props.id &&\n\t\t\t\t( action.type === this.props.info || action.type === this.props.success || action.type === this.props.danger )\n\t\t\t) {\n\t\t\t\taction = extractValue( action );\n\t\t\t\tif (\n\t\t\t\t\tsession.selectedCohort &&\n\t\t\t\t\t!isUserInCohort( session.selectedCohort, action.email )\n\t\t\t\t) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tthis.emailHash[ action.email ] = action.type;\n\t\t\t\tif ( this.state.period ) {\n\t\t\t\t\tconst { from, to } = this.state.period;\n\t\t\t\t\tif ( action.absoluteTime > from && action.absoluteTime < to ) {\n\t\t\t\t\t\tfiltered.push( action );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfiltered.push( action );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst newState = {\n\t\t\tnSuccess: 0,\n\t\t\tnDanger: 0,\n\t\t\tnInfo: 0,\n\t\t\tactions: filtered\n\t\t};\n\t\tif ( !this.state.period ) {\n\t\t\t// Attach total number of actions on initial call:\n\t\t\tnewState.nActions = filtered.length;\n\t\t}\n\t\tconst users = session.userList;\n\t\tfor ( let i = 0; i < users.length; i++ ) {\n\t\t\tconst userEmail = users[ i ].email;\n\t\t\tif ( hasOwnProperty( this.emailHash, userEmail ) ) {\n\t\t\t\tconst type = this.emailHash[ userEmail ];\n\t\t\t\tif ( this.props.success && type === this.props.success ) {\n\t\t\t\t\tnewState.nSuccess += 1;\n\t\t\t\t} else if ( this.props.danger && type === this.props.danger ) {\n\t\t\t\t\tnewState.nDanger += 1;\n\t\t\t\t} else if ( this.props.info && type === this.props.info ) {\n\t\t\t\t\tnewState.nInfo += 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.setState( newState, () => {\n\t\t\tsession.update( UPDATED_VISUALIZER, this.props.id );\n\t\t});\n\t}\n\n\tcloseDeleteModal = () => {\n\t\tthis.setState({\n\t\t\tshowDeleteModal: false,\n\t\t\tselectedAction: null\n\t\t});\n\t}\n\n\tdeleteFactory = ( idx ) => {\n\t\treturn () => {\n\t\t\tdebug( 'Delete action at index '+idx );\n\t\t\tthis.setState({\n\t\t\t\tselectedAction: this.state.actions[ idx ],\n\t\t\t\tshowDeleteModal: true\n\t\t\t});\n\t\t};\n\t}\n\n\tdeleteSelectedAction = () => {\n\t\tconst session = this.context;\n\t\tsession.removeSessionElementFromDB( this.state.selectedAction.sessiondataID, ( err ) => {\n\t\t\tif ( !err ) {\n\t\t\t\tthis.addSessionActions();\n\t\t\t}\n\t\t\tthis.closeDeleteModal();\n\t\t});\n\t}\n\n\trenderTooltip() {\n\t\tconst session = this.context;\n\t\tlet nUsers;\n\t\tif ( session.selectedCohort ) {\n\t\t\tnUsers = session.activeCohortMembers.length;\n\t\t} else {\n\t\t\tnUsers = session.userList.length;\n\t\t}\n\t\tconst focusUsers = usersWithFocus( session.userFocuses, this.emailHash, this.props.id );\n\n\t\t// eslint-disable-next-line i18next/no-literal-string\n\t\tlet tooltip = `${this.props.t('interaction-rate-tooltip')}:\\n\\n`;\n\t\tconst table = <table className=\"table table-bordered table-condensed\" >\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>{this.props.t('action-type')}</th>\n\t\t\t\t\t<th>{this.props.t('rate')}</th>\n\t\t\t\t\t<th>{this.props.t('color')}</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t{ this.props.success ?\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{extractSubstr( this.props.success )}</td>\n\t\t\t\t\t\t<td>{this.state.nSuccess} / {nUsers}</td>\n\t\t\t\t\t\t<td>{this.props.t('green')}</td>\n\t\t\t\t\t</tr> : null\n\t\t\t\t}\n\t\t\t\t{ this.props.danger ?\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{extractSubstr( this.props.danger)}</td>\n\t\t\t\t\t\t<td>{this.state.nDanger} / {nUsers}</td>\n\t\t\t\t\t\t<td>{this.props.t('red')}</td>\n\t\t\t\t\t</tr> : null\n\t\t\t\t}\n\t\t\t\t{ this.props.info ?\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{extractSubstr( this.props.info )}</td>\n\t\t\t\t\t\t<td>{this.state.nInfo} / {nUsers}</td>\n\t\t\t\t\t\t<td>{this.props.t('blue')}</td>\n\t\t\t\t\t</tr> : null\n\t\t\t\t}\n\t\t\t\t<tr>\n\t\t\t\t\t<td>{this.props.t('in-focus')}</td>\n\t\t\t\t\t<td>{focusUsers.length} / {nUsers}</td>\n\t\t\t\t\t<td>{this.props.t('orange')}</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>;\n\n\t\ttooltip = <Popover title={tooltip} style={{ fontSize: 12, textAlign: 'left', maxWidth: 1200 }} >\n\t\t\t<Popover.Content>\n\t\t\t\t{table}\n\t\t\t\t<p>{this.props.t('users-in-focus')}</p>\n\t\t\t\t<p style={{ wordWrap: 'break-word' }} >{focusUsers.join( ', ')}</p>\n\t\t\t</Popover.Content>\n\t\t</Popover>;\n\t\treturn tooltip;\n\t}\n\n\trenderFullscreenModal() {\n\t\tconst optionalProps = {};\n\t\tif ( this.props.buttonLabel ) {\n\t\t\toptionalProps.actionLabel = this.props.buttonLabel;\n\t\t} else {\n\t\t\toptionalProps.actionLabel = this.props.t('actions');\n\t\t}\n\t\tif ( !this.state.showActions ) {\n\t\t\treturn null;\n\t\t}\n\t\treturn ( <FullscreenActionDisplay\n\t\t\tcomponentID={this.props.id}\n\t\t\tactions={this.state.actions}\n\t\t\tshowExtended={this.state.showExtended}\n\t\t\tdeleteFactory={this.deleteFactory}\n\t\t\tonPeriodChange={this.onPeriodChange}\n\t\t\ttoggleExtended={this.toggleExtended}\n\t\t\ttoggleActions={this.toggleActions}\n\t\t\tdata={this.props.data}\n\t\t\tselectedCohort={this.context.selectedCohort}\n\t\t\tonCohortChange={this.onCohortChange}\n\t\t\tt={this.props.t}\n\t\t\t{...optionalProps}\n\t\t/> );\n\t}\n\n\trender() {\n\t\tif ( !this.props.id ) {\n\t\t\treturn <Gate owner><span className=\"title no-id-message\">{this.props.t('no-id')}</span></Gate>;\n\t\t}\n\t\tconst session = this.context;\n\t\tlet nUsers;\n\t\tif ( session.selectedCohort ) {\n\t\t\tnUsers = session.activeCohortMembers.length;\n\t\t} else {\n\t\t\tnUsers = session.userList.length;\n\t\t}\n\t\tconst focusUsers = usersWithFocus( session.userFocuses, this.emailHash, this.props.id );\n\t\tlet successRate = this.state.nSuccess / nUsers;\n\t\tsuccessRate *= 100.0;\n\t\tlet dangerRate = this.state.nDanger / nUsers;\n\t\tdangerRate *= 100.0;\n\t\tlet infoRate = this.state.nInfo / nUsers;\n\t\tinfoRate *= 100.0;\n\t\tlet focusRate = focusUsers.length / nUsers;\n\t\tfocusRate *= 100.0;\n\t\tconst buttonLabel = this.props.buttonLabel || this.props.t('actions');\n\t\treturn (\n\t\t\t<div\n\t\t\t\tid={`${this.props.id}_response_visualizer`}\n\t\t\t\tstyle={{ display: this.props.inline ? 'inline' : 'inherit' }}\n\t\t\t>\n\t\t\t\t<Gate owner>\n\t\t\t\t{this.renderFullscreenModal()}\n\t\t\t\t\t<ButtonGroup size=\"sm\" vertical style={{ verticalAlign: 'inherit', ...this.props.style }} >\n\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\tplacement='top'\n\t\t\t\t\t\t\ttooltip={this.props.showID ? <span>\n\t\t\t\t\t\t\t\t{this.props.t('open-tooltip', { label: uncapitalize( buttonLabel ), id: this.props.id })}\n\t\t\t\t\t\t\t</span> : null}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tonClick={this.toggleActions}\n\t\t\t\t\t\t\t\tstyle={{ ...this.props.buttonStyle }}\n\t\t\t\t\t\t\t\tvariant={this.props.variant}\n\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\tid={`${this.props.id}_answers_button`}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span style={{ marginRight: '5px', pointerEvents: 'none' }} >{buttonLabel}</span>\n\t\t\t\t\t\t\t\t<Badge variant=\"dark\" style={{ fontSize: '10px', pointerEvents: 'none' }}>{this.state.nActions}</Badge>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t<OverlayTrigger\n\t\t\t\t\t\t\ttrigger={['hover', 'focus']}\n\t\t\t\t\t\t\tplacement=\"top\"\n\t\t\t\t\t\t\toverlay={this.renderTooltip()}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ProgressBar style={{ width: '100%', marginTop: '3px', height: '0.7rem', boxShadow: '0 0 2px black' }}>\n\t\t\t\t\t\t\t\t<ProgressBar variant=\"info\" now={infoRate} max={100} min={0} />\n\t\t\t\t\t\t\t\t<ProgressBar variant=\"warning\" now={focusRate} max={100} min={0} />\n\t\t\t\t\t\t\t\t<ProgressBar variant=\"success\" now={successRate} max={100} min={0} />\n\t\t\t\t\t\t\t\t<ProgressBar variant=\"danger\" now={dangerRate} max={100} min={0} />\n\t\t\t\t\t\t\t</ProgressBar>\n\t\t\t\t\t\t</OverlayTrigger>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</Gate>\n\t\t\t\t<DeleteModal\n\t\t\t\t\tshow={this.state.showDeleteModal}\n\t\t\t\t\tonDelete={this.deleteSelectedAction}\n\t\t\t\t\tonClose={this.closeDeleteModal}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\n\n// PROPERTIES //\n\nResponseVisualizer.propTypes = {\n\tbuttonLabel: PropTypes.string,\n\tbuttonStyle: PropTypes.object,\n\tdata: PropTypes.shape({\n\t\ttype: PropTypes.oneOf([\n\t\t\t'factor', 'image', 'text', 'number', 'matches', 'matrix', 'range', 'tensor'\n\t\t]),\n\t\tlevels: PropTypes.array,\n\t\tquestion: PropTypes.oneOfType([ PropTypes.node, PropTypes.string ]),\n\t\tsolution: PropTypes.any\n\t}),\n\tshowID: PropTypes.bool,\n\tsuccess: PropTypes.string,\n\tdanger: PropTypes.string,\n\tinfo: PropTypes.string,\n\tinline: PropTypes.bool,\n\tstyle: PropTypes.object,\n\tvariant: PropTypes.oneOf([\n\t\t'primary', 'secondary', 'light', 'dark'\n\t]),\n\tnoSessionRegistration: PropTypes.bool\n};\n\nResponseVisualizer.defaultProps = {\n\tbuttonLabel: null,\n\tbuttonStyle: {},\n\tdata: {\n\t\ttype: 'text'\n\t},\n\tshowID: true,\n\tsuccess: null,\n\tdanger: null,\n\tinfo: null,\n\tinline: false,\n\tstyle: {},\n\tvariant: 'secondary',\n\tnoSessionRegistration: false\n};\n\nResponseVisualizer.contextType = SessionContext;\n\n\n// EXPORTS //\n\nexport default withTranslation( 'ResponseVisualizer' )( ResponseVisualizer );\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport classNames from 'classnames';\nimport React, { cloneElement } from 'react';\nimport { useBootstrapPrefix } from './ThemeProvider';\nimport { map } from './ElementChildren';\nvar ROUND_PRECISION = 1000;\n/**\n * Validate that children, if any, are instances of `<ProgressBar>`.\n */\n\nfunction onlyProgressBar(props, propName, componentName) {\n  var children = props[propName];\n\n  if (!children) {\n    return null;\n  }\n\n  var error = null;\n  React.Children.forEach(children, function (child) {\n    if (error) {\n      return;\n    }\n    /**\n     * Compare types in a way that works with libraries that patch and proxy\n     * components like react-hot-loader.\n     *\n     * see https://github.com/gaearon/react-hot-loader#checking-element-types\n     */\n\n\n    var element = /*#__PURE__*/React.createElement(ProgressBar, null);\n    if (child.type === element.type) return;\n    var childType = child.type;\n    var childIdentifier = React.isValidElement(child) ? childType.displayName || childType.name || childType : child;\n    error = new Error(\"Children of \" + componentName + \" can contain only ProgressBar \" + (\"components. Found \" + childIdentifier + \".\"));\n  });\n  return error;\n}\n\nvar defaultProps = {\n  min: 0,\n  max: 100,\n  animated: false,\n  isChild: false,\n  srOnly: false,\n  striped: false\n};\n\nfunction getPercentage(now, min, max) {\n  var percentage = (now - min) / (max - min) * 100;\n  return Math.round(percentage * ROUND_PRECISION) / ROUND_PRECISION;\n}\n\nfunction renderProgressBar(_ref, ref) {\n  var _classNames;\n\n  var min = _ref.min,\n      now = _ref.now,\n      max = _ref.max,\n      label = _ref.label,\n      srOnly = _ref.srOnly,\n      striped = _ref.striped,\n      animated = _ref.animated,\n      className = _ref.className,\n      style = _ref.style,\n      variant = _ref.variant,\n      bsPrefix = _ref.bsPrefix,\n      props = _objectWithoutPropertiesLoose(_ref, [\"min\", \"now\", \"max\", \"label\", \"srOnly\", \"striped\", \"animated\", \"className\", \"style\", \"variant\", \"bsPrefix\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    ref: ref\n  }, props, {\n    role: \"progressbar\",\n    className: classNames(className, bsPrefix + \"-bar\", (_classNames = {}, _classNames[\"bg-\" + variant] = variant, _classNames[bsPrefix + \"-bar-animated\"] = animated, _classNames[bsPrefix + \"-bar-striped\"] = animated || striped, _classNames)),\n    style: _extends({\n      width: getPercentage(now, min, max) + \"%\"\n    }, style),\n    \"aria-valuenow\": now,\n    \"aria-valuemin\": min,\n    \"aria-valuemax\": max\n  }), srOnly ? /*#__PURE__*/React.createElement(\"span\", {\n    className: \"sr-only\"\n  }, label) : label);\n}\n\nvar ProgressBar = React.forwardRef(function (_ref2, ref) {\n  var isChild = _ref2.isChild,\n      props = _objectWithoutPropertiesLoose(_ref2, [\"isChild\"]);\n\n  props.bsPrefix = useBootstrapPrefix(props.bsPrefix, 'progress');\n\n  if (isChild) {\n    return renderProgressBar(props, ref);\n  }\n\n  var min = props.min,\n      now = props.now,\n      max = props.max,\n      label = props.label,\n      srOnly = props.srOnly,\n      striped = props.striped,\n      animated = props.animated,\n      bsPrefix = props.bsPrefix,\n      variant = props.variant,\n      className = props.className,\n      children = props.children,\n      wrapperProps = _objectWithoutPropertiesLoose(props, [\"min\", \"now\", \"max\", \"label\", \"srOnly\", \"striped\", \"animated\", \"bsPrefix\", \"variant\", \"className\", \"children\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    ref: ref\n  }, wrapperProps, {\n    className: classNames(className, bsPrefix)\n  }), children ? map(children, function (child) {\n    return cloneElement(child, {\n      isChild: true\n    });\n  }) : renderProgressBar({\n    min: min,\n    now: now,\n    max: max,\n    label: label,\n    srOnly: srOnly,\n    striped: striped,\n    animated: animated,\n    bsPrefix: bsPrefix,\n    variant: variant\n  }, ref));\n});\nProgressBar.displayName = 'ProgressBar';\nProgressBar.defaultProps = defaultProps;\nexport default ProgressBar;","import React from 'react';\n/**\n * Iterates through children that are typically specified as `props.children`,\n * but only maps over children that are \"valid elements\".\n *\n * The mapFunction provided index will be normalised to the components mapped,\n * so an invalid component would not increase the index.\n *\n */\n\nfunction map(children, func) {\n  var index = 0;\n  return React.Children.map(children, function (child) {\n    return React.isValidElement(child) ? func(child, index++) : child;\n  });\n}\n/**\n * Iterates through children that are \"valid elements\".\n *\n * The provided forEachFunc(child, index) will be called for each\n * leaf child with the index reflecting the position relative to \"valid components\".\n */\n\n\nfunction forEach(children, func) {\n  var index = 0;\n  React.Children.forEach(children, function (child) {\n    if (React.isValidElement(child)) func(child, index++);\n  });\n}\n\nexport { map, forEach };","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict';\n/**\n* Test if a value is an empty string.\n*\n* @module @stdlib/assert/is-empty-string\n*\n* @example\n* var isEmptyString = require( '@stdlib/assert/is-empty-string' );\n*\n* var bool = isEmptyString( '' );\n* // returns true\n*\n* bool = isEmptyString( 'beep' );\n* // returns false\n*\n* bool = isEmptyString( [] );\n* // returns false\n*\n* @example\n* var isEmptyString = require( '@stdlib/assert/is-empty-string' ).isObject;\n*\n* var bool = isEmptyString( new String( '' ) );\n* // returns true\n*\n* bool = isEmptyString( '' );\n* // returns false\n*\n* @example\n* var isEmptyString = require( '@stdlib/assert/is-empty-string' ).isPrimitive;\n*\n* var bool = isEmptyString( '' );\n* // returns true\n*\n* bool = isEmptyString( new String( '' ) );\n* // returns false\n*/\n// MODULES //\n\nvar setReadOnly = require('@stdlib/utils/define-nonenumerable-read-only-property');\n\nvar isEmptyString = require('./main.js');\n\nvar isPrimitive = require('./primitive.js');\n\nvar isObject = require('./object.js'); // MAIN //\n\n\nsetReadOnly(isEmptyString, 'isPrimitive', isPrimitive);\nsetReadOnly(isEmptyString, 'isObject', isObject); // EXPORTS //\n\nmodule.exports = isEmptyString;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar isPrimitive = require('./primitive.js');\n\nvar isObject = require('./object.js'); // MAIN //\n\n/**\n* Tests if a value is an empty string.\n*\n* @param {*} value - value to test\n* @returns {boolean} boolean indicating whether value is an empty string\n*\n* @example\n* var bool = isEmptyString( '' );\n* // returns true\n*\n* @example\n* var bool = isEmptyString( 'beep' );\n* // returns false\n*\n* @example\n* var bool = isEmptyString( [] );\n* // returns false\n*/\n\n\nfunction isEmptyString(value) {\n  return isPrimitive(value) || isObject(value);\n} // EXPORTS //\n\n\nmodule.exports = isEmptyString;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar isString = require('@stdlib/assert/is-string').isObject; // MAIN //\n\n/**\n* Tests if a value is an empty string object.\n*\n* @param {*} value - value to test\n* @returns {boolean} boolean indicating whether value is an empty string object\n*\n* @example\n* var bool = isEmptyString( '' );\n* // returns false\n*\n* @example\n* var bool = isEmptyString( new String( '' ) );\n* // returns true\n*\n* @example\n* var bool = isEmptyString( [] );\n* // returns false\n*/\n\n\nfunction isEmptyString(value) {\n  return isString(value) && value.valueOf() === '';\n} // EXPORTS //\n\n\nmodule.exports = isEmptyString;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MAIN //\n\n/**\n* Tests if a value is an empty string primitive.\n*\n* @param {*} value - value to test\n* @returns {boolean} boolean indicating whether value is an empty string primitive\n*\n* @example\n* var bool = isEmptyString( '' );\n* // returns true\n*\n* @example\n* var bool = isEmptyString( 'beep' );\n* // returns false\n*\n* @example\n* var bool = isEmptyString( [] );\n* // returns false\n*/\n\nfunction isEmptyString(value) {\n  return value === '';\n} // EXPORTS //\n\n\nmodule.exports = isEmptyString;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict';\n/**\n* Tokenize a string.\n*\n* @module @stdlib/nlp/tokenize\n*\n* @example\n* var tokenize = require( '@stdlib/nlp/tokenize' );\n*\n* var str = 'Hello Mrs. Maple, could you call me back?';\n* var out = tokenize( str );\n* // returns [ 'Hello', 'Mrs.', 'Maple', ',', 'could', 'you', 'call', 'me', 'back', '?' ]\n*\n* str = 'Hello World!';\n* out = tokenize( str );\n* // returns [ 'Hello', 'World', '!' ]\n*/\n// MODULES //\n\nvar tokenize = require('./tokenize.js'); // EXPORTS //\n\n\nmodule.exports = tokenize;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar isBoolean = require('@stdlib/assert/is-boolean').isPrimitive;\n\nvar isString = require('@stdlib/assert/is-string').isPrimitive;\n\nvar hasOwnProp = require('@stdlib/assert/has-own-property');\n\nvar ABBRS = require('./abbreviations.json');\n\nvar EMOJIS = require('./emojis.json');\n\nvar CONTRACT = require('./contractions.json'); // VARIABLES //\n\n\nvar REGEXP_PREFIXES = /^([,([{*<\"'`.])/gi;\nvar REGEXP_SUFFIXES = /([,.!?%*>:;\"'`)\\]}])$/gi; // FUNCTIONS //\n\n/**\n* Extends an array by the elements of another array.\n*\n* @private\n* @param {Array} arr - input array\n* @param {Array} ext - array to extend `arr` with\n* @returns {Array} mutated input array\n*\n* @example\n* var arr = [ 1, 2, 3 ];\n* var out = extend( arr, [ 4, 5 ] );\n* // returns [ 1, 2, 3, 4, 5 ]\n*/\n\nfunction extend(arr, ext) {\n  var i;\n\n  for (i = 0; i < ext.length; i++) {\n    arr.push(ext[i]);\n  }\n\n  return arr;\n}\n/**\n* Tokenizes a substring.\n*\n* @private\n* @param {string} substr - input string\n* @returns {Array} token array\n*\n* @example\n* var str = '(never)';\n* var out = tokenizeSubstring( str );\n* // returns [ '(', 'never', ')' ]\n*/\n\n\nfunction tokenizeSubstring(substr) {\n  var prefixes = [];\n  var suffixes = [];\n  var match;\n  var done;\n  var res;\n\n  do {\n    if (!EMOJIS[substr] && !ABBRS[substr] && !CONTRACT[substr]) {\n      match = substr.split(REGEXP_PREFIXES);\n\n      if (match.length > 1) {\n        prefixes.push(match[1]);\n        substr = match[2];\n      } else {\n        match = substr.split(REGEXP_SUFFIXES);\n\n        if (match.length > 1) {\n          substr = match[0];\n          suffixes.push(match[1]);\n        } else {\n          done = true;\n        }\n      }\n    } else {\n      done = true;\n    }\n  } while (!done);\n\n  res = prefixes;\n  res.push(substr);\n  extend(res, suffixes);\n  return res;\n} // MAIN //\n\n/**\n* Tokenize a string.\n*\n* @param {string} str - input string\n* @param {boolean} [keepWhitespace=false] - boolean indicating whether whitespace characters should be returned as part of the token array\n* @throws {TypeError} first argument must be a string primitive\n* @throws {TypeError} second argument must be a boolean primitive\n* @returns {Array} array of tokens\n*\n* @example\n* var str = 'Hello World!';\n* var out = tokenize( str );\n* // returns [ 'Hello', 'World', '!' ]\n*\n* @example\n* var str = '';\n* var out = tokenize( str );\n* // returns []\n*\n* @example\n* var str = 'Hello Mrs. Maple, could you call me back?';\n* var out = tokenize( str );\n* // returns [ 'Hello', 'Mrs.', 'Maple', ',', 'could', 'you', 'call', 'me', 'back', '?' ]\n*/\n\n\nfunction tokenize(str, keepWhitespace) {\n  var subtkns;\n  var substrs;\n  var tokens;\n  var substr;\n  var cache;\n  var i;\n\n  if (!isString(str)) {\n    throw new TypeError('invalid argument. First argument must be a string primitive. Value: `' + str + '`.');\n  }\n\n  if (arguments.length > 1) {\n    if (!isBoolean(keepWhitespace)) {\n      throw new TypeError('invalid argument. Second argument must be a boolean primitive. Value: `' + keepWhitespace + '`.');\n    }\n  }\n\n  if (!str) {\n    return [];\n  } // Split on whitespace:\n\n\n  if (keepWhitespace) {\n    substrs = str.split(/(\\s+)/);\n  } else {\n    substrs = str.split(/\\s+/);\n  } // Set up cache to hold tokens for substring matches:\n\n\n  cache = {}; // Initialize token array:\n\n  tokens = [];\n\n  for (i = 0; i < substrs.length; i++) {\n    substr = substrs[i];\n\n    if (hasOwnProp(cache, substr)) {\n      extend(tokens, cache[substr]);\n    } else {\n      subtkns = tokenizeSubstring(substr);\n      extend(tokens, subtkns);\n      cache[substr] = subtkns;\n    }\n  }\n\n  return tokens;\n} // EXPORTS //\n\n\nmodule.exports = tokenize;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict';\n/**\n* Remove the last character of a string.\n*\n* @module @stdlib/string/remove-last\n*\n* @example\n* var removeLast = require( '@stdlib/string/remove-last' );\n*\n* var out = removeLast( 'last man standing' );\n* // returns 'last man standin'\n*\n* out = removeLast( 'Hidden Treasures' );\n* // returns 'Hidden Treasure';\n*/\n// MODULES //\n\nvar removeLast = require('./remove_last.js'); // EXPORTS //\n\n\nmodule.exports = removeLast;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar isString = require('@stdlib/assert/is-string').isPrimitive; // MAIN //\n\n/**\n* Removes the last character of a string.\n*\n* @param {string} str - input string\n* @throws {TypeError} must provide a string primitive\n* @returns {string} updated string\n*\n* @example\n* var out = removeLast( 'last man standing' );\n* // returns 'last man standin'\n*\n* @example\n* var out = removeLast( 'presidential election' );\n* // returns 'presidential electio'\n*\n* @example\n* var out = removeLast( 'javaScript' );\n* // returns 'javaScrip'\n*\n* @example\n* var out = removeLast( 'Hidden Treasures' );\n* // returns 'Hidden Treasure'\n*/\n\n\nfunction removeLast(str) {\n  if (!isString(str)) {\n    throw new TypeError('invalid argument. First argument must be a string primitive. Value: `' + str + '`.');\n  }\n\n  if (str === '') {\n    return '';\n  }\n\n  return str.substring(0, str.length - 1);\n} // EXPORTS //\n\n\nmodule.exports = removeLast;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict';\n/**\n* Uncapitalize the first character of a string.\n*\n* @module @stdlib/string/uncapitalize\n*\n* @example\n* var uncapitalize = require( '@stdlib/string/uncapitalize' );\n*\n* var out = uncapitalize( 'Last man standing' );\n* // returns 'last man standing'\n*\n* out = uncapitalize( 'Hidden Treasures' );\n* // returns 'hidden Treasures';\n*/\n// MODULES //\n\nvar uncapitalize = require('./uncapitalize.js'); // EXPORTS //\n\n\nmodule.exports = uncapitalize;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar isString = require('@stdlib/assert/is-string').isPrimitive; // MAIN //\n\n/**\n* Uncapitalizes the first character of a string.\n*\n* @param {string} str - input string\n* @throws {TypeError} must provide a string primitive\n* @returns {string} input string with first character converted to lowercase\n*\n* @example\n* var out = uncapitalize( 'Last man standing' );\n* // returns 'last man standing'\n*\n* @example\n* var out = uncapitalize( 'Presidential election' );\n* // returns 'presidential election'\n*\n* @example\n* var out = uncapitalize( 'JavaScript' );\n* // returns 'javaScript'\n*\n* @example\n* var out = uncapitalize( 'Hidden Treasures' );\n* // returns 'hidden Treasures'\n*/\n\n\nfunction uncapitalize(str) {\n  if (!isString(str)) {\n    throw new TypeError('invalid argument. First argument must be a string primitive. Value: `' + str + '`.');\n  }\n\n  if (str === '') {\n    return '';\n  }\n\n  return str.charAt(0).toLowerCase() + str.slice(1);\n} // EXPORTS //\n\n\nmodule.exports = uncapitalize;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict';\n/**\n* Generate a frequency table.\n*\n* @module @stdlib/utils/tabulate\n*\n* @example\n* var tabulate = require( '@stdlib/utils/tabulate' );\n*\n* var arr = [ 'beep', 'boop', 'foo', 'beep' ];\n*\n* var out = tabulate( arr );\n* // returns [ [ 'beep', 2, 0.5 ], [ 'boop', 1, 0.25 ], [ 'foo', 1, 0.25 ] ]\n*/\n// MODULES //\n\nvar tabulate = require('./tabulate.js'); // EXPORTS //\n\n\nmodule.exports = tabulate;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar isCollection = require('@stdlib/assert/is-collection');\n\nvar indexOf = require('@stdlib/utils/index-of'); // MAIN //\n\n/**\n* Generates a frequency table.\n*\n* ## Notes\n*\n* -   The output is an array of arrays. Each sub-array corresponds to a unique value in the input collection and is structured as follows:\n*\n*     -   0: unique value\n*     -   1: value count\n*     -   2: frequency percentage\n*\n*\n* @param {Collection} collection - input collection\n* @throws {TypeError} first argument must be a collection\n* @returns {(Array<Array>|Array)} frequency table\n*\n* @example\n* var arr = [ 'beep', 'boop', 'foo', 'beep' ];\n*\n* var out = tabulate( arr );\n* // returns [ [ 'beep', 2, 0.5 ], [ 'boop', 1, 0.25 ], [ 'foo', 1, 0.25 ] ]\n*/\n\n\nfunction tabulate(collection) {\n  var count;\n  var tmp;\n  var len;\n  var out;\n  var v;\n  var i;\n  var j;\n\n  if (!isCollection(collection)) {\n    throw new TypeError('invalid argument. First argument must be a collection. Value: `' + collection + '`.');\n  }\n\n  count = 0;\n  tmp = [];\n  out = []; // For each collection element, determine if we've seen the element before. If not, cache a reference which points to its location in the output array; otherwise, update the running count.\n\n  len = collection.length;\n\n  for (i = 0; i < len; i++) {\n    v = collection[i];\n    count += 1;\n    j = indexOf(tmp, v);\n\n    if (j === -1) {\n      tmp.push(v);\n      out.push([v, 1, 0]);\n    } else {\n      out[j][1] += 1;\n    }\n  } // Compute percentages...\n\n\n  len = out.length;\n\n  for (i = 0; i < len; i++) {\n    out[i][2] = out[i][1] / count;\n  }\n\n  return out;\n} // EXPORTS //\n\n\nmodule.exports = tabulate;","\"use strict\";\n\nvar hasProps = function hasProps(jsx) {\n  return Object.prototype.hasOwnProperty.call(jsx, 'props');\n};\n\nvar reduceJsxToString = function reduceJsxToString(previous, current) {\n  return previous + innerText(current);\n};\n\nvar innerText = function innerText(jsx) {\n  if (jsx === null || typeof jsx === 'boolean' || typeof jsx === 'undefined') {\n    return '';\n  }\n\n  if (typeof jsx === 'number') {\n    return jsx.toString();\n  }\n\n  if (typeof jsx === 'string') {\n    return jsx;\n  }\n\n  if (Array.isArray(jsx)) {\n    return jsx.reduce(reduceJsxToString, '');\n  }\n\n  if (hasProps(jsx) && Object.prototype.hasOwnProperty.call(jsx.props, 'children')) {\n    return innerText(jsx.props.children);\n  }\n\n  return '';\n};\n\ninnerText.default = innerText;\nmodule.exports = innerText;"],"sourceRoot":""}