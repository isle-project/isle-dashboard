"use strict";(self.webpackChunkisle_dashboard=self.webpackChunkisle_dashboard||[]).push([[6634],{80635:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(45254),prop_types__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(45697),prop_types__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_9__),react_i18next__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(81468),react_bootstrap_Alert__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(24032),react_bootstrap_Alert__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(react_bootstrap_Alert__WEBPACK_IMPORTED_MODULE_7__),react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(30276),react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_8__),_stdlib_assert_is_array__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(76266),_stdlib_assert_is_array__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_stdlib_assert_is_array__WEBPACK_IMPORTED_MODULE_1__),_isle_project_components_plotly__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1846),_isle_project_components_tooltip__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(77287),_isle_project_components_models_decision_tree_tree_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(55139),_isle_project_utils_prop_check__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(25048),_isle_project_utils_factor_variable__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(93199),__defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__spreadValues=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a},__publicField=(obj,key,value)=>(__defNormalProp(obj,typeof key!="symbol"?key+"":key,value),value);let COUNTER=0;const fitModel=({y,x,type,nTrees,nTry,impurityMeasure,data,quantitative,scoreThreshold,maxTreeDepth,minItemsCount})=>{try{let predictors;_stdlib_assert_is_array__WEBPACK_IMPORTED_MODULE_1___default()(x)?predictors=x:predictors=[x];let forest;type==="Classification"&&(forest=new _isle_project_components_models_decision_tree_tree_js__WEBPACK_IMPORTED_MODULE_4__.OI({response:y,predictors,data,quantitative,criterion:impurityMeasure,nTrees,nTry,scoreThreshold,maxTreeDepth,minItemsCount}));const importances=[];for(let i=0;i<predictors.length;i++){const attr=predictors[i];importances.push(forest.importances[attr])}return{forest,predictors,importances}}catch(_){return{}}};class RandomForest extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),__publicField(this,"handlePredict",()=>{this.props.onPredict(this.state.forest,COUNTER)}),COUNTER+=1;const{y,x,type,nTrees,nTry,impurityMeasure,data,quantitative,scoreThreshold,maxTreeDepth,minItemsCount}=props;this.state=__spreadValues(__spreadValues({},fitModel({y,x,type,nTrees,nTry,impurityMeasure,data,quantitative,scoreThreshold,maxTreeDepth,minItemsCount})),props)}static getDerivedStateFromProps(nextProps,prevState){if(nextProps.y!==prevState.y||nextProps.x!==prevState.x||nextProps.type!==prevState.type||nextProps.nTrees!==prevState.nTrees||nextProps.nTry!==prevState.nTry||nextProps.impurityMeasure!==prevState.impurityMeasure||nextProps.data!==prevState.data||nextProps.quantitative!==prevState.quantitative||nextProps.scoreThreshold!==prevState.scoreThreshold||nextProps.maxTreeDepth!==prevState.maxTreeDepth||nextProps.minItemsCount!==prevState.minItemsCount){const{y,x,type,nTrees,nTry,impurityMeasure,data,quantitative,scoreThreshold,maxTreeDepth,minItemsCount}=nextProps;return __spreadValues(__spreadValues({},fitModel({y,x,type,nTrees,nTry,impurityMeasure,data,quantitative,scoreThreshold,maxTreeDepth,minItemsCount})),nextProps)}return null}render(){const{forest}=this.state,{t}=this.props;return forest?react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{style:{overflowX:"auto",width:"100%"}},react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",{className:"title"},t("random-forest-for",{y:this.props.y,counter:COUNTER})),react__WEBPACK_IMPORTED_MODULE_0__.createElement("p",null,t("created-from-trees",{nTrees:this.props.nTrees,nTry:this.props.nTry})),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_isle_project_components_plotly__WEBPACK_IMPORTED_MODULE_2__.Z,{editable:!0,data:[{type:"bar",x:this.state.predictors,y:this.state.importances}],layout:{xaxis:{title:t("variable")},yaxis:{title:t("importance")}}}),this.props.onPredict?react__WEBPACK_IMPORTED_MODULE_0__.createElement(_isle_project_components_tooltip__WEBPACK_IMPORTED_MODULE_3__.Z,{tooltip:t("predictions-attached")},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_8___default(),{variant:"secondary",size:"sm",style:{marginTop:10},onClick:this.handlePredict},this.props.t("use-model-to-predict"))):null):react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_bootstrap_Alert__WEBPACK_IMPORTED_MODULE_7___default(),{variant:"danger"},t("missing-attributes"))}}RandomForest.defaultProps={type:"Classification",nTrees:50,nTry:1,impurityMeasure:"gini",scoreThreshold:.01,maxTreeDepth:20,minItemsCount:50,onPredict:null},RandomForest.propTypes={data:prop_types__WEBPACK_IMPORTED_MODULE_9___default().object.isRequired,y:prop_types__WEBPACK_IMPORTED_MODULE_9___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_9___default().string,prop_types__WEBPACK_IMPORTED_MODULE_9___default().instanceOf(_isle_project_utils_factor_variable__WEBPACK_IMPORTED_MODULE_6__.E)]).isRequired,x:prop_types__WEBPACK_IMPORTED_MODULE_9___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_9___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_9___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_9___default().string,prop_types__WEBPACK_IMPORTED_MODULE_9___default().instanceOf(_isle_project_utils_factor_variable__WEBPACK_IMPORTED_MODULE_6__.E)])),prop_types__WEBPACK_IMPORTED_MODULE_9___default().string,prop_types__WEBPACK_IMPORTED_MODULE_9___default().instanceOf(_isle_project_utils_factor_variable__WEBPACK_IMPORTED_MODULE_6__.E)]).isRequired,type:prop_types__WEBPACK_IMPORTED_MODULE_9___default().oneOf(["Classification","Regression"]),quantitative:prop_types__WEBPACK_IMPORTED_MODULE_9___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_9___default().string).isRequired,nTrees:prop_types__WEBPACK_IMPORTED_MODULE_9___default().number,nTry:prop_types__WEBPACK_IMPORTED_MODULE_9___default().number,impurityMeasure:prop_types__WEBPACK_IMPORTED_MODULE_9___default().oneOf(["gini","entropy"]),scoreThreshold:prop_types__WEBPACK_IMPORTED_MODULE_9___default().number,maxTreeDepth:prop_types__WEBPACK_IMPORTED_MODULE_9___default().number,minItemsCount:prop_types__WEBPACK_IMPORTED_MODULE_9___default().number,onPredict:prop_types__WEBPACK_IMPORTED_MODULE_9___default().func},__webpack_exports__.default=(0,react_i18next__WEBPACK_IMPORTED_MODULE_10__.Zh)("models")((0,_isle_project_utils_prop_check__WEBPACK_IMPORTED_MODULE_5__.W)(RandomForest))}}]);

//# sourceMappingURL=RandomForest.37192f00.chunk.js.map