(self.webpackChunkisle_dashboard=self.webpackChunkisle_dashboard||[]).push([[72786],{96128:function(e,t,a){"use strict";a.d(t,{fH:function(){return v},Zl:function(){return Z}});var n=a(87757),s=a.n(n),r=a(92137),l=a(41488),i=a(86072),o=a.n(i),c=a(87284),m=a(24833),u=a.n(m),d=a(4135),p=a(41985),h=a(33357);function f(e){return{type:h.eu,payload:{badges:e}}}var g=function(){var e=(0,r.Z)(s().mark((function e(t){var a,n,r,i,m,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o().get(d.ZP+"/get_user_badges");case 3:if(a=e.sent,n=a.data,r=n.badges,i=n.addedBadges,t(f(r)),i.length>0)for(m=0;m<r.length;m++)h=r[m],u()(i,h.name)&&(0,p.wN)(t,(g=void 0,v=void 0,E=void 0,Z=void 0,g=(s=h).name,v=s.description,E=s.picture,Z=d.ZP+"/badges/"+E,{children:l.createElement("div",null,l.createElement("h3",null,c.Z.t("common:received-badge"),g),l.createElement("div",null,l.createElement("div",null,l.createElement("div",{className:"received-badge-before"}),l.createElement("img",{className:"received-badge",src:Z,alt:"Received Badge"})),l.createElement("p",{style:{marginTop:15}},c.Z.t("common:received-badge-for"),l.createElement("b",null,v)))),level:"info",position:"tc",dismissible:"button",autoDismiss:0}));e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,p.EG)(t,e.t0);case 12:case"end":return e.stop()}var s,g,v,E,Z}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),v=function(e){return(0,r.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g(e);case 2:case"end":return t.stop()}}),t)})))},E=function(){var e=(0,r.Z)(s().mark((function e(t){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o().get(d.ZP+"/get_available_badges");case 3:a=e.sent,t((n=a.data,{type:h.Z9,payload:{badges:n}})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),(0,p.EG)(t,e.t0);case 10:case"end":return e.stop()}var n}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),Z=function(e){return(0,r.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E(e);case 2:case"end":return t.stop()}}),t)})))}},70384:function(e,t,a){"use strict";a.d(t,{Z:function(){return k}});var n=a(6610),s=a(5991),r=a(63349),l=a(10379),i=a(60446),o=a(96156),c=a(41488),m=a(25472),u=a(70048),d=a(93391),p=a(47701),h=a(29619),f=a(54012),g=a(75018),v=a(73230),E=a(4135),Z=function(e){(0,l.Z)(a,e);var t=(0,i.Z)(a);function a(e){var s;return(0,n.Z)(this,a),s=t.call(this,e),(0,o.Z)((0,r.Z)(s),"handleResponseChange",(function(e){s.setState({response:e.target.value})})),(0,o.Z)((0,r.Z)(s),"handleResponseSubmit",(function(){s.props.submitTicketMessage({message:s.state.response,ticketID:s.props.ticket._id}),s.setState({response:""})})),(0,o.Z)((0,r.Z)(s),"toggleCompletion",(function(){s.props.ticket.done?s.props.openTicket(s.props.ticket._id):s.props.closeTicket(s.props.ticket._id)})),(0,o.Z)((0,r.Z)(s),"renderMessage",(function(e,t){var a=s.props.t,n=new Date(e.createdAt);return c.createElement("div",{className:"message-container",key:t},c.createElement("div",{className:"message-data"},c.createElement("div",{className:"message-profile-pic"},c.createElement("img",{src:"".concat(E.ZP,"/thumbnail/").concat(e.picture),alt:"User Profile Pic"})),c.createElement("div",{className:"message-author-line"},c.createElement("span",{className:"message-author"},e.author),"\xa0",a("common:wrote-on",{date:"".concat(n.toLocaleTimeString()," ").concat(n.toLocaleDateString())}))),c.createElement("div",{className:"message-body"},e.body))})),s.state={response:""},s}return(0,s.Z)(a,[{key:"render",value:function(){var e,t=this.props.t,a=this.props.ticket;return c.createElement(c.Fragment,null,c.createElement(h.Z,{show:this.props.show,onHide:this.props.onHide,dialogClassName:"modal-60w"},c.createElement(h.Z.Header,null,c.createElement(h.Z.Title,{as:"h3",style:{width:"100%"}},t("common:title"),": ",a.title,c.createElement(d.Z,{placement:"right",overlay:(e=t("close-ticket-modal"),c.createElement(p.Z,{id:"tooltip"},e))},c.createElement(u.Z,{onClick:this.props.onHide,style:{float:"right"},variant:"outline-secondary","aria-label":t("close-ticket-modal"),className:"modal-close"},c.createElement("span",{"aria-hidden":"true"},"x"))))),c.createElement(h.Z.Body,{style:{height:"60vh",overflowY:"auto"}},c.createElement("span",{className:"title"},t("common:description"),":"),c.createElement("p",{style:{whiteSpace:"pre-wrap"}},a.description),c.createElement("hr",null),a.namespace.title?c.createElement(c.Fragment,null,c.createElement("span",{className:"title"},"".concat(t("common:course"),": ")),c.createElement("span",null,a.namespace.title)," | "):null,a.lesson?c.createElement(c.Fragment,null,c.createElement("span",{className:"title"},"".concat(t("common:lesson"),": ")),c.createElement("span",null,a.lesson.title)," | "):null,a.component?c.createElement(c.Fragment,null,c.createElement("span",{className:"title"},"".concat(t("common:component"),": ")),c.createElement("span",null,a.component)):null,a.attachments.length>0?c.createElement(c.Fragment,null,c.createElement("br",null),c.createElement("span",{className:"title"},"".concat(t("common:attachments"),": ")),a.attachments.map((function(e,t){return c.createElement("a",{href:"".concat(E.ZP,"/attachments/").concat(e.filename),key:t,style:{marginLeft:6},target:"_blank",rel:"noopener noreferrer"},c.createElement("i",{className:"fas fa-link",style:{marginRight:2}}),e.title)}))):null,c.createElement("br",null),c.createElement("hr",null),c.createElement("span",{className:"title"},t("common:messages"),":"),a.messages.map(this.renderMessage),c.createElement("hr",null)),c.createElement(h.Z.Footer,{style:{background:"ghostwhite"}},c.createElement(v.Z,{controlId:"form-text",style:{width:"calc(100% - 200px)"}},c.createElement(f.Z,null,t("enter-response")),c.createElement(g.Z,{name:"body",type:"text",as:"textarea",rows:"5",value:this.state.response,placeholder:a.done?t("require-open-ticket"):t("response-comes-here"),onChange:this.handleResponseChange,disabled:a.done})),c.createElement("div",{style:{float:"right",width:"180px"}},c.createElement(u.Z,{block:!0,onClick:this.handleResponseSubmit,disabled:!this.state.response||a.done},t("submit-response")),c.createElement(u.Z,{block:!0,onClick:this.toggleCompletion},a.done?t("common:open-ticket"):t("common:close-ticket")),c.createElement(u.Z,{block:!0,onClick:this.props.onHide},t("common:hide"))))))}}]),a}(c.Component);Z.defaultProps={};var k=(0,m.Z)(["ticket_modal","common"])(Z)},72786:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Ue}});var n=a(41488),s=a(9251),r=a(6610),l=a(5991),i=a(63349),o=a(10379),c=a(60446),m=a(96156),u=a(25472),d=a(41074),p=a.n(d),h=a(70048),f=a(29530),g=a(22529),v=a(63002),E=a(93391),Z=a(47701),k=a(66731),y=a.n(k),b=a(10322),w=a.n(b),T=a(37263),N=a.n(T),C=a(68487),S=a.n(C),x=a(75033),M=a(31835),P=a(4135),F=a(28991),I=a(89308),D=a(52785),H=a(23596),L=a(72945),R=a(54012),A=a(75018),_=a(73230),B=a(36659),U=a(29619),z=a(67775),Q=a.n(z),q=a(10077),K=a.n(q),O=a(87757),G=a.n(O),V=a(92137),j=function(e){(0,o.Z)(a,e);var t=(0,c.Z)(a);function a(e){var s;return(0,r.Z)(this,a),s=t.call(this,e),(0,m.Z)((0,i.Z)(s),"requestTfaQRCode",(0,V.Z)(G().mark((function e(){var t;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.props.getTfaQRCode();case 2:(t=e.sent)&&s.setState({tfaQRCode:{__html:t.data}});case 4:case"end":return e.stop()}}),e)})))),(0,m.Z)((0,i.Z)(s),"enableTfa",(function(){s.props.enableTFA(s.state.token)})),(0,m.Z)((0,i.Z)(s),"disableTfa",(function(){s.props.disableTFA()})),(0,m.Z)((0,i.Z)(s),"renderQRCode",(function(){if(!s.state.tfaQRCode)return null;var e=s.props.t;return n.createElement(n.Fragment,null,n.createElement("div",{dangerouslySetInnerHTML:s.state.tfaQRCode}),n.createElement("p",null,e("tfa-enable-instructions")),n.createElement(H.Z,null,n.createElement(L.Z,{sm:8},n.createElement(A.Z,{autoFocus:!0,type:"text",onChange:function(e){s.setState({token:e.target.value})}})),n.createElement(L.Z,{sm:3},n.createElement(h.Z,{onClick:s.enableTfa,disabled:6!==s.state.token.length},e("common:confirm")))))})),s.state={token:""},s}return(0,l.Z)(a,[{key:"render",value:function(){var e=this.props.t;return this.props.user.twoFactorAuth?n.createElement(f.Z,{bg:"light",border:"success"},n.createElement(f.Z.Header,null,e("two-factor-authentication")),n.createElement(f.Z.Body,null,n.createElement("p",null,e("two-factor-authentication-is-enabled")),n.createElement(h.Z,{variant:"warning",style:{float:"right",marginRight:5},onClick:this.disableTfa},e("common:disable")))):n.createElement(f.Z,{bg:"light"},n.createElement(f.Z.Header,null,n.createElement("span",{className:"title"},e("common:two-factor-authentication"))),n.createElement(f.Z.Body,null,n.createElement("p",null,e("two-factor-authentication-is-disabled")),n.createElement(h.Z,{variant:"success",style:{float:"right",marginRight:5},onClick:this.requestTfaQRCode},n.createElement("i",{className:"fas fa-qrcode",style:{marginRight:10}}),e("common:enable")),this.renderQRCode()))}}]),a}(n.Component);j.defaultProps={};var $=j,J=function(e){(0,o.Z)(a,e);var t=(0,c.Z)(a);function a(e){var n;return(0,r.Z)(this,a),n=t.call(this,e),(0,m.Z)((0,i.Z)(n),"handleInputChange",(function(e){n.setState({token:e.target.value})})),(0,m.Z)((0,i.Z)(n),"handleSubmit",(0,V.Z)(G().mark((function e(){return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.authenticate({writeAccessToken:n.state.token});case 2:e.sent&&n.props.onHide();case 4:case"end":return e.stop()}}),e)})))),n.state={token:null},n}return(0,l.Z)(a,[{key:"render",value:function(){return n.createElement(U.Z,{onHide:this.props.onHide,show:this.props.show},n.createElement(U.Z.Header,{closeButton:!0},n.createElement(U.Z.Title,{as:"h3"},"Enter Access Token")),n.createElement(U.Z.Body,null,n.createElement("div",null,"Please enter the write-access token that was sent to you. If you have not received it yet, please get in touch with ",n.createElement("a",{href:"mailto:pgb@andrew.cmu.edu"},"Philipp Burckhardt"),"."),n.createElement("br",null),n.createElement(B.Z,null,n.createElement(E.Z,{placement:"right",overlay:n.createElement(Z.Z,{id:"ownerTooltip"},"Please enter the access token.")},n.createElement(_.Z,null,n.createElement(H.Z,null,n.createElement(L.Z,{sm:2},n.createElement(R.Z,null,"Token")),n.createElement(L.Z,{sm:10},n.createElement(A.Z,{name:"title",type:"text",placeholder:"Enter token",onChange:this.handleInputChange}))))))),n.createElement(U.Z.Footer,null,n.createElement(h.Z,{onClick:this.handleSubmit,disabled:!this.state.token},"Submit")))}}]),a}(n.Component),W=function(e){return n.createElement(Z.Z,{id:"tooltip"},e)},Y=K()("isle-dashboard"),X=function(e){(0,o.Z)(a,e);var t=(0,c.Z)(a);function a(e){var n;return(0,r.Z)(this,a),n=t.call(this,e),(0,m.Z)((0,i.Z)(n),"handleUpdate",(function(){var e=n.state,t=e.name,a=e.password,s=e.passwordRepeat,r=e.organization,l=e.customFields,i={name:t,organization:r},o=!1;a&&s===a&&(o=!0,i.password=a),t===n.props.user.name&&r===n.props.user.organization||(o=!0),Q()(l)||(i.customFields=l,o=!0),o&&(Y("Update user..."),n.props.updateUser(i),n.props.onHide())})),(0,m.Z)((0,i.Z)(n),"handleInputChange",(function(e){var t,a=e.target,s=a.value,r=a.name;n.setState((t={},(0,m.Z)(t,r,s),(0,m.Z)(t,"changed",!0),t))})),(0,m.Z)((0,i.Z)(n),"getNameValidationState",(function(){var e=n.state.name;return!!(e&&e.length>3)})),(0,m.Z)((0,i.Z)(n),"getPasswordValidationState",(function(){var e=n.state,t=e.password,a=e.passwordRepeat;return!(t.length<6||0===a.length)&&t===a})),(0,m.Z)((0,i.Z)(n),"toggleTokenModal",(function(){n.setState({showTokenModal:!n.state.showTokenModal})})),n.state={email:e.user.email,name:e.user.name,organization:e.user.organization,password:"",passwordRepeat:"",changed:!1,showTokenModal:!1,customFields:e.user.customFields||{}},n}return(0,l.Z)(a,[{key:"renderInstructorButton",value:function(){if(this.props.user.writeAccess)return null;var e=this.props.t;return n.createElement(h.Z,{onClick:this.toggleTokenModal,variant:"outline-success",style:{float:"right",marginRight:5}},e("get-instructor-access"))}},{key:"render",value:function(){var e=this,t=this.getPasswordValidationState(),a=this.getNameValidationState(),s=this.state.password||this.state.passwordRepeat,r=this.props.user,l=this.props.t,i=this.state.customFields,o=r.availableCustomFields||[];return n.createElement(n.Fragment,null,n.createElement(U.Z,{show:this.props.show,onHide:this.props.onHide,dialogClassName:"edit-modal"},n.createElement(U.Z.Header,null,n.createElement(U.Z.Title,{as:"h3",style:{width:"100%"}},l("profile"),n.createElement(E.Z,{placement:"right",overlay:W(l("close-edit-modal"))},n.createElement(h.Z,{onClick:this.props.onHide,style:{float:"right"},variant:"outline-secondary","aria-label":l("close-edit-modal"),className:"modal-close"},n.createElement("span",{"aria-hidden":"true"},"x"))),this.renderInstructorButton())),n.createElement(U.Z.Body,null,n.createElement(B.Z,{as:H.Z},n.createElement(L.Z,{sm:6},n.createElement(_.Z,{controlId:"form-email"},n.createElement(R.Z,{style:{width:"100%"}},l("common:email"),r.verifiedEmail?null:n.createElement(D.Z,{variant:"danger",style:{float:"right"}},l("common:email-not-verified"),n.createElement(E.Z,{placement:"right",overlay:W(l("resend-confirm-email"))},n.createElement(h.Z,{size:"sm",variant:"outline-light",onClick:this.props.resendConfirmEmail,style:{fontSize:12,marginLeft:6}},n.createElement("i",{className:"fas fa-redo-alt"}))))),n.createElement(A.Z,{name:"email",type:"email",value:this.state.email,disabled:!0})),n.createElement(E.Z,{placement:"right",overlay:W(l("update-name"))},n.createElement(_.Z,{controlId:"form-name"},n.createElement(R.Z,null,l("common:name")),n.createElement(A.Z,{name:"name",type:"text",value:this.state.name,onChange:this.handleInputChange,isInvalid:!a}),n.createElement(B.Z.Control.Feedback,{type:"invalid"},l("invalid-name")))),n.createElement(E.Z,{placement:"right",overlay:W(l("update-organization"))},n.createElement(_.Z,{controlId:"form-organization"},n.createElement(R.Z,null,l("common:organization")),n.createElement(A.Z,{name:"organization",type:"text",value:this.state.organization,onChange:this.handleInputChange}))),o.filter((function(e){return e.showOnProfile||e.editableOnProfile})).map((function(t,a){var s,r=i[t.name];return s="checkbox"===t.type?n.createElement(B.Z.Check,{type:"checkbox",label:t.name,defaultChecked:r,disabled:!t.editableOnProfile,onChange:function(a){var n=(0,F.Z)({},e.state.customFields);n[t.name]=a.target.checked,e.setState({customFields:n,changed:!0})}}):"text"===t.type?n.createElement(_.Z,{controlId:"form-".concat(t.name)},n.createElement(R.Z,null,t.name),n.createElement(A.Z,{name:t.name,type:"text",value:r,placeholder:"Enter ".concat(t.name,"..."),disabled:!t.editableOnProfile,onChange:function(a){var n=(0,F.Z)({},e.state.customFields);n[t.name]=a.target.value,e.setState({customFields:n,changed:!0})},autoComplete:"none"})):n.createElement(_.Z,{controlId:"form-".concat(t.name)},n.createElement(R.Z,null,t.name),n.createElement(I.ZP,{defaultValue:r?{label:r,value:r}:null,disabled:!t.editableOnProfile,options:t.options.map((function(e){return{value:e,label:e}})),onChange:function(a){var n=(0,F.Z)({},e.state.customFields);n[t.name]=a.value,e.setState({customFields:n,changed:!0})}})),n.createElement(E.Z,{key:a,placement:"top",overlay:W(t.description)},s)}))),n.createElement(L.Z,{sm:6},n.createElement(E.Z,{placement:"right",overlay:W(l("enter-password"))},n.createElement(_.Z,{controlId:"form-password"},n.createElement(R.Z,null,l("common:password")),n.createElement(A.Z,{name:"password",type:"password",value:this.state.password,autoComplete:"none",placeholder:l("common:choose-new-password"),onChange:this.handleInputChange,maxLength:30,minLength:6,isInvalid:s&&!t}),n.createElement(B.Z.Control.Feedback,{type:"invalid"},"Please enter a new password with at least six characters."))),n.createElement(_.Z,{controlId:"form-repeat-password"},n.createElement(A.Z,{name:"passwordRepeat",type:"password",value:this.state.passwordRepeat,autoComplete:"none",placeholder:l("repeat-new-password"),onChange:this.handleInputChange,maxLength:30,minLength:6,isInvalid:s&&!t}),n.createElement(B.Z.Control.Feedback,{type:"invalid"},l("invalid-password"))),n.createElement("hr",null),n.createElement($,{user:this.props.user,t:this.props.t,disableTFA:this.props.disableTFA,enableTFA:this.props.enableTFA,getTfaQRCode:this.props.getTfaQRCode}))),n.createElement(H.Z,{style:{paddingTop:10}},n.createElement(h.Z,{block:!0,disabled:!this.state.changed||!a||!t&&s,onClick:this.handleUpdate},l("common:update"))))),n.createElement(J,{user:r,authenticate:this.props.authenticate,show:this.state.showTokenModal,onHide:this.toggleTokenModal}))}}]),a}(n.Component);X.defaultProps={};var ee=X,te=a(75314),ae=function(e){(0,o.Z)(a,e);var t=(0,c.Z)(a);function a(){return(0,r.Z)(this,a),t.apply(this,arguments)}return(0,l.Z)(a,[{key:"shouldComponentUpdate",value:function(e){return e.selectedNamespaceID!==this.props.selectedNamespaceID}},{key:"render",value:function(){var e=this.props,t=e.selectedNamespace,a=e.lessonData;if(!t||!a)return null;var s=t.lessons;if(!s)return null;for(var r={},l=0;l<s.length;l++){var i=s[l]._id;if(a[i]){var o=a[i].actionTypes;if(o)for(var c=y()(o),m=0;m<c.length;m++){var u=c[m];r[u]?r[u]+=o[u]:r[u]=o[u]}}}for(var d=y()(r),p=new Array(d.length),h=0;h<d.length;h++){var f=d[h],g=r[d[h]];p[h]=n.createElement("tr",{key:h},n.createElement("td",null,f),n.createElement("td",null,g))}return n.createElement(te.Z,{size:"sm",striped:!0,style:{fontSize:"0.8rem"}},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"Action Type"),n.createElement("th",null,"Count"))),n.createElement("tbody",null,p))}}]),a}(n.Component);ae.defaultProps={lessonData:null,selectedNamespace:null,selectedNamespaceID:""};var ne=ae,se=a(54544),re=a(70384),le=a(87329),ie=a(80950),oe=a.n(ie),ce=K()("isle:toolbar:ticketing"),me=function(e){return{value:e,label:e.title}},ue=function(e){(0,o.Z)(a,e);var t=(0,c.Z)(a);function a(e){var n;return(0,r.Z)(this,a),n=t.call(this,e),(0,m.Z)((0,i.Z)(n),"attachFile",(function(){var e=document.createElement("input");e.type="file",e.onchange=function(e){var t=e.target.files,a=[].concat((0,le.Z)(n.state.files),(0,le.Z)(t));n.setState({files:a})},e.click()})),(0,m.Z)((0,i.Z)(n),"handleTitleChange",(function(e){n.setState({title:e.target.value})})),(0,m.Z)((0,i.Z)(n),"handleDescriptionChange",(function(e){n.setState({description:e.target.value})})),(0,m.Z)((0,i.Z)(n),"handleCourseChange",(function(e){n.setState({selectedCourse:e})})),(0,m.Z)((0,i.Z)(n),"handleSubmit",(0,V.Z)(G().mark((function e(){return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ce("Create ticket..."),e.next=3,n.props.createTicket({title:n.state.title,description:n.state.description,platform:{name:oe().name,version:oe().version,product:oe().product,manufacturer:oe().manufacturer,os:oe().os,description:oe().description},namespace:n.state.selectedCourse.value,files:n.state.files});case 3:n.props.onHide();case 4:case"end":return e.stop()}}),e)})))),(0,m.Z)((0,i.Z)(n),"removeFileFactory",(function(e){return function(){var t=n.state.files.slice();t.splice(e,1),n.setState({files:t})}})),n.state={title:"",description:"",selectedCourse:e.enrolledNamespaces?me(e.enrolledNamespaces[0]):null,files:[]},n}return(0,l.Z)(a,[{key:"renderAttachments",value:function(){var e=this;return 0===this.state.files.length?null:n.createElement(n.Fragment,null,n.createElement("span",{className:"title"},this.props.t("attachments"),":"),n.createElement(se.Z,{className:"ticketing-attachment-list"},this.state.files.map((function(t,a){return n.createElement(se.Z.Item,{key:"file-".concat(a)},t.name,n.createElement(h.Z,{variant:"danger",size:"sm",onClick:e.removeFileFactory(a),style:{float:"right"}},"x"))}))))}},{key:"render",value:function(){var e=this.props.t;return n.createElement(U.Z,{onHide:this.props.onHide,show:this.props.show,dialogClassName:"modal-40w"},n.createElement(U.Z.Header,{closeButton:!0},n.createElement(U.Z.Title,{as:"h3"},e("new-ticket"))),n.createElement(U.Z.Body,null,n.createElement("p",null,e("ticketing-intro")),n.createElement(_.Z,null,n.createElement(R.Z,null,e("common:course"),":"),n.createElement(I.ZP,{options:this.props.enrolledNamespaces.map(me),onChange:this.handleCourseChange,value:this.state.selectedCourse})),n.createElement(_.Z,null,n.createElement(R.Z,null,e("common:title"),":"),n.createElement(A.Z,{type:"text",placeholder:e("ticket-title-placeholder"),onChange:this.handleTitleChange})),n.createElement(_.Z,{controlId:"form-text"},n.createElement(R.Z,null,e("common:description"),":"),n.createElement(A.Z,{name:"body",type:"text",as:"textarea",rows:"5",placeholder:e("ticket-description-placeholder"),value:this.state.description,onChange:this.handleDescriptionChange})),this.renderAttachments()),n.createElement(U.Z.Footer,null,n.createElement(E.Z,{placement:"left",overlay:n.createElement(Z.Z,{id:"attachmentTooltip"},e("attach-file"))},n.createElement(h.Z,{onClick:this.attachFile},n.createElement("i",{className:"fas fa-paperclip"}))),n.createElement(h.Z,{onClick:this.props.onHide},e("common:cancel")),n.createElement(h.Z,{onClick:this.handleSubmit},e("create-ticket"))))}}]),a}(n.Component);ue.defaultProps={enrolledNamespaces:[]};var de=ue,pe=/ticket=([^&]*)/,he=function(e){(0,o.Z)(s,e);var t,a=(0,c.Z)(s);function s(e){var t;return(0,r.Z)(this,s),t=a.call(this,e),(0,m.Z)((0,i.Z)(t),"toggleCreateModal",(function(){t.setState({showCreateModal:!t.state.showCreateModal})})),(0,m.Z)((0,i.Z)(t),"toggleTicketModal",(function(){t.setState({showMessagesModal:!t.state.showMessagesModal})})),(0,m.Z)((0,i.Z)(t),"toggleShowAll",(function(){t.setState({showOpen:!t.state.showOpen})})),t.state={showCreateModal:!1,showMessagesModal:!1,showOpen:!0},t}return(0,l.Z)(s,[{key:"componentDidMount",value:(t=(0,V.Z)(G().mark((function e(){var t,a,n,s;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.getUserTickets();case 2:if(!this.props.history||!this.props.history.location.search){e.next=16;break}if(!(t=pe.exec(this.props.history.location.search))||!t[1]){e.next=16;break}if(!(a=this.props.user.tickets)){e.next=16;break}n=0;case 8:if(!(n<a.length)){e.next=16;break}if((s=a[n])._id!==t[1]){e.next=13;break}return this.setState({selectedTicket:s,showMessagesModal:!0}),e.abrupt("break",16);case 13:n++,e.next=8;break;case 16:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"renderTicketList",value:function(){var e=this,t=[],a=this.props,s=a.user,r=a.t;if(!s)return null;var l=s.tickets;if(!l)return null;if(this.state.showOpen)for(var i=function(a){var s=l[a];if(!0===s.done)return"continue";t.push(n.createElement(se.Z.Item,{key:"ticket-".concat(a)},s.title,": ",s.description,n.createElement(E.Z,{placement:"bottom",overlay:n.createElement(Z.Z,{id:"ticket-status-tooltip"},r("common:close-ticket"))},n.createElement(h.Z,{variant:"outline-secondary",size:"sm",style:{float:"right",marginLeft:6},onClick:function(){e.props.closeTicket(s._id)}},n.createElement("i",{className:"far fa-square"}))),n.createElement(h.Z,{size:"sm",variant:"outline-secondary",style:{float:"right"},onClick:function(){e.setState({selectedTicket:s},e.toggleTicketModal)}},r("common:messages"),n.createElement(D.Z,{className:"ticket-badge",variant:"secondary"},s.messages.length))))},o=0;o<l.length;o++)i(o);else for(var c=function(a){var s=l[a];if(!1===s.done)return"continue";t.push(n.createElement(se.Z.Item,{key:"ticket-".concat(a)},s.title,": ",s.description,n.createElement(E.Z,{placement:"bottom",overlay:n.createElement(Z.Z,{id:"ticket-status-tooltip"},r("common:open-ticket"))},n.createElement(h.Z,{variant:"outline-secondary",size:"sm",style:{float:"right",marginLeft:6},onClick:function(){e.props.openTicket(s._id)}},n.createElement("i",{className:"far fa-check-square"}))),n.createElement(h.Z,{size:"sm",variant:"outline-secondary",style:{float:"right"},onClick:function(){e.setState({selectedTicket:s},e.toggleTicketModal)}},r("common:messages"),n.createElement(D.Z,{className:"ticket-badge",variant:"secondary"},s.messages.length))))},m=0;m<l.length;m++)c(m);return n.createElement(se.Z,null,t)}},{key:"render",value:function(){var e=this.props.t,t=this.props.user.enrolledNamespaces.filter((function(e){return e.enableTicketing}));return n.createElement(n.Fragment,null,n.createElement(U.Z,{onHide:this.props.onHide,show:this.props.show,dialogClassName:"modal-40w"},n.createElement(U.Z.Header,{closeButton:!0},n.createElement(U.Z.Title,{as:"h3"},e("my-tickets"))),n.createElement(U.Z.Body,null,this.renderTicketList()),n.createElement(U.Z.Footer,null,n.createElement(h.Z,{onClick:this.toggleShowAll},this.state.showOpen?e("show-completed-tickets"):e("show-open-tickets")),n.createElement(h.Z,{onClick:this.toggleCreateModal},e("new-ticket")),n.createElement(h.Z,{onClick:this.props.onHide},e("common:close")))),this.state.showCreateModal?n.createElement(de,{show:this.state.showCreateModal,onHide:this.toggleCreateModal,enrolledNamespaces:t,createTicket:this.props.createTicket,t:e}):null,this.state.showMessagesModal?n.createElement(re.Z,{show:this.state.showMessagesModal,onHide:this.toggleTicketModal,ticket:this.state.selectedTicket,submitTicketMessage:this.props.submitTicketMessage,closeTicket:this.props.closeTicket,openTicket:this.props.openTicket}):null)}}]),s}(n.Component),fe=a.p+"static/media/hoodie.b28478de.jpg",ge=a.p+"static/media/question.4a50b186.svg",ve=a.p+"static/media/badge_circle.d94dd9bb.svg",Ee=(a(62173),(0,M.Z)((function(){return a.e(45335).then(a.bind(a,45335))}))),Ze=(0,M.Z)((function(){return Promise.all([a.e(17491),a.e(73814),a.e(60468)]).then(a.bind(a,60468))})),ke=(0,M.Z)((function(){return Promise.all([a.e(17491),a.e(73814),a.e(52556)]).then(a.bind(a,52556))}));function ye(e,t){if(!e)return"";for(var a=0;a<e.length;a++)if(e[a]._id===t)return e[a].title;return""}var be=function(e){(0,o.Z)(a,e);var t=(0,c.Z)(a);function a(e){var n;(0,r.Z)(this,a),n=t.call(this,e),(0,m.Z)((0,i.Z)(n),"toggleEditModal",(function(){n.setState({showEditModal:!n.state.showEditModal})})),(0,m.Z)((0,i.Z)(n),"toggleTicketListModal",(function(){n.setState({showTicketListModal:!n.state.showTicketListModal})})),(0,m.Z)((0,i.Z)(n),"toggleProfilePicModal",(function(){n.setState({showProfilePicModal:!n.state.showProfilePicModal})})),(0,m.Z)((0,i.Z)(n),"handleSelect",(function(e,t){var a=t.target.title,s=t.target.dataset.id;n.setState({selectedNamespaceID:e,selectedNamespace:n.props.user.enrolledNamespaces[s]},(function(){var e=n.props.user.enrolledNamespaces[s];w()(e.lessons[0])||n.props.getLessons(a)}))})),(0,m.Z)((0,i.Z)(n),"handleStatsSelect",(function(e,t){n.setState({selectedStatsType:e})})),(0,m.Z)((0,i.Z)(n),"handleDataSelect",(function(e,t){n.setState({selectedDataType:e})})),(0,m.Z)((0,i.Z)(n),"submitTicketMessage",(function(e){var t=e.message,a=e.ticketID;n.props.sendTicketMessage({message:t,ticketID:a,user:n.props.user})}));var s=null,l=null;return e.user.enrolledNamespaces.length>0&&(l=(s=e.user.enrolledNamespaces[0])._id),n.state={showEditModal:!1,showProfilePicModal:!1,showTicketListModal:!1,selectedNamespace:s,selectedNamespaceID:l,selectedDataType:"messages",selectedStatsType:"progress"},n}return(0,l.Z)(a,[{key:"componentDidMount",value:function(){this.props.user.files||this.props.getUserFiles();var e=this.state.selectedNamespace;e&&this.props.getLessons(e.title),this.props.getUserBadges()}},{key:"renderRightPanel",value:function(){return this.state.selectedNamespace?"progress"===this.state.selectedStatsType?n.createElement(ke,{user:this.props.user,selectedNamespace:this.state.selectedNamespace}):"timeSpent"===this.state.selectedStatsType?n.createElement(Ze,{user:this.props.user,selectedNamespace:this.state.selectedNamespace}):void 0:null}},{key:"renderLeftPanel",value:function(){if(!this.state.selectedNamespace)return null;if("files"===this.state.selectedDataType)return this.renderFiles();if("actions"===this.state.selectedDataType){var e=this.props.user.lessonData;return n.createElement(ne,{lessonData:e,selectedNamespace:this.state.selectedNamespace,selectedNamespaceID:this.state.selectedNamespaceID})}return"messages"===this.state.selectedDataType?this.renderMessages():void 0}},{key:"renderFiles",value:function(){var e=this.props,t=e.t,a=e.user.files;if(a&&(a=a[this.state.selectedNamespaceID]),!N()(a))return null;for(var s=[],r=0;r<a.length;r++){var l=a[r],i=ye(this.state.selectedNamespace.lessons,l.lesson),o="fas fa-file-image fa-4x";switch(p().extname(l.filename)){case".html":o="fab fa-html5 fa-4x";break;case".pdf":o="far fa-file-pdf fa-4x";break;case".jpg":o="fas fa-file-image fa-4x"}s.push(n.createElement(g.Z,{key:r},n.createElement("div",{className:"mr-3"},n.createElement("a",{href:P.ZP+"/"+l.filename,target:"_blank",rel:"noopener noreferrer"},n.createElement("i",{className:o}))),n.createElement(g.Z.Body,null,n.createElement("a",{href:P.ZP+"/"+l.filename,target:"_blank",rel:"noopener noreferrer"},n.createElement("h4",null,l.title)),n.createElement("p",null,t("common:date"),": ",new Date(l.createdAt).toLocaleDateString(),i?", ".concat(t("common:lesson"),": ").concat(i):i))))}return s}},{key:"renderMessages",value:function(){return this.state.selectedNamespace.announcements?n.createElement("div",null,this.state.selectedNamespace.announcements.map((function(e,t){var a=new Date(e.createdAt),s=a.toLocaleDateString()+"  -  "+a.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"});return n.createElement("div",{key:t,className:"message-container"},n.createElement("div",{className:"message-data"},n.createElement("div",{className:"message-profile-pic"},n.createElement("img",{src:e.picture,alt:"Message User Profile"})),n.createElement("div",{className:"message-author-line"},n.createElement("span",{className:"message-author"},e.author," "),"wrote on ",s)),n.createElement("div",{className:"message-title"},e.title),n.createElement("div",{className:"message-body"},e.body))}))):null}},{key:"renderStatisticDataToolbar",value:function(){var e=this.props.t;return n.createElement(v.Z,{variant:"tabs",activeKey:this.state.selectedDataType,onSelect:this.handleDataSelect},n.createElement(v.Z.Item,null,n.createElement(v.Z.Link,{eventKey:"messages",title:e("messages")},e("messages"))),n.createElement(v.Z.Item,null,n.createElement(v.Z.Link,{eventKey:"files",title:e("common:files")},e("common:files"))),n.createElement(v.Z.Item,null,n.createElement(v.Z.Link,{eventKey:"actions",title:e("actions")},e("actions"))))}},{key:"renderStatisticStatsToolbar",value:function(){var e=this.props.t;return n.createElement(v.Z,{variant:"tabs",activeKey:this.state.selectedStatsType,onSelect:this.handleStatsSelect},n.createElement(v.Z.Item,null,n.createElement(v.Z.Link,{eventKey:"progress",title:e("progress")},e("progress"))),n.createElement(v.Z.Item,null,n.createElement(v.Z.Link,{eventKey:"timeSpent",title:e("time-spent")},e("time-spent"))))}},{key:"renderStatisticSection",value:function(){var e=this.props,t=e.t,a=e.user.enrolledNamespaces;return n.createElement("div",{className:"profile-page-statistics"},n.createElement("div",{className:"profile-page-statistics-navigation-title"},t("common:courses")),n.createElement("div",{className:"profile-page-statistics-navigation"},n.createElement(v.Z,{variant:"tabs",activeKey:this.state.selectedNamespaceID,onSelect:this.handleSelect},a.map((function(e,t){var a=e.title,s=e._id;return n.createElement(v.Z.Item,{key:t},n.createElement(v.Z.Link,{eventKey:s,title:a,"data-id":t},a))})))),n.createElement("div",{className:"profile-page-statistics-data-select"},t("common:data")),n.createElement("div",{className:"profile-page-statistics-top-actions"},this.state.selectedNamespaceID?this.renderStatisticDataToolbar():null),n.createElement("div",{className:"profile-page-statistics-title2"},t("common:statistics")),n.createElement("div",{className:"profile-page-statistics-actions"},this.renderLeftPanel()),n.createElement("div",{className:"profile-page-statistics-select"},this.state.selectedNamespaceID?this.renderStatisticStatsToolbar():null),n.createElement("div",{className:"profile-page-statistics-stats"},this.renderRightPanel()))}},{key:"renderBadgesSection",value:function(){for(var e=[],t=this.props.user.badges||[],a=0;a<24;a++){var s=ge,r="Hidden Badge",l="profile-page-badge-item-interior unknown",i="badge-not-acquired";a<t.length&&(s=P.ZP+"/badges/"+t[a].picture,r=t[a].description,l="profile-page-badge-item-interior",t[a].acquired&&(i="badge-acquired")),e.push(n.createElement("div",{style:{animation:"scale-up "+(.05*a+.1)+"s"},className:"profile-page-badge-item-nova",key:a},n.createElement(E.Z,{placement:"top",overlay:n.createElement(Z.Z,{id:"badge-".concat(a,"-description")},r)},n.createElement("div",{className:"profile-page-badge-item"},n.createElement("img",{className:"mask",src:ve,alt:""}),n.createElement("div",{className:l},n.createElement("img",{className:i,src:s,alt:"User Badge"}))))))}return e}},{key:"renderUserSection",value:function(){var e=this.props,t=e.t,a=e.user,s=null;a.createdAt&&(s=new Date(a.createdAt).toLocaleDateString());var r=fe;a.picture&&(r=a.picture);var l=S()(this.props.user.enrolledNamespaces,(function(e){return e.enableTicketing})),i=y()(a.lessonData).length;return n.createElement("div",{className:"profile-page-user-container"},n.createElement("div",{role:"button",className:"profile-page-user-portrait",onClick:this.toggleProfilePicModal,onKeyPress:this.toggleProfilePicModal,tabIndex:0},n.createElement("img",{alt:"User Profile",src:r})),n.createElement("div",{className:"profile-page-user-personal"},n.createElement("div",{className:"profile-page-user-personal-name"},n.createElement(f.Z,null,n.createElement(f.Z.Header,null,n.createElement(f.Z.Title,{as:"h3"},a.name," ",n.createElement("br",null),a.organization?n.createElement("small",null,a.organization):null),s?n.createElement("div",null,t("registered-since",{date:s})):null),n.createElement(f.Z.Body,null,n.createElement("div",{className:"profile-page-user-values"},n.createElement("div",{className:"profile-page-user-legend"},t("score")),n.createElement("div",{className:"profile-page-user-value"},a.score),n.createElement("div",{className:"profile-page-user-legend"},t("no-lessons")),n.createElement("div",{className:"profile-page-user-value"},i),n.createElement("div",{className:"profile-page-user-legend"},t("time-spent")),n.createElement("div",{className:"profile-page-user-value"},(0,x.Z)(a.spentTime))))),n.createElement("div",null,n.createElement(h.Z,{style:{marginTop:15},block:!0,onClick:this.toggleEditModal},t("edit-profile")),l?n.createElement(h.Z,{style:{marginTop:15},block:!0,onClick:this.toggleTicketListModal},t("show-tickets")):null))),n.createElement("div",{className:"profile-page-user-footer"}))}},{key:"render",value:function(){var e=this.props.t;return n.createElement(n.Fragment,null,n.createElement("div",{className:"profile-page-grid-container"},n.createElement("div",{className:"profile-page-left"},this.renderUserSection()),this.renderStatisticSection(),n.createElement("div",{className:"profile-page-badge-title"},e("common:badges")),n.createElement("div",{className:"profile-page-badge-container"},this.renderBadgesSection())),n.createElement(ee,{user:this.props.user,authenticate:this.props.authenticate,show:this.state.showEditModal,addNotification:this.props.addNotification,updateUser:this.props.updateUser,onHide:this.toggleEditModal,resendConfirmEmail:this.props.resendConfirmEmail,disableTFA:this.props.disableTFA,enableTFA:this.props.enableTFA,getTfaQRCode:this.props.getTfaQRCode,t:e}),n.createElement(he,{createTicket:this.props.createTicket,show:this.state.showTicketListModal,onHide:this.toggleTicketListModal,getUserTickets:this.props.getUserTickets,user:this.props.user,submitTicketMessage:this.submitTicketMessage,closeTicket:this.props.closeTicket,openTicket:this.props.openTicket,history:this.props.history,t:e}),n.createElement(Ee,{user:this.props.user,show:this.state.showProfilePicModal,onHide:this.toggleProfilePicModal,uploadProfilePic:this.props.uploadProfilePic,t:e}))}}]),a}(n.Component);be.defaultProps={};var we=(0,u.Z)(["profile_page","common"])(be),Te=a(38315),Ne=a(96128),Ce=a(1725),Se=a(60299),xe=a(41985),Me=a(82406),Pe=a(86072),Fe=a.n(Pe),Ie=a(87284),De=a(33357),He=function(){var e=(0,V.Z)(G().mark((function e(t){var a;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Fe().get(P.ZP+"/get_tfa_qrcode");case 3:return a=e.sent,t({type:De.Bu,payload:{events:a.data.events}}),e.abrupt("return",a);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",(0,xe.EG)(t,e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),Le=function(e){return(0,V.Z)(G().mark((function t(){var a;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,He(e);case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}}),t)})))},Re=function(){var e=(0,V.Z)(G().mark((function e(t,a){var n;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Fe().post(P.ZP+"/enable_tfa",{token:a});case 3:n=e.sent,(0,xe.wN)(t,{title:n.data.verified?Ie.Z.t("common:tfa-enabled"):Ie.Z.t("common:tfa-not-enabled"),message:n.data.message,level:n.data.verified?"success":"error"}),t({type:De.E4,payload:{verified:n.data.verified}}),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",(0,xe.EG)(t,e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}(),Ae=function(e){return function(){var t=(0,V.Z)(G().mark((function t(a){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Re(e,a);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},_e=function(){var e=(0,V.Z)(G().mark((function e(t){var a;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Fe().post(P.ZP+"/disable_tfa");case 3:a=e.sent,(0,xe.wN)(t,{title:Ie.Z.t("common:tfa-disabled"),message:a.data.message,level:"success"}),t({type:De.oF,payload:{message:a.data.message,disabled:a.data.disabled}}),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",(0,xe.EG)(t,e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),Be=function(e){return(0,V.Z)(G().mark((function t(){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_e(e);case 2:case"end":return t.stop()}}),t)})))};var Ue=(0,s.$j)((function(e){return{user:e.user}}),(function(e){return{addNotification:(0,xe.pP)(e),createTicket:(0,Me.Cn)(e),getUserBadges:(0,Ne.fH)(e),updateUser:(0,Se.vi)(e),authenticate:(0,Se.m8)(e),getUserFiles:(0,Ce.f2)(e),getLessons:(0,Te.Hy)(e),resendConfirmEmail:(0,Se.WA)(e),sendTicketMessage:(0,Me.fG)(e),closeTicket:(0,Me.xG)(e),openTicket:(0,Me.mJ)(e),getUserTickets:(0,Me.S$)(e),uploadProfilePic:(0,Se.UA)(e),enableTFA:Ae(e),disableTFA:Be(e),getTfaQRCode:Le(e)}}))(we)},75033:function(e,t,a){"use strict";var n=a(78674),s=a.n(n);t.Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{hours:!0,minutes:!0,seconds:!0};e/=1e3;var a=s()(e/3600);e%=3600;var n=s()(e/60);n<10&&(n="0"+n),e%=60;var r=s()(e);r<10&&(r="0"+r);var l="";return t.hours&&(l+=a),t.minutes&&(l&&(l+=":"),l+=n),t.seconds&&(l&&(l+=":"),l+=r),l}},62173:function(){}}]);
//# sourceMappingURL=72786.a881b746.chunk.js.map