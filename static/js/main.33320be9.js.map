{"version":3,"sources":["actions/authentication.js","actions/cohort.js","actions/completions.js","actions/lesson.js","actions/notification.js","actions/settings.js","actions/user.js","components/spinner/index.js","constants/action_types.js","constants/languages.js","constants/server.js","helpers/axios.js","helpers/i18n.js","hooks/use-mount-effect/index.js","reducers/admin.js","reducers/badges.js","reducers/cohorts.js","reducers/namespace.js","reducers/notification.js","reducers/translations.js","reducers/settings.js","reducers/gallery.js","reducers/search.js","reducers/user.js","reducers/index.js","hooks/use-previous/index.js","containers/notification.js","components/language-switcher/index.js","components/footer-bar/index.js","containers/visible-footer-bar/index.js","containers/app.js","service_worker.js","index.js"],"names":["addErrorNotification","GET_COMPLETION_LESSON_REFS","server","types","cohorts","user","completions","cohort","i","notification","settings","search"],"mappings":"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","file":"static/js/main.33320be9.js","sourcesContent":["/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport axios from 'axios';\nimport logger from 'debug';\nimport server from 'constants/server';\nimport { addErrorNotification } from 'actions/notification.js';\nimport { loggedIn } from 'actions/user';\n\n\n// VARIABLES //\n\nconst debug = logger( 'isle-dashboard:actions:authentication' );\n\n\n// FUNCTIONS //\n\n/**\n * Sanitizes the user object.\n *\n * @param {Object} user - user object\n * @returns {Array} sanitized user object and a boolean indicating whether the user object needs sanitizing on the server\n */\nconst sanitizeUser = ( user ) => {\n\t// Check for duplicated enrolled and owned namespaces:\n\tconst ownedNamespaces = user.ownedNamespaces;\n\tconst newOwnedNamespaces = [];\n\tlet ids = new Set();\n\tfor ( let i = 0; i < ownedNamespaces.length; i++ ) {\n\t\tif ( !ids.has( ownedNamespaces[ i ]._id ) ) {\n\t\t\tids.add( ownedNamespaces[ i ]._id );\n\t\t\tnewOwnedNamespaces.push( ownedNamespaces[ i ] );\n\t\t}\n\t}\n\tconst enrolledNamespaces = user.enrolledNamespaces;\n\tconst newEnrolledNamespaces = [];\n\tids = new Set();\n\tfor ( let i = 0; i < enrolledNamespaces.length; i++ ) {\n\t\tif ( !ids.has( enrolledNamespaces[ i ]._id ) ) {\n\t\t\tids.add( enrolledNamespaces[ i ]._id );\n\t\t\tnewEnrolledNamespaces.push( enrolledNamespaces[ i ] );\n\t\t}\n\t}\n\tconst needsSanitizing = newOwnedNamespaces.length !== ownedNamespaces.length ||\n\t\tnewEnrolledNamespaces.length !== enrolledNamespaces.length;\n\n\tif ( needsSanitizing ) {\n\t\tuser.ownedNamespaces = newOwnedNamespaces;\n\t\tuser.enrolledNamespaces = newEnrolledNamespaces;\n\t}\n\tdebug( 'Does user need sanitizing? '+needsSanitizing );\n\treturn [ user, needsSanitizing ];\n};\n\n\n// MAIN //\n\n/**\n * Makes a POST request to the server to sanitize the user.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} user - user object\n * @returns {(Promise|null)} promise or null\n */\nexport const sanitizeRequest = ( dispatch, user ) => {\n\ttry {\n\t\treturn axios.post( server+'/sanitize_user', {\n\t\t\tid: user.id\n\t\t});\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t\treturn null;\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to sanitize the user with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to the server to sanitize the user\n */\nexport const sanitizeRequestInjector = dispatch => {\n\treturn async ( user ) => {\n\t\tconst result = await sanitizeRequest( dispatch, user );\n\t\treturn result;\n\t};\n};\n\n/**\n * Makes a POST request to the server to fetch the user's credentials.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} obj - object with a `id` property and a `token` property\n * @returns {(Object|null)} user object or null\n */\nexport const fetchCredentials = async ( dispatch, obj ) => {\n\tif ( !obj.id || !obj.token ) {\n\t\treturn null;\n\t}\n\tdebug( 'Fetch user credentials...' );\n\tlocalStorage.setItem( 'ISLE_USER_'+server, JSON.stringify( obj ) );\n\ttry {\n\t\tconst res = await axios.post( server+'/credentials_dashboard', {\n\t\t\tid: obj.id\n\t\t});\n\t\tdebug( 'Fetched user credentials...' );\n\t\tlet user = res.data;\n\t\tif ( user.picture ) {\n\t\t\tuser.picture = server + '/avatar/' + user.picture;\n\t\t}\n\t\tuser = {\n\t\t\t...obj,\n\t\t\t...user\n\t\t};\n\t\tlet [ sanitizedUser, needsSanitizing ] = sanitizeUser( user );\n\t\tdispatch( loggedIn( user ) );\n\t\tif ( needsSanitizing ) {\n\t\t\tsanitizeRequest( dispatch, obj );\n\t\t}\n\t\treturn sanitizedUser;\n\t} catch ( err ) {\n\t\tdebug( 'Failed to fetch user credentials...' );\n\t\taddErrorNotification( dispatch, err );\n\t\treturn null;\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to fetch the user's credentials with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to the server to fetch the user's credentials\n */\nexport const fetchCredentialsInjector = dispatch => {\n\treturn async ( obj ) => {\n\t\tconst result = await fetchCredentials( dispatch, obj );\n\t\treturn result;\n\t};\n};\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\nimport axios from 'axios';\r\nimport qs from 'querystring';\r\nimport logger from 'debug';\r\nimport i18next from 'i18next';\r\nimport server from 'constants/server';\r\nimport { getLessons } from 'actions/lesson';\r\nimport { addNotification, addErrorNotification } from 'actions/notification';\r\nimport { ADD_ENROLLED_NAMESPACE, GET_ALL_COHORTS, RETRIEVED_COHORTS, RETRIEVED_ENROLLABLE_COHORTS } from 'constants/action_types.js';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst debug = logger( 'isle-dashboard:actions:cohorts' );\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n * Returns an action for a new enrolled namespace.\r\n *\r\n * @param {Object} namespace - namespace object\r\n * @param {string} namespace._id - namespace ID\r\n * @param {string} namespace.title - namespace title\r\n * @param {string} namespace.description - namespace description\r\n * @param {Array} namespace.owners - namespace owners\r\n * @returns {Object} action\r\n */\r\nexport function addEnrolledNamespace({ title, owners, description, _id }) {\r\n\treturn {\r\n\t\ttype: ADD_ENROLLED_NAMESPACE,\r\n\t\tpayload: {\r\n\t\t\ttitle,\r\n\t\t\tdescription,\r\n\t\t\towners,\r\n\t\t\t_id\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Returns an action for retrieving all enrollable cohorts.\r\n *\r\n * @param {Array} cohorts - cohorts\r\n * @param {Object} user - user object\r\n * @returns {Object} action\r\n */\r\nexport function retrievedEnrollableCohorts( cohorts, user ) {\r\n\treturn {\r\n\t\ttype: RETRIEVED_ENROLLABLE_COHORTS,\r\n\t\tpayload: {\r\n\t\t\tcohorts,\r\n\t\t\tuser\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Returns an action for retrieved cohorts.\r\n *\r\n * @param {Array} cohorts - cohorts\r\n * @param {Object} user - user object\r\n * @returns {Object} action\r\n */\r\nexport function retrievedCohorts( cohorts, user ) {\r\n\treturn {\r\n\t\ttype: RETRIEVED_COHORTS,\r\n\t\tpayload: {\r\n\t\t\tcohorts,\r\n\t\t\tuser\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Returns an action for retrieving all cohorts.\r\n *\r\n * @param {Array} cohorts - cohorts\r\n * @returns {Object} action\r\n */\r\nexport function retrievedAllCohorts( cohorts ) {\r\n\treturn {\r\n\t\ttype: GET_ALL_COHORTS,\r\n\t\tpayload: {\r\n\t\t\tcohorts\r\n\t\t}\r\n\t};\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\n/**\r\n * Makes a GET request for retrieving all enrollable cohorts.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} user - user object\r\n */\r\nexport const getEnrollableCohorts = async ( dispatch, user ) => {\r\n\ttry {\r\n\t\tconst res = await axios.get( server+'/get_enrollable_cohorts' );\r\n\t\tconst cohorts = res.data.cohorts;\r\n\t\tdebug( 'Retrieved '+cohorts.length+' cohorts...' );\r\n\t\tdispatch( retrievedEnrollableCohorts( cohorts, user ) );\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function making a GET request for retrieving all enrollable cohorts with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make GET request for retrieving all enrollable cohorts\r\n */\r\nexport const getEnrollableCohortsInjector = dispatch => {\r\n\treturn async ( user ) => {\r\n\t\tawait getEnrollableCohorts( dispatch, user );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a GET request for retrieving all cohorts for the selected course.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} options - request options\r\n * @param {string} options.namespaceID - course ID\r\n */\r\nexport const getCohorts = async ( dispatch, { namespaceID }) => {\r\n\ttry {\r\n\t\tconst res = await axios.get( server+'/get_cohorts?'+qs.stringify({ namespaceID }) );\r\n\t\tdispatch( retrievedCohorts( res.data.cohorts ) );\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function making a GET request for retrieving all cohorts for the selected course with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make GET request for retrieving all cohorts for the selected course\r\n */\r\nexport const getCohortsInjector = ( dispatch ) => {\r\n\treturn async ({ namespaceID, userToken }) => {\r\n\t\tawait getCohorts( dispatch, { namespaceID, userToken });\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a POST request for adding the user to the selected cohort.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {string} cohortID - cohort ID\r\n * @param {Object} namespace - namespace object\r\n */\r\nexport const addUserToCohort = async ( dispatch, cohortID, namespace ) => {\r\n\ttry {\r\n\t\tconst res = await axios.post( server+'/add_to_cohort', { cohortID });\r\n\t\taddNotification( dispatch, {\r\n\t\t\tmessage: res.data.message,\r\n\t\t\tlevel: 'success'\r\n\t\t});\r\n\t\tdispatch( addEnrolledNamespace( namespace ) );\r\n\t\tconst namespaceName = namespace.title;\r\n\t\tgetLessons( dispatch, namespaceName );\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function making a POST request for adding the user to the selected cohort with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make POST request for adding the user to the selected cohort\r\n */\r\nexport const addUserToCohortInjector = ( dispatch ) => {\r\n\treturn async ( cohortID, namespace ) => {\r\n\t\tawait addUserToCohort( dispatch, cohortID, namespace );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a POST request for deleting the selected cohort.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {string} _id - cohort ID\r\n * @param {string} namespaceID - namespace identifier corresponding to the cohort\r\n */\r\nexport const deleteCohort = async ( dispatch, _id, namespaceID ) => {\r\n\ttry {\r\n\t\tconst res = await axios.post( server+'/delete_cohort', { _id });\r\n\t\taddNotification( dispatch, {\r\n\t\t\tmessage: res.data.message,\r\n\t\t\tlevel: 'success'\r\n\t\t});\r\n\t\tdispatch( retrievedEnrollableCohorts( null ) );\r\n\t\tif ( namespaceID ) {\r\n\t\t\tgetCohorts( dispatch, {\r\n\t\t\t\tnamespaceID\r\n\t\t\t});\r\n\t\t}\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function making a POST request for deleting the selected cohort with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make POST request for deleting the selected cohort\r\n */\r\nexport const deleteCohortInjector = ( dispatch ) => {\r\n\treturn async ( _id, namespaceID ) => {\r\n\t\tawait deleteCohort( dispatch, _id, namespaceID );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a POST request for creating a new cohort.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} cohort - cohort object\r\n * @param {string} namespaceID - namespace identifier corresponding to the cohort\r\n */\r\nexport const createCohort = async ( dispatch, cohort, namespaceID ) => {\r\n\ttry {\r\n\t\tconst res = await axios.post( server+'/create_cohort', cohort );\r\n\t\taddNotification( dispatch, {\r\n\t\t\tmessage: res.data.message,\r\n\t\t\tlevel: 'success'\r\n\t\t});\r\n\t\tdispatch( retrievedEnrollableCohorts( null ) );\r\n\t\tgetCohorts( dispatch, { namespaceID });\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function making a POST request for creating a new cohort with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make POST request for creating a new cohort\r\n */\r\nexport const createCohortInjector = ( dispatch ) => {\r\n\treturn async ( cohort, namespaceID ) => {\r\n\t\tawait createCohort( dispatch, cohort, namespaceID );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a POST request for updating the selected cohort.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} cohort - cohort object\r\n * @param {string} namespaceID - namespace identifier corresponding to the cohort\r\n */\r\nexport const updateCohort = async ( dispatch, cohort, namespaceID ) => {\r\n\ttry {\r\n\t\tconst res = await axios.post( server+'/update_cohort', { cohort });\r\n\t\tlet msg = res.data.message;\r\n\t\tlet notification;\r\n\t\tif ( res.data.newEmails && res.data.newEmails.length > 0 ) {\r\n\t\t\tnotification = {\r\n\t\t\t\tchildren: <div>\r\n\t\t\t\t\t<p>{msg}</p>\r\n\t\t\t\t\t<p>{i18next.t('common:email-invitations-sent')}</p>\r\n\t\t\t\t\t<p>{res.data.newEmails.join( '\\n' )}</p>\r\n\t\t\t\t</div>,\r\n\t\t\t\tlevel: 'success',\r\n\t\t\t\tautoDismiss: 0,\r\n\t\t\t\tdismissible: 'button'\r\n\t\t\t};\r\n\t\t}\r\n\t\telse {\r\n\t\t\tnotification = {\r\n\t\t\t\tmessage: msg,\r\n\t\t\t\tlevel: 'success'\r\n\t\t\t};\r\n\t\t}\r\n\t\taddNotification( dispatch, notification );\r\n\t\tdispatch( retrievedEnrollableCohorts( null ) );\r\n\t\tgetCohorts( dispatch, { namespaceID });\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function making a POST request for updating the selected cohort with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make POST request for updating the selected cohort\r\n */\r\nexport const updateCohortInjector = ( dispatch ) => {\r\n\treturn async ( cohort, namespaceID ) => {\r\n\t\tawait updateCohort( dispatch, cohort, namespaceID );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a POST request for retrieving the list of cohorts.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n */\r\nexport const getAllCohorts = async ( dispatch ) => {\r\n\ttry {\r\n\t\tconst res = await axios.get( server+'/get_all_cohorts' );\r\n\t\tdispatch( retrievedAllCohorts( res.data.cohorts ) );\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function making a POST request for retrieving the list of all cohorts with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make POST request for retrieving the list of all cohorts\r\n */\r\nexport const getAllCohortsInjector = ( dispatch ) => {\r\n\treturn async () => {\r\n\t\tawait getAllCohorts( dispatch );\r\n\t};\r\n};\r\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport axios from 'axios';\nimport server from 'constants/server';\nimport { addNotification, addErrorNotification } from 'actions/notification';\nimport { COMPUTED_COMPLETIONS, CREATED_METRIC, DELETED_METRIC,\n\tGET_COMPLETION_LESSON_REFS, GET_COMPLETION_COMPONENTS, GET_COMPLETION_TAGS,\n\tSAVED_LESSON_METRICS, UPDATED_METRIC, RETRIEVED_COMPLETION_RULES } from 'constants/action_types.js';\n\n\n// VARIABLES //\n\nconst DEFAULT_TAGS = [\n\t'_default_tag'\n];\n\n\n// MAIN //\n\n/**\n * Makes a GET request to the server to retrieve all completion tags.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Array<ObjectId>} lessonIDs - ids for lessons whose tags are\n *     to be retrieved.\n * @returns {void}\n */\nexport const getCompletionTags = async ( dispatch, lessonIDs ) => {\n\ttry {\n\t\tconst res = await axios.post( `${server}/completion_tags`, {\n\t\t\tlessons: lessonIDs\n\t\t});\n\t\tdispatch({\n\t\t\ttype: GET_COMPLETION_TAGS,\n\t\t\tpayload: {\n\t\t\t\tcompletionTags: res.data\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\tdispatch({\n\t\t\ttype: GET_COMPLETION_TAGS,\n\t\t\tpayload: {\n\t\t\t\tcompletionTags: DEFAULT_TAGS\n\t\t\t}\n\t\t});\n\t}\n};\n\n/**\n* Returns a function to retrieve all completion tags for a set of lessons.\n*\n* @param {Function} dispatch - dispatch function\n* @returns {Function} function to retrieve completion tags\n*/\nexport const getCompletionTagsInjector = dispatch => {\n\treturn async ( lessonIDs ) => {\n\t\tawait getCompletionTags( dispatch, lessonIDs );\n\t};\n};\n\nexport const getCompletionComponents = async ( dispatch, lessonIds ) => {\n\ttry {\n\t\tconst res = await axios.post( `${server}/completion_components`, {\n\t\t\tlessons: lessonIds\n\t\t});\n\t\tdispatch({\n\t\t\ttype: GET_COMPLETION_COMPONENTS,\n\t\t\tpayload: {\n\t\t\t\tcomponentsByLesson: res.data\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\tconsole.error( 'Error getting completion components: ', err );\n\t\tconst componentsByLesson = {};\n\t\tlessonIds.forEach( lessonID => {\n\t\t\tcomponentsByLesson[ lessonID ] = [];\n\t\t});\n\t\tdispatch({\n\t\t\ttype: GET_COMPLETION_COMPONENTS,\n\t\t\tpayload: {\n\t\t\t\tcomponentsByLesson\n\t\t\t}\n\t\t});\n\t}\n};\n\n/**\n * Retrieves the names of lower level metrics (refs)\n *\n * @param {Function} dispatch - dispatch function\n * @param {Array<ObjectId>} entities - id of entities whose refs (metrics at next lowest level)\n *     we are retrieving. In the typical case, these will be lesson ids.\n * @param {string} target - name of the target field in the Completions table that we\n *     constrain to be in `entities`.  In the typical case, this will be 'lesson'.\n *     We then search for refs (component metric names) for which lesson id belongs to\n *     the given list of entities.\n * @returns {void}\n */\nexport const getCompletionLessonRefs = async ( dispatch, { entities, target } ) => {\n\ttry {\n\t\tconst res = await axios.post( `${server}/completion_refs`, {\n\t\t\tentities,\n\t\t\ttarget\n\t\t});\n\t\tdispatch({\n\t\t\ttype: GET_COMPLETION_LESSON_REFS,\n\t\t\tpayload: {\n\t\t\t\tcompletionRefs: res.data\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to retrieve the names of lower level metrics (refs).\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to retrieve completion refs\n */\nexport const getCompletionLessonRefsInjector = dispatch => {\n\treturn async ({ entities, target }) => {\n\t\tawait getCompletionLessonRefs( dispatch, { entities, target });\n\t};\n};\n\n/**\n * Makes a POST request to the server to compute completion values for a particular metric, entity, and a set of users.\n *\n * @param {Function} dispatch - dispatch function\n */\nexport const computeCompletions = async ( dispatch, { metric, ids, users, policyOptions } ) => {\n\ttry {\n\t\tconst res = await axios.post( `${server}/compute_completions`, {\n\t\t\tmetric,\n\t\t\tids,\n\t\t\tusers,\n\t\t\tpolicyOptions\n\t\t});\n\t\tdispatch({\n\t\t\ttype: COMPUTED_COMPLETIONS,\n\t\t\tpayload: res.data\n\t\t});\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t}\n\tcatch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to compute completion values for a particular metric, entity, and a set of users.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to compute completion values\n */\nexport const computeCompletionsInjector = dispatch => {\n\treturn async ({ metric, ids, users, policyOptions }) => {\n\t\tconst res = await computeCompletions( dispatch, { metric, ids, users, policyOptions });\n\t\treturn res;\n\t};\n};\n\n/**\n * Makes a POST request to the server to create a new completion metric.\n *\n * @param {Function} dispatch - dispatch function\n * @param {string} name - the metric name\n * @param {string} level - the level of the hierarchy for which we are computing completions,\n *     one of: 'program', 'namespace', 'lesson', 'component'.\n * @param {ObjectId} id - the id of the entity at the given level for which we are computing\n *     the completions.\n * @param {Array} rule - a vector of the form ['rule-name', ...params], specifying\n *     the aggregation rule used by the completion\n * @param {Array} coverage - an array of the form ['all'], ['include', ...ids], or\n *     ['exclude', ...ids], where ids are the ObjectId's for the  entities at the next\n *     sublevel (e.g., lessons when level is 'namespace').\n * @param {string} ref - the name of the metric to use at the next lower level for computing\n *     the completions that are used at this level.\n * @param {Object<string,number>} tagWeights - a map from completion tag names to weights\n * @param {boolean} autoCompute - whether to automatically compute the completions for this metric\n * @param {boolean} visibleToStudent - whether to make the score visible to the student with whom it is associated\n * @returns {void}\n */\n export const createMetric = async ( dispatch, { name, rule, coverage, level, id, ref, tagWeights, autoCompute, visibleToStudent }) => {\n\ttry {\n\t\tconst res = await axios.post( `${server}/create_metric`, {\n\t\t\tname, rule, coverage, level, id, ref, tagWeights, autoCompute, visibleToStudent\n\t\t});\n\t\tconsole.log( res.data );\n\t\tdispatch({\n\t\t\ttype: CREATED_METRIC,\n\t\t\tpayload: {\n\t\t\t\tmetric: res.data.metric,\n\t\t\t\tlevel,\n\t\t\t\tid\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to create a new completion metric.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} a function to make a POST request to the server to create a new completion metric\n */\nexport const createMetricInjector = dispatch => {\n\treturn async ( metric ) => {\n\t\tawait createMetric( dispatch, metric );\n\t};\n};\n\n/**\n * Makes a POST request to the server to update a completion metric.\n *\n * @param {Function} dispatch - dispatch function\n * @param {string} body.name - the metric name\n * @param {string} body.level - the level of the hierarchy for which we are computing completions,\n *     one of: 'program', 'namespace', 'lesson', 'component'.\n * @param {ObjectId} body.id - the id of the entity at the given level for which we are computing\n *     the completions.\n * @param {Array} body.rule - a vector of the form ['rule-name', ...params], specifying\n *     the aggregation rule used by the completion\n * @param {Array} body.coverage - an array of the form ['all'], ['include', ...ids], or\n *     ['exclude', ...ids], where ids are the ObjectId's for the  entities at the next\n *     sublevel (e.g., lessons when level is 'namespace').\n * @param {string} body.ref - the name of the metric to use at the next lower level for computing\n *     the completions that are used at this level.\n * @param {Object<string,number>} body.tagWeights - a map from completion tag names to weights\n * @returns {void}\n */\nexport const updateMetric = async ( dispatch, body ) => {\n\ttry {\n\t\tconst res = await axios.post( `${server}/update_metric`, body );\n\t\tconsole.log( res.data );\n\t\tdispatch({\n\t\t\ttype: UPDATED_METRIC,\n\t\t\tpayload: {\n\t\t\t\tmetric: body,\n\t\t\t\tlevel: body.level,\n\t\t\t\tid: body.id\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to update a completion metric.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} a function to make a POST request to the server to update a completion metric\n */\nexport const updateMetricInjector = dispatch => {\n\treturn async ( metric ) => {\n\t\tawait updateMetric( dispatch, metric );\n\t};\n};\n\n/**\n * Makes a POST request to the server to delete a completion metric.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} body - request body\n * @param {string} body.name - the metric name\n * @param {string} body.level - the level of the hierarchy for which we are computing completions,\n *     one of: 'program', 'namespace', 'lesson', 'component'.\n * @param {ObjectId} body.id - the id of the entity at the given level for which we are computing\n *     the completions.\n * @returns {void}\n */\nexport const deleteMetric = async ( dispatch, { name, level, id }) => {\n\ttry {\n\t\tawait axios.post( `${server}/delete_metric`, {\n\t\t\tname, level, id\n\t\t});\n\t\tdispatch({\n\t\t\ttype: DELETED_METRIC,\n\t\t\tpayload: {\n\t\t\t\tname, level, id\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to delete a completion metric.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} a function to make a POST request to the server to delete a completion metric\n */\nexport const deleteMetricInjector = dispatch => {\n\treturn async ({ name, level, id }) => {\n\t\tconst res = await deleteMetric( dispatch, { name, level, id });\n\t\treturn res;\n\t};\n};\n\nexport const saveLessonMetrics = async ( dispatch, body ) => {\n\ttry {\n\t\tconst res = await axios.post( `${server}/save_lesson_metrics`, body );\n\t\tconsole.log( 'SAVE LESSON METRICS', res.data );\n\t\tdispatch({\n\t\t\ttype: SAVED_LESSON_METRICS,\n\t\t\tpayload: {\n\t\t\t\t...res.data,\n\t\t\t\tmetricName: body.name\n\t\t\t}\n\t\t});\n\t\treturn res;\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\nexport const saveLessonMetricsInjector = dispatch => {\n\treturn async ( body ) => {\n\t\tconst res = await saveLessonMetrics( dispatch, body );\n\t\treturn res;\n\t};\n};\n\nexport const getCompletionRules = async ( dispatch ) => {\n\ttry {\n\t\tconst res = await axios.get( `${server}/completion_rules` );\n\t\tdispatch({\n\t\t\ttype: RETRIEVED_COMPLETION_RULES,\n\t\t\tpayload: {\n\t\t\t\tcompletionRules: res.data\n\t\t\t}\n\t\t});\n\t\treturn res;\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\nexport const getCompletionRulesInjector = dispatch => {\n\treturn async () => {\n\t\tconst res = await getCompletionRules( dispatch );\n\t\treturn res;\n\t};\n};\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport axios from 'axios';\nimport qs from 'querystring';\nimport server from 'constants/server';\nimport { isPrimitive as isBoolean } from '@stdlib/assert/is-boolean';\nimport { isPrimitive as isString } from '@stdlib/assert/is-string';\nimport isNull from '@stdlib/assert/is-null';\nimport { addNotification, addErrorNotification } from 'actions/notification';\nimport { DELETED_LESSON, GET_ALL_LESSONS, GET_TEMPLATE_LESSONS, GET_ROOMS, UPDATED_LESSON, RETRIEVED_LESSONS, RETRIEVED_PUBLIC_LESSONS } from 'constants/action_types.js';\n\n\n// EXPORTS //\n\n/**\n * Returns an action signifying a lesson has been deleted.\n *\n * @param {string} lessonName - name of the lesson\n * @returns {Object} action\n */\nexport function deletedLesson( lessonName ) {\n\treturn {\n\t\ttype: DELETED_LESSON,\n\t\tpayload: {\n\t\t\tlessonName\n\t\t}\n\t};\n}\n\n/**\n * Returns an action indicating that a lesson has been updated.\n *\n * @param {string} lessonName - name of the lesson\n * @param {Object} props - properties of the lesson\n * @returns {Object} action\n */\nexport function updatedLesson( lessonName, props ) {\n\treturn {\n\t\ttype: UPDATED_LESSON,\n\t\tpayload: {\n\t\t\tlessonName,\n\t\t\tprops\n\t\t}\n\t};\n}\n\n/**\n * Returns an action indicating that lessons have been retrieved.\n *\n * @param {Array} lessons - lessons\n * @param {string} namespaceName - namespace name\n * @returns {Object} action\n */\nexport function retrievedLessons({ lessons, namespaceName }) {\n\treturn {\n\t\ttype: RETRIEVED_LESSONS,\n\t\tpayload: {\n\t\t\tlessons,\n\t\t\tnamespaceName\n\t\t}\n\t};\n}\n\n/**\n * Returns an action indicating that all lessons have been retrieved for an admin user.\n *\n * @param {Array} lessons - lessons\n * @returns {Object} action\n */\nexport function retrievedAllLessons( lessons ) {\n\treturn {\n\t\ttype: GET_ALL_LESSONS,\n\t\tpayload: {\n\t\t\tlessons\n\t\t}\n\t};\n}\n\n/**\n * Returns an action indicating that all lessons that may serve as templates have been retrieved.\n *\n * @param {Array} templateLessons - lessons that may serve as templates\n * @returns {Object} action\n */\nexport function retrievedTemplateLessons( templateLessons ) {\n\treturn {\n\t\ttype: GET_TEMPLATE_LESSONS,\n\t\tpayload: {\n\t\t\ttemplateLessons\n\t\t}\n\t};\n}\n\n/**\n * Returns an action indicating that all chat rooms have been retrieved.\n *\n * @param {Array} rooms - chat rooms\n * @returns {Object} action\n */\nexport function retrievedRooms( rooms ) {\n\treturn {\n\t\ttype: GET_ROOMS,\n\t\tpayload: {\n\t\t\trooms\n\t\t}\n\t};\n}\n\n/**\n * Returns an action indicating that all public lessons have been retrieved.\n *\n * @param {Array} lessons - lessons\n * @returns {Object} action\n */\nexport function retrievedPublicLessons( lessons ) {\n\treturn {\n\t\ttype: RETRIEVED_PUBLIC_LESSONS,\n\t\tpayload: {\n\t\t\tlessons\n\t\t}\n\t};\n}\n\n/**\n * Makes a POST request to retrieve all public lessons.\n *\n * @param {Function} dispatch - dispatch function\n */\nexport const getPublicLessons = async ( dispatch ) => {\n\ttry {\n\t\tconst res = await axios.get( server+'/get_public_lessons' );\n\t\tdispatch( retrievedPublicLessons( res.data.lessons ) );\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to retrieve all public lessons.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to retrieve all public lessons\n */\nexport const getPublicLessonsInjector = ( dispatch ) => {\n\treturn async () => {\n\t\tawait getPublicLessons( dispatch );\n\t};\n};\n\n/**\n * Makes a GET request to retrieve the ISLE file for a lesson.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.lessonName - name of the lesson\n * @param {string} options.namespaceName - namespace name\n * @returns {(Object|null)} file data or null if the file does not exist\n */\nexport const getIsleFile = async ( dispatch, { lessonName, namespaceName }) => {\n\ttry {\n\t\tconst res = await axios.get( server+'/get_isle_file?'+qs.stringify({\n\t\t\tlessonName,\n\t\t\tnamespaceName\n\t\t}) );\n\t\treturn res.data;\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t\treturn null;\n\t}\n};\n\n/**\n * Returns a function to make a GET request to retrieve the ISLE file for a lesson.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a GET request to retrieve the ISLE file for a lesson\n */\nexport const getIsleFileInjector = ( dispatch ) => {\n\treturn async ({ lessonName, namespaceName }) => {\n\t\tconst file = await getIsleFile( dispatch, { lessonName, namespaceName });\n\t\treturn file;\n\t};\n};\n\n/**\n * Makes a GET request to retrieve all lessons for a given namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @param {string} namespaceName - namespace name\n */\nexport const getLessons = async ( dispatch, namespaceName ) => {\n\tif ( namespaceName ) {\n\t\ttry {\n\t\t\tconsole.log( 'Retrieve lessons for namespace: ', namespaceName );\n\t\t\tconst res = await axios.get( server+'/get_lessons?'+qs.stringify({\n\t\t\t\tnamespaceName\n\t\t\t}) );\n\t\t\tif ( isNull( res.data ) ) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\tlet lessons = res.data.lessons;\n\t\t\tconsole.log( 'Retrieved %s lessons.', lessons.length );\n\t\t\tlessons = lessons.map(( lesson, index ) => {\n\t\t\t\tlesson.colorIndex = index % 20;\n\t\t\t\tlesson.url = server+'/'+namespaceName+'/'+lesson.title;\n\t\t\t\tif ( lesson.lockUntil ) {\n\t\t\t\t\tlesson.lockUntil = new Date( lesson.lockUntil.time );\n\t\t\t\t}\n\t\t\t\tif ( !lesson.createdAt ) {\n\t\t\t\t\tlesson.createdAt = new Date( 0 ).toLocaleString();\n\t\t\t\t}\n\t\t\t\tif ( !lesson.updatedAt ) {\n\t\t\t\t\tlesson.updatedAt = lesson.createdAt;\n\t\t\t\t}\n\t\t\t\treturn lesson;\n\t\t\t});\n\t\t\tdispatch( retrievedLessons({ lessons, namespaceName }) );\n\t\t\treturn lessons;\n\t\t} catch ( err ) {\n\t\t\taddErrorNotification( dispatch, err );\n\t\t}\n\t}\n};\n\n/**\n * Returns a function to make a GET request to retrieve all lessons for a given namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a GET request to retrieve all lessons for a given namespace\n */\nexport const getLessonsInjector = ( dispatch ) => {\n\treturn async ( namespaceName ) => {\n\t\tawait getLessons( dispatch, namespaceName );\n\t};\n};\n\n/**\n * Makes a POST request to copy a lesson from a source namespace to a target namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.sourceName - source lesson name\n * @param {string} options.targetName - target lesson name\n * @param {string} options.source - source namespace name\n * @param {string} options.target - target namespace name\n * @returns {(Object|Error)} response data or an error if encountered\n */\nexport const copyLesson = async ( dispatch, { sourceName, target, targetName, source }) => {\n\tif ( sourceName && target && source ) {\n\t\ttry {\n\t\t\tconst res = await axios.post( server+'/copy_lesson', {\n\t\t\t\ttarget,\n\t\t\t\tsource,\n\t\t\t\tsourceName,\n\t\t\t\ttargetName\n\t\t\t});\n\t\t\taddNotification( dispatch, {\n\t\t\t\tmessage: res.data.message,\n\t\t\t\tlevel: 'success'\n\t\t\t});\n\t\t\treturn res;\n\t\t} catch ( err ) {\n\t\t\taddErrorNotification( dispatch, err );\n\t\t\treturn err;\n\t\t}\n\t}\n};\n\n/**\n * Returns a function to make a POST request to copy a lesson from a source namespace to a target namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to copy a lesson from a source namespace to a target namespace\n */\nexport const copyLessonInjector = ( dispatch ) => {\n\treturn async ({ sourceName, target, targetName, source }) => {\n\t\tawait copyLesson( dispatch, { sourceName, target, targetName, source } );\n\t};\n};\n\n/**\n * Makes a POST request to copy all lessons from a source namespace to a target namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.source - source namespace name\n * @param {string} options.target - target namespace name\n * @returns {(Object|Error)} response data or an error if encountered\n */\nexport const copyNamespaceLessons = async ( dispatch, { target, source }) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/copy_namespace_lessons', {\n\t\t\ttarget,\n\t\t\tsource\n\t\t});\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t\treturn res;\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t\treturn err;\n\t}\n};\n\n/**\n * Returns a function to make a POST request to copy all lessons from a source namespace to a target namespace.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to copy all lessons from a source namespace to a target namespace\n */\nexport const copyNamespaceLessonsInjector = ( dispatch ) => {\n\treturn async ({ target, source }) => {\n\t\tconst res = await copyNamespaceLessons( dispatch, { target, source } );\n\t\treturn res;\n\t};\n};\n\n/**\n * Makes a POST request to delete a lesson.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.lessonName - lesson name\n * @param {string} options.namespaceName - namespace name\n * @returns {(Object|Error)} response data or an error if encountered\n */\nexport const deleteLesson = async ( dispatch, { lessonName, namespaceName }) => {\n\tif ( !namespaceName || !lessonName ) {\n\t\tconst err = new Error( 'Missing `namespaceName` or `lessonName`.' );\n\t\taddErrorNotification( dispatch, err );\n\t\treturn err;\n\t}\n\ttry {\n\t\tconst res = await axios.post( server+'/delete_lesson', {\n\t\t\tnamespaceName,\n\t\t\tlessonName\n\t\t});\n\t\tdispatch( deletedLesson( lessonName ) );\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t\treturn res;\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t\treturn err;\n\t}\n};\n\n/**\n * Returns a function to make a POST request to delete a lesson.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to delete a lesson\n */\nexport const deleteLessonInjector = ( dispatch ) => {\n\treturn async ({ lessonName, namespaceName }) => {\n\t\tawait deleteLesson( dispatch, { lessonName, namespaceName } );\n\t};\n};\n\n/**\n * Makes a POST request to show a lesson in the gallery of the dashboard.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.lessonName - lesson name\n * @param {string} options.namespaceName - namespace name\n */\nexport const showLessonInGallery = async ( dispatch, { lessonName, namespaceName }) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/show_lesson', {\n\t\t\tnamespaceName,\n\t\t\tlessonName\n\t\t});\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t\tdispatch( updatedLesson( lessonName, { public: true }) );\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to show a lesson in the gallery of the dashboard.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to show a lesson in the gallery of the dashboard\n */\nexport const showLessonInGalleryInjector = ( dispatch ) => {\n\treturn async ({ lessonName, namespaceName }) => {\n\t\tawait showLessonInGallery( dispatch, { lessonName, namespaceName });\n\t};\n};\n\n\n/**\n * Makes a POST request to hide a lesson in the gallery of the dashboard.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.lessonName - lesson name\n * @param {string} options.namespaceName - namespace name\n */\nexport const hideLessonInGallery = async ( dispatch, { lessonName, namespaceName }) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/hide_lesson', {\n\t\t\tnamespaceName,\n\t\t\tlessonName\n\t\t});\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t\tdispatch( updatedLesson( lessonName, { public: false }) );\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to hide a lesson in the gallery of the dashboard.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to hide a lesson in the gallery of the dashboard\n */\nexport const hideLessonInGalleryInjector = ( dispatch ) => {\n\treturn async ({ lessonName, namespaceName }) => {\n\t\tawait hideLessonInGallery( dispatch, { lessonName, namespaceName });\n\t};\n};\n\n/**\n * Makes a POST request to make a lesson available to users, i.e. set it to being active.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.lessonName - lesson name\n * @param {string} options.namespaceName - namespace name\n */\nexport const activateLesson = async ( dispatch, { lessonName, namespaceName }) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/activate_lesson?', {\n\t\t\tnamespaceName,\n\t\t\tlessonName\n\t\t});\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t\tdispatch( updatedLesson( lessonName, { active: true }) );\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to make a lesson available to users, i.e. set it to being active.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to make a lesson available to users, i.e. set it to being active\n */\nexport const activateLessonInjector = ( dispatch ) => {\n\treturn async ({ lessonName, namespaceName }) => {\n\t\tawait activateLesson( dispatch, { lessonName, namespaceName });\n\t};\n};\n\n/**\n * Makes a POST request to make a lesson hidden from users, i.e. set it to being inactive.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.lessonName - lesson name\n * @param {string} options.namespaceName - namespace name\n */\nexport const deactivateLesson = async ( dispatch, { lessonName, namespaceName }) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/deactivate_lesson', {\n\t\t\tnamespaceName,\n\t\t\tlessonName\n\t\t});\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t\tdispatch( updatedLesson( lessonName, { active: false }) );\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to make a lesson hidden from users, i.e. set it to being inactive.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to make a lesson hidden from users, i.e. set it to being inactive\n */\nexport const deactivateLessonInjector = ( dispatch ) => {\n\treturn async ({ lessonName, namespaceName }) => {\n\t\tawait deactivateLesson( dispatch, { lessonName, namespaceName });\n\t};\n};\n\n/**\n * Makes a POST request to update a lesson.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.lessonName - lesson name\n * @param {string} options.namespaceName - namespace name\n * @param {string} options.newTitle - new title\n * @param {string} options.newDescription - new description\n * @param {string} options.lockAfter - date on which the lesson should be made unavailable to users\n * @param {string} options.lockUntil - date on which the lesson should be made available to users\n * @param {boolean} options.template - controls whether the lesson shall be a template or not\n * @param {boolean} options.hideFromDashboard - controls whether the lesson shall be hidden from the dashboard (but may still be active and accessible)\n * @param {string} options.tag - tag associated with the lesson\n * @returns {boolean} true if the lesson was updated, false otherwise\n */\nexport const updateLesson = async ( dispatch, { lessonName, namespaceName, newTitle, newDescription, lockAfter, lockUntil, tag, template, hideFromDashboard }) => {\n\tif ( namespaceName && lessonName ) {\n\t\ttry {\n\t\t\tconst query = {\n\t\t\t\tnamespaceName,\n\t\t\t\tlessonName,\n\t\t\t\tnewTitle,\n\t\t\t\tnewDescription,\n\t\t\t\tlockAfter,\n\t\t\t\tlockUntil,\n\t\t\t\thideFromDashboard\n\t\t\t};\n\t\t\tif ( isBoolean( template ) ) {\n\t\t\t\tquery.template = template;\n\t\t\t}\n\t\t\tif ( isString( tag ) && tag !== '_default_tag' ) {\n\t\t\t\tquery.tag = tag;\n\t\t\t}\n\t\t\tconst res = await axios.post( server+'/update_lesson', query );\n\t\t\tdispatch( deletedLesson( lessonName ) );\n\t\t\taddNotification( dispatch, {\n\t\t\t\tmessage: res.data.message,\n\t\t\t\tlevel: 'success'\n\t\t\t});\n\t\t\tgetLessons( dispatch, namespaceName );\n\t\t\treturn true;\n\t\t} catch ( err ) {\n\t\t\taddErrorNotification( dispatch, err );\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn false;\n};\n\n/**\n * Returns a function to make a POST request to update a lesson.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to update a lesson\n */\nexport const updateLessonInjector = ( dispatch ) => {\n\treturn async ({ lessonName, namespaceName, newTitle, newDescription, lockAfter, lockUntil, hideFromDashboard, tag, template }) => {\n\t\tconst bool = await updateLesson( dispatch, { lessonName, namespaceName, newTitle, newDescription, lockAfter, lockUntil, hideFromDashboard, tag, template });\n\t\treturn bool;\n\t};\n};\n\n/**\n * Makes a GET request to retrieve all lessons for an admin user.\n *\n * @param {Function} dispatch - dispatch function\n */\nexport const getAllLessons = async ( dispatch ) => {\n\ttry {\n\t\tconst res = await axios.get( server+'/get_all_lessons' );\n\t\tdispatch( retrievedAllLessons( res.data.lessons ) );\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a GET request to retrieve all lessons for an admin user.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a GET request to retrieve all lessons for an admin user\n */\nexport const getAllLessonsInjector = ( dispatch ) => {\n\treturn async () => {\n\t\tawait getAllLessons( dispatch );\n\t};\n};\n\n/**\n * Makes a GET request to retrieve all template lessons.\n *\n * @param {Function} dispatch - dispatch function\n */\nexport const getTemplateLessons = async ( dispatch ) => {\n\ttry {\n\t\tconst res = await axios.get( server+'/get_template_lessons' );\n\t\tdispatch( retrievedTemplateLessons( res.data.lessons ) );\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a GET request to retrieve all template lessons.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a GET request to retrieve all template lessons\n */\nexport const getTemplateLessonsInjector = ( dispatch ) => {\n\treturn async () => {\n\t\tawait getTemplateLessons( dispatch );\n\t};\n};\n\n\n/**\n * Makes a GET request to retrieve all chat rooms\n *\n * @param {Function} dispatch - dispatch function\n */\nexport const getRooms = async ( dispatch ) => {\n\ttry {\n\t\tconst res = await axios.get( server+'/get_open_rooms' );\n\t\tdispatch( retrievedRooms( res.data.rooms ) );\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a GET request to retrieve all chat rooms\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a GET request to retrieve all chat rooms\n */\nexport const getRoomsInjector = ( dispatch ) => {\n\treturn async () => {\n\t\tawait getRooms( dispatch );\n\t};\n};\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport { ADD_NOTIFICATION, ADD_ERROR_NOTIFICATION } from 'constants/action_types.js';\r\n\r\n\r\n// EXPORTS //\r\n\r\n/**\r\n * Dispatches an action object to add a notification.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} notification - Notification object\r\n */\r\nexport function addNotification( dispatch, notification ) {\r\n\tdispatch({\r\n\t\ttype: ADD_NOTIFICATION,\r\n\t\tpayload: notification\r\n\t});\r\n}\r\n\r\n/**\r\n * Returns a function to dispatch an action object to add a notification.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to dispatch action object to add a notification\r\n */\r\nexport const addNotificationInjector = dispatch => {\r\n\treturn notification => {\r\n\t\taddNotification( dispatch, notification );\r\n\t};\r\n};\r\n\r\n/**\r\n * Dispatches an action object to add an error notification.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Error} err - error object\r\n */\r\nexport function addErrorNotification( dispatch, err ) {\r\n\tlet msg;\r\n\tif ( err.response ) {\r\n\t\tmsg = 'Server response: ' + err.response.status + '.\\n';\r\n\t\tmsg += err.response.data;\r\n\t} else {\r\n\t\tmsg = err.message;\r\n\t}\r\n\tdispatch({\r\n\t\ttype: ADD_ERROR_NOTIFICATION,\r\n\t\tpayload: msg\r\n\t});\r\n}\r\n\r\n/**\r\n * Returns a function to dispatch an action object to add an error notification with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to dispatch action object to add an error notification\r\n */\r\nexport const addErrorNotificationInjector = dispatch => {\r\n\treturn message => {\r\n\t\taddErrorNotification( dispatch, message );\r\n\t};\r\n};\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\nimport axios from 'axios';\r\nimport server from 'constants/server';\r\nimport i18next from 'i18next';\r\nimport { addNotification, addErrorNotification } from 'actions/notification';\r\nimport { UPDATED_SETTINGS, UPDATED_TRANSLATIONS, GET_CUSTOM_TRANSLATIONS, GET_SETTINGS_PUBLIC, GET_SETTINGS } from 'constants/action_types.js';\r\n\r\n\r\n// EXPORTS //\r\n\r\n/**\r\n * Makes a GET request to the server to retrieve the server instance settings.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {void}\r\n */\r\nexport const getSettings = async ( dispatch ) => {\r\n\ttry {\r\n\t\tconst res = await axios.get( server+'/get_settings' );\r\n\t\tdispatch({\r\n\t\t\ttype: GET_SETTINGS,\r\n\t\t\tpayload: res.data\r\n\t\t});\r\n\t} catch ( err ) {\r\n\t\treturn addErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function to make a GET request to the server to retrieve the server instance settings with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make a GET request to the server to retrieve the server instance settings\r\n */\r\nexport const getSettingsInjector = dispatch => {\r\n\treturn async () => {\r\n\t\tawait getSettings( dispatch );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a GET request to the server to retrieve the server instance's public settings.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {void}\r\n */\r\nexport const getPublicSettings = async ( dispatch ) => {\r\n\ttry {\r\n\t\tconst res = await axios.get( server+'/get_public_settings' );\r\n\t\tdispatch({\r\n\t\t\ttype: GET_SETTINGS_PUBLIC,\r\n\t\t\tpayload: res.data\r\n\t\t});\r\n\t} catch ( err ) {\r\n\t\treturn addErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function to make a GET request to the server to retrieve the server instance's public settings with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make a GET request to the server to retrieve the server instance's public settings\r\n */\r\nexport const getPublicSettingsInjector = dispatch => {\r\n\treturn async () => {\r\n\t\tawait getPublicSettings( dispatch );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a POST request to the server to update a server instance setting.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {string} name - name of the setting to update\r\n * @param {string} value - value of the setting to update\r\n * @returns {void}\r\n */\r\nexport const updateSettings = async ( dispatch, name, value ) => {\r\n\ttry {\r\n\t\tconst res = await axios.post( server+'/update_settings', {\r\n\t\t\tname, value\r\n\t\t});\r\n\t\taddNotification( dispatch, {\r\n\t\t\ttitle: i18next.t('common:updated'),\r\n\t\t\tmessage: res.data.message,\r\n\t\t\tlevel: 'success'\r\n\t\t});\r\n\t\tdispatch({\r\n\t\t\ttype: UPDATED_SETTINGS,\r\n\t\t\tpayload: res.data\r\n\t\t});\r\n\t} catch ( err ) {\r\n\t\treturn addErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function to make a POST request to the server to update a server instance setting with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make a POST request to the server to update a server instance setting\r\n */\r\nexport const updateSettingsInjector = dispatch => {\r\n\treturn async ( name, value ) => {\r\n\t\tawait updateSettings( dispatch, name, value );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a POST request to the server to add a custom translation.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} translation - the translation to add\r\n * @param {string} translation.language - the locale of the translation\r\n * @param {string} translation.ns - the namespace of the translation\r\n * @param {string} translation.key - the translation's key\r\n * @param {string} translation.value - the translation's value\r\n * @returns {(Object|Error)} the translation added or an error\r\n */\r\nexport const addCustomTranslation = async ( dispatch, { language, ns, key, value }) => {\r\n\ttry {\r\n\t\tconst res = await axios.post( server+'/add_custom_translation', {\r\n\t\t\tlanguage, ns, key, value\r\n\t\t});\r\n\t\taddNotification( dispatch, {\r\n\t\t\ttitle: i18next.t('common:updated'),\r\n\t\t\tmessage: res.data.message,\r\n\t\t\tlevel: 'success'\r\n\t\t});\r\n\t\tdispatch({\r\n\t\t\ttype: UPDATED_TRANSLATIONS,\r\n\t\t\tpayload: res.data\r\n\t\t});\r\n\t\treturn res;\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t\treturn err;\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function to make a POST request to the server to add a custom translation with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make a POST request to the server to add a custom translation\r\n */\r\nexport const addCustomTranslationInjector = dispatch => {\r\n\treturn async ({ language, ns, key, value }) => {\r\n\t\tconst res = await addCustomTranslation( dispatch, { language, ns, key, value });\r\n\t\treturn res;\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a POST request to the server to get all custom translations.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {void}\r\n */\r\nexport const getCustomTranslations = async ( dispatch ) => {\r\n\ttry {\r\n\t\tconst res = await axios.get( server+'/get_translations' );\r\n\t\tdispatch({\r\n\t\t\ttype: GET_CUSTOM_TRANSLATIONS,\r\n\t\t\tpayload: res.data\r\n\t\t});\r\n\t} catch ( err ) {\r\n\t\treturn addErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function to make a POST request to the server to get all custom translations with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make a POST request to the server to get all custom translations\r\n */\r\nexport const getCustomTranslationsInjector = dispatch => {\r\n\treturn async () => {\r\n\t\tawait getCustomTranslations( dispatch );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a POST request to the server to remove a custom translation.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} translation - the translation to remove\r\n * @param {string} translation.language - the locale of the translation\r\n * @param {string} translation.ns - the namespace of the translation\r\n * @param {string} translation.key - the translation's key\r\n * @returns {(Object|Error)} the server response or an error\r\n */\r\nexport const removeCustomTranslation = async ( dispatch, { language, ns, key }) => {\r\n\ttry {\r\n\t\tconst res = await axios.post( server+'/remove_custom_translation', {\r\n\t\t\tlanguage, ns, key\r\n\t\t});\r\n\t\taddNotification( dispatch, {\r\n\t\t\ttitle: i18next.t('common:removed'),\r\n\t\t\tmessage: res.data.message,\r\n\t\t\tlevel: 'success'\r\n\t\t});\r\n\t\tdispatch({\r\n\t\t\ttype: UPDATED_TRANSLATIONS,\r\n\t\t\tpayload: res.data\r\n\t\t});\r\n\t\treturn res;\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t\treturn err;\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function to make a POST request to the server to remove a custom translation with a bound dispatch function.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make a POST request to the server to remove a custom translation\r\n */\r\nexport const removeCustomTranslationInjector = dispatch => {\r\n\treturn async ({ language, ns, key }) => {\r\n\t\tconst res = await removeCustomTranslation( dispatch, { language, ns, key });\r\n\t\treturn res;\r\n\t};\r\n};\r\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport axios from 'axios';\nimport logger from 'debug';\nimport qs from 'querystring';\nimport i18next from 'i18next';\nimport server from 'constants/server';\nimport { fetchCredentials } from 'actions/authentication.js';\nimport { getEnrollableCohorts } from 'actions/cohort.js';\nimport { addNotification, addErrorNotification } from 'actions/notification.js';\nimport { AUTHENTICATED, USER_PICTURE_MODIFIED, DELETED_USER, GET_USERS, LOGGED_IN, LOGGED_OUT, RECEIVED_TOKEN, REQUEST_TFA, USER_UPDATED, USER_UPDATED_BY_ADMIN } from 'constants/action_types.js';\n\n\n// VARIABLES //\n\nconst debug = logger( 'isle-dashboard:actions:user' );\n\n\n// EXPORTS //\n\n/**\n * Returns an action signaling that the user has been authenticated.\n *\n * @param {Object} user - user object\n * @returns {Object} action\n */\nexport function loggedIn( user ) {\n\treturn {\n\t\ttype: LOGGED_IN,\n\t\tpayload: {\n\t\t\temail: user.email,\n\t\t\tverifiedEmail: user.verifiedEmail,\n\t\t\tname: user.name,\n\t\t\tfirstName: user.firstName,\n\t\t\tlastName: user.lastName,\n\t\t\tpreferredName: user.preferredName,\n\t\t\tpronouns: user.pronouns,\n\t\t\tenrolledNamespaces: user.enrolledNamespaces,\n\t\t\townedNamespaces: user.ownedNamespaces,\n\t\t\torganization: user.organization,\n\t\t\twriteAccess: user.writeAccess,\n\t\t\tadministrator: user.administrator,\n\t\t\tlessonData: user.lessonData,\n\t\t\tpicture: user.picture,\n\t\t\tcreatedAt: user.createdAt,\n\t\t\tupdatedAt: user.updatedAt,\n\t\t\tscore: user.score,\n\t\t\tspentTime: user.spentTime,\n\t\t\tlicensed: user.licensed,\n\t\t\tcustomFields: user.customFields,\n\t\t\tavailableCustomFields: user.availableCustomFields,\n\t\t\ttwoFactorAuth: user.twoFactorAuth\n\t\t}\n\t};\n}\n\n/**\n * Returns an action signaling that the user has logged-in and a JSON web token has been received.\n *\n * @param {Object} options - function options\n * @param {string} options.token - JSON web token\n * @param {string} options.id - user id\n * @returns {Object} action\n */\nexport function receivedToken({ token, id }) {\n\treturn {\n\t\ttype: RECEIVED_TOKEN,\n\t\tpayload: {\n\t\t\ttoken,\n\t\t\tid\n\t\t}\n\t};\n}\n\n/**\n* Returns an action signaling that a request for a two-factor authentication token has been made.\n*\n* @param {Object} options - function options\n* @param {string} options.email - user email\n* @param {string} options.password - user password\n* @returns {Object} action\n*/\nexport function requestTFA({ email, password }) {\n\treturn {\n\t\ttype: REQUEST_TFA,\n\t\tpayload: {\n\t\t\temail,\n\t\t\tpassword\n\t\t}\n\t};\n}\n\n/**\n * Returns an action signaling that the user has been logged-out.\n *\n * @returns {Object} action\n */\nexport function loggedOut() {\n\treturn {\n\t\ttype: LOGGED_OUT\n\t};\n}\n\n/**\n * Returns an action signaling that the user has been authenticated.\n *\n * @returns {Object} action\n */\nexport function authenticated() {\n\treturn {\n\t\ttype: AUTHENTICATED\n\t};\n}\n\n/**\n * Returns an action signaling that the user's picture has been updated.\n *\n * @param {Object} picture - user picture\n * @returns {Object} action\n */\nexport function updateUserPicture( picture ) {\n\treturn {\n\t\ttype: USER_PICTURE_MODIFIED,\n\t\tpayload: {\n\t\t\tpicture\n\t\t}\n\t};\n}\n\n/**\n * Returns an action signaling that the user's name or organization has been updated.\n *\n * @param {Object} user - user object\n * @returns {Object} action\n */\nexport const updatedUser = ( user ) => {\n\treturn {\n\t\ttype: USER_UPDATED,\n\t\tpayload: user\n\t};\n};\n\n/**\n * Returns an action signaling that a user has been updated by an administrator.\n *\n * @param {Object} user - user object\n * @returns {Object} action\n */\nexport const updatedUserByAdmin = ( user ) => {\n\treturn {\n\t\ttype: USER_UPDATED_BY_ADMIN,\n\t\tpayload: user\n\t};\n};\n\n/**\n * Makes a GET request to the server to retrieve list of users.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {void}\n */\nexport const getUsers = async ( dispatch ) => {\n\ttry {\n\t\tconst res = await axios.get( server+'/get_users' );\n\t\tdispatch({\n\t\t\ttype: GET_USERS,\n\t\t\tpayload: {\n\t\t\t\tusers: res.data.users\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a GET request to the server to retrieve list of users with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a GET request to the server to retrieve list of users\n */\nexport const getUsersInjector = dispatch => {\n\treturn async () => {\n\t\tawait getUsers( dispatch );\n\t};\n};\n\n/**\n * Makes a POST request to the server to impersonate a user.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.id - user id\n * @param {string} options.password - user password\n */\nexport const impersonateUser = async ( dispatch, { id, password }) => {\n\tdebug( 'Impersonating user with id '+id );\n\ttry {\n\t\tconst res = await axios.post( server+'/impersonate', { id, password });\n\t\tconst user = await fetchCredentials( dispatch, {\n\t\t\tid: res.data.id\n\t\t});\n\t\t// Save user token to local storage:\n\t\tconst JWT = {\n\t\t\ttoken: res.data.token,\n\t\t\tid: res.data.id\n\t\t};\n\t\tconst userVal = 'ISLE_USER_' + server;\n\t\tlocalStorage.setItem( userVal, JSON.stringify( JWT ) );\n\t\tif ( user ) {\n\t\t\tgetEnrollableCohorts( dispatch, user );\n\t\t}\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to impersonate a user with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to the server to impersonate a user\n */\nexport const impersonateUserInjector = dispatch => {\n\treturn async ({ id, password }) => {\n\t\tawait impersonateUser( dispatch, { id, password } );\n\t};\n};\n\n/**\n * Makes a POST request to the server to delete a user.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.id - user id\n */\nexport const deleteUser = async ( dispatch, { id }) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/delete_user', { id });\n\t\taddNotification( dispatch, {\n\t\t\ttitle: i18next.t('common:deleted'),\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t\tdispatch({\n\t\t\ttype: DELETED_USER,\n\t\t\tpayload: {\n\t\t\t\tid\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to delete a user with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to the server to delete a user\n */\nexport const deleteUserInjector = dispatch => {\n\treturn async ({ id }) => {\n\t\tawait deleteUser( dispatch, { id } );\n\t};\n};\n\n/**\n * Makes POST requests to the server to upload a user's profile picture.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {Object} options.avatarData - user avatar picture data\n * @param {Object} options.thumbnailData - user thumbnail picture data\n */\nexport const uploadProfilePic = async ( dispatch, { avatarData, thumbnailData }) => {\n\ttry {\n\t\tlet res = await axios.post( server+'/upload_profile_pic', avatarData );\n\t\tconst message = res.data.message;\n\t\tlet filename = res.data.filename;\n\t\tfilename = server + '/avatar/' + filename;\n\t\tdispatch( updateUserPicture( filename ) );\n\n\t\tres = await axios.post( server+'/upload_thumbnail_pic', thumbnailData );\n\t\taddNotification( dispatch, {\n\t\t\ttitle: i18next.t('profile-pic-title'),\n\t\t\tmessage,\n\t\t\tlevel: 'success',\n\t\t\tposition: 'tl'\n\t\t});\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make POST requests to the server to upload a user's profile picture with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make POST requests to the server to upload a user's profile picture\n */\nexport const uploadProfilePicInjector = ( dispatch ) => {\n\treturn async ({ avatarData, thumbnailData }) => {\n\t\tawait uploadProfilePic( dispatch, { avatarData, thumbnailData });\n\t};\n};\n\n/**\n * Makes a POST request to the server to authenticate a user as an instructor.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.writeAccessToken - write access token to enable instructor access\n * @returns {boolean} true if the user is now an instructor, false otherwise\n */\nexport const authenticate = async ( dispatch, { writeAccessToken }) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/set_write_access', { token: writeAccessToken });\n\t\tdispatch( authenticated() );\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message+' You can now create your own courses on ISLE and have access to the gallery of public lessons.',\n\t\t\tlevel: 'success',\n\t\t\tautoDismiss: 10\n\t\t});\n\t\treturn true;\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t\treturn false;\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to authenticate a user as an instructor with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to the server to authenticate a user as an instructor\n */\nexport const authenticateInjector = ( dispatch ) => {\n\treturn async ({ writeAccessToken }) => {\n\t\tconst result = await authenticate( dispatch, { writeAccessToken });\n\t\treturn result;\n\t};\n};\n\n/**\n * Makes a POST request to the server to trigger an email to be sent to the user to change their password.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} options - request options\n * @param {string} options.email - user email\n */\nexport const forgotPassword = async ( dispatch, { email }) => {\n\ttry {\n\t\tawait axios.get( server+'/forgot_password?'+qs.stringify({ email }) );\n\t\taddNotification( dispatch, {\n\t\t\tmessage: 'Check your email inbox for a link to choose a new password.',\n\t\t\tlevel: 'success'\n\t\t});\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to trigger an email to be sent to the user to change their password with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to the server to trigger an email to be sent to the user to change their password\n */\nexport const forgotPasswordInjector = ( dispatch ) => {\n\treturn async ({ email }) => {\n\t\tawait forgotPassword( dispatch, { email });\n\t};\n};\n\n/**\n * Makes a POST request to the server to change a user's data.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} form - form data\n */\nexport const updateUser = async ( dispatch, form ) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/update_user', form );\n\t\tdispatch( updatedUser( form ) );\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to change a user's data with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to the server to change a user's data\n */\nexport const updateUserInjector = ( dispatch ) => {\n\treturn async ( form ) => {\n\t\tawait updateUser( dispatch, form );\n\t};\n};\n\n/**\n * Makes a POST request to the server to create a new user.\n *\n * @param {Object} form - form data\n * @returns {Promise} promise that resolves to the server response\n */\nexport const createUser = ( form ) => {\n\treturn axios.post( server+'/create_user', form );\n};\n\n/**\n * Makes a POST request to the server to login a user.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} form - form data\n * @returns {Object} server response\n */\nexport const handleLogin = async ( dispatch, form ) => {\n\tconst res = await axios.post( server+'/login', form );\n\tif ( res.data.message === 'finish-login-via-tfa' ) {\n\t\tdispatch( requestTFA( res.data ) );\n\t} else {\n\t\tdispatch( receivedToken( res.data ) );\n\t}\n\treturn res;\n};\n\n/**\n * Returns a function to make a POST request to the server to login a user with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to the server to login a user\n */\nexport const handleLoginInjector = ( dispatch ) => {\n\treturn async ( form ) => {\n\t\tconst result = await handleLogin( dispatch, form );\n\t\treturn result;\n\t};\n};\n\n/**\n * Makes a POST request to the server to login a user with a TFA code.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} form - form data\n * @returns {(Object|Error)} server response or an error if the TFA code is invalid\n */\nexport const handleLoginTFA = async ( dispatch, form ) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/login_tfa', form );\n\t\tdispatch( receivedToken( res.data ) );\n\t\treturn res;\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t\treturn err;\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to login a user with a TFA code with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to the server to login a user with a TFA code\n */\nexport const handleLoginTFAInjector = ( dispatch ) => {\n\treturn async ( form ) => {\n\t\tconst result = await handleLoginTFA( dispatch, form );\n\t\treturn result;\n\t};\n};\n\n/**\n * Restores a users' login session.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} user - user object\n */\nexport const restoreLogin = ( dispatch, user ) => {\n\tdispatch( loggedIn( user ) );\n};\n\n/**\n * Returns a function to restore a users' login session with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to restore a users' login session\n */\nexport const restoreLoginInjector = ( dispatch ) => {\n\treturn ( user ) => {\n\t\trestoreLogin( dispatch, user );\n\t};\n};\n\n/**\n * Logs a user out.\n *\n * @param {Function} dispatch - dispatch function\n */\nexport const logout = async ( dispatch ) => {\n\tdebug( 'Logging out the current user...' );\n\ttry {\n\t\tawait axios.post( server+'/invalidate_session' );\n\t} catch ( err ) {\n\t\tdebug( err.message );\n\t}\n\tlocalStorage.removeItem( 'ISLE_USER_'+server );\n\tdispatch( loggedOut() );\n};\n\n/**\n * Returns a function to log a user out with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to log a user out\n */\nexport const logoutInjector = ( dispatch ) => {\n\treturn () => {\n\t\tlogout( dispatch );\n\t};\n};\n\n/**\n * Makes a GET request to the server to check whether a user's locally stored data has to be updated.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} user - user object\n */\nexport const userUpdateCheck = async ( dispatch, user ) => {\n\ttry {\n\t\tconst res = await axios.get( server+'/user_update_check?'+qs.stringify({\n\t\t\tupdatedAt: user.updatedAt\n\t\t}) );\n\t\tdebug( 'Received response: '+res.data );\n\t\tif ( !res.data.hasMostRecent ) {\n\t\t\tconst res = await axios.post( server+'/credentials_dashboard', {\n\t\t\t\tid: user.id\n\t\t\t});\n\t\t\tlet newUser = res.data;\n\t\t\tif ( newUser.picture ) {\n\t\t\t\tnewUser.picture = server + '/avatar/' + newUser.picture;\n\t\t\t}\n\t\t\tnewUser = {\n\t\t\t\tid: user.id,\n\t\t\t\ttoken: user.token,\n\t\t\t\t...newUser\n\t\t\t};\n\t\t\tdebug( 'Updated user data...' );\n\t\t\tdispatch( loggedIn( newUser ) );\n\t\t}\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a GET request to the server to check whether a user's locally stored data has to be updated with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a GET request to the server to check whether a user's locally stored data has to be updated\n */\nexport const userUpdateCheckInjector = ( dispatch ) => {\n\treturn async ( user ) => {\n\t\tawait userUpdateCheck( dispatch, user );\n\t};\n};\n\n/**\n * Makes a POST request to the server to confirm a user's email address.\n *\n * @param {string} token - user token\n * @returns {string} server response message or error message\n */\nexport const confirmEmail = async ( token ) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/confirm_email', {\n\t\t\ttoken\n\t\t});\n\t\treturn res.data.message;\n\t} catch ( err ) {\n\t\tif ( err.response && err.response.data ) {\n\t\t\treturn err.response.data;\n\t\t}\n\t\treturn err.message;\n\t}\n};\n\n/**\n * Make a POST request to the server to trigger a new email for confirming a user's email address.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} user - user object\n */\nexport const resendConfirmEmail = async ( dispatch, user ) => {\n\ttry {\n\t\tawait axios.post( server+'/resend_confirm_email' );\n\t\taddNotification( dispatch, {\n\t\t\ttitle: 'Email sent',\n\t\t\tmessage: i18next.t('common:verification-email-sent'),\n\t\t\tlevel: 'success',\n\t\t\tposition: 'tl'\n\t\t});\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to trigger a new email for confirming a user's email address with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to the server to trigger a new email for confirming a user's email address\n */\nexport const resendConfirmEmailInjector = ( dispatch ) => {\n\treturn async ( user ) => {\n\t\tawait resendConfirmEmail( dispatch, user );\n\t};\n};\n\n/**\n * Makes a POST request to the server by an administrator to update an arbitrary user's data.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} form - form object with new user data\n * @param {string} [form.password] - user password\n * @param {boolean} [form.writeAccess] - boolean indicating whether the user should have instructor access\n * @param {boolean} [form.administrator] - boolean indicating whether the user should be an administrator\n * @param {boolean} [form.twoFactorAuth] - boolean indicating whether the user should have two factor authentication enabled\n * @param {boolean} [form.loginWithoutPassword] - boolean indicating whether the user should be able to login without a password\n * @param {string} [form.name] - user name\n * @param {string} [form.organization] - user organization\n * @param {Object} [form.customFields] - user custom fields\n */\nexport const adminUpdateUser = async ( dispatch, form ) => {\n\ttry {\n\t\tconst res = await axios.post( server+'/admin_update_user', form );\n\t\taddNotification( dispatch, {\n\t\t\tmessage: res.data.message,\n\t\t\tlevel: 'success'\n\t\t});\n\t\tdispatch( updatedUserByAdmin( form ) );\n\t} catch ( err ) {\n\t\taddErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server by an administrator to update an arbitrary user's data with a bound dispatch function.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to make a POST request to the server by an administrator to update an arbitrary user's data\n */\nexport const adminUpdateUserInjector = ( dispatch ) => {\n\treturn async ( form ) => {\n\t\tawait adminUpdateUser( dispatch, form );\n\t};\n};\n","/**\r\n* The MIT License (MIT)\r\n*\r\n* Copyright (c) 2015 Tobias Ahlin\r\n*\r\n* Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n* this software and associated documentation files (the \"Software\"), to deal in\r\n* the Software without restriction, including without limitation the rights to\r\n* use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n* the Software, and to permit persons to whom the Software is furnished to do so,\r\n* subject to the following conditions:\r\n*\r\n* The above copyright notice and this permission notice shall be included in all\r\n* copies or substantial portions of the Software.\r\n*\r\n* THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n* FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n* COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n* IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n* CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\n\r\n\r\n// MAIN //\r\n\r\nconst Spinner = ({ className }) => {\r\n\treturn ( <div className={`sk-cube-grid ${className}`} >\r\n\t\t<div className=\"sk-cube sk-cube1\"></div>\r\n\t\t<div className=\"sk-cube sk-cube2\"></div>\r\n\t\t<div className=\"sk-cube sk-cube3\"></div>\r\n\t\t<div className=\"sk-cube sk-cube4\"></div>\r\n\t\t<div className=\"sk-cube sk-cube5\"></div>\r\n\t\t<div className=\"sk-cube sk-cube6\"></div>\r\n\t\t<div className=\"sk-cube sk-cube7\"></div>\r\n\t\t<div className=\"sk-cube sk-cube8\"></div>\r\n\t\t<div className=\"sk-cube sk-cube9\"></div>\r\n\t</div> );\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default Spinner;\r\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// EXPORTS //\n\nexport const ADD_ENROLLED_NAMESPACE = 'ADD_ENROLLED_NAMESPACE';\nexport const ADD_ERROR_NOTIFICATION = 'ADD_ERROR_NOTIFICATION';\nexport const ADD_NOTIFICATION = 'ADD_NOTIFICATION';\nexport const APPEND_CREATED_NAMESPACE = 'APPEND_CREATED_NAMESPACE';\nexport const AUTHENTICATED = 'AUTHENTICATED';\nexport const CHANGED_NAMESPACE = 'CHANGED_NAMESPACE';\nexport const COMPUTED_COMPLETIONS = 'COMPUTED_COMPLETIONS';\nexport const CREATED_ANNOUNCEMENT = 'CREATED_ANNOUNCEMENT';\nexport const CREATED_CUSTOM_FIELD = 'CREATED_CUSTOM_FIELD';\nexport const CREATED_BACKUP = 'CREATED_BACKUP';\nexport const CREATED_METRIC = 'CREATED_METRIC';\nexport const CREATED_ROLE = 'CREATED_ROLE';\nexport const CREATED_TICKET = 'CREATED_TICKET';\nexport const DELETED_BACKUP = 'DELETED_BACKUP';\nexport const DELETED_CURRENT_NAMESPACE = 'DELETED_CURRENT_NAMESPACE';\nexport const DELETED_CUSTOM_FIELD = 'DELETED_CUSTOM_FIELD';\nexport const DELETED_EVENT = 'DELETED_EVENT';\nexport const DELETED_FILE = 'DELETED_FILE';\nexport const DELETED_LESSON = 'DELETED_LESSON';\nexport const DELETED_METRIC = 'DELETED_METRIC';\nexport const DELETED_PROGRAM = 'DELETED_PROGRAM';\nexport const DELETED_ROLE = 'DELETED_ROLE';\nexport const DELETED_TICKET = 'DELETED_TICKET';\nexport const DELETED_USER = 'DELETED_USER';\nexport const DELETED_ANNOUNCEMENT = 'DELETED_ANNOUNCEMENT';\nexport const DISABLED_TFA = 'DISABLED_TFA';\nexport const EDITED_ANNOUNCEMENT = 'EDITED_ANNOUNCEMENT';\nexport const ENABLED_TFA = 'ENABLED_TFA';\nexport const FIELD_POSITION_DECREMENTED = 'FIELD_POSITION_DECREMENTED';\nexport const FIELD_POSITION_INCREMENTED = 'FIELD_POSITION_INCREMENTED';\nexport const GET_ALL_COHORTS = 'GET_ALL_COHORTS';\nexport const GET_ALL_FILES = 'GET_ALL_FILES';\nexport const GET_ALL_LESSONS = 'GET_ALL_LESSONS';\nexport const GET_ALL_NAMESPACES = 'GET_ALL_NAMESPACES';\nexport const GET_ALL_PROGRAMS = 'GET_ALL_PROGRAMS';\nexport const GET_ALL_ROLES = 'GET_ALL_ROLES';\nexport const GET_BACKUPS = 'GET_BACKUPS';\nexport const GET_EVENTS = 'GET_EVENTS';\nexport const GET_ALL_TICKETS = 'GET_ALL_TICKETS';\nexport const GET_COMPLETION_LESSON_REFS = 'GET_COMPLETION_LESSON_REFS';\nexport const GET_COMPLETION_TAGS = 'GET_COMPLETION_TAGS';\nexport const GET_COMPLETION_COMPONENTS = 'GET_COMPLETION_COMPONENTS';\nexport const GET_COURSE_TICKETS = 'GET_COURSE_TICKETS';\nexport const GET_CUSTOM_FIELDS = 'GET_CUSTOM_FIELDS';\nexport const GET_CUSTOM_TRANSLATIONS = 'GET_CUSTOM_TRANSLATIONS';\nexport const GET_OVERVIEW_STATISTICS = 'GET_OVERVIEW_STATISTICS';\nexport const GET_HISTORICAL_OVERVIEW_STATISTICS = 'GET_HISTORICAL_OVERVIEW_STATISTICS';\nexport const GET_REQUEST_STATISTICS = 'GET_REQUEST_STATISTICS';\nexport const GET_ROOMS = 'GET_ROOMS';\nexport const GET_SETTINGS = 'GET_SETTINGS';\nexport const GET_SETTINGS_PUBLIC = 'GET_SETTINGS_PUBLIC';\nexport const GET_TEMPLATE_LESSONS = 'GET_TEMPLATE_LESSONS';\nexport const GET_TFA_QRCODE = 'GET_TFA_QRCODE';\nexport const GET_USERS = 'GET_USERS';\nexport const GET_USER_TICKETS = 'GET_USER_TICKETS';\nexport const LESSON_ORDER = 'LESSON_ORDER';\nexport const LESSON_ORDER_DIRECTION = 'LESSON_ORDER_DIRECTION';\nexport const RECEIVED_FILES = 'RECEIVED_FILES';\nexport const RECEIVED_LICENSE = 'RECEIVED_LICENSE';\nexport const RECEIVED_NAMESPACE_FILES = 'RECEIVED_NAMESPACE_FILES';\nexport const RECEIVED_TOKEN = 'RECEIVED_TOKEN';\nexport const REMOVED_LICENSE = 'REMOVED_LICENSE';\nexport const REQUEST_TFA = 'REQUEST_TFA';\nexport const RETRIEVED_BADGES = 'RETRIEVED_BADGES';\nexport const RETRIEVED_COHORTS = 'RETRIEVED_COHORTS';\nexport const RETRIEVED_COMPLETION_RULES = 'RETRIEVED_COMPLETION_RULES';\nexport const RETRIEVED_LESSONS = 'RETRIEVED_LESSONS';\nexport const RETRIEVED_PUBLIC_LESSONS = 'RETRIEVED_PUBLIC_LESSONS';\nexport const SAVED_LESSON_METRICS = 'SAVED_LESSON_METRICS';\nexport const SEARCH_PHRASE_SET = 'SEARCH_PHRASE_SET';\nexport const TICKET_CLOSED = 'TICKET_CLOSED';\nexport const TICKET_OPENED = 'TICKET_OPENED';\nexport const TICKET_MESSAGE_ADDED = 'TICKET_MESSAGE_ADDED';\nexport const TICKET_PRIORITY_UPDATED = 'TICKET_PRIORITY_UPDATED';\nexport const TRIGGERED_EVENT = 'TRIGGERED_EVENT';\nexport const UPDATED_LESSON = 'UPDATED_LESSON';\nexport const UPDATED_METRIC = 'UPDATED_METRIC';\nexport const UPDATED_OWNED_NAMESPACE = 'UPDATED_OWNED_NAMESPACE';\nexport const LOGGED_IN = 'LOGGED_IN';\nexport const LOGGED_OUT = 'LOGGED_OUT';\nexport const USER_UPDATED = 'USER_UPDATED';\nexport const USER_UPDATED_BY_ADMIN = 'USER_UPDATED_BY_ADMIN';\nexport const USER_PICTURE_MODIFIED = 'USER_PICTURE_MODIFIED';\nexport const USER_RECEIVED_BADGES = 'USER_RECEIVED_BADGES';\nexport const UPDATED_CUSTOM_FIELD = 'UPDATED_CUSTOM_FIELD';\nexport const UPDATED_ROLE = 'UPDATED_ROLE';\nexport const UPDATED_SETTINGS = 'UPDATED_SETTINGS';\nexport const UPDATED_STUDENT_PROGRESS = 'UPDATED_STUDENT_PROGRESS';\nexport const UPDATED_TRANSLATIONS = 'UPDATED_TRANSLATIONS';\nexport const RETRIEVED_ENROLLABLE_COHORTS = 'RETRIEVED_ENROLLABLE_COHORTS';\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// EXPORTS //\r\n\r\nexport const LANGUAGES = [\r\n\t{ value: 'en', label: 'english' },\r\n\t{ value: 'bg', label: 'bulgarian' },\r\n\t{ value: 'cs', label: 'czech' },\r\n\t{ value: 'da', label: 'danish' },\r\n\t{ value: 'de', label: 'german' },\r\n\t{ value: 'el', label: 'greek' },\r\n\t{ value: 'es', label: 'spanish' },\r\n\t{ value: 'et', label: 'estonian' },\r\n\t{ value: 'fi', label: 'finnish' },\r\n\t{ value: 'fr', label: 'french' },\r\n\t{ value: 'hu', label: 'hungarian' },\r\n\t{ value: 'it', label: 'italian' },\r\n\t{ value: 'ja', label: 'japanese' },\r\n\t{ value: 'lt', label: 'lithuanian' },\r\n\t{ value: 'lv', label: 'latvian' },\r\n\t{ value: 'nl', label: 'dutch' },\r\n\t{ value: 'pl', label: 'polish' },\r\n\t{ value: 'pt', label: 'portuguese' },\r\n\t{ value: 'ro', label: 'romanian' },\r\n\t{ value: 'ru', label: 'russian' },\r\n\t{ value: 'sk', label: 'slovak' },\r\n\t{ value: 'sl', label: 'slovenian' },\r\n\t{ value: 'sv', label: 'swedish' },\r\n\t{ value: 'zh', label: 'chinese' }\r\n];\r\n\r\nexport const LANGUAGE_CODES = [ 'en', 'bg', 'cs', 'da', 'de', 'el', 'es', 'et', 'fi', 'fr', 'hu', 'it', 'ja', 'lt', 'lv', 'nl', 'pl', 'pt', 'ro', 'ru', 'sk', 'sl', 'sv', 'zh' ];\r\n\r\nexport const languageLabel = ( code ) => {\r\n\tswitch ( code ) {\r\n\tcase 'en':\r\n\tdefault:\r\n\t\treturn 'english';\r\n\tcase 'bg':\r\n\t\treturn 'bulgarian';\r\n\tcase 'cs':\r\n\t\treturn 'czech';\r\n\tcase 'da':\r\n\t\treturn 'danish';\r\n\tcase 'de':\r\n\t\treturn 'german';\r\n\tcase 'el':\r\n\t\treturn 'greek';\r\n\tcase 'es':\r\n\t\treturn 'spanish';\r\n\tcase 'et':\r\n\t\treturn 'estonian';\r\n\tcase 'fi':\r\n\t\treturn 'finnish';\r\n\tcase 'fr':\r\n\t\treturn 'french';\r\n\tcase 'hu':\r\n\t\treturn 'hungarian';\r\n\tcase 'it':\r\n\t\treturn 'italian';\r\n\tcase 'ja':\r\n\t\treturn 'japanese';\r\n\tcase 'lt':\r\n\t\treturn 'lithuanian';\r\n\tcase 'lv':\r\n\t\treturn 'latvian';\r\n\tcase 'nl':\r\n\t\treturn 'dutch';\r\n\tcase 'pl':\r\n\t\treturn 'polish';\r\n\tcase 'pt':\r\n\t\treturn 'portuguese';\r\n\tcase 'ro':\r\n\t\treturn 'romanian';\r\n\tcase 'ru':\r\n\t\treturn 'russian';\r\n\tcase 'sk':\r\n\t\treturn 'slovak';\r\n\tcase 'sl':\r\n\t\treturn 'slovenian';\r\n\tcase 'sv':\r\n\t\treturn 'swedish';\r\n\tcase 'zh':\r\n\t\treturn 'chinese';\r\n\t}\r\n};\r\n\r\n/**\r\n* Returns the language description for a given language code.\r\n*\r\n* @param {string} code - the language code\r\n* @returns {string} the language description\r\n*/\r\nexport const languageDescription = ( code ) => {\r\n\tswitch ( code ) {\r\n\tcase 'en':\r\n\tdefault:\r\n\t\treturn 'English - EN';\r\n\tcase 'bg':\r\n\t\treturn 'Български - BG';\r\n\tcase 'cs':\r\n\t\treturn 'Česky - CS';\r\n\tcase 'da':\r\n\t\treturn 'Dansk - DA';\r\n\tcase 'el':\r\n\t\treturn 'Ελληνική - EL';\r\n\tcase 'es':\r\n\t\treturn 'Español - ES';\r\n\tcase 'et':\r\n\t\treturn 'Eesti - ET';\r\n\tcase 'de':\r\n\t\treturn 'Deutsch - DE';\r\n\tcase 'fi':\r\n\t\treturn 'Suomalainen - FI';\r\n\tcase 'fr':\r\n\t\treturn 'Français - FR';\r\n\tcase 'hu':\r\n\t\treturn 'Hungarian - HU';\r\n\tcase 'it':\r\n\t\treturn 'Italiano - IT';\r\n\tcase 'ja':\r\n\t\treturn 'にほんご - JA';\r\n\tcase 'lt':\r\n\t\treturn 'Lietuvių kalba - LT';\r\n\tcase 'lv':\r\n\t\treturn 'Latviešu - LV';\r\n\tcase 'nl':\r\n\t\treturn 'Nederlands - NL';\r\n\tcase 'pl':\r\n\t\treturn 'Polski - PL';\r\n\tcase 'pt':\r\n\t\treturn 'Porgtugês - PT';\r\n\tcase 'ro':\r\n\t\treturn 'Românesc - RO';\r\n\tcase 'ru':\r\n\t\treturn 'русский - RU';\r\n\tcase 'sk':\r\n\t\treturn 'Slovenská - SK';\r\n\tcase 'sl':\r\n\t\treturn 'Slovenski - SL';\r\n\tcase 'sv':\r\n\t\treturn 'Svenska - SV';\r\n\tcase 'zh':\r\n\t\treturn '中文 - ZH';\r\n\t}\r\n};\r\n\r\nexport default LANGUAGES;\r\n","\r\n/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport serverJSON from './../../config/server.json';\r\n\r\n\r\n// VARIABLES //\r\n\r\nexport const REMOTE = serverJSON.publicUrl;\r\nexport const LOCAL = 'http://localhost:17777';\r\n\r\n\r\n// MAIN //\r\n\r\nlet server;\r\nif ( process.env.NODE_ENV === 'development' ) { // eslint-disable-line no-process-env\r\n\tserver = process.env.REACT_APP_SERVER === 'remote' ? REMOTE : LOCAL; // eslint-disable-line no-process-env\r\n} else {\r\n\tserver = window.location.origin;\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default server;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport axios from 'axios';\r\nimport i18next from './i18n';\r\nimport { store } from './../index.js';\r\n\r\n\r\n// MAIN //\r\n\r\naxios.interceptors.request.use( ( config ) => {\r\n\tconfig.headers[ 'Accept-Language' ] = i18next.language;\r\n\tconst state = store.getState();\r\n\tconst token = state.user.token;\r\n\tif ( token ) {\r\n\t\tconfig.headers.Authorization = `JWT ${token}`;\r\n\t}\r\n\treturn config;\r\n});\r\n\r\nconst namespaceClient = axios.create();\r\nnamespaceClient.interceptors.request.use( ( config ) => {\r\n\tconfig.headers[ 'Accept-Language' ] = i18next.language;\r\n\tconst state = store.getState();\r\n\tconst token = state.user.token;\r\n\tif ( token ) {\r\n\t\tconfig.headers.Authorization = `JWT ${token}`;\r\n\t}\r\n\tconfig.headers[ 'X-Context-Level' ] = 'namespace';\r\n\r\n\tconst target = config.data.namespaceID || config.params.namespaceID || state.namespace._id;\r\n\tconfig.headers[ 'X-Context-Target' ] = target;\r\n\treturn config;\r\n});\r\n\r\nconst programClient = axios.create();\r\n\r\nconst lessonClient = axios.create();\r\nlessonClient.interceptors.request.use( ( config ) => {\r\n\tconfig.headers[ 'Accept-Language' ] = i18next.language;\r\n\tconst state = store.getState();\r\n\tconst token = state.user.token;\r\n\tif ( token ) {\r\n\t\tconfig.headers.Authorization = `JWT ${token}`;\r\n\t}\r\n\tconfig.headers[ 'X-Context-Level' ] = 'lesson';\r\n\r\n\tlet target = config.data.lessonID || config.params.lessonID;\r\n\ttarget += state.namespace._id;\r\n\tconfig.headers[ 'X-Context-Target' ] = target;\r\n\r\n\treturn config;\r\n});\r\n\r\nconst globalClient = axios.create();\r\nglobalClient.interceptors.request.use( ( config ) => {\r\n\tconfig.headers[ 'Accept-Language' ] = i18next.language;\r\n\tconst token = store.getState().user.token;\r\n\tif ( token ) {\r\n\t\tconfig.headers.Authorization = `JWT ${token}`;\r\n\t}\r\n\tconfig.headers[ 'X-Context-Level' ] = 'global';\r\n\tconfig.headers[ 'X-Context-Target' ] = true;\r\n\treturn config;\r\n});\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport const namespaceAxios = namespaceClient;\r\nexport const programAxios = programClient;\r\nexport const lessonAxios = lessonClient;\r\nexport const globalAxios = globalClient;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport i18n from 'i18next';\r\nimport { initReactI18next } from 'react-i18next';\r\nimport LanguageDetector from 'i18next-browser-languagedetector';\r\nimport HttpApi from 'i18next-http-backend/cjs';\r\nimport Backend from 'i18next-chained-backend';\r\nimport server from 'constants/server';\r\nimport { store } from './../index.js';\r\n\r\n\r\n// MAIN //\r\n\r\ni18n.use( Backend )\r\n\t.use( LanguageDetector )\r\n\t.use( initReactI18next )\r\n\t.init({\r\n\t\tdebug: false,\r\n\t\tlng: localStorage.getItem( 'i18nextLng' ) || 'en',\r\n\t\tfallbackLng: 'en',\r\n\t\treturnEmptyString: false,\r\n\t\tbackend: {\r\n\t\t\tbackends: [\r\n\t\t\t\tHttpApi,\r\n\t\t\t\tHttpApi,\r\n\t\t\t\tHttpApi\r\n\t\t\t],\r\n\t\t\tbackendOptions: [\r\n\t\t\t\t{\r\n\t\t\t\t\tloadPath: server+'/dashboard/locales/{{lng}}/{{ns}}.json'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tloadPath: server+'/locales/{{lng}}/{{ns}}.json'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tloadPath: 'https://cdn.jsdelivr.net/npm/@isle-project/locales/components/{{ns}}/{{lng}}.json'\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\treact: {\r\n\t\t\tuseSuspense: false\r\n\t\t},\r\n\t\tinterpolation: {\r\n\t\t\tescapeValue: false // Not needed for React!\r\n\t\t}\r\n\t});\r\n\r\n\r\ni18n.store.on( 'added', function onLoaded( lng, ns ) {\r\n\tconst state = store.getState();\r\n\tconst translations = state.translations;\r\n\tconst custom = translations[ lng ][ ns ];\r\n\tif ( custom ) {\r\n\t\tconst keys = Object.keys( custom );\r\n\t\tif ( !i18n.store.data[ lng ][ ns+'_ORIGINAL' ] ) {\r\n\t\t\ti18n.store.data[ lng ][ ns+'_ORIGINAL' ] = {};\r\n\t\t}\r\n\t\tfor ( let i = 0; i < keys.length; i++ ) {\r\n\t\t\ti18n.store.data[ lng ][ ns+'_ORIGINAL' ][ keys[ i ] ] = i18n.store.data[ lng ][ ns ][ keys[ i ] ];\r\n\t\t\ti18n.store.data[ lng ][ ns ][ keys[ i ] ] = custom[ keys[ i ] ];\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default i18n;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport { useEffect } from 'react';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n * A custom React hook that calls `useEffect` with a callback that is invoked once when the component is mounted.\r\n *\r\n * @param {Function} callback - callback to invoke once the component has mounted\r\n * @returns {void}\r\n */\r\nconst useMountEffect = ( callback ) => useEffect( callback, [] ); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default useMountEffect;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport objectKeys from '@stdlib/utils/keys';\r\nimport * as types from 'constants/action_types.js';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst initialState = {\r\n\tcohorts: [],\r\n\tevents: [],\r\n\tfiles: [],\r\n\tlessons: [],\r\n\tlessonsMap: {},\r\n\tnamespaces: [],\r\n\tprograms: [],\r\n\troles: [],\r\n\trooms: [],\r\n\ttickets: [],\r\n\tusers: [],\r\n\tstatistics: {},\r\n\trequestStatistics: [],\r\n\thistoricalStatistics: [],\r\n\tbackups: [],\r\n\tlicense: null,\r\n\tsettings: {}\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default function admin( state = initialState, action ) {\r\n\tswitch ( action.type ) {\r\n\tcase types.GET_USERS: {\r\n\t\tlet users = action.payload.users;\r\n\t\tusers = users.map( x => {\r\n\t\t\tconst keys = objectKeys( x.lessonData );\r\n\t\t\tlet chatMessages = 0;\r\n\t\t\tlet nActions = 0;\r\n\t\t\tfor ( let i = 0; i < keys.length; i++ ) {\r\n\t\t\t\tconst key = keys[ i ];\r\n\t\t\t\tchatMessages += x.lessonData[ key ].chatMessages;\r\n\t\t\t\tconst types = objectKeys( x.lessonData[ key ].actionTypes );\r\n\t\t\t\tfor ( let j = 0; j < types.length; j++ ) {\r\n\t\t\t\t\tnActions += x.lessonData[ key ].actionTypes[ types[ j ] ];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tx.nActions = nActions;\r\n\t\t\tx.chatMessages = chatMessages;\r\n\t\t\tx.createdAt = new Date( x.createdAt );\r\n\t\t\tx.updatedAt = new Date( x.updatedAt );\r\n\t\t\treturn x;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tusers\r\n\t\t});\r\n\t}\r\n\tcase types.GET_ALL_COHORTS: {\r\n\t\tlet cohorts = action.payload.cohorts;\r\n\t\tcohorts = cohorts.map( x => {\r\n\t\t\tx.startDate = new Date( x.startDate );\r\n\t\t\tx.endDate = new Date( x.endDate );\r\n\t\t\treturn x;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tcohorts\r\n\t\t});\r\n\t}\r\n\tcase types.GET_ALL_FILES: {\r\n\t\tlet files = action.payload.files;\r\n\t\tfiles = files.map( x => {\r\n\t\t\tx.updatedAt = new Date( x.updatedAt );\r\n\t\t\treturn x;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tfiles\r\n\t\t});\r\n\t}\r\n\tcase types.DELETED_FILE: {\r\n\t\tconst files = state.files.filter( x => x._id !== action.payload.id );\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tfiles\r\n\t\t});\r\n\t}\r\n\tcase types.GET_ALL_LESSONS: {\r\n\t\tlet lessons = action.payload.lessons;\r\n\t\tconst lessonsMap = { ...state.lessonsMap };\r\n\t\tlessons = lessons.map( x => {\r\n\t\t\tx.createdAt = new Date( x.createdAt );\r\n\t\t\tx.updatedAt = new Date( x.updatedAt );\r\n\t\t\tlessonsMap[ x._id ] = x.title;\r\n\t\t\treturn x;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tlessons,\r\n\t\t\tlessonsMap\r\n\t\t});\r\n\t}\r\n\tcase types.GET_ALL_NAMESPACES: {\r\n\t\tlet namespaces = action.payload.namespaces;\r\n\t\tnamespaces = namespaces.map( x => {\r\n\t\t\tx.createdAt = new Date( x.createdAt );\r\n\t\t\tx.updatedAt = new Date( x.updatedAt );\r\n\t\t\treturn x;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tnamespaces\r\n\t\t});\r\n\t}\r\n\tcase types.GET_ALL_PROGRAMS: {\r\n\t\tlet programs = action.payload.programs;\r\n\t\tprograms = programs.map( x => {\r\n\t\t\tx.createdAt = new Date( x.createdAt );\r\n\t\t\tx.updatedAt = new Date( x.updatedAt );\r\n\t\t\treturn x;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tprograms\r\n\t\t});\r\n\t}\r\n\tcase types.GET_EVENTS: {\r\n\t\tlet events = action.payload.events;\r\n\t\tevents = events.map( x => {\r\n\t\t\tx.time = new Date( x.time );\r\n\t\t\treturn x;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tevents\r\n\t\t});\r\n\t}\r\n\tcase types.GET_ROOMS: {\r\n\t\tlet rooms = action.payload.rooms;\r\n\t\trooms = rooms.map( x => {\r\n\t\t\tx.startTime = new Date( x.startTime );\r\n\t\t\treturn x;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\trooms\r\n\t\t});\r\n\t}\r\n\tcase types.DELETED_EVENT: {\r\n\t\tconst events = state.events.filter( x => x._id !== action.payload.id );\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tevents\r\n\t\t});\r\n\t}\r\n\tcase types.DELETED_USER: {\r\n\t\tconst users = state.users.filter( x => x._id !== action.payload.id );\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tusers\r\n\t\t});\r\n\t}\r\n\tcase types.DELETED_PROGRAM: {\r\n\t\tconst programs = state.programs.filter( x => x._id !== action.payload.id );\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tprograms\r\n\t\t});\r\n\t}\r\n\tcase types.TRIGGERED_EVENT: {\r\n\t\tconst events = state.events.slice();\r\n\t\tfor ( let i = 0; i < events.length; i++ ) {\r\n\t\t\tif ( events[ i ]._id === action.payload.id ) {\r\n\t\t\t\tevents[ i ].done = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tevents\r\n\t\t});\r\n\t}\r\n\tcase types.USER_UPDATED_BY_ADMIN: {\r\n\t\tlet users = state.users.slice();\r\n\t\tfor ( let i = 0; i < users.length; i++ ) {\r\n\t\t\tconst user = users[ i ];\r\n\t\t\tif ( user._id === action.payload.id ) {\r\n\t\t\t\tconst keys = objectKeys( action.payload );\r\n\t\t\t\tfor ( let j = 0; j < keys.length; j++ ) {\r\n\t\t\t\t\tconst key = keys[ j ];\r\n\t\t\t\t\tif ( key !== 'id' ) {\r\n\t\t\t\t\t\tuser[ key ] = action.payload[ key ];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tusers\r\n\t\t});\r\n\t}\r\n\tcase types.GET_OVERVIEW_STATISTICS: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tstatistics: action.payload.statistics\r\n\t\t});\r\n\t}\r\n\tcase types.GET_ALL_TICKETS: {\r\n\t\tlet tickets = action.payload.tickets;\r\n\t\ttickets = tickets.map( x => {\r\n\t\t\tx.createdAt = new Date( x.createdAt );\r\n\t\t\tx.updatedAt = new Date( x.updatedAt );\r\n\t\t\treturn x;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttickets\r\n\t\t});\r\n\t}\r\n\tcase types.DELETED_TICKET: {\r\n\t\tconst tickets = state.tickets.filter( x => x._id !== action.payload.id );\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttickets\r\n\t\t});\r\n\t}\r\n\tcase types.TICKET_OPENED: {\r\n\t\tconst tickets = state.tickets.map( ticket => {\r\n\t\t\tif ( ticket._id === action.payload.id ) {\r\n\t\t\t\tticket.done = false;\r\n\t\t\t}\r\n\t\t\treturn ticket;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttickets\r\n\t\t});\r\n\t}\r\n\tcase types.TICKET_PRIORITY_UPDATED: {\r\n\t\tconst tickets = state.tickets.map( ticket => {\r\n\t\t\tif ( ticket._id === action.payload.id ) {\r\n\t\t\t\tticket.priority = action.payload.priority;\r\n\t\t\t}\r\n\t\t\treturn ticket;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttickets\r\n\t\t});\r\n\t}\r\n\tcase types.TICKET_CLOSED: {\r\n\t\tconst tickets = state.tickets.map( ticket => {\r\n\t\t\tif ( ticket._id === action.payload.id ) {\r\n\t\t\t\tticket.done = true;\r\n\t\t\t}\r\n\t\t\treturn ticket;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttickets\r\n\t\t});\r\n\t}\r\n\tcase types.TICKET_MESSAGE_ADDED: {\r\n\t\tconst tickets = state.tickets.map( ticket => {\r\n\t\t\tif ( ticket._id === action.payload.id ) {\r\n\t\t\t\tconst message = action.payload.message;\r\n\t\t\t\tmessage.picture = message.picture.substring( message.picture.lastIndexOf( '/' )+1 );\r\n\t\t\t\tticket.messages.unshift( message );\r\n\t\t\t}\r\n\t\t\treturn ticket;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttickets\r\n\t\t});\r\n\t}\r\n\tcase types.RECEIVED_LICENSE:\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tlicense: action.payload.license\r\n\t\t});\r\n\tcase types.REMOVED_LICENSE:\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tlicense: null\r\n\t\t});\r\n\tcase types.GET_HISTORICAL_OVERVIEW_STATISTICS: {\r\n\t\tconst statistics = action.payload.statistics.map( x => {\r\n\t\t\tx.createdAt = x.createdAt.substring( 0, x.createdAt.indexOf( 'T' ) );\r\n\t\t\treturn x;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\thistoricalStatistics: statistics\r\n\t\t});\r\n\t}\r\n\tcase types.GET_REQUEST_STATISTICS: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\trequestStatistics: action.payload.statistics\r\n\t\t});\r\n\t}\r\n\tcase types.GET_BACKUPS: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tbackups: action.payload.backups\r\n\t\t});\r\n\t}\r\n\tcase types.CREATED_BACKUP: {\r\n\t\tconst backups = state.backups.slice();\r\n\t\tbackups.push( action.payload.backup );\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tbackups\r\n\t\t});\r\n\t}\r\n\tcase types.DELETED_BACKUP: {\r\n\t\tconst backups = state.backups.filter( x => x._id !== action.payload.id );\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tbackups\r\n\t\t});\r\n\t}\r\n\tcase types.GET_SETTINGS: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tsettings: action.payload\r\n\t\t});\r\n\t}\r\n\tcase types.UPDATED_SETTINGS: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tsettings: action.payload.settings\r\n\t\t});\r\n\t}\r\n\tcase types.GET_ALL_ROLES: {\r\n\t\tconst roles = action.payload.roles;\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\troles\r\n\t\t});\r\n\t}\r\n\tcase types.CREATED_ROLE: {\r\n\t\tconst roles = state.roles.slice();\r\n\t\troles.push( action.payload.role );\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\troles\r\n\t\t});\r\n\t}\r\n\tcase types.DELETED_ROLE: {\r\n\t\tconst roles = state.roles.filter( x => x._id !== action.payload.id );\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\troles\r\n\t\t});\r\n\t}\r\n\tcase types.UPDATED_ROLE: {\r\n\t\tconst { role } = action.payload;\r\n\t\tconst roles = state.roles.map( x => {\r\n\t\t\tif ( role._id === x._id ) {\r\n\t\t\t\treturn role;\r\n\t\t\t}\r\n\t\t\treturn x;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\troles\r\n\t\t});\r\n\t}\r\n\tdefault:\r\n\t\treturn state;\r\n\t}\r\n}\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport * as types from 'constants/action_types.js';\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default function badges( state = null, action ) {\r\n\tswitch ( action.type ) {\r\n\tcase types.RETRIEVED_BADGES: {\r\n\t\treturn action.payload.badges;\r\n\t}\r\n\tdefault:\r\n\t\treturn state;\r\n\t}\r\n}\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport * as types from 'constants/action_types.js';\r\nimport isArray from '@stdlib/assert/is-array';\r\nimport isRegExpString from '@stdlib/assert/is-regexp-string';\r\nimport reFromString from '@stdlib/utils/regexp-from-string';\r\nimport contains from '@stdlib/assert/contains';\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nfunction titleCompare( a, b ) {\r\n\treturn ( '' + a.title ).localeCompare( b.title );\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default function cohorts( state = null, action ) {\r\n\tswitch ( action.type ) {\r\n\tcase types.RETRIEVED_ENROLLABLE_COHORTS: {\r\n\t\tlet cohorts = action.payload.cohorts;\r\n\t\tif ( !isArray( cohorts ) ) {\r\n\t\t\treturn cohorts;\r\n\t\t}\r\n\t\tcohorts = cohorts.filter( elem => {\r\n\t\t\tlet emailFilter = elem.emailFilter || '';\r\n\t\t\tif ( isRegExpString( emailFilter ) ) {\r\n\t\t\t\temailFilter = reFromString( emailFilter );\r\n\t\t\t\treturn emailFilter.test( action.payload.user.email );\r\n\t\t\t}\r\n\t\t\treturn contains( action.payload.user.email, emailFilter || '' );\r\n\t\t});\r\n\t\treturn cohorts.sort( titleCompare );\r\n\t}\r\n\tdefault:\r\n\t\treturn state;\r\n\t}\r\n}\r\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport hasOwnProp from '@stdlib/assert/has-own-property';\nimport isString from '@stdlib/assert/is-string';\nimport isWhitespace from '@stdlib/assert/is-whitespace';\nimport copy from '@stdlib/utils/copy';\nimport isObject from '@stdlib/assert/is-object';\nimport objectKeys from '@stdlib/utils/keys';\nimport mapValues from '@stdlib/utils/map-values';\nimport * as types from 'constants/action_types.js';\n\n\n// FUNCTIONS //\n\nfunction titleCompare( a, b ) {\n\treturn ( '' + a.title ).localeCompare( b.title );\n}\n\n\n// VARIABLES //\n\nconst initialState = {\n\t_id: null,\n\ttitle: '',\n\tdescription: '',\n\towners: '',\n\tenableTicketing: false,\n\tannouncements: [],\n\tlessons: [],\n\tcohorts: [],\n\tfiles: [],\n\townerFiles: [],\n\tlessonTags: [ '_default_tag' ],\n\tcomponentTags: [ '_default_tag' ],\n\ttickets: [],\n\tcompletions: [],\n\tcomponentsByLesson: {}\n};\n\n\n// EXPORTS //\n\nexport default function namespace( state = initialState, action ) {\n\tswitch ( action.type ) {\n\tcase types.CHANGED_NAMESPACE: {\n\t\tconst tags = new Set();\n\t\tconst completions = action.payload.completions;\n\t\tfor ( let i = 0; i < completions.length; i++ ) {\n\t\t\tconst { tagWeights } = completions[ i ];\n\t\t\tfor ( const tag in tagWeights ) {\n\t\t\t\tif ( hasOwnProp( tagWeights, tag ) ) {\n\t\t\t\t\ttags.add( tag );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn Object.assign({}, state, {\n\t\t\t_id: action.payload._id,\n\t\t\ttitle: action.payload.title,\n\t\t\tdescription: action.payload.description,\n\t\t\tannouncements: action.payload.announcements,\n\t\t\tenableTicketing: action.payload.enableTicketing,\n\t\t\towners: action.payload.owners,\n\t\t\tcohorts: action.payload.cohorts,\n\t\t\tcompletions: completions,\n\t\t\tlessonTags: Array.from( tags )\n\t\t});\n\t}\n\tcase types.DELETED_CURRENT_NAMESPACE: {\n\t\treturn initialState;\n\t}\n\tcase types.UPDATED_STUDENT_PROGRESS: {\n\t\tconst { cohort, email, lessonID, progress } = action.payload;\n\t\tconst cohorts = state.cohorts;\n\t\tfor ( let i = 0; i < cohorts.length; i++ ) {\n\t\t\tif ( cohorts[ i ].title === cohort ) {\n\t\t\t\tconst members = cohorts[ i ].members;\n\t\t\t\tfor ( let j = 0; j < members.length; j++ ) {\n\t\t\t\t\tif ( members[ j ].email === email ) {\n\t\t\t\t\t\tconst member = members[ j ];\n\t\t\t\t\t\tmember.lessonData[ lessonID ].progress = progress / 100;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn Object.assign({}, state, { cohorts });\n\t}\n\tcase types.RETRIEVED_LESSONS: {\n\t\tif ( action.payload.namespaceName === state.title ) {\n\t\t\tconst lessons = action.payload.lessons;\n\t\t\tconst tags = new Set( state.lessonTags );\n\t\t\tlessons.forEach( lesson => {\n\t\t\t\tif ( isString( lesson.tag ) && !isWhitespace( lesson.tag ) && lesson.tag !== '_default_tag' ) {\n\t\t\t\t\ttags.add( lesson.tag );\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn Object.assign({}, state, {\n\t\t\t\tlessons,\n\t\t\t\tlessonTags: Array.from( tags )\n\t\t\t});\n\t\t}\n\t\treturn state;\n\t}\n\tcase types.RETRIEVED_COHORTS: {\n\t\tconst newCohorts = action.payload.cohorts;\n\t\tconst lastUpdatedAsDate = ( completion ) => {\n\t\t\tconst date = new Date( completion.lastUpdated );\n\t\t\tcompletion.lastUpdated = date;\n\t\t\treturn completion;\n\t\t};\n\t\tfor ( let i = 0; i < newCohorts.length; i++ ) {\n\t\t\tconst cohort = newCohorts[ i ];\n\t\t\tfor ( let j = 0; j < cohort.members.length; j++ ) {\n\t\t\t\tconst member = cohort.members[ j ];\n\t\t\t\tmember.completions = mapValues( member.completions || {}, lastUpdatedAsDate );\n\t\t\t}\n\t\t}\n\t\treturn Object.assign({}, state, {\n\t\t\tcohorts: newCohorts.sort( titleCompare )\n\t\t});\n\t}\n\tcase types.DELETED_LESSON: {\n\t\tlet lessons = state.lessons.slice();\n\t\tlessons = lessons.filter( x => x.title !== action.payload.lessonName );\n\t\treturn Object.assign({}, state, {\n\t\t\tlessons\n\t\t});\n\t}\n\tcase types.UPDATED_LESSON: {\n\t\tlet lessons = state.lessons.slice();\n\t\tconst { props, lessonName } = action.payload;\n\t\tfor ( let i = 0; i < lessons.length; i++ ) {\n\t\t\tif ( lessons[ i ].title === lessonName ) {\n\t\t\t\tfor ( let key in props ) {\n\t\t\t\t\tif ( hasOwnProp( props, key ) ) {\n\t\t\t\t\t\tlessons[ i ][ key ] = props[ key ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tconst lessonTags = state.lessonTags.slice();\n\t\tif ( props.tag && !isWhitespace( props.tag ) && props.tag !== '_default_tag' ) {\n\t\t\tif ( !state.lessonTags.includes( props.tag ) ) {\n\t\t\t\tlessonTags.push( props.tag );\n\t\t\t}\n\t\t}\n\t\treturn Object.assign({}, state, {\n\t\t\tlessons,\n\t\t\tlessonTags\n\t\t});\n\t}\n\tcase types.RECEIVED_NAMESPACE_FILES: {\n\t\tlet lessons = state.lessons;\n\t\tlet files = action.payload.files;\n\t\tfiles = files.map( file => {\n\t\t\tfile.updatedAt = new Date( file.updatedAt );\n\t\t\tfor ( let i = 0; i < lessons.length; i++ ) {\n\t\t\t\tif ( lessons[ i ]._id === file.lesson ) {\n\t\t\t\t\tfile.lesson = lessons[ i ];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn file;\n\t\t});\n\t\tconst newState = {};\n\t\tif ( action.payload.owner ) {\n\t\t\tnewState.ownerFiles = files;\n\t\t} else {\n\t\t\tnewState.files = files;\n\t\t}\n\t\treturn Object.assign({}, state, newState );\n\t}\n\tcase types.EDITED_ANNOUNCEMENT: {\n\t\tconst announcements = state.announcements.slice();\n\t\tfor (let i = 0; i < announcements.length; i++) {\n\t\t\tif (announcements[i].createdAt === action.payload.announcement.createdAt) {\n\t\t\t\tannouncements[i] = action.payload.announcement;\n\t\t\t}\n\t\t}\n\t\treturn Object.assign({}, state, {\n\t\t\tannouncements: announcements\n\t\t});\n\t}\n\tcase types.CREATED_ANNOUNCEMENT: {\n\t\tconst announcements = state.announcements.slice();\n\t\tannouncements.unshift(action.payload.announcement);\n\t\treturn Object.assign({}, state, {\n\t\t\tannouncements: announcements\n\t\t});\n\t}\n\tcase types.DELETED_ANNOUNCEMENT: {\n\t\tconst announcements = state.announcements.slice();\n\t\tannouncements.splice(action.payload.index, 1);\n\n\t\treturn Object.assign({}, state, {\n\t\t\tannouncements: announcements\n\t\t});\n\t}\n\tcase types.GET_COURSE_TICKETS: {\n\t\tlet tickets = action.payload.tickets;\n\t\ttickets = tickets.map( x => {\n\t\t\tx.createdAt = new Date( x.createdAt );\n\t\t\treturn x;\n\t\t});\n\t\treturn Object.assign({}, state, {\n\t\t\ttickets\n\t\t});\n\t}\n\tcase types.TICKET_OPENED: {\n\t\tconst tickets = state.tickets.map( ticket => {\n\t\t\tif ( ticket._id === action.payload.id ) {\n\t\t\t\tticket.done = false;\n\t\t\t}\n\t\t\treturn ticket;\n\t\t});\n\t\treturn Object.assign({}, state, {\n\t\t\ttickets\n\t\t});\n\t}\n\tcase types.TICKET_CLOSED: {\n\t\tconst tickets = state.tickets.map( ticket => {\n\t\t\tif ( ticket._id === action.payload.id ) {\n\t\t\t\tticket.done = true;\n\t\t\t}\n\t\t\treturn ticket;\n\t\t});\n\t\treturn Object.assign({}, state, {\n\t\t\ttickets\n\t\t});\n\t}\n\tcase types.TICKET_PRIORITY_UPDATED: {\n\t\tconst tickets = state.tickets.map( ticket => {\n\t\t\tif ( ticket._id === action.payload.id ) {\n\t\t\t\tticket.priority = action.payload.priority;\n\t\t\t}\n\t\t\treturn ticket;\n\t\t});\n\t\treturn Object.assign({}, state, {\n\t\t\ttickets\n\t\t});\n\t}\n\tcase types.TICKET_MESSAGE_ADDED: {\n\t\tconst tickets = state.tickets.map( ticket => {\n\t\t\tif ( ticket._id === action.payload.id ) {\n\t\t\t\tconst message = action.payload.message;\n\t\t\t\tmessage.picture = message.picture.substring( message.picture.lastIndexOf( '/' )+1 );\n\t\t\t\tticket.messages.unshift( message );\n\t\t\t}\n\t\t\treturn ticket;\n\t\t});\n\t\treturn Object.assign({}, state, {\n\t\t\ttickets\n\t\t});\n\t}\n\tcase types.LOGGED_OUT: {\n\t\treturn initialState;\n\t}\n\tcase types.UPDATED_METRIC: {\n\t\tconsole.log( 'UPDATED_METRIC IN CURRENT NS', action.payload );\n\t\tif ( action.payload.level !== 'namespace' || action.payload.id !== state._id ) {\n\t\t\treturn state;\n\t\t}\n\t\tconsole.log( 'Need to update...' );\n\t\tconst completions = state.completions.slice();\n\t\tconst metric = action.payload.metric;\n\t\tfor ( let i = 0; i < completions.length; i++ ) {\n\t\t\tif ( completions[ i ].name === metric.name ) {\n\t\t\t\tcompletions[ i ] = metric;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tlet newLessonTags;\n\t\tif ( isObject( metric.tagWeights ) ) {\n\t\t\tnewLessonTags = new Set( state.lessonTags );\n\t\t\tconst tags = objectKeys( metric.tagWeights );\n\t\t\tfor ( let i = 0; i < tags.length; i++ ) {\n\t\t\t\tif ( newLessonTags.has( tags[ i ] ) ) {\n\t\t\t\t\tnewLessonTags.add( tags[ i ] );\n\t\t\t\t}\n\t\t\t}\n\t\t\tnewLessonTags = Array.from( newLessonTags );\n\t\t}\n\t\treturn Object.assign({}, state, {\n\t\t\tcompletions,\n\t\t\t...(newLessonTags && { lessonTags: newLessonTags })\n\t\t});\n\t}\n\tcase types.CREATED_METRIC: {\n\t\tif ( action.payload.level !== 'namespace' || action.payload.id !== state._id ) {\n\t\t\treturn state;\n\t\t}\n\t\tconst completions = state.completions.slice();\n\t\tconst metric = action.payload.metric;\n\t\tlet newLessonTags;\n\t\tif ( isObject( metric.tagWeights ) ) {\n\t\t\tnewLessonTags = new Set( state.lessonTags );\n\t\t\tconst tags = objectKeys( metric.tagWeights );\n\t\t\tfor ( let i = 0; i < tags.length; i++ ) {\n\t\t\t\tif ( newLessonTags.has( tags[ i ] ) ) {\n\t\t\t\t\tnewLessonTags.add( tags[ i ] );\n\t\t\t\t}\n\t\t\t}\n\t\t\tnewLessonTags = Array.from( newLessonTags );\n\t\t}\n\t\tcompletions.push( metric );\n\t\treturn Object.assign({}, state, {\n\t\t\tcompletions,\n\t\t\t...(newLessonTags && { lessonTags: newLessonTags })\n\t\t});\n\t}\n\tcase types.DELETED_METRIC: {\n\t\tif ( action.payload.level !== 'namespace' || action.payload.id !== state._id ) {\n\t\t\treturn state;\n\t\t}\n\t\tconst newCompletions = [];\n\t\tfor ( let i = 0; i < state.completions.length; i++ ) {\n\t\t\tif ( state.completions[ i ].name !== action.payload.name ) {\n\t\t\t\tnewCompletions.push( state.completions[ i ] );\n\t\t\t}\n\t\t}\n\t\tconst metricKey = `${action.payload.level}-${action.payload.id}-${action.payload.name}`;\n\t\tconst newCohorts = copy( state.cohorts );\n\t\tfor ( let i = 0; i < newCohorts.length; i++ ) {\n\t\t\tfor ( let j = 0; j < newCohorts[ i ].members.length; j++ ) {\n\t\t\t\tconst user = newCohorts[ i ].members[ j ];\n\t\t\t\tdelete user.completions[ metricKey ];\n\t\t\t}\n\t\t}\n\t\treturn Object.assign({}, state, {\n\t\t\tcompletions: newCompletions,\n\t\t\tcohorts: newCohorts\n\t\t});\n\t}\n\tcase types.COMPUTED_COMPLETIONS: {\n\t\tconst { completions, entityIds, lastUpdated, metrics } = action.payload;\n\t\tconst newCohorts = copy( state.cohorts );\n\t\tfor ( let i = 0; i < newCohorts.length; i++ ) {\n\t\t\tfor ( let j = 0; j < newCohorts[ i ].members.length; j++ ) {\n\t\t\t\tconst user = newCohorts[ i ].members[ j ];\n\t\t\t\tfor ( let k = 0; k < entityIds.length; k++ ) {\n\t\t\t\t\tconst id = entityIds[ k ];\n\t\t\t\t\tconst metric = metrics[ k ];\n\t\t\t\t\tif ( completions[ k ][ user._id ] !== void 0 ) {\n\t\t\t\t\t\tuser.completions = {\n\t\t\t\t\t\t\t...user.completions,\n\t\t\t\t\t\t\t[`${metric.level}-${id}-${metric.name}`]: {\n\t\t\t\t\t\t\t\tmetricName: metric.name,\n\t\t\t\t\t\t\t\tinstance: completions[ k ][ user._id ],\n\t\t\t\t\t\t\t\tlastUpdated: new Date( lastUpdated )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn Object.assign({}, state, {\n\t\t\tcohorts: newCohorts\n\t\t});\n\t}\n\tcase types.SAVED_LESSON_METRICS: {\n\t\tconst { lessons, metricName } = action.payload;\n\t\tconst updatedLessons = [...lessons.changed, ...lessons.created, ...lessons.deleted ];\n\n\t\tlet newCohorts = state.cohorts;\n\t\tif ( lessons.deleted.length > 0 ) {\n\t\t\tnewCohorts = copy( state.cohorts );\n\t\t\tfor ( let i = 0; i < newCohorts.length; i++ ) {\n\t\t\t\tfor ( let j = 0; j < newCohorts[ i ].members.length; j++ ) {\n\t\t\t\t\tconst user = newCohorts[ i ].members[ j ];\n\t\t\t\t\tuser.completions = {...user.completions };\n\t\t\t\t\tfor ( let k = 0; k < lessons.deleted.length; k++ ) {\n\t\t\t\t\t\tconst lesson = lessons.deleted[ k ];\n\t\t\t\t\t\tconst metricKey = `lesson-${lesson._id}-${metricName}`;\n\t\t\t\t\t\tdelete user.completions[ metricKey ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst idsToLessons = {};\n\t\tupdatedLessons.forEach( lesson => {\n\t\t\tidsToLessons[ lesson._id ] = lesson;\n\t\t});\n\t\tconst newLessons = state.lessons.map( lesson => {\n\t\t\tif ( idsToLessons[ lesson._id ] !== void 0 ) {\n\t\t\t\treturn idsToLessons[ lesson._id ];\n\t\t\t}\n\t\t\treturn lesson;\n\t\t});\n\t\treturn Object.assign({}, state, {\n\t\t\tlessons: newLessons,\n\t\t\tcohorts: newCohorts\n\t\t});\n\t}\n\tcase types.GET_COMPLETION_TAGS: {\n\t\tconst { completionTags } = action.payload;\n\t\tconsole.log( 'Received completion tags', completionTags );\n\t\treturn Object.assign({}, state, {\n\t\t\tcomponentTags: completionTags\n\t\t});\n\t}\n\tcase types.GET_COMPLETION_COMPONENTS: {\n\t\tconst { componentsByLesson } = action.payload;\n\t\tconsole.log( 'Received completion components', componentsByLesson );\n\t\treturn Object.assign({}, state, {\n\t\t\tcomponentsByLesson\n\t\t});\n\t}\n\tdefault:\n\t\treturn state;\n\t}\n}\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport * as types from 'constants/action_types.js';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst initialState = {\r\n\tmessage: '',\r\n\tlevel: '',\r\n\tposition: 'tl',\r\n\tchildren: null,\r\n\ttime: null,\r\n\tautoDismiss: 5\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default function namespace( state = initialState, action ) {\r\n\tswitch ( action.type ) {\r\n\tcase types.ADD_NOTIFICATION: {\r\n\t\treturn Object.assign({}, initialState, {\r\n\t\t\t...action.payload,\r\n\t\t\ttime: new Date()\r\n\t\t});\r\n\t}\r\n\tcase types.ADD_ERROR_NOTIFICATION: {\r\n\t\treturn {\r\n\t\t\ttitle: 'Error encountered',\r\n\t\t\tmessage: action.payload,\r\n\t\t\tlevel: 'error',\r\n\t\t\tposition: 'tl',\r\n\t\t\tautoDismiss: 5,\r\n\t\t\ttime: new Date()\r\n\t\t};\r\n\t}\r\n\tdefault:\r\n\t\treturn state;\r\n\t}\r\n}\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport * as types from 'constants/action_types.js';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst initialState = {};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default function translations( state = initialState, action ) {\r\n\tswitch ( action.type ) {\r\n\t\tcase types.GET_CUSTOM_TRANSLATIONS: {\r\n\t\t\treturn Object.assign( {}, state, action.payload );\r\n\t\t}\r\n\t\tcase types.UPDATED_TRANSLATIONS: {\r\n\t\t\treturn Object.assign( {}, state, action.payload.translations );\r\n\t\t}\r\n\tdefault:\r\n\t\treturn state;\r\n\t}\r\n}\r\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport * as types from 'constants/action_types.js';\n\n\n// VARIABLES //\n\nconst initialState = {};\n\n\n// EXPORTS //\n\nexport default function settings( state = initialState, action ) {\n\tswitch ( action.type ) {\n\tcase types.GET_SETTINGS_PUBLIC: {\n\t\treturn Object.assign({}, state, action.payload );\n\t}\n\tcase types.UPDATED_SETTINGS: {\n\t\treturn Object.assign({}, state, action.payload.settings );\n\t}\n\tcase types.RETRIEVED_COMPLETION_RULES: {\n\t\treturn Object.assign({}, state, {\n\t\t\tcompletionRules: action.payload.completionRules\n\t\t});\n\t}\n\tdefault:\n\t\treturn state;\n\t}\n}\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport * as types from 'constants/action_types.js';\r\nimport server from 'constants/server';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst initialState = {\r\n\tlessons: null\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default function namespace( state = initialState, action ) {\r\n\tswitch ( action.type ) {\r\n\tcase types.RETRIEVED_PUBLIC_LESSONS: {\r\n\t\tlet lessons = action.payload.lessons;\r\n\t\tlessons = lessons.map( (lesson, index) => {\r\n\t\t\tlesson.colorIndex = index % 20;\r\n\t\t\tlesson.url = server+'/'+lesson.namespace+'/'+lesson.title;\r\n\t\t\tif ( !lesson.createdAt ) {\r\n\t\t\t\tlesson.createdAt = new Date( 0 ).toLocaleString();\r\n\t\t\t}\r\n\t\t\tif ( !lesson.updatedAt ) {\r\n\t\t\t\tlesson.updatedAt = lesson.createdAt;\r\n\t\t\t}\r\n\t\t\treturn lesson;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tlessons\r\n\t\t});\r\n\t}\r\n\tdefault:\r\n\t\treturn state;\r\n\t}\r\n}\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport lowercase from '@stdlib/string/lowercase';\r\nimport * as types from 'constants/action_types.js';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst initialState = {\r\n\tphrase: null,\r\n\ttype: 'sequentially',\r\n\tdirection: 'ascending'\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default function search( state = initialState, action ) {\r\n\tswitch ( action.type ) {\r\n\tcase types.SEARCH_PHRASE_SET: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tphrase: lowercase( action.payload.phrase )\r\n\t\t});\r\n\t}\r\n\tcase types.LESSON_ORDER: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttype: action.payload.type\r\n\t\t});\r\n\t}\r\n\tcase types.LESSON_ORDER_DIRECTION: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tdirection: action.payload.direction\r\n\t\t});\r\n\t}\r\n\tcase types.LOGGED_OUT: {\r\n\t\treturn initialState;\r\n\t}\r\n\tdefault:\r\n\t\treturn state;\r\n\t}\r\n}\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport groupBy from '@stdlib/utils/group-by';\r\nimport copy from '@stdlib/utils/copy';\r\nimport * as types from 'constants/action_types.js';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst initialState = {\r\n\tloggedIn: false,\r\n\temail: '',\r\n\tverifiedEmail: false,\r\n\tname: '',\r\n\tfirstName: '',\r\n\tlastName: '',\r\n\tpreferredName: '',\r\n\tpronouns: '',\r\n\torganization: '',\r\n\twriteAccess: false,\r\n\tadministrator: false,\r\n\tenrolledNamespaces: [],\r\n\townedNamespaces: [],\r\n\tlessonData: {},\r\n\tpicture: null,\r\n\tcreatedAt: null,\r\n\tupdatedAt: null,\r\n\tscore: null,\r\n\tspentTime: null,\r\n\tfiles: null,\r\n\tbadges: null,\r\n\tid: null,\r\n\ttoken: null,\r\n\ttickets: [],\r\n\tlicensed: false,\r\n\tcustomFields: null,\r\n\tavailableCustomFields: [],\r\n\ttwoFactorAuth: false,\r\n\trequestTFA: null,\r\n\ttemplateLessons: []\r\n};\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nfunction getNamespace( namespaces, name ) {\r\n\tfor ( let i= 0; i < namespaces.length; i++ ) {\r\n\t\tif ( namespaces[i].title === name ) {\r\n\t\t\treturn namespaces[i];\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default function user( state = initialState, action ) {\r\n\tswitch ( action.type ) {\r\n\tcase types.RECEIVED_TOKEN: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttoken: action.payload.token,\r\n\t\t\tid: action.payload.id\r\n\t\t});\r\n\t}\r\n\tcase types.LOGGED_IN: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\temail: action.payload.email,\r\n\t\t\tverifiedEmail: action.payload.verifiedEmail,\r\n\t\t\tname: action.payload.name,\r\n\t\t\tfirstName: action.payload.firstName,\r\n\t\t\tlastName: action.payload.lastName,\r\n\t\t\tpreferredName: action.payload.preferredName,\r\n\t\t\tpronouns: action.payload.pronouns,\r\n\t\t\tenrolledNamespaces: action.payload.enrolledNamespaces,\r\n\t\t\townedNamespaces: action.payload.ownedNamespaces,\r\n\t\t\torganization: action.payload.organization,\r\n\t\t\twriteAccess: action.payload.writeAccess,\r\n\t\t\tadministrator: action.payload.administrator,\r\n\t\t\tpicture: action.payload.picture,\r\n\t\t\tlessonData: action.payload.lessonData,\r\n\t\t\tcreatedAt: action.payload.createdAt,\r\n\t\t\tupdatedAt: action.payload.updatedAt,\r\n\t\t\tscore: action.payload.score,\r\n\t\t\tspentTime: action.payload.spentTime,\r\n\t\t\tlicensed: action.payload.licensed,\r\n\t\t\tcustomFields: action.payload.customFields,\r\n\t\t\tavailableCustomFields: action.payload.availableCustomFields,\r\n\t\t\ttwoFactorAuth: action.payload.twoFactorAuth,\r\n\t\t\tloggedIn: true\r\n\t\t});\r\n\t}\r\n\tcase types.AUTHENTICATED: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\twriteAccess: true\r\n\t\t});\r\n\t}\r\n\tcase types.LOGGED_OUT: {\r\n\t\treturn initialState;\r\n\t}\r\n\tcase types.USER_UPDATED: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tname: action.payload.name,\r\n\t\t\tfirstName: action.payload.firstName,\r\n\t\t\tlastName: action.payload.lastName,\r\n\t\t\tpreferredName: action.payload.preferredName,\r\n\t\t\tpronouns: action.payload.pronouns,\r\n\t\t\torganization: action.payload.organization,\r\n\t\t\tcustomFields: action.payload.customFields\r\n\t\t});\r\n\t}\r\n\tcase types.USER_PICTURE_MODIFIED: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tpicture: action.payload.picture\r\n\t\t});\r\n\t}\r\n\tcase types.APPEND_CREATED_NAMESPACE: {\r\n\t\tconst arr = state.ownedNamespaces.slice();\r\n\t\tarr.push( action.payload.namespace );\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\townedNamespaces: arr\r\n\t\t});\r\n\t}\r\n\tcase types.DELETED_CURRENT_NAMESPACE: {\r\n\t\tconst arr = [];\r\n\t\tfor ( let i = 0; i < state.ownedNamespaces.length; i++ ) {\r\n\t\t\tconst item = state.ownedNamespaces[ i ];\r\n\t\t\tif ( item._id !== action.payload.id ) {\r\n\t\t\t\tarr.push( item );\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\townedNamespaces: arr\r\n\t\t});\r\n\t}\r\n\tcase types.RETRIEVED_LESSONS: {\r\n\t\tconst arr = state.enrolledNamespaces.slice();\r\n\t\tfor ( let i = 0; i < arr.length; i++ ) {\r\n\t\t\tconst course = arr[ i ];\r\n\t\t\tif ( course.title === action.payload.namespaceName ) {\r\n\t\t\t\tarr[ i ].lessons = action.payload.lessons;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tenrolledNamespaces: arr\r\n\t\t});\r\n\t}\r\n\tcase types.UPDATED_OWNED_NAMESPACE: {\r\n\t\tconst arr = state.ownedNamespaces.slice();\r\n\t\tfor ( let i = 0; i < arr.length; i++ ) {\r\n\t\t\tconst item = arr[ i ];\r\n\t\t\tif ( item._id === action.payload._id ) {\r\n\t\t\t\tarr[ i ] = action.payload;\r\n\t\t\t} else {\r\n\t\t\t\tarr[ i ] = item;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\townedNamespaces: arr\r\n\t\t});\r\n\t}\r\n\tcase types.ADD_ENROLLED_NAMESPACE: {\r\n\t\tconst arr = state.enrolledNamespaces.slice();\r\n\t\tarr.push( action.payload );\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tenrolledNamespaces: arr\r\n\t\t});\r\n\t}\r\n\tcase types.CREATED_ANNOUNCEMENT: {\r\n\t\tconst namespaceName = action.payload.namespaceName;\r\n\t\tconst enrolledNamespaces = copy( state.enrolledNamespaces );\r\n\t\tlet ns = getNamespace( enrolledNamespaces, namespaceName );\r\n\t\tif ( ns ) {\r\n\t\t\tns.announcements.unshift( action.payload.announcement );\r\n\t\t}\r\n\t\tconst ownedNamespaces = copy( state.ownedNamespaces );\r\n\t\tns = getNamespace( ownedNamespaces, namespaceName );\r\n\t\tif ( ns ) {\r\n\t\t\tns.announcements.unshift( action.payload.announcement );\r\n\t\t}\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tenrolledNamespaces,\r\n\t\t\townedNamespaces\r\n\t\t});\r\n\t}\r\n\tcase types.EDITED_ANNOUNCEMENT: {\r\n\t\tconst namespaceName = action.payload.namespaceName;\r\n\t\tconst announcement = action.payload.announcement;\r\n\t\tconst createdAt = announcement.createdAt;\r\n\t\tconst enrolledNamespaces = copy( state.enrolledNamespaces );\r\n\t\tlet ns = getNamespace( enrolledNamespaces, namespaceName );\r\n\t\tif ( ns ) {\r\n\t\t\tfor ( let i = 0; i < ns.announcements.length; i++ ) {\r\n\t\t\t\tif ( ns.announcements[ i ].createdAt === createdAt ) {\r\n\t\t\t\t\tns.announcements[ i ] = announcement;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst ownedNamespaces = copy( state.ownedNamespaces );\r\n\t\tns = getNamespace( ownedNamespaces, namespaceName );\r\n\t\tif ( ns ) {\r\n\t\t\tfor ( let i = 0; i < ns.announcements.length; i++ ) {\r\n\t\t\t\tif ( ns.announcements[ i ].createdAt === createdAt ) {\r\n\t\t\t\t\tns.announcements[ i ] = announcement;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tenrolledNamespaces,\r\n\t\t\townedNamespaces\r\n\t\t});\r\n\t}\r\n\tcase types.DELETED_ANNOUNCEMENT: {\r\n\t\tconst namespaceName = action.payload.namespaceName;\r\n\t\tconst enrolledNamespaces = copy( state.enrolledNamespaces );\r\n\t\tlet ns = getNamespace( enrolledNamespaces, namespaceName );\r\n\t\tif ( ns ) {\r\n\t\t\tns.announcements.splice( action.payload.index, 1 );\r\n\t\t}\r\n\t\tconst ownedNamespaces = copy( state.ownedNamespaces );\r\n\t\tns = getNamespace( ownedNamespaces, namespaceName );\r\n\t\tif ( ns ) {\r\n\t\t\tns.announcements.splice( action.payload.index, 1 );\r\n\t\t}\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tenrolledNamespaces,\r\n\t\t\townedNamespaces\r\n\t\t});\r\n\t}\r\n\tcase types.RECEIVED_FILES: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tfiles: groupBy( action.payload.files, ( v ) => {\r\n\t\t\t\treturn v.namespace;\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\tcase types.GET_USER_TICKETS: {\r\n\t\tlet tickets = action.payload.tickets;\r\n\t\ttickets = tickets.map( x => {\r\n\t\t\tx.createdAt = new Date( x.createdAt );\r\n\t\t\treturn x;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttickets\r\n\t\t});\r\n\t}\r\n\tcase types.CREATED_TICKET: {\r\n\t\tconst tickets = state.tickets.slice();\r\n\t\ttickets.push({\r\n\t\t\t...action.payload,\r\n\t\t\tmessages: [],\r\n\t\t\tuser: {\r\n\t\t\t\tpicture: state.picture.substring( state.picture.lastIndexOf( '/' )+1 ),\r\n\t\t\t\tname: state.name,\r\n\t\t\t\temail: state.email\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttickets\r\n\t\t});\r\n\t}\r\n\tcase types.TICKET_OPENED: {\r\n\t\tconst tickets = state.tickets.map( ticket => {\r\n\t\t\tif ( ticket._id === action.payload.id ) {\r\n\t\t\t\tticket.done = false;\r\n\t\t\t}\r\n\t\t\treturn ticket;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttickets\r\n\t\t});\r\n\t}\r\n\tcase types.TICKET_CLOSED: {\r\n\t\tconst tickets = state.tickets.map( ticket => {\r\n\t\t\tif ( ticket._id === action.payload.id ) {\r\n\t\t\t\tticket.done = true;\r\n\t\t\t}\r\n\t\t\treturn ticket;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttickets\r\n\t\t});\r\n\t}\r\n\tcase types.TICKET_MESSAGE_ADDED: {\r\n\t\tconst tickets = state.tickets.map( ticket => {\r\n\t\t\tif ( ticket._id === action.payload.id ) {\r\n\t\t\t\tconst message = action.payload.message;\r\n\t\t\t\tmessage.picture = message.picture.substring( message.picture.lastIndexOf( '/' )+1 );\r\n\t\t\t\tticket.messages.unshift( message );\r\n\t\t\t}\r\n\t\t\treturn ticket;\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttickets\r\n\t\t});\r\n\t}\r\n\tcase types.USER_RECEIVED_BADGES: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tbadges: action.payload.badges\r\n\t\t});\r\n\t}\r\n\tcase types.GET_CUSTOM_FIELDS:\r\n\tcase types.FIELD_POSITION_DECREMENTED:\r\n\tcase types.FIELD_POSITION_INCREMENTED: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tavailableCustomFields: action.payload.customFields\r\n\t\t});\r\n\t}\r\n\tcase types.DELETED_CUSTOM_FIELD: {\r\n\t\tconst fields = [];\r\n\t\tfor ( let i = 0; i < state.availableCustomFields.length; i++ ) {\r\n\t\t\tconst item = state.availableCustomFields[ i ];\r\n\t\t\tif ( item._id !== action.payload.id ) {\r\n\t\t\t\tfields.push( item );\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tavailableCustomFields: fields\r\n\t\t});\r\n\t}\r\n\tcase types.CREATED_CUSTOM_FIELD: {\r\n\t\tconst availableCustomFields = state.availableCustomFields.slice();\r\n\t\tavailableCustomFields.push({\r\n\t\t\t...action.payload\r\n\t\t});\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tavailableCustomFields\r\n\t\t});\r\n\t}\r\n\tcase types.ENABLED_TFA: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttwoFactorAuth: action.payload.verified\r\n\t\t});\r\n\t}\r\n\tcase types.DISABLED_TFA: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttwoFactorAuth: !action.payload.disabled\r\n\t\t});\r\n\t}\r\n\tcase types.REQUEST_TFA: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\trequestTFA: {\r\n\t\t\t\temail: action.payload.email,\r\n\t\t\t\tpassword: action.payload.password\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tcase types.GET_TEMPLATE_LESSONS: {\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\ttemplateLessons: action.payload.templateLessons\r\n\t\t});\r\n\t}\r\n\tcase types.UPDATED_METRIC: {\r\n\t\tconsole.log( 'UPDATED_METRIC', action.payload );\r\n\t\tconst enrolledNamespaces = state.enrolledNamespaces.slice();\r\n\t\tconst ownedNamespaces = state.ownedNamespaces.slice();\r\n\t\tfor ( let i = 0; i < state.enrolledNamespaces.length; i++ ) {\r\n\t\t\tconst ns = state.enrolledNamespaces[ i ];\r\n\t\t\tif ( ns._id !== action.payload.id ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tconst completions = ns.completions.slice();\r\n\t\t\tconst metric = action.payload.metric;\r\n\t\t\tfor ( let j = 0; j < completions.length; j++ ) {\r\n\t\t\t\tif ( completions[ j ].name === metric.name ) {\r\n\t\t\t\t\tcompletions[ j ] = metric;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tenrolledNamespaces[ i ].completions = completions;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tfor ( let i = 0; i < state.ownedNamespaces.length; i++ ) {\r\n\t\t\tconst ns = state.ownedNamespaces[ i ];\r\n\t\t\tif ( ns._id !== action.payload.id ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tconst completions = ns.completions.slice();\r\n\t\t\tconst metric = action.payload.metric;\r\n\t\t\tfor ( let j = 0; j < completions.length; j++ ) {\r\n\t\t\t\tif ( completions[ j ].name === metric.name ) {\r\n\t\t\t\t\tcompletions[ j ] = metric;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\townedNamespaces[ i ].completions = completions;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tenrolledNamespaces: enrolledNamespaces,\r\n\t\t\townedNamespaces: ownedNamespaces\r\n\t\t});\r\n\t}\r\n\tcase types.CREATED_METRIC: {\r\n\t\tconst enrolledNamespaces = state.enrolledNamespaces.slice();\r\n\t\tconst ownedNamespaces = state.ownedNamespaces.slice();\r\n\t\tfor ( let i = 0; i < state.enrolledNamespaces.length; i++ ) {\r\n\t\t\tconst ns = state.enrolledNamespaces[ i ];\r\n\t\t\tif ( ns._id !== action.payload.id ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tconst completions = ns.completions.slice();\r\n\t\t\tcompletions.push( action.payload.metric );\r\n\t\t\tenrolledNamespaces[ i ].completions = completions;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tfor ( let i = 0; i < state.ownedNamespaces.length; i++ ) {\r\n\t\t\tconst ns = state.ownedNamespaces[ i ];\r\n\t\t\tif ( ns._id !== action.payload.id ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tconst completions = ns.completions.slice();\r\n\t\t\tcompletions.push( action.payload.metric );\r\n\t\t\townedNamespaces[ i ].completions = completions;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tenrolledNamespaces: enrolledNamespaces,\r\n\t\t\townedNamespaces: ownedNamespaces\r\n\t\t});\r\n\t}\r\n\tcase types.DELETED_METRIC: {\r\n\t\tconsole.log( 'DELETED_METRIC', action.payload );\r\n\t\tconst enrolledNamespaces = state.enrolledNamespaces.slice();\r\n\t\tconst ownedNamespaces = state.ownedNamespaces.slice();\r\n\t\tfor ( let i = 0; i < state.enrolledNamespaces.length; i++ ) {\r\n\t\t\tconst ns = state.enrolledNamespaces[ i ];\r\n\t\t\tif ( ns._id !== action.payload.id ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tconst newCompletions = [];\r\n\t\t\tfor ( let i = 0; i < ns.completions.length; i++ ) {\r\n\t\t\t\tif ( ns.completions[ i ].name !== action.payload.name ) {\r\n\t\t\t\t\tnewCompletions.push( ns.completions[ i ] );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tenrolledNamespaces[ i ].completions = newCompletions;\r\n\t\t\tconsole.log( 'newCompletions', newCompletions );\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tfor ( let i = 0; i < state.ownedNamespaces.length; i++ ) {\r\n\t\t\tconst ns = state.ownedNamespaces[ i ];\r\n\t\t\tif ( ns._id !== action.payload.id ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tconst newCompletions = [];\r\n\t\t\tfor ( let i = 0; i < ns.completions.length; i++ ) {\r\n\t\t\t\tif ( ns.completions[ i ].name !== action.payload.name ) {\r\n\t\t\t\t\tnewCompletions.push( ns.completions[ i ] );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\townedNamespaces[ i ].completions = newCompletions;\r\n\t\t\tconsole.log( 'newCompletions', newCompletions );\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\treturn Object.assign({}, state, {\r\n\t\t\tenrolledNamespaces: enrolledNamespaces,\r\n\t\t\townedNamespaces: ownedNamespaces\r\n\t\t});\r\n\t}\r\n\tdefault:\r\n\t\treturn state;\r\n\t}\r\n}\r\n\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport { combineReducers } from 'redux';\r\nimport admin from './admin';\r\nimport badges from './badges';\r\nimport cohorts from './cohorts';\r\nimport namespace from './namespace';\r\nimport notification from './notification';\r\nimport translations from './translations';\r\nimport settings from './settings';\r\nimport gallery from './gallery';\r\nimport search from './search';\r\nimport user from './user';\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default () => combineReducers({\r\n\tadmin,\r\n\tbadges,\r\n\tcohorts,\r\n\tgallery,\r\n\tnamespace,\r\n\tnotification,\r\n\tsearch,\r\n\tsettings,\r\n\ttranslations,\r\n\tuser\r\n});\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport { useEffect, useRef } from 'react';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n * Hook to use a previous value.\r\n *\r\n * @param {*} value - value for which to return the previous value\r\n * @returns {*} previous value\r\n */\r\nfunction usePrevious( value ) {\r\n\tconst ref = useRef();\r\n\tuseEffect( () => {\r\n\t\tref.current = value;\r\n\t}, [ value ] );\r\n\treturn ref.current;\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default usePrevious;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { connect } from 'react-redux';\r\nimport NotificationSystem from 'react-notification-system';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst style = {\r\n\tNotificationItem: {\r\n\t\tDefaultStyle: {\r\n\t\t\tmargin: '20px 2px 2px 1px'\r\n\t\t},\r\n\t\tinfo: {\r\n\t\t\tcolor: 'black',\r\n\t\t\tbackgroundColor: 'white',\r\n\t\t\tboxShadow: '0 0 4px darkslategray',\r\n\t\t\theight: '400px',\r\n\t\t\twidth: '400px',\r\n\t\t\tborderTop: 'none'\r\n\t\t}\r\n\t}\r\n};\r\n\r\n\r\n// MAIN //\r\n\r\nclass NotificationContainer extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\t}\r\n\r\n\tcomponentDidUpdate( prevProps, prevState ) {\r\n\t\tconst notification = this.props.notification;\r\n\t\tconst prevNotification = prevProps.notification;\r\n\t\tif ( prevNotification.time !== notification.time ) {\r\n\t\t\tthis.notificationSystem.addNotification( notification );\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<NotificationSystem\r\n\t\t\t\tstyle={style}\r\n\t\t\t\tref={( elem ) => {\r\n\t\t\t\t\tthis.notificationSystem = elem;\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nNotificationContainer.propTypes = {\r\n\tnotification: PropTypes.object.isRequired\r\n};\r\n\r\nfunction mapStateToProps( state ) {\r\n\treturn {\r\n\t\tnotification: state.notification\r\n\t};\r\n}\r\n\r\nexport default connect(\r\n\tmapStateToProps\r\n)( NotificationContainer );\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { useState, Fragment } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport i18next from 'i18next';\r\nimport { useTranslation } from 'react-i18next';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport { LANGUAGE_CODES, languageDescription } from 'constants/languages';\r\nimport './language_switcher.css';\r\n\r\n\r\n// FUNCTIONS //\r\n\r\n/**\r\n* Modal for selecting a language.\r\n*\r\n* @param {Object} props - component props\r\n* @param {Object} props.languages - object containing language codes\r\n* @param {Function} props.t - translation function\r\n* @param {Function} props.onHide - callback to hide the modal\r\n* @returns {ReactElement} modal\r\n*/\r\nconst SelectModal = ({ t, languages, onHide }) => {\r\n\tconst availableLanguages = languages || LANGUAGE_CODES;\r\n\tconst changeLanguageFactory = ( lng ) => {\r\n\t\treturn async () => {\r\n\t\t\tonHide();\r\n\t\t\tawait i18next.changeLanguage( lng );\r\n\t\t};\r\n\t};\r\n\treturn (\r\n\t\t<Modal show onHide={onHide} >\r\n\t\t\t<Modal.Header closeButton >\r\n\t\t\t\t<Modal.Title as=\"h3\">{t('choose-language')}</Modal.Title>\r\n\t\t\t</Modal.Header>\r\n\t\t\t<Modal.Body>\r\n\t\t\t\t<ButtonGroup size=\"sm\" vertical style={{ width: '100%' }} >\r\n\t\t\t\t\t{availableLanguages.map( ( x, idx ) => {\r\n\t\t\t\t\t\treturn ( <Button\r\n\t\t\t\t\t\t\tkey={idx} variant=\"outline-primary\"\r\n\t\t\t\t\t\t\tonClick={changeLanguageFactory( x )}\r\n\t\t\t\t\t\t>{languageDescription( x )}</Button> );\r\n\t\t\t\t\t})}\r\n\t\t\t\t</ButtonGroup>\r\n\t\t\t</Modal.Body>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n* Renders a language switcher button in the bottom-right corner of the screen.\r\n*\r\n* @param {Object} props - component props\r\n* @param {Object} props.languages - object containing language codes\r\n* @returns {ReactElement} component\r\n*/\r\nconst LanguageSwitcher = ({ languages }) => {\r\n\tconst { t } = useTranslation( 'common' );\r\n\tconst [ showSelectModal, setShowSelectModal ] = useState( false );\r\n\tconst toggleSelectModal = () => {\r\n\t\tsetShowSelectModal( !showSelectModal );\r\n\t};\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<OverlayTrigger placement=\"left\" overlay={<Tooltip id=\"language-switcher\">{t('change-language')}</Tooltip>} >\r\n\t\t\t\t<Button\r\n\t\t\t\t\tonClick={toggleSelectModal} className=\"language-switcher\"\r\n\t\t\t\t\tvariant=\"light\" size=\"sm\" aria-label={t('choose-language')}\r\n\t\t\t\t>\r\n\t\t\t\t\t<i className=\"fas fa-globe\"></i>\r\n\t\t\t\t</Button>\r\n\t\t\t</OverlayTrigger>\r\n\t\t\t{showSelectModal ? <SelectModal languages={languages} t={t} onHide={toggleSelectModal} /> : null}\r\n\t\t</Fragment>\r\n\t);\r\n};\r\n\r\n\r\n// PROPERTIES //\r\n\r\nLanguageSwitcher.propTypes = {\r\n\tlanguages: PropTypes.array\r\n};\r\n\r\nLanguageSwitcher.defaultProps = {\r\n\tlanguages: null\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default LanguageSwitcher;\r\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { useTranslation } from 'react-i18next';\nimport { Link } from 'react-router-dom';\nimport LanguageSwitcher from 'components/language-switcher';\nimport pkgJson from './../../../package.json';\nimport './footer_bar.css';\n\n\n// MAIN //\n\n/**\n* A footer bar component rendering the ISLE logo, copyright notice, dashboard version number, and links to the terms and privacy policy.\n*\n* @property {Object} props - component properties\n* @property {Object} props.settings - ISLE instance settings\n* @returns {ReactElement} component\n*/\nconst FooterBar = ({ settings }) => {\n\tconst { t } = useTranslation( [ 'footer_bar', 'common' ] );\n\treturn ( <div className=\"footer-bar\" >\n\t\t<div className=\"isle-logo\" >\n\t\t\t<img src=\"img/isle_logo.svg\" alt=\"ISLE Logo\" />\n\t\t\t<div className=\"footer-bar-copyright\" >\n\t\t\t\t© 2016-2022 The ISLE Authors. All rights reserved.\n\t\t\t</div>\n\t\t</div>\n\t\t<div className=\"isle-terms\" >\n\t\t\t{' | '}\n\t\t\t<Link target=\"_blank\" to=\"/terms\" >{t('terms')}</Link>\n\t\t\t{' | '}\n\t\t\t<Link target=\"_blank\" to=\"/privacy\" >{t('privacy')}</Link>\n\t\t</div>\n\t\t<div>\n\t\t</div>\n\t\t<LanguageSwitcher\n\t\t\tlanguages={settings.availableLanguages}\n\t\t/>\n\t\t<div className=\"footer-dashboard-version\" >\n\t\t\tDashboard v{pkgJson.version}\n\t\t</div>\n\t</div> );\n};\n\n\n// PROPERTIES //\n\nFooterBar.propTypes = {\n\tsettings: PropTypes.object.isRequired\n};\n\n\n// EXPORTS //\n\nexport default FooterBar;\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport FooterBar from 'components/footer-bar';\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nfunction mapStateToProps( state ) {\r\n\treturn {\r\n\t\tsettings: state.settings\r\n\t};\r\n}\r\n\r\n\r\n// MAIN //\r\n\r\nconst VisibleFooterBar = connect( mapStateToProps )( FooterBar );\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default VisibleFooterBar;\r\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React, { lazy, Suspense, useEffect, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport logger from 'debug';\nimport { connect } from 'react-redux';\nimport { Route, Routes, useNavigate, useLocation } from 'react-router-dom';\nimport { Helmet } from 'react-helmet-async';\nimport capitalize from '@stdlib/string/capitalize';\nimport axios from 'axios';\nimport Spinner from 'components/spinner';\nimport usePrevious from 'hooks/use-previous';\nimport useMountEffect from 'hooks/use-mount-effect/index.js';\nimport server from 'constants/server';\nimport { fetchCredentialsInjector } from 'actions/authentication.js';\nimport { getEnrollableCohortsInjector } from 'actions/cohort.js';\nimport { getPublicSettingsInjector, getCustomTranslationsInjector } from 'actions/settings.js';\nimport { getCompletionRulesInjector } from 'actions/completions.js';\nimport { receivedToken } from 'actions/user.js';\nimport NotificationSystem from './notification.js';\nimport './app.css';\n\n\n// VARIABLES //\n\nimport FooterBar from 'containers/visible-footer-bar';\nconst AsyncTerms = lazy(() => import( 'containers/visible-terms' ));\nconst AsyncPrivacy = lazy(() => import( 'containers/visible-privacy' ));\nconst AsyncHeaderBar = lazy(() => import( 'containers/visible-header-bar' ));\nconst AsyncForgotPassword = lazy(() => import( 'containers/visible-forgot-password' ));\nconst AsyncCreateNamespace = lazy(() => import( 'containers/visible-create-namespace' ));\nconst AsyncEditNamespace = lazy(() => import( 'containers/visible-edit-namespace' ));\nconst AsyncNewPassword = lazy(() => import( 'containers/visible-new-password' ));\nconst AsyncCompleteRegistration = lazy(() => import( 'containers/visible-complete-registration' ));\nconst AsyncConfirmEmail = lazy(() => import( 'containers/visible-confirm-email' ));\nconst AsyncAdminPage = lazy(() => import( 'containers/visible-admin' ));\nconst AsyncLogin = lazy(() => import( 'containers/visible-login' ));\nconst AsyncLoginTFA = lazy(() => import( 'containers/visible-login-tfa' ));\nconst AsyncSignup = lazy(() => import( 'containers/visible-signup' ));\nconst AsyncNamespaceData = lazy(() => import( 'containers/visible-namespace-data' ));\nconst AsyncGallery = lazy(() => import( 'containers/visible-gallery' ));\nconst AsyncLessonsPage = lazy(() => import( 'containers/visible-lessons-page' ));\nconst AsyncProfilePage = lazy(() => import( 'containers/visible-profile-page' ));\nconst AsyncEnrollPage = lazy(() => import( 'containers/visible-enroll-page' ));\nconst USER_STORAGE_ID = 'ISLE_USER_'+server;\nconst RE_PUBLIC_PAGES = /(?:new-password|complete-registration|confirm-email|signup|login|login-tfa|terms|privacy)/;\nconst debug = logger( 'isle-dashboard' );\nconst RE_LEADING_PART = /^[\\s\\S]*\\//;\nconst RE_HYPHEN = /-([a-z])/;\n\n\n// FUNCTIONS //\n\n/**\n* Injects the application title into the document's title tag.\n*\n* @private\n* @returns {ReactElement} helmet component\n*/\nconst Title = () => {\n\tconst { pathname } = useLocation();\n\tlet title;\n\tif ( pathname ) {\n\t\ttitle = pathname.replace( RE_LEADING_PART, '' );\n\t\ttitle = title.replace( RE_HYPHEN, replacer );\n\t\ttitle = capitalize( title );\n\t}\n\tif ( title ) {\n\t\ttitle = `${title} | ISLE Dashboard`;\n\t} else {\n\t\ttitle = 'ISLE Dashboard';\n\t}\n\treturn (\n\t\t<Helmet>\n\t\t\t<title>{title}</title>\n\t\t</Helmet>\n\t);\n\n\t/**\n\t* Replaces a hyphen followed by a lowercase letter with a space and an uppercase letter.\n\t*\n\t* @private\n\t* @param {string} match - match string\n\t* @param {string} p1 - first capture group\n\t* @returns {string} replacement string\n\t*/\n\tfunction replacer( match, p1 ) {\n\t\treturn ' ' + p1.toUpperCase();\n\t}\n};\n\n/**\n* Generates a destination URL based off the query string or a sensible default and navigates to it.\n*\n* @private\n* @param {string} search - query string\n* @param {boolean} writeAccess - whether or not the user has write access\n* @param {Function} navigate - function that navigates to a provided URL\n* @returns {void}\n*/\nfunction goToDestination( search, writeAccess, navigate ) {\n\tlet url = new URLSearchParams( search ).get( 'url' );\n\tif ( !url ) {\n\t\turl = writeAccess ? '/dashboard/lessons' : '/dashboard/profile';\n\t}\n\tif ( url.indexOf( 'dashboard' ) !== -1 ) {\n\t\turl = url.replace( /\\/dashboard/, '' );\n\t\tdebug( 'Redirecting to dashboard page: %s', url );\n\t\tnavigate( url );\n\t} else {\n\t\tdebug( 'Destination is not a dashboard URL: %s', url );\n\t\twindow.location = server + url;\n\t}\n}\n\n\n// MAIN //\n\n/**\n* The main application component.\n*\n* @param {Object} props - component properties\n* @param {boolean} props.isLoggedIn - whether or not the user is logged in\n* @param {Object} props.user - user object\n* @param {Object} props.settings - application settings\n* @param {Function} props.fetchCredentials - function to fetch credentials\n* @param {Function} props.getCustomTranslations - function to get custom translations\n* @param {Function} props.getCompletionRules - function to get metric completion rules\n* @param {Function} props.getPublicSettings - function to get public settings\n* @param {Function} props.getEnrollableCohorts - function to get enrollable cohorts\n* @param {Function} props.dispatch - redux dispatch function\n* @returns {ReactElement} component\n*/\nconst App =({ isLoggedIn, dispatch, getCompletionRules, getCustomTranslations, getPublicSettings, fetchCredentials, getEnrollableCohorts, user, settings }) => {\n\tconst oldIsLoggedIn = usePrevious( isLoggedIn );\n\tconst writeAccess = user.writeAccess;\n\tconst navigate = useNavigate();\n\tconst { pathname, search } = useLocation();\n\tuseMountEffect( () => {\n\t\tasync function fetchDataAndRedirect() {\n\t\t\tdebug( 'Mounting application...' );\n\t\t\tgetCustomTranslations();\n\t\t\tgetPublicSettings();\n\t\t\tgetCompletionRules();\n\t\t\tif ( isLoggedIn ) {\n\t\t\t\tdebug( 'User is logged in, check local storage...' );\n\t\t\t\tconst isle = localStorage.getItem( USER_STORAGE_ID );\n\t\t\t\tif ( !isle ) {\n\t\t\t\t\tdebug( 'User is logged in, but no local storage found -> write to local storage' );\n\t\t\t\t\tlocalStorage.setItem( USER_STORAGE_ID, JSON.stringify({\n\t\t\t\t\t\ttoken: user.token,\n\t\t\t\t\t\tid: user.id\n\t\t\t\t\t}) );\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if ( !RE_PUBLIC_PAGES.test( pathname ) ) {\n\t\t\t\tlet isle = localStorage.getItem( USER_STORAGE_ID );\n\t\t\t\tif ( isle ) {\n\t\t\t\t\tdebug( 'User is not logged in, but local storage item found -> read from local storage...' );\n\t\t\t\t\tisle = JSON.parse( isle );\n\t\t\t\t\tconst user = await fetchCredentials( isle );\n\t\t\t\t\tif ( user ) {\n\t\t\t\t\t\tgetEnrollableCohorts( user );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst res = await axios.get( server+'/saml-xmw/session' );\n\t\t\t\t\t\tif ( !res.data ) {\n\t\t\t\t\t\t\tthrow new Error( 'No data returned from server' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdispatch( receivedToken( res.data ) );\n\t\t\t\t\t\tconst user = await fetchCredentials( res.data );\n\t\t\t\t\t\tif ( user ) {\n\t\t\t\t\t\t\tgetEnrollableCohorts( user );\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch ( err ) {\n\t\t\t\t\t\tif ( settings.saml === 'enabled' ) {\n\t\t\t\t\t\t\tdebug( 'No SAML session found, redirecting to SAML login choice page...' );\n\t\t\t\t\t\t\twindow.location = server+'/saml-xmw/login-choice';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdebug( 'No SAML session found, redirecting to credentials login page...' );\n\t\t\t\t\t\t\tnavigate( '/login' );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if ( pathname === '/' ) {\n\t\t\t\tnavigate( '/login' );\n\t\t\t}\n\t\t}\n\t\tfetchDataAndRedirect();\n\t});\n\tuseEffect( () => {\n\t\tconst isLoggingOut = oldIsLoggedIn && !isLoggedIn;\n\t\tconst isLoggingIn = !oldIsLoggedIn && isLoggedIn;\n\t\tif ( isLoggingIn ) {\n\t\t\tif ( pathname === '/login-tfa' ) {\n\t\t\t\tgoToDestination( search, writeAccess, navigate );\n\t\t\t}\n\t\t\telse if ( pathname && pathname !== '/' && pathname !== '/login' ) {\n\t\t\t\tdebug( 'User has logged in, redirecting to: '+pathname );\n\t\t\t\tnavigate( pathname );\n\t\t\t} else {\n\t\t\t\tdebug( 'User has logged in, redirecting...' );\n\t\t\t\taxios.post( server+'/ensure_session' )\n\t\t\t\t\t.then( ( res ) => {\n\t\t\t\t\t\tgoToDestination( search, writeAccess, navigate );\n\t\t\t\t\t} )\n\t\t\t\t\t.catch( ( err ) => {\n\t\t\t\t\t\tdebug( 'Encountered an error while ensuring session: '+err.message );\n\t\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse if ( isLoggingOut ) {\n\t\t\tif ( settings.saml === 'enabled' ) {\n\t\t\t\twindow.location = server+'/saml-xmw/login-choice';\n\t\t\t} else {\n\t\t\t\tnavigate( '/login' );\n\t\t\t}\n\t\t}\n\t\telse if (\n\t\t\tisLoggedIn && pathname &&\n\t\t\t( pathname === '/' || pathname === '/login' || pathname === '/login-tfa' )\n\t\t) {\n\t\t\tdebug( 'User is logged in, check for redirect...' );\n\t\t\taxios.post( server+'/ensure_session' )\n\t\t\t\t.then( ( res ) => {\n\t\t\t\t\tgoToDestination( search, writeAccess, navigate );\n\t\t\t\t} )\n\t\t\t\t.catch( ( err ) => {\n\t\t\t\t\tdebug( 'Encountered an error while ensuring session: '+err.message );\n\t\t\t\t});\n\t\t}\n\t}, [ isLoggedIn, pathname, search, navigate, oldIsLoggedIn, writeAccess, settings ] );\n\tlet AuthenticationBarrier = null;\n\tif ( isLoggedIn ) {\n\t\tAuthenticationBarrier =\n\t\t\t<Fragment>\n\t\t\t\t{!RE_PUBLIC_PAGES.test( pathname ) ? <Suspense fallback={<Spinner />}>\n\t\t\t\t\t<AsyncHeaderBar />\n\t\t\t\t</Suspense> : null}\n\t\t\t\t<Routes>\n\t\t\t\t\t<Route\n\t\t\t\t\t\tpath=\"/create-namespace\"\n\t\t\t\t\t\telement={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t\t\t<AsyncCreateNamespace />\n\t\t\t\t\t\t</Suspense>}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route\n\t\t\t\t\t\tpath=\"/edit-namespace/:namespace\"\n\t\t\t\t\t\telement={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t\t\t<AsyncEditNamespace />\n\t\t\t\t\t\t</Suspense>}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route\n\t\t\t\t\t\tpath=\"/namespace-data/:namespace/*\"\n\t\t\t\t\t\telement={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t\t\t<AsyncNamespaceData />\n\t\t\t\t\t\t</Suspense>}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route\n\t\t\t\t\t\tpath=\"/profile\"\n\t\t\t\t\t\telement={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t\t\t<AsyncProfilePage />\n\t\t\t\t\t\t</Suspense>}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route\n\t\t\t\t\t\tindex\n\t\t\t\t\t\tpath=\"/lessons\"\n\t\t\t\t\t\telement={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t\t\t<AsyncLessonsPage />\n\t\t\t\t\t\t</Suspense>}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route\n\t\t\t\t\t\tpath=\"/lessons/:namespace\"\n\t\t\t\t\t\telement={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t\t\t<AsyncLessonsPage />\n\t\t\t\t\t\t</Suspense>}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route\n\t\t\t\t\t\tpath=\"/gallery\"\n\t\t\t\t\t\telement={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t\t\t<AsyncGallery />\n\t\t\t\t\t\t</Suspense>}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route\n\t\t\t\t\t\tpath=\"/enroll\"\n\t\t\t\t\t\telement={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t\t\t<AsyncEnrollPage />\n\t\t\t\t\t\t</Suspense>}\n\t\t\t\t\t/>\n\t\t\t\t\t<Route\n\t\t\t\t\t\tpath=\"/admin/*\"\n\t\t\t\t\t\telement={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t\t\t<AsyncAdminPage />\n\t\t\t\t\t\t</Suspense>}\n\t\t\t\t\t/>\n\t\t\t\t</Routes>\n\t\t\t</Fragment>;\n\t}\n\treturn (\n\t\t<div className=\"App\">\n\t\t\t<Title />\n\t\t\t{AuthenticationBarrier}\n\t\t\t<Routes>\n\t\t\t\t<Route index path=\"/\" element={<Spinner />} />\n\t\t\t\t<Route path=\"/login\" element={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t<AsyncLogin />\n\t\t\t\t</Suspense>} />\n\t\t\t\t<Route path=\"/login-tfa\" element={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t<AsyncLoginTFA />\n\t\t\t\t</Suspense>} />\n\t\t\t\t<Route path=\"/new-password\" element={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t<AsyncNewPassword />\n\t\t\t\t</Suspense>} />\n\t\t\t\t<Route path=\"/complete-registration\" element={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t<AsyncCompleteRegistration />\n\t\t\t\t</Suspense>} />\n\t\t\t\t<Route path=\"/confirm-email\" element={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t<AsyncConfirmEmail />\n\t\t\t\t</Suspense>} />\n\t\t\t\t{settings.allowUserRegistrations ? <Route path=\"/signup\" element={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t<AsyncSignup />\n\t\t\t\t</Suspense>} /> : null}\n\t\t\t\t<Route path=\"/forgot-password\" element={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t<AsyncForgotPassword />\n\t\t\t\t</Suspense>} />\n\t\t\t\t<Route path=\"/terms\" element={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t<AsyncTerms />\n\t\t\t\t</Suspense>} />\n\t\t\t\t<Route path=\"/privacy\" element={<Suspense fallback={<Spinner />}>\n\t\t\t\t\t<AsyncPrivacy />\n\t\t\t\t</Suspense>} />\n\t\t\t</Routes>\n\t\t\t<FooterBar />\n\t\t\t<NotificationSystem />\n\t\t</div>\n\t);\n};\n\n\n// PROPERTIES //\n\nApp.propTypes = {\n\tdispatch: PropTypes.func.isRequired,\n\tfetchCredentials: PropTypes.func.isRequired,\n\tgetCompletionRules: PropTypes.func.isRequired,\n\tgetCustomTranslations: PropTypes.func.isRequired,\n\tgetEnrollableCohorts: PropTypes.func.isRequired,\n\tgetPublicSettings: PropTypes.func.isRequired,\n\tisLoggedIn: PropTypes.bool.isRequired,\n\tsettings: PropTypes.object.isRequired,\n\tuser: PropTypes.object.isRequired\n};\n\n\n// EXPORTS //\n\nexport default connect( mapStateToProps, mapDispatchToProps )( App );\n\nfunction mapStateToProps( state ) {\n\treturn {\n\t\tisLoggedIn: state.user.loggedIn,\n\t\tuser: state.user,\n\t\tsettings: state.settings\n\t};\n}\n\nfunction mapDispatchToProps( dispatch ) {\n\treturn {\n\t\tdispatch: dispatch,\n\t\tfetchCredentials: fetchCredentialsInjector( dispatch ),\n\t\tgetCompletionRules: getCompletionRulesInjector( dispatch ),\n\t\tgetCustomTranslations: getCustomTranslationsInjector( dispatch ),\n\t\tgetPublicSettings: getPublicSettingsInjector( dispatch ),\n\t\tgetEnrollableCohorts: getEnrollableCohortsInjector( dispatch )\n\t};\n}\n","/**\r\n* MIT License\r\n*\r\n* Copyright (c) 2013-present, Facebook, Inc.\r\n*\r\n* Permission is hereby granted, free of charge, to any person obtaining a copy\r\n* of this software and associated documentation files (the \"Software\"), to deal\r\n* in the Software without restriction, including without limitation the rights\r\n* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n* copies of the Software, and to permit persons to whom the Software is\r\n* furnished to do so, subject to the following conditions:\r\n*\r\n* The above copyright notice and this permission notice shall be included in all\r\n* copies or substantial portions of the Software.\r\n*\r\n* THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r\n* SOFTWARE.\r\n*/\r\n\r\n/* eslint-disable no-process-env, no-console */\r\n\r\nconst isLocalhost = Boolean(\r\n\twindow.location.hostname === 'localhost' ||\r\n\t\t// [::1] is the IPv6 localhost address.\r\n\t\twindow.location.hostname === '[::1]' ||\r\n\t\t// 127.0.0.0/8 are considered localhost for IPv4.\r\n\t\twindow.location.hostname.match(\r\n\t\t\t/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n\t\t)\r\n);\r\n\r\nexport function register( config ) {\r\n\tif ( process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator ) {\r\n\t\t// The URL constructor is available in all browsers that support SW.\r\n\t\twindow.addEventListener('load', () => {\r\n\t\t\tconst swUrl = `${window.location.origin}/dashboard/service-worker.js`;\r\n\t\t\tif ( isLocalhost ) {\r\n\t\t\t\t// This is running on localhost. Let's check if a service worker still exists or not.\r\n\t\t\t\tcheckValidServiceWorker( swUrl, config );\r\n\r\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the service worker/PWA documentation.\r\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\r\n\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t'This web app is being served cache-first by a service ' +\r\n\t\t\t\t\t\t\t'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// Is not localhost. Just register service worker\r\n\t\t\t\tregisterValidSW( swUrl, config );\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction registerValidSW( swUrl, config ) {\r\n\tnavigator.serviceWorker\r\n\t\t.register(swUrl)\r\n\t\t.then(registration => {\r\n\t\t\tregistration.onupdatefound = () => {\r\n\t\t\t\tconst installingWorker = registration.installing;\r\n\t\t\t\tif ( installingWorker === null ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tinstallingWorker.onstatechange = () => {\r\n\t\t\t\t\tif ( installingWorker.state === 'installed' ) {\r\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\r\n\t\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t\t\tAt this point, the updated precached content has been fetched,\r\n\t\t\t\t\t\t\t\tbut the previous service worker will still serve the older\r\n\t\t\t\t\t\t\t\tcontent until all client tabs are closed.\r\n\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\t'New content is available and will be used when all ' +\r\n\t\t\t\t\t\t\t\t\t'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t// Execute callback\r\n\t\t\t\t\t\t\tif (config && config.onUpdate) {\r\n\t\t\t\t\t\t\t\tconfig.onUpdate(registration);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t\t\tAt this point, everything has been precached.\r\n\t\t\t\t\t\t\t\tIt's the perfect time to display a\r\n\t\t\t\t\t\t\t\t\"Content is cached for offline use.\" message.\r\n\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\tconsole.log('Content is cached for offline use.');\r\n\t\t\t\t\t\t\t// Execute callback\r\n\t\t\t\t\t\t\tif (config && config.onSuccess) {\r\n\t\t\t\t\t\t\t\tconfig.onSuccess(registration);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t};\r\n\t\t})\r\n\t\t.catch(error => {\r\n\t\t\tconsole.error( 'Error during service worker registration:', error );\r\n\t\t});\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n\t// Check if the service worker can be found. If it can't reload the page.\r\n\tfetch(swUrl, {\r\n\t\theaders: { 'Service-Worker': 'script' }\r\n\t})\r\n\t\t.then(response => {\r\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\r\n\t\t\tconst contentType = response.headers.get('content-type');\r\n\t\t\tif (\r\n\t\t\t\tresponse.status === 404 ||\r\n\t\t\t\t(contentType !== null && contentType.indexOf('javascript') === -1)\r\n\t\t\t) {\r\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\r\n\t\t\t\tnavigator.serviceWorker.ready.then(registration => {\r\n\t\t\t\t\tregistration.unregister().then(() => {\r\n\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// Service worker found. Proceed as normal.\r\n\t\t\t\tregisterValidSW(swUrl, config);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(() => {\r\n\t\t\tconsole.log(\r\n\t\t\t\t'No internet connection found. App is running in offline mode.'\r\n\t\t\t);\r\n\t\t});\r\n}\r\n\r\nexport function unregister() {\r\n\tif ( 'serviceWorker' in navigator ) {\r\n\t\tnavigator.serviceWorker.ready.then(registration => {\r\n\t\t\tregistration.unregister();\r\n\t\t});\r\n\t}\r\n}\r\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport 'react-dates/initialize';\nimport React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport localforage from 'localforage';\nimport { Provider } from 'react-redux';\nimport { persistStore, persistReducer } from 'redux-persist';\nimport { PersistGate } from 'redux-persist/integration/react';\nimport { createStore } from 'redux';\nimport { BrowserRouter } from 'react-router-dom';\nimport { HelmetProvider } from 'react-helmet-async';\nimport createRootReducer from 'reducers';\nimport App from 'containers/app.js';\nimport * as serviceWorker from './service_worker.js';\nimport './helpers/axios';\nimport 'css/animations.css';\nimport 'css/index.css';\n\n\n// VARIABLES //\n\nconst persistConfig = {\n\tkey: 'root',\n\tblacklist: [ 'router', 'license', 'requestTFA' ],\n\tstorage: localforage\n};\nconst rootReducer = createRootReducer( history );\nconst persistedReducer = persistReducer( persistConfig, rootReducer );\n\nexport const store = createStore( persistedReducer );\nconst persistor = persistStore( store );\n\nconst container = document.getElementById( 'root' );\nconst root = createRoot( container );\n\n\n// MAIN //\n\nroot.render(\n\t<Provider store={store} >\n\t\t<PersistGate loading={null} persistor={persistor}>\n\t\t\t<HelmetProvider>\n\t\t\t\t<BrowserRouter basename=\"/dashboard\" >\n\t\t\t\t\t<App />\n\t\t\t\t</BrowserRouter>\n\t\t\t</HelmetProvider>\n\t\t</PersistGate>\n\t</Provider>\n);\n\nserviceWorker.register();\n"],"sourceRoot":""}