"use strict";(self.webpackChunkisle_dashboard=self.webpackChunkisle_dashboard||[]).push([[4882],{74882:function(e,t,a){a.r(t);var s=a(1413),n=a(15671),r=a(43144),l=a(97326),i=a(60136),o=a(29388),c=a(4942),m=a(41488),d=a(10077),p=a.n(d),h=a(25472),u=a(66734),f=a(87095),v=a(62300),E=a(47701),y=a(73109),g=a(23596),Z=a(72945),b=a(70048),k=a(75314),w=a(54544),x=a(17491),S=a(7131),A=a.n(S),T=a(67583),D=a.n(T),N=a(89161),z=a.n(N),P=a(42190),B=a.n(P),U=a(5557),C=a(63834),I=a(44593),q=a(83531),R=a(98032),_=a(52428);function F(e){var t=[];if(!e)return t;for(var a=1;a<e.length;a++){var s=e[a]-e[a-1];t.push(s)}return t}function H(e){switch(e){case"left":return"right";case"right":return"left";case"up":return"down";case"down":return"up"}}var L=p()("isle-dashboard:admin"),O=[0,.9,.1,.8,.2,.7,.3],j={users:I.Z[0],namespaces:I.Z[1],lessons:I.Z[2],cohorts:I.Z[3],files:I.Z[4],events:I.Z[5],sessionData:I.Z[7],dailyActiveUsers:I.Z[8],weeklyActiveUsers:I.Z[9],monthlyActiveUsers:I.Z[10],tickets:I.Z[11],closedTickets:I.Z[12],openTickets:I.Z[13]},M={users:"nUsers",namespaces:"nNamespaces",lessons:"nLessons",cohorts:"nCohorts",files:"nFiles",events:"nEvents",sessionData:"nSessionData",tickets:"nTickets",openTickets:"nOpenTickets",closedTickets:"nClosedTickets",dailyActiveUsers:"dailyActiveUsers",weeklyActiveUsers:"weeklyActiveUsers",monthlyActiveUsers:"monthlyActiveUsers"},G={users:!1,namespaces:!1,lessons:!1,cohorts:!1,files:!1,events:!1,sessionData:!1,dailyActiveUsers:!1,weeklyActiveUsers:!1,monthlyActiveUsers:!1,tickets:!1,openTickets:!1,closedTickets:!1},Y=["sendDataToCloud","zoom2d","pan2d","select2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleHover","toggleSpikelines","resetViews"],J=function(e){(0,i.Z)(a,e);var t=(0,o.Z)(a);function a(e){var r;return(0,n.Z)(this,a),r=t.call(this,e),(0,c.Z)((0,l.Z)(r),"hideExplorer",(function(){r.setState({dataExplorer:"hidden"})})),(0,c.Z)((0,l.Z)(r),"handleFilterChange",(function(e){for(var t=B()(e.target.value),a=[],s=0;s<r.props.statistics.actionTypes.length;s++){var n=r.props.statistics.actionTypes[s];if(n)(n._id.type||"").includes(t)&&a.push(n)}r.setState({filteredActionTypes:a})})),(0,c.Z)((0,l.Z)(r),"renderExplorer",(function(){var e;switch(r.state.dataExplorer){case"action-types":e=m.createElement(_.Z,{title:r.props.t("explorer-action-types-title"),data:(0,s.Z)((0,s.Z)({},r.state.historicalActionTypes),{},{time:r.props.historicalStatistics.map((function(e){return e.createdAt}))}),categorical:["time"],close:r.hideExplorer});break;case"overview-statistics":e=m.createElement(_.Z,{title:r.props.t("explorer-overview-stats-title"),data:(0,R.Z)(r.props.historicalStatistics),categorical:["createdAt"],close:r.hideExplorer})}return e})),r.state={displayInPlot:(0,s.Z)((0,s.Z)({},G),{},{users:!0}),revision:0,filteredActionTypes:e.statistics.actionTypes,historicalActionTypes:null,useDifferencing:!1,dataExplorer:"hidden"},r}return(0,r.Z)(a,[{key:"componentDidMount",value:function(){this.props.getOverviewStatistics();var e=this.props.historicalStatistics[this.props.historicalStatistics.length-1];if(e&&e.updatedAt){var t=new Date(e.updatedAt),a=t.getFullYear(),s=t.getMonth(),n=t.getDate();L("Latest data from ".concat(s,"/").concat(n,"/").concat(a,"..."));var r=new Date,l=r.getFullYear(),i=r.getMonth(),o=r.getDate();L("Current date is ".concat(i,"/").concat(o,"/").concat(l)),(l>a||i>s||o>n)&&(L("Request historical data from server..."),this.props.getHistoricalOverviewStats())}else L("Retrieve overview data..."),this.props.getHistoricalOverviewStats();this.props.historicalStatistics&&this.extractHistoricalActionTypes()}},{key:"componentDidUpdate",value:function(e){this.props.statistics.actionTypes!==e.statistics.actionTypes&&this.setState({filteredActionTypes:this.props.statistics.actionTypes}),this.props.historicalStatistics.length!==e.historicalStatistics.length&&this.extractHistoricalActionTypes()}},{key:"extractHistoricalActionTypes",value:function(){L("Extract and format action types for time series display...");for(var e=z()(this.props.historicalStatistics,"actionTypes"),t={},a=0;a<e.length;a++)if(e[a])for(var s=0;s<e[a].length;s++){var n=e[a][s],r=n._id.type;t[r]||(t[r]=[]),t[r][a]=n.count}this.setState({historicalActionTypes:t})}},{key:"renderTimeSeries",value:function(){for(var e=this,t="",a=this.props.historicalStatistics,n=z()(a,"createdAt"),r=[n[0],n[n.length-1]],l={xaxis:{autorange:!0,range:r,rangeselector:{buttons:[{count:7,label:"1w",step:"day",stepmode:"backward"},{count:1,label:"1m",step:"month",stepmode:"backward"},{count:6,label:"6m",step:"month",stepmode:"backward"},{step:"all"}]},rangeslider:{range:r},type:"date",fixedrange:!0},legend:{orientation:"h"},margin:{l:10,r:15,b:30,t:30,pad:10}},i=D()(this.state.displayInPlot),o=[],c=[0,1],d=0;d<i.length;d++){var p=i[d];if(!0===this.state.displayInPlot[p]){t+=""===t?"":", ",t+=this.props.t("common:"+p);var h=void 0,u=void 0;j[p]?(h=j[p],u=z()(a,M[p])):(h=I.Z[d%I.Z.length+7],u=this.state.historicalActionTypes[p]),this.state.useDifferencing&&(u=F(u));var f={type:this.state.useDifferencing?"bar":"scatter",mode:"line",name:this.props.t("common:"+p),x:n,y:u,marker:{color:h}};this.state.useDifferencing&&(f.offsetgroup=o.length);var E=o.length;E>0&&(f.yaxis="y".concat(E+1)),o.push(f);var y={title:this.props.t("common:"+p),titlefont:{color:h},tickfont:{color:h},fixedrange:!0};o.length>1&&(y.overlaying="y"),o.length%2===0?(y.side="left",c[0]+=.1):(y.side="right",c[1]-=.1),y.position=O[o.length],0===E?l.yaxis=y:l["yaxis".concat(E+1)]=y}}return l.xaxis.domain=c,l.title="".concat(this.state.useDifferencing?this.props.t("daily-changes-of"):this.props.t("time-series-of")).concat(t),0===o.length?m.createElement(v.Z,{style:{width:"100%",height:"73.7%"}},m.createElement("h3",{style:{textAlign:"center",marginTop:"12%"}},"Select a variable to be displayed...")):m.createElement(m.Fragment,null,m.createElement(x.Z,{revision:this.state.revision,data:o,config:{displayModeBar:"hover",displaylogo:!1,modeBarButtonsToRemove:Y,modeBarButtonsToAdd:[{name:this.props.t("download-data"),icon:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},click:function(e){var a=new Blob([JSON.stringify(e.data)],{type:"application/json"});(0,q.Z)(a,"stats_".concat(t,".json"))}}]},layout:l,style:{width:"100%",height:"80%"},useResizeHandler:!0}),o.length>0?m.createElement(m.Fragment,null,m.createElement(b.Z,{onClick:function(){e.setState({displayInPlot:(0,s.Z)({},G),revision:e.state.revision+1})},style:{marginLeft:"35%"}},this.props.t("common:reset")),m.createElement(b.Z,{onClick:function(){e.setState({useDifferencing:!e.state.useDifferencing})},style:{marginLeft:"1%"}},this.state.useDifferencing?"Display Time Series":this.props.t("display-daily-changes"))):null)}},{key:"renderDiskUsage",value:function(){if(!this.props.statistics.database)return null;var e=this.props.statistics.database,t=e.fsUsedSize,a=e.fsTotalSize;t/=1073741824,a/=1073741824;var s=A()(t),n=A()(a-t),r=this.props.t;return m.createElement(x.Z,{data:[{values:[s,n],labels:["".concat(r("used-space"),": ").concat(s," GB"),"".concat(r("free-space"),": ").concat(n," GB")],type:"pie"}],config:{displayModeBar:!1,displaylogo:!1},layout:{plot_bgcolor:"rgba(0,0,0,0.0)",paper_bgcolor:"rgba(0,0,0,0.0)",xaxis:{fixedrange:!0},yaxis:{fixedrange:!0},autosize:!0,margin:{l:50,r:50,b:50,t:50}},useResizeHandler:!0,style:{width:"75%",height:"200px"}})}},{key:"renderDatabaseStats",value:function(){var e=this.props.t;if(!this.props.statistics.database)return null;var t=this.props.statistics.database,a=t.storageSize,s=t.dataSize,n=t.objects,r=t.avgObjSize;return m.createElement(w.Z,{variant:"flush",style:{fontSize:"1em"}},m.createElement(w.Z.Item,{style:{padding:".5rem 0.8rem"}},e("physical-storage-size"),": ",a),m.createElement(w.Z.Item,{style:{padding:".5rem 0.8rem"}},e("reserved-storage-size"),": ",s),m.createElement(w.Z.Item,{style:{padding:".5rem 0.8rem"}},e("number-of-objects"),": ",n," "),m.createElement(w.Z.Item,{style:{padding:".5rem 0.8rem"}},e("average-object-size"),": ",A()(r)))}},{key:"renderDailyStatistics",value:function(){var e=this.props.t,t=this.props.statistics,a=t.dailyActiveUsers,s=t.weeklyActiveUsers,n=t.monthlyActiveUsers,r=t.lastHourActiveUsers;return m.createElement(w.Z,{variant:"flush",style:{fontSize:"1em"}},m.createElement(w.Z.Item,{style:{padding:".5rem 0.8rem"}},e("last-hour-active-users"),":",m.createElement("span",{style:{float:"right",marginRight:56}},r)),m.createElement(w.Z.Item,{style:{padding:".5rem 0.8rem"}},m.createElement("span",null,e("daily-active-users"),":"),m.createElement("span",{style:{float:"right"}},m.createElement("span",{style:{marginRight:24}},a),this.renderPlotButton("dailyActiveUsers","down"))),m.createElement(w.Z.Item,{style:{padding:".5rem 0.8rem"}},m.createElement("span",null,e("weekly-active-users"),":"),m.createElement("span",{style:{float:"right"}},m.createElement("span",{style:{marginRight:24}},s),this.renderPlotButton("weeklyActiveUsers","down"))),m.createElement(w.Z.Item,{style:{padding:".5rem 0.8rem"}},m.createElement("span",null,e("monthly-active-users"),":"),m.createElement("span",{style:{float:"right"}},m.createElement("span",{style:{marginRight:24}},n),this.renderPlotButton("monthlyActiveUsers","down"))))}},{key:"renderActionTypes",value:function(){var e=this,t=this.state.filteredActionTypes;return t?m.createElement(m.Fragment,null,m.createElement("h2",null,this.props.t("common:actions"),m.createElement(u.Z,{placement:"right",overlay:m.createElement(E.Z,{id:"explorer-action-types-tooltip"},this.props.t("common:data-explorer"))},m.createElement(b.Z,{"aria-label":this.props.t("common:data-explorer"),onClick:function(){e.setState({dataExplorer:"action-types"})},style:{marginLeft:12}},m.createElement("i",{className:"fas fa-chart-bar"}))),m.createElement(U.Z,{style:{position:"absolute",top:0,right:8,width:140,fontSize:"1.2rem"},placeholder:"Search...",onChange:this.handleFilterChange})),m.createElement("div",{className:"action-types-table-container"},m.createElement(k.Z,{striped:!0,hover:!0,className:"action-types-table",size:"sm"},m.createElement("thead",null,m.createElement("tr",null,m.createElement("th",null,this.props.t("common:visualize")),m.createElement("th",null,this.props.t("common:type")),m.createElement("th",null,this.props.t("common:count")))),m.createElement("tbody",null,t.map((function(t,a){return m.createElement("tr",{key:a},m.createElement("td",null,e.renderPlotButton(t._id.type,"right")),m.createElement("td",null,t._id.type),m.createElement("td",null,t.count))})))))):null}},{key:"renderPlotButton",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",n=arguments.length>2?arguments[2]:void 0,r=function(){var a=(0,s.Z)({},t.state.displayInPlot);a[e]=!a[e],t.setState({displayInPlot:G},(function(){t.setState({displayInPlot:a,revision:t.state.revision+1})}))};return this.state.displayInPlot[e]?m.createElement(b.Z,{"aria-label":this.props.t("hide-data",{name:e}),variant:"warning",size:"sm",onClick:r},m.createElement("i",{className:n||"fas fa-arrow-circle-".concat(a)})):m.createElement(b.Z,{"aria-label":this.props.t("show-data",{name:e}),variant:"secondary",size:"sm",onClick:r},m.createElement("i",{className:n||"fas fa-arrow-circle-".concat(H(a))}))}},{key:"render",value:function(){var e=this;L("Rendering overview page...");var t=this.props.statistics,a=t.nUsers,s=t.nNamespaces,n=t.nLessons,r=t.nCohorts,l=t.nSessionData,i=t.nFiles,o=t.nEvents,c=t.nTickets,d=this.props.t,p=m.createElement(y.Z,{className:"admin-outer-container slide-in-right"},m.createElement(g.Z,{className:"first-row"},m.createElement(Z.Z,{className:"column-border",sm:4,md:3},m.createElement("h2",null,this.props.t("overall"),m.createElement(u.Z,{placement:"right",overlay:m.createElement(E.Z,{id:"explorer-overview-tooltip"},d("common:data-explorer"))},m.createElement(b.Z,{"aria-label":d("common:data-explorer"),onClick:function(){e.setState({dataExplorer:"overview-statistics"})},style:{marginLeft:12}},m.createElement("i",{className:"fas fa-chart-bar"}))),m.createElement("span",{className:"overview-server-name"},C.ZP)),m.createElement(k.Z,{striped:!0,hover:!0,className:"overview-table"},m.createElement("thead",null,m.createElement("tr",null,m.createElement("th",null,this.props.t("common:icon")),m.createElement("th",null,this.props.t("common:table")),m.createElement("th",null,this.props.t("common:count")),m.createElement("th",null,this.props.t("common:visualize")))),m.createElement("tbody",null,m.createElement("tr",null,m.createElement("td",null,m.createElement("i",{className:"fas fa-user",style:{color:j.users}})),m.createElement("td",null,d("admin:users")),m.createElement("td",null,a),m.createElement("td",null,this.renderPlotButton("users"))),m.createElement("tr",null,m.createElement("td",null,m.createElement("i",{className:"fas fa-school",style:{color:j.namespaces}})),m.createElement("td",null,d("common:courses")),m.createElement("td",null,s),m.createElement("td",null,this.renderPlotButton("namespaces"))),m.createElement("tr",null,m.createElement("td",null,m.createElement("i",{className:"fas fa-chalkboard",style:{color:j.lessons}})),m.createElement("td",null,d("common:lessons")),m.createElement("td",null,n),m.createElement("td",null,this.renderPlotButton("lessons"))),m.createElement("tr",null,m.createElement("td",null,m.createElement("i",{className:"fas fa-users",style:{color:j.cohorts}})),m.createElement("td",null,d("common:cohorts")),m.createElement("td",null,r),m.createElement("td",null,this.renderPlotButton("cohorts"))),m.createElement("tr",null,m.createElement("td",null,m.createElement("i",{className:"fas fa-file",style:{color:j.files}})),m.createElement("td",null,d("common:files")),m.createElement("td",null,i),m.createElement("td",null,this.renderPlotButton("files"))),m.createElement("tr",null,m.createElement("td",null,m.createElement("i",{className:"fas fa-clock",style:{color:j.events}})),m.createElement("td",null,d("common:events")),m.createElement("td",null,o),m.createElement("td",null,this.renderPlotButton("events"))),m.createElement("tr",null,m.createElement("td",null,m.createElement("i",{className:"fas fa-shoe-prints",style:{color:j.sessionData}})),m.createElement("td",null,d("common:sessionData")),m.createElement("td",null,l),m.createElement("td",null,this.renderPlotButton("sessionData"))),m.createElement("tr",null,m.createElement("td",null,m.createElement("i",{className:"fas fa-medkit",style:{color:j.tickets}})),m.createElement("td",null,d("common:tickets")),m.createElement("td",null,c),m.createElement("td",null,m.createElement(f.Z,null,this.renderPlotButton("tickets"),this.renderPlotButton("openTickets","left","fas fa-lock-open"),this.renderPlotButton("closedTickets","left","fas fa-lock"))))))),m.createElement(Z.Z,{className:"column-border",sm:8,md:6},m.createElement("h2",null,this.props.t("over-time")),this.renderTimeSeries()),m.createElement(Z.Z,{sm:12,md:3},this.renderActionTypes())),m.createElement(g.Z,{className:"second-row"},m.createElement(Z.Z,{md:3,sm:4,className:"column-border"},m.createElement("h3",null,d("disk-usage")),this.renderDiskUsage()),m.createElement(Z.Z,{md:6,sm:8,className:"column-border"},m.createElement("h3",null,d("database")),this.renderDatabaseStats()),m.createElement(Z.Z,{md:3,sm:12},m.createElement("h3",null,this.props.t("daily-statistics")),this.renderDailyStatistics())));return"hidden"===this.state.dataExplorer?p:this.renderExplorer()}}]),a}(m.Component);J.defaultProps={historicalStatistics:[],statistics:{}},t.default=(0,h.Z)(["admin","common"])(J)},5557:function(e,t,a){var s=a(1413),n=a(41488),r=a(25472),l=a(73230),i=a(75018),o=a(33226),c=a(70048);t.Z=(0,r.Z)(["header_bar","common"])((function(e){return n.createElement(l.Z,{style:(0,s.Z)({width:"14vw",minWidth:"120px",float:"left",marginBottom:"4px",marginRight:"5px"},e.style)},n.createElement(o.Z,null,n.createElement(i.Z,{className:"header-bar-search",type:"text",placeholder:e.placeholder,value:e.value,onChange:e.onChange,"aria-label":e.t("search-field"),style:{height:"38px"}}),n.createElement(o.Z.Append,null,n.createElement(c.Z,{"aria-label":e.t("search-field-icon"),disabled:!0,variant:"secondary",style:{cursor:"auto"}},n.createElement("i",{className:"fa fa-search"})))))}))},44593:function(e,t){t.Z=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#c49c94","#e377c2","#17becf","#aec7e8","#ffbb78","#ff9896","#98df8a","#7f7f7f","#c5b0d5","#f7b6d2","#bcbd22","#c7c7c7","#dbdb8d","#9edae5"]},52428:function(e,t,a){var s=(0,a(31835).Z)((function(){return Promise.all([a.e(7704),a.e(5999)]).then(a.bind(a,45369))}));t.Z=s}}]);
//# sourceMappingURL=4882.d10ca1ed.chunk.js.map