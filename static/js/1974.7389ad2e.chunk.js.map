{"version":3,"sources":["actions/namespace.js","components/async/index.js","constants/colors.js","ev/components/lesson-creator/index.js","ev/containers/lesson-creator/index.js","components/lessons-page/details_modal.js","components/lessons-page/delete_modal.js","components/lessons-page/lesson.js","components/lessons-page/enrolled_lesson.js","components/lessons-page/no_course_banner.js","components/lessons-page/no_lesson_banner.js","components/lessons-page/index.js","containers/visible-lessons-page/index.js","utils/file_saver.js","utils/format_time.js","utils/is_owner.js","utils/sort_lessons.js"],"names":[],"mappings":"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","file":"static/js/1974.7389ad2e.chunk.js","sourcesContent":["/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport axios from 'axios';\r\nimport qs from 'querystring';\r\nimport i18next from 'i18next';\r\nimport saveAs from 'utils/file_saver.js';\r\nimport server from 'constants/server';\r\nimport { addNotification, addErrorNotification } from 'actions/notification';\r\nimport { getCohorts } from 'actions/cohort';\r\nimport { APPEND_CREATED_NAMESPACE, CHANGED_NAMESPACE, DELETED_CURRENT_NAMESPACE, GET_ALL_NAMESPACES, UPDATED_OWNED_NAMESPACE, UPDATED_STUDENT_PROGRESS } from 'constants/action_types.js';\r\n\r\n\r\n// EXPORTS //\r\n\r\n/**\r\n * Returns an action object to be used in signalling that a namespace has been created.\r\n *\r\n * @param {Object} namespace - the created namespace\r\n * @returns {Object} the action object\r\n */\r\nexport function appendCreatedNamespace( namespace ) {\r\n\treturn {\r\n\t\ttype: APPEND_CREATED_NAMESPACE,\r\n\t\tpayload: {\r\n\t\t\tnamespace\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Returns an action object to be used in signalling that a namespace has been changed.\r\n *\r\n * @param {Object} namespace - the changed namespace\r\n * @param {string} namespace.title - namespace title\r\n * @param {Array} namespace.owners - ids of owners\r\n * @param {Array} namespace.announcements - announcements\r\n * @param {Array} namespace.cohorts - cohorts\r\n * @param {string} namespace.description - namespace description\r\n * @param {boolean} namespace.enableTicketing - controls if ticketing is enabled for the namespace\r\n * @param {string} namespace._id - id of the namespace\r\n * @returns {Object} the action object\r\n */\r\nexport function changedNamespace({ title, owners, announcements = [], cohorts = [], description, enableTicketing, _id }) {\r\n\treturn {\r\n\t\ttype: CHANGED_NAMESPACE,\r\n\t\tpayload: {\r\n\t\t\ttitle,\r\n\t\t\tannouncements,\r\n\t\t\tcohorts,\r\n\t\t\tdescription,\r\n\t\t\tenableTicketing,\r\n\t\t\towners,\r\n\t\t\t_id\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Returns an action object to be used in signalling that a namespace has been deleted.\r\n *\r\n * @param {string} id - the id of the namespace to be deleted\r\n * @returns {Object} the action object\r\n */\r\nexport function deletedCurrentNamespace( id ) {\r\n\treturn {\r\n\t\ttype: DELETED_CURRENT_NAMESPACE,\r\n\t\tpayload: {\r\n\t\t\tid\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Returns an action object to be used in signalling that a student's progress has been updated.\r\n *\r\n * @param {Object} options - progress of the student\r\n * @param {string} options.email - email of the student\r\n * @param {string} options.lessonId - lesson id\r\n * @param {number} options.progress - progress of the student\r\n * @param {Object} options.cohort - cohort of the student\r\n */\r\nexport function updateStudentProgress({ email, lessonID, progress, cohort }) {\r\n\treturn {\r\n\t\ttype: UPDATED_STUDENT_PROGRESS,\r\n\t\tpayload: {\r\n\t\t\temail, lessonID, progress, cohort\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Returns an action object to be used in signalling that an owned namespace has been updated.\r\n *\r\n * @param {Object} namespace - the updated namespace\r\n * @param {string} namespace.title - namespace title\r\n * @param {Array} namespace.owners - ids of owners\r\n * @param {Array} namespace.enableTicketing - controls if ticketing is enabled for the namespace\r\n * @param {string} namespace._id - id of the namespace\r\n * @returns {Object} the action object\r\n */\r\nexport function updatedOwnedNamespace({ title, owners, description, enableTicketing, _id }) {\r\n\treturn {\r\n\t\ttype: UPDATED_OWNED_NAMESPACE,\r\n\t\tpayload: {\r\n\t\t\ttitle,\r\n\t\t\tdescription,\r\n\t\t\towners,\r\n\t\t\tenableTicketing,\r\n\t\t\t_id\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Makes a POST request to create a new namespace.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} namespace - the new namespace\r\n * @param {string} namespace.title - namespace title\r\n * @param {Array} namespace.description - namespace description\r\n * @param {Array} namespace.owners - ids of owners\r\n * @param {Object} namespace.props - properties of the invoking component\r\n */\r\nexport const createNamespace = async ( dispatch, { title, description, owners, props }) => {\r\n\ttry {\r\n\t\tconst res = await axios.post( server+'/create_namespace', { title, description, owners });\r\n\t\tif ( !res.data.successful ) {\r\n\t\t\treturn addErrorNotification( dispatch, new Error( res.data.message ));\r\n\t\t}\r\n\t\tconst namespace = res.data.namespace;\r\n\t\tprops.onNamespace( namespace );\r\n\t\tdispatch( appendCreatedNamespace( namespace ) );\r\n\t\twindow.location.replace( '/dashboard/lessons' );\r\n\t\taddNotification( dispatch, {\r\n\t\t\tmessage: res.data.message,\r\n\t\t\tlevel: res.data.successful ? 'success' : 'error'\r\n\t\t});\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function to make a POST request to create a new namespace.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make the POST request to create a new namespace\r\n */\r\nexport const createNamespaceInjector = dispatch => {\r\n\treturn async ({ title, description, owners, props }) => {\r\n\t\tawait createNamespace( dispatch, { title, description, owners, props } );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a POST request to delete a namespace.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {string} id - the id of the namespace to be deleted\r\n * @returns {void}\r\n */\r\nexport const deleteCurrentNamespace = async ( dispatch, id ) => {\r\n\ttry {\r\n\t\tconst res = await axios.post( server+'/delete_namespace', { id });\r\n\t\twindow.location.replace( '/dashboard/lessons' );\r\n\t\tdispatch( deletedCurrentNamespace( id ) );\r\n\t\taddNotification( dispatch, {\r\n\t\t\tmessage: res.data.message,\r\n\t\t\tlevel: 'success'\r\n\t\t});\r\n\t} catch ( err ) {\r\n\t\treturn addErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function to make a POST request to delete a namespace.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make the POST request to delete a namespace\r\n */\r\nexport const deleteCurrentNamespaceInjector = ( dispatch ) => {\r\n\treturn async ( id ) => {\r\n\t\tawait deleteCurrentNamespace( dispatch, id );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a POST request to update a namespace.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} ns - the updated namespace\r\n */\r\nexport const updateCurrentNamespace = async ( dispatch, ns ) => {\r\n\ttry {\r\n\t\tconst res = await axios.post( server+'/update_namespace', { ns });\r\n\t\tdispatch( changedNamespace( res.data.namespace ) );\r\n\t\tdispatch( updatedOwnedNamespace( res.data.namespace ) );\r\n\t\taddNotification( dispatch, {\r\n\t\t\tmessage: res.data.message,\r\n\t\t\tlevel: 'success'\r\n\t\t});\r\n\t\tgetCohorts( dispatch, {\r\n\t\t\tnamespaceID: ns._id\r\n\t\t});\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function to make a POST request to update a namespace.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make the POST request to update a namespace\r\n */\r\nexport const updateCurrentNamespaceInjector = ( dispatch ) => {\r\n\treturn async ( id, ns ) => {\r\n\t\tawait updateCurrentNamespace( dispatch, id, ns );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a GET request to get a namespace's actions.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} options - request options\r\n * @param {string} options.namespaceID - id of the namespace\r\n * @param {string} options.namespaceTitle - title of the namespace\r\n * @returns {void}\r\n */\r\nexport const getNamespaceActions = async ( dispatch, { namespaceID, namespaceTitle } ) => {\r\n\ttry {\r\n\t\tconst res = await axios.get( server+'/get_namespace_actions?'+qs.stringify({ namespaceID }) );\r\n\t\tconst blob = new Blob([ res.data ], {\r\n\t\t\ttype: 'application/json'\r\n\t\t});\r\n\t\tconst name = `actions_${namespaceTitle}.json`;\r\n\t\tsaveAs( blob, name );\r\n\t} catch ( err ) {\r\n\t\taddErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function to make a GET request to get a namespace's actions.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make the GET request to get a namespace's actions\r\n */\r\nexport const getNamespaceActionsInjector = ( dispatch ) => {\r\n\treturn async ({ namespaceID, namespaceTitle }) => {\r\n\t\tawait getNamespaceActions( dispatch, { namespaceID, namespaceTitle });\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a POST request to update a user's lesson progress.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} options - request options\r\n * @param {string} options.namespaceID - id of the namespace\r\n * @param {string} options.lessonID - id of the lesson\r\n * @param {string} options.email - email of the user\r\n * @param {number} options.progress - progress of the user\r\n * @param {Object} options.cohort - cohort of the user\r\n */\r\nexport const adjustProgress = async ( dispatch, { email, lessonID, namespaceID, progress, cohort }) => {\r\n\tconst res = await axios.post( server+'/user_adjust_progress', {\r\n\t\temail, lessonID, namespaceID, progress\r\n\t});\r\n\taddNotification( dispatch, {\r\n\t\ttitle: i18next.t('common:updated'),\r\n\t\tmessage: res.data.message,\r\n\t\tlevel: 'success'\r\n\t});\r\n\tdispatch( updateStudentProgress({ email, lessonID, progress, cohort }) );\r\n};\r\n\r\n/**\r\n * Returns a function to make a POST request to update a user's lesson progress.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make the POST request to update a user's lesson progress\r\n */\r\nexport const adjustProgressInjector = ( dispatch ) => {\r\n\treturn async ( { email, lessonID, namespaceID, progress, cohort } ) => {\r\n\t\tawait adjustProgress( dispatch, { email, lessonID, namespaceID, progress, cohort } );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a GET request to get a all available namespaces.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {void}\r\n */\r\nexport const getAllNamespaces = async ( dispatch ) => {\r\n\ttry {\r\n\t\tconst res = await axios.get( server+'/get_all_namespaces' );\r\n\t\tdispatch({\r\n\t\t\ttype: GET_ALL_NAMESPACES,\r\n\t\t\tpayload: {\r\n\t\t\t\tnamespaces: res.data.namespaces\r\n\t\t\t}\r\n\t\t});\r\n\t} catch ( err ) {\r\n\t\treturn addErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function to make a GET request to get a all available namespaces.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make the GET request to get a all available namespaces\r\n */\r\nexport const getAllNamespacesInjector = ( dispatch ) => {\r\n\treturn async () => {\r\n\t\tawait getAllNamespaces( dispatch );\r\n\t};\r\n};\r\n\r\n/**\r\n * Makes a POST request to set the order lessons appear on the dashboard.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @param {Object} options - request options\r\n * @param {Array} options.lessons - lessons of the course in the order to be displayed on the dashboard\r\n * @param {string} options.id - id of the namespace\r\n * @returns {void}\r\n */\r\nexport const setLessonOrder = async ( dispatch, { lessons, id }) => {\r\n\ttry {\r\n\t\tawait axios.post( server+'/set_lesson_order', {\r\n\t\t\tlessons, id\r\n\t\t});\r\n\t} catch ( err ) {\r\n\t\treturn addErrorNotification( dispatch, err );\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns a function to make a POST request to set the order lessons appear on the dashboard.\r\n *\r\n * @param {Function} dispatch - dispatch function\r\n * @returns {Function} function to make the POST request to set the order lessons appear on the dashboard\r\n */\r\nexport const setLessonOrderInjector = ( dispatch ) => {\r\n\treturn async ({ lessons, id }) => {\r\n\t\tawait setLessonOrder( dispatch, { lessons, id } );\r\n\t};\r\n};\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component } from 'react';\r\nimport Spinner from 'components/spinner';\r\n\r\n\r\n// MAIN //\r\n\r\nfunction asyncComponent( importComponent ) {\r\n\tclass AsyncComponent extends Component {\r\n\t\tconstructor( props ) {\r\n\t\t\tsuper( props );\r\n\r\n\t\t\tthis.state = {\r\n\t\t\t\tcomponent: null\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tasync componentDidMount() {\r\n\t\t\tconst { default: component } = await importComponent();\r\n\t\t\tthis.setState({ // eslint-disable-line react/no-did-mount-set-state\r\n\t\t\t\tcomponent: component\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\trender() {\r\n\t\t\tconst C = this.state.component;\r\n\t\t\treturn C ? <C {...this.props} /> : <Spinner />;\r\n\t\t}\r\n\t}\r\n\treturn AsyncComponent;\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default asyncComponent;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MAIN //\r\n\r\nconst COLORS = [\r\n\t'#1f77b4',\r\n\t'#ff7f0e',\r\n\t'#2ca02c',\r\n\t'#d62728',\r\n\t'#9467bd',\r\n\t'#8c564b',\r\n\t'#c49c94',\r\n\t'#e377c2',\r\n\t'#17becf',\r\n\t'#aec7e8',\r\n\t'#ffbb78',\r\n\t'#ff9896',\r\n\t'#98df8a',\r\n\t'#7f7f7f',\r\n\t'#c5b0d5',\r\n\t'#f7b6d2',\r\n\t'#bcbd22',\r\n\t'#c7c7c7',\r\n\t'#dbdb8d',\r\n\t'#9edae5'\r\n];\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default COLORS;\r\n","// MODULES //\r\n\r\nimport asyncComponent from 'components/async';\r\n\r\n\r\n// MAIN //\r\n\r\nconst LessonCreator = asyncComponent( () => import( './main.js' ) );\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default LessonCreator;\r\n","// MODULES //\r\n\r\nimport { connect } from 'react-redux';\r\nimport LessonCreator from 'ev/components/lesson-creator';\r\nimport { copyLessonInjector } from 'actions/lesson';\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nfunction mapStateToProps( state ) {\r\n\treturn {\r\n\t\tadmin: state.admin,\r\n\t\tuser: state.user\r\n\t};\r\n}\r\n\r\nfunction mapDispatchToProps( dispatch ) {\r\n\treturn {\r\n\t\tcopyLesson: copyLessonInjector( dispatch )\r\n\t};\r\n}\r\n\r\n\r\n// MAIN //\r\n\r\nconst VisibleLessonCreator = connect( mapStateToProps, mapDispatchToProps )( LessonCreator );\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default VisibleLessonCreator;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport logger from 'debug';\r\nimport Button from 'react-bootstrap/Button';\r\nimport FormControl from 'react-bootstrap/FormControl';\r\nimport FormLabel from 'react-bootstrap/FormLabel';\r\nimport FormGroup from 'react-bootstrap/FormGroup';\r\nimport Form from 'react-bootstrap/Form';\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport DateTimePicker from 'react-datetime-picker';\r\nimport isEmptyObject from '@stdlib/assert/is-empty-object';\r\nimport SERVER from 'constants/server';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst debug = logger( 'isle-dashboard' );\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nfunction preventPropagation( event ) {\r\n\tevent.stopPropagation();\r\n}\r\n\r\n\r\n// MAIN //\r\n\r\nclass DetailsModal extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\r\n\t\tlet unlockLesson;\r\n\t\tlet lockLesson;\r\n\t\tlet lockUntil;\r\n\t\tlet lockAfter;\r\n\t\tif ( props.lockUntil ) {\r\n\t\t\tunlockLesson = true;\r\n\t\t\tlockUntil = props.lockUntil;\r\n\t\t} else {\r\n\t\t\tunlockLesson = false;\r\n\t\t\tlockUntil = new Date();\r\n\t\t}\r\n\t\tif ( props.lockAfter ) {\r\n\t\t\tlockLesson = true;\r\n\t\t\tlockAfter = props.lockAfter;\r\n\t\t} else {\r\n\t\t\tlockLesson = false;\r\n\t\t\tlockAfter = new Date();\r\n\t\t}\r\n\t\tthis.state = {\r\n\t\t\ttitle: props.title,\r\n\t\t\tdescription: props.description,\r\n\t\t\tdisabled: false,\r\n\t\t\thideFromDashboard: props.hideFromDashboard,\r\n\t\t\ttemplate: props.template,\r\n\t\t\tchangedTemplate: false,\r\n\t\t\tunlockLesson,\r\n\t\t\tlockUntil,\r\n\t\t\tlockLesson,\r\n\t\t\tlockAfter\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidUpdate( prevProps ) {\r\n\t\tconst newState = {};\r\n\t\tif ( prevProps.title !== this.props.title ) {\r\n\t\t\tnewState.title = this.props.title;\r\n\t\t}\r\n\t\tif ( prevProps.description !== this.props.description ) {\r\n\t\t\tnewState.description = this.props.description;\r\n\t\t}\r\n\t\tif ( prevProps.template !== this.props.template ) {\r\n\t\t\tnewState.template = this.props.template;\r\n\t\t}\r\n\t\tif ( prevProps.lockUntil !== this.props.lockUntil ) {\r\n\t\t\tif ( this.props.lockUntil ) {\r\n\t\t\t\tnewState.unlockLesson = true;\r\n\t\t\t\tnewState.lockUntil = this.props.lockUntil;\r\n\t\t\t} else {\r\n\t\t\t\tnewState.unlockLesson = false;\r\n\t\t\t\tnewState.lockUntil = new Date();\r\n\t\t\t}\r\n\t\t}\r\n\t\tif ( prevProps.lockAfter !== this.props.lockAfter ) {\r\n\t\t\tif ( this.props.lockAfter ) {\r\n\t\t\t\tnewState.lockLesson = true;\r\n\t\t\t\tnewState.lockAfter = this.props.lockAfter;\r\n\t\t\t} else {\r\n\t\t\t\tnewState.lockLesson = false;\r\n\t\t\t\tnewState.lockAfter = new Date();\r\n\t\t\t}\r\n\t\t}\r\n\t\tif ( !isEmptyObject( newState ) ) {\r\n\t\t\tthis.setState( newState );\r\n\t\t}\r\n\t}\r\n\r\n\thandleInputChange = ( event ) => {\r\n\t\tconst target = event.target;\r\n\t\tconst value = target.value;\r\n\t\tconst name = target.name;\r\n\t\tdebug( `Input field ${name} changed to ${value}` );\r\n\t\tthis.setState({\r\n\t\t\t[ name ]: value\r\n\t\t}, () => {\r\n\t\t\tif ( this.state.title.length >= 3 && this.state.description.length > 0 ) {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tdisabled: false\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tdisabled: true\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\thandleUnlockChange = ( event ) => {\r\n\t\tthis.setState({\r\n\t\t\tunlockLesson: event.target.checked\r\n\t\t});\r\n\t};\r\n\r\n\thandleLockChange = ( event ) => {\r\n\t\tthis.setState({\r\n\t\t\tlockLesson: event.target.checked\r\n\t\t});\r\n\t};\r\n\r\n\thandleTimeUntilChange = ( value ) => {\r\n\t\tthis.setState({\r\n\t\t\tlockUntil: value\r\n\t\t});\r\n\t};\r\n\r\n\thandleTimeAfterChange = ( value ) => {\r\n\t\tthis.setState({\r\n\t\t\tlockAfter: value\r\n\t\t});\r\n\t};\r\n\r\n\thandleTemplateChange = ( event ) => {\r\n\t\tthis.setState({\r\n\t\t\ttemplate: event.target.checked,\r\n\t\t\tchangedTemplate: true\r\n\t\t});\r\n\t};\r\n\r\n\thideFromDashboardChange = ( event ) => {\r\n\t\tthis.setState({\r\n\t\t\thideFromDashboard: event.target.checked\r\n\t\t});\r\n\t};\r\n\r\n\tonSubmit = ( evt ) => {\r\n\t\tevt.preventDefault();\r\n\t\tconst details = {\r\n\t\t\tnewTitle: this.state.title,\r\n\t\t\tnewDescription: this.state.description\r\n\t\t};\r\n\t\tif ( this.state.unlockLesson ) {\r\n\t\t\tdetails.lockUntil = this.state.lockUntil;\r\n\t\t}\r\n\t\tif ( this.state.lockLesson ) {\r\n\t\t\tdetails.lockAfter = this.state.lockAfter;\r\n\t\t}\r\n\t\tif ( this.state.hideFromDashboard !== this.props.hideFromDashboard ) {\r\n\t\t\tdetails.hideFromDashboard = this.state.hideFromDashboard;\r\n\t\t}\r\n\t\tif ( this.state.changedTemplate ) {\r\n\t\t\tdetails.template = this.state.template;\r\n\t\t}\r\n\t\tthis.props.update( details );\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { t } = this.props;\r\n\t\treturn (\r\n\t\t\t<Modal show={this.props.show} onHide={this.props.close}>\r\n\t\t\t\t<Form action={SERVER} method=\"get\" onSubmit={this.onSubmit} onKeyDown={preventPropagation} >\r\n\t\t\t\t\t<Modal.Header>\r\n\t\t\t\t\t\t<Modal.Title as=\"h3\">{t('lesson-details')}</Modal.Title>\r\n\t\t\t\t\t</Modal.Header>\r\n\t\t\t\t\t<Modal.Body className=\"d-grid gap-2\" >\r\n\t\t\t\t\t\t<FormGroup>\r\n\t\t\t\t\t\t\t<FormLabel>{t('common:title')}</FormLabel>\r\n\t\t\t\t\t\t\t<FormControl\r\n\t\t\t\t\t\t\t\tname=\"title\"\r\n\t\t\t\t\t\t\t\ttype=\"title\"\r\n\t\t\t\t\t\t\t\tonChange={this.handleInputChange}\r\n\t\t\t\t\t\t\t\tdefaultValue={this.state.title}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t\t<FormGroup>\r\n\t\t\t\t\t\t\t<FormLabel>{t('common:description')}</FormLabel>\r\n\t\t\t\t\t\t\t<FormControl\r\n\t\t\t\t\t\t\t\tname=\"description\"\r\n\t\t\t\t\t\t\t\ttype=\"description\"\r\n\t\t\t\t\t\t\t\tonChange={this.handleInputChange}\r\n\t\t\t\t\t\t\t\tdefaultValue={this.state.description}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t\t<FormGroup>\r\n\t\t\t\t\t\t\t<Form.Check\r\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\tlabel={t('common:lock-until')}\r\n\t\t\t\t\t\t\t\tchecked={this.state.unlockLesson}\r\n\t\t\t\t\t\t\t\tonChange={this.handleUnlockChange}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t{this.state.unlockLesson ? <DateTimePicker\r\n\t\t\t\t\t\t\t\t\tminDate={new Date()}\r\n\t\t\t\t\t\t\t\t\tonChange={this.handleTimeUntilChange}\r\n\t\t\t\t\t\t\t\t\tvalue={this.state.lockUntil}\r\n\t\t\t\t\t\t\t\t\tclearIcon={null}\r\n\t\t\t\t\t\t\t\t/> : null }\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t\t<FormGroup>\r\n\t\t\t\t\t\t\t<Form.Check\r\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\tlabel={t('common:lock-after')}\r\n\t\t\t\t\t\t\t\tchecked={this.state.lockLesson}\r\n\t\t\t\t\t\t\t\tonChange={this.handleLockChange}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t{this.state.lockLesson ? <DateTimePicker\r\n\t\t\t\t\t\t\t\t\tminDate={new Date()}\r\n\t\t\t\t\t\t\t\t\tonChange={this.handleTimeAfterChange}\r\n\t\t\t\t\t\t\t\t\tvalue={this.state.lockAfter}\r\n\t\t\t\t\t\t\t\t\tclearIcon={null}\r\n\t\t\t\t\t\t\t\t/> : null }\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t\t<FormGroup>\r\n\t\t\t\t\t\t\t<Form.Check\r\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\tlabel={t('common:hide-from-dashboard')}\r\n\t\t\t\t\t\t\t\tchecked={this.state.hideFromDashboard}\r\n\t\t\t\t\t\t\t\tonChange={this.hideFromDashboardChange}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t\t{ this.props.user.administrator ? <FormGroup>\r\n\t\t\t\t\t\t\t<Form.Check\r\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\tlabel={t('provide-as-template')}\r\n\t\t\t\t\t\t\t\tchecked={this.state.template}\r\n\t\t\t\t\t\t\t\tonChange={this.handleTemplateChange}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FormGroup> : null}\r\n\t\t\t\t\t</Modal.Body>\r\n\t\t\t\t\t<Modal.Footer>\r\n\t\t\t\t\t\t<Button onClick={this.props.close}>{t('common:cancel')}</Button>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tvariant=\"success\"\r\n\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\tdisabled={this.state.disabled}\r\n\t\t\t\t\t\t>{t('common:save')}</Button>\r\n\t\t\t\t\t</Modal.Footer>\r\n\t\t\t\t</Form>\r\n\t\t\t</Modal>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\n// PROPERTIES //\r\n\r\nDetailsModal.propTypes = {\r\n\tclose: PropTypes.func.isRequired,\r\n\tdescription: PropTypes.string.isRequired,\r\n\thideFromDashboard: PropTypes.bool,\r\n\tlockAfter: PropTypes.instanceOf( Date ),\r\n\tlockUntil: PropTypes.instanceOf( Date ),\r\n\tshow: PropTypes.bool.isRequired,\r\n\ttemplate: PropTypes.bool,\r\n\ttitle: PropTypes.string.isRequired,\r\n\tupdate: PropTypes.func.isRequired,\r\n\tuser: PropTypes.object.isRequired\r\n};\r\n\r\nDetailsModal.defaultProps = {\r\n\thideFromDashboard: false,\r\n\tlockAfter: null,\r\n\tlockUntil: null,\r\n\ttemplate: null\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default DetailsModal;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Modal from 'react-bootstrap/Modal';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n * Delete modal component.\r\n *\r\n * @param {Object} props - component properties\r\n * @param {boolean} props.show - boolean indicating if the modal is visible\r\n * @param {Function} props.close - callback to invoke when the modal is closed\r\n * @param {Function} props.delete - callback to invoke when the delete button is clicked\r\n * @param {string} props.title - lesson title\r\n * @param {Function} props.t - i18n translate function\r\n * @returns {ReactElement} delete modal\r\n */\r\nconst DeleteModal = ( props ) => (\r\n\t<Modal show={props.show} onHide={props.close}>\r\n\t\t<Modal.Header>\r\n\t\t\t<Modal.Title>{props.t('common:delete')}?</Modal.Title>\r\n\t\t</Modal.Header>\r\n\t\t<Modal.Body>\r\n\t\t\t{props.t('delete-modal-body', { name: props.title })}\r\n\t\t</Modal.Body>\r\n\t\t<Modal.Footer>\r\n\t\t\t<Button onClick={props.close}>{props.t('common:cancel')}</Button>\r\n\t\t\t<Button variant=\"danger\" onClick={props.delete} >{props.t('common:delete')}</Button>\r\n\t\t</Modal.Footer>\r\n\t</Modal>\r\n);\r\n\r\n\r\n// PROPERTIES //\r\n\r\nDeleteModal.propTypes = {\r\n\tclose: PropTypes.func.isRequired,\r\n\tdelete: PropTypes.func.isRequired,\r\n\tshow: PropTypes.bool.isRequired,\r\n\tt: PropTypes.func.isRequired,\r\n\ttitle: PropTypes.string.isRequired\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default DeleteModal;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component, Fragment } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport logger from 'debug';\r\nimport { withTranslation } from 'react-i18next';\r\nimport Badge from 'react-bootstrap/Badge';\r\nimport Button from 'react-bootstrap/Button';\r\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\r\nimport ButtonToolbar from 'react-bootstrap/ButtonToolbar';\r\nimport Card from 'react-bootstrap/Card';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport copyToClipboard from 'clipboard-copy';\r\nimport DetailsModal from './details_modal.js';\r\nimport DeleteModal from './delete_modal.js';\r\nimport COLORS from 'constants/colors';\r\nimport background from './architecture.jpeg';\r\nimport upload from './upload.svg';\r\nimport './lesson.css';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst DEFAULT_DESCRIPTION = 'No description supplied.';\r\nconst debug = logger( 'isle:lessons-page:lesson' );\r\nconst IS_IOS = isIOS();\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nfunction isIOS() {\r\n\treturn [\r\n\t\t'iPad Simulator',\r\n\t\t'iPhone Simulator',\r\n\t\t'iPod Simulator',\r\n\t\t'iPad',\r\n\t\t'iPhone',\r\n\t\t'iPod'\r\n\t].includes( navigator.platform ) ||\r\n\t(\r\n\t\tnavigator.userAgent.includes('Mac') &&\r\n\t\t'ontouchend' in document\r\n\t);\r\n}\r\n\r\n\r\n// MAIN //\r\n\r\nclass Lesson extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\r\n\t\tthis.state = {\r\n\t\t\tshowDeleteModal: false,\r\n\t\t\tshowDetailsModal: false,\r\n\t\t\tisleFile: null\r\n\t\t};\r\n\t}\r\n\r\n\ttoggleLessonState = () => {\r\n\t\tconst query = {\r\n\t\t\tlessonName: this.props.title,\r\n\t\t\tnamespaceName: this.props.namespace\r\n\t\t};\r\n\t\tif ( this.props.active ) {\r\n\t\t\tthis.props.deactivateLesson( query );\r\n\t\t} else {\r\n\t\t\tthis.props.activateLesson( query );\r\n\t\t}\r\n\t};\r\n\r\n\ttoggleLessonVisibility = () => {\r\n\t\tconst query = {\r\n\t\t\tlessonName: this.props.title,\r\n\t\t\tnamespaceName: this.props.namespace\r\n\t\t};\r\n\t\tif ( this.props.public ) {\r\n\t\t\tthis.props.hideLessonInGallery( query );\r\n\t\t} else {\r\n\t\t\tthis.props.showLessonInGallery( query );\r\n\t\t}\r\n\t};\r\n\r\n\tdelete = () => {\r\n\t\tthis.props.deleteLesson({\r\n\t\t\tlessonName: this.props.title,\r\n\t\t\tnamespaceName: this.props.namespace\r\n\t\t});\r\n\t\tthis.closeDeleteModal();\r\n\t};\r\n\r\n\tupdate = async ({ newTitle, newDescription, lockAfter, lockUntil, hideFromDashboard, template }) => {\r\n\t\tconst bool = await this.props.updateLesson({\r\n\t\t\tlessonName: this.props.title,\r\n\t\t\tnamespaceName: this.props.namespace,\r\n\t\t\tnewTitle,\r\n\t\t\tnewDescription,\r\n\t\t\ttemplate,\r\n\t\t\tlockAfter: lockAfter ? lockAfter.getTime() : null,\r\n\t\t\tlockUntil: lockUntil ? lockUntil.getTime() : null,\r\n\t\t\thideFromDashboard\r\n\t\t});\r\n\t\tif ( bool ) {\r\n\t\t\tthis.closeDetailsModal();\r\n\t\t}\r\n\t};\r\n\r\n\tshowDeleteModal = () => {\r\n\t\tthis.setState({ showDeleteModal: true });\r\n\t};\r\n\r\n\tshowDetailsModal = () => {\r\n\t\tthis.setState({ showDetailsModal: true });\r\n\t};\r\n\r\n\tcloseDeleteModal = () => {\r\n\t\tthis.setState({ showDeleteModal: false });\r\n\t};\r\n\r\n\tcloseDetailsModal = () => {\r\n\t\tthis.setState({ showDetailsModal: false });\r\n\t};\r\n\r\n\tgetIsleFile = async () => {\r\n\t\tdebug( 'Request ISLE source code from server...' );\r\n\t\tif ( !this.state.isleFile ) {\r\n\t\t\tconst data = await this.props.getIsleFile({\r\n\t\t\t\tlessonName: this.props.title,\r\n\t\t\t\tnamespaceName: this.props.namespace\r\n\t\t\t});\r\n\t\t\tif ( data ) {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tisleFile: data\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tcopyIsleFileToClipboard = () => {\r\n\t\tif ( !this.state.isleFile ) {\r\n\t\t\treturn this.props.addNotification({\r\n\t\t\t\tmessage: this.props.t('source-file-error'),\r\n\t\t\t\tlevel: 'error'\r\n\t\t\t});\r\n\t\t}\r\n\t\tconst promise = copyToClipboard( this.state.isleFile );\r\n\t\tpromise.then( () => {\r\n\t\t\tthis.props.addNotification({\r\n\t\t\t\tmessage: this.props.t('source-file-copied'),\r\n\t\t\t\tlevel: 'success'\r\n\t\t\t});\r\n\t\t}).catch( err => {\r\n\t\t\tthis.props.addNotification({\r\n\t\t\t\tmessage: err.message,\r\n\t\t\t\tlevel: 'error'\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\tcopyLinkToClipboard = () => {\r\n\t\tconst promise = copyToClipboard( this.props.url );\r\n\t\tpromise.then( () => {\r\n\t\t\tthis.props.addNotification({\r\n\t\t\t\tmessage: this.props.t('link-copied'),\r\n\t\t\t\tlevel: 'success'\r\n\t\t\t});\r\n\t\t}).catch( err => {\r\n\t\t\tthis.props.addNotification({\r\n\t\t\t\tmessage: err.message,\r\n\t\t\t\tlevel: 'error'\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\tcopyNameToClipboard = ( event ) => {\r\n\t\tevent.stopPropagation();\r\n\t\tconst promise = copyToClipboard( this.props.title );\r\n\t\tpromise.then( () => {\r\n\t\t\tthis.props.addNotification({\r\n\t\t\t\tmessage: this.props.t('name-copied'),\r\n\t\t\t\tlevel: 'success'\r\n\t\t\t});\r\n\t\t}).catch( err => {\r\n\t\t\tthis.props.addNotification({\r\n\t\t\t\tmessage: err.message,\r\n\t\t\t\tlevel: 'error'\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\topenLesson = () => {\r\n\t\tif ( IS_IOS ) {\r\n\t\t\twindow.location = this.props.url;\r\n\t\t} else {\r\n\t\t\tconst win = window.open( this.props.url, '_blank' );\r\n\t\t\twin.focus();\r\n\t\t}\r\n\t};\r\n\r\n\trenderButtonToolbarDate() {\r\n\t\tconst { t } = this.props;\r\n\r\n\t\tlet updated = new Date( this.props.updatedAt );\r\n\t\tupdated = updated.toLocaleDateString();\r\n\r\n\t\tlet date = new Date( this.props.createdAt );\r\n\t\tdate = date.toLocaleDateString();\r\n\t\treturn (\r\n\t\t\t<span className=\"lessons-upload\">\r\n\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"toggle_visibility\">{t('created-at')}</Tooltip>}>\r\n\t\t\t\t<span className=\"lessons-uploaded-image\">\r\n\t\t\t\t\t<img alt=\"Upload Date Icon\" style={{ stroke: 'white', fill: 'red' }} src={upload} />\r\n\t\t\t\t</span>\r\n\t\t\t</OverlayTrigger>\r\n\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"toggle_visibility\">{t('last-updated')}{updated}</Tooltip>}>\r\n\t\t\t\t<span className=\"lessons-uploaded\">{date}</span>\r\n\t\t\t</OverlayTrigger>\r\n\t\t</span>\r\n\t\t);\r\n\t}\r\n\r\n\trenderActivateButton() {\r\n\t\tconst { lockUntil, t } = this.props;\r\n\t\tconst activeStyle = this.props.active === true ? 'success' : 'warning';\r\n\t\tif ( lockUntil ) {\r\n\t\t\treturn ( <OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"lockUntil_disabled\">\r\n\t\t\t\t{t('scheduled-at', { date: lockUntil.toLocaleString() })}\r\n\t\t\t</Tooltip>} >\r\n\t\t\t\t<Badge\r\n\t\t\t\t\tclassName=\"lessons-status\"\r\n\t\t\t\t\tbg={activeStyle}\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\topacity: 0.3\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{this.props.active ? t('active') : t('inactive')}\r\n\t\t\t\t</Badge>\r\n\t\t\t</OverlayTrigger> );\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"toggle_availability\">{this.props.active ? t('disable-lesson') : t('activate-lesson')}</Tooltip>}>\r\n\t\t\t\t<Badge\r\n\t\t\t\t\tclassName=\"lessons-status\"\r\n\t\t\t\t\tonClick={this.toggleLessonState}\r\n\t\t\t\t\tbg={activeStyle}\r\n\t\t\t\t>\r\n\t\t\t\t\t{this.props.active ? t('active') : t('inactive')}\r\n\t\t\t\t</Badge>\r\n\t\t\t</OverlayTrigger>\r\n\t\t);\r\n\t}\r\n\r\n\trenderButtonToolbar() {\r\n\t\tconst { t } = this.props;\r\n\t\tconst publicStyle = this.props.public === true ? 'success' : 'warning';\r\n\t\treturn ( <ButtonToolbar className=\"lesson-button-toolbar\">\r\n\t\t\t<ButtonGroup style={{ marginRight: '2px' }} >\r\n\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"open_details\">{t('open-details')}</Tooltip>}>\r\n\t\t\t\t\t<Button size=\"sm\" variant=\"secondary\" onClick={this.showDetailsModal} aria-label={t('open-details')} >\r\n\t\t\t\t\t\t<i className=\"fa fa-cog\"></i>\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"delete_lesson\">{t('delete-lesson')}</Tooltip>}>\r\n\t\t\t\t\t<Button size=\"sm\" variant=\"secondary\" onClick={this.showDeleteModal} aria-label={t('delete-lesson')} >\r\n\t\t\t\t\t\t<i className=\"fa fa-trash-alt\"></i>\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"isle-file\">{t('copy-file')}</Tooltip>}>\r\n\t\t\t\t\t<Button variant=\"secondary\" size=\"sm\" onFocus={this.getIsleFile} onMouseEnter={this.getIsleFile}\r\n\t\t\t\t\t\tonClick={this.copyIsleFileToClipboard} style={{ float: 'right' }}\r\n\t\t\t\t\t\taria-label={t('copy-file')}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i className=\"fa fa-clipboard\"></i>\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</OverlayTrigger>\r\n\t\t\t</ButtonGroup>\r\n\t\t\t{this.renderActivateButton()}\r\n\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"toggle_visibility\">{this.props.public ? t('remove-from-gallery') : t('show-in-gallery') }</Tooltip>}>\r\n\t\t\t\t<Badge className=\"lessons-status\" onClick={this.toggleLessonVisibility} bg={publicStyle}>{this.props.public ? t(('public')) : t('private')}</Badge>\r\n\t\t\t</OverlayTrigger>\r\n\t\t\t{ this.renderButtonToolbarDate() }\r\n\t\t</ButtonToolbar> );\r\n\t}\r\n\r\n\trenderModals() {\r\n\t\treturn ( <Fragment>\r\n\t\t\t<DeleteModal {...this.props} show={this.state.showDeleteModal} close={this.closeDeleteModal} delete={this.delete} />\r\n\t\t\t{ this.state.showDetailsModal ?\r\n\t\t\t\t<DetailsModal {...this.props} show={this.state.showDetailsModal} close={this.closeDetailsModal} update={this.update} /> :\r\n\t\t\t\tnull\r\n\t\t\t}\r\n\t\t</Fragment> );\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { t } = this.props;\r\n\t\treturn (\r\n\t\t\t<Card className=\"animated-lesson-card\">\r\n\t\t\t\t<Card.Body style={{ padding: 0, opacity: this.props.hideFromDashboard ? 0.6 : 1.0 }}>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tfilter: 'grayscale(30%)',\r\n\t\t\t\t\t\t\tbackground: COLORS[ this.props.colorIndex ]\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tclassName=\"hovereffect\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\tclassName=\"img-responsive\"\r\n\t\t\t\t\t\t\tsrc={background}\r\n\t\t\t\t\t\t\tref={( div ) => {\r\n\t\t\t\t\t\t\t\tthis.img = div;\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\talt=\"Tile background\"\r\n\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\twidth: '100%',\r\n\t\t\t\t\t\t\t\theight: 180\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName=\"overlay\"\r\n\t\t\t\t\t\t\tstyle={{ cursor: 'cell' }}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<h2>\r\n\t\t\t\t\t\t\t\t<OverlayTrigger\r\n\t\t\t\t\t\t\t\t\tplacement=\"top\"\r\n\t\t\t\t\t\t\t\t\toverlay={<Tooltip id=\"copy_name\">\r\n\t\t\t\t\t\t\t\t\t\t{t('common:copy-name')\r\n\t\t\t\t\t\t\t\t\t}</Tooltip>}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"lesson-title-button\"\r\n\t\t\t\t\t\t\t\t\t\trole=\"button\" tabIndex={0}\r\n\t\t\t\t\t\t\t\t\t\tonClick={this.copyNameToClipboard}\r\n\t\t\t\t\t\t\t\t\t\tonKeyPress={this.copyNameToClipboard}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{this.props.title}\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t{this.props.description !== DEFAULT_DESCRIPTION ?\r\n\t\t\t\t\t\t\t\t<h3>{this.props.description}</h3> :\r\n\t\t\t\t\t\t\t\tnull\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\tref={( link ) => {\r\n\t\t\t\t\t\t\t\t\tthis.link = link;\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tclassName=\"info\"\r\n\t\t\t\t\t\t\t\tonClick={this.openLesson} onKeyPress={this.openLesson}\r\n\t\t\t\t\t\t\t\ttabIndex={0} role=\"button\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{t('open-lesson')}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"copy_link\">{t('common:copy-link')}</Tooltip>}>\r\n\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\trole=\"button\" tabIndex={0}\r\n\t\t\t\t\t\t\tclassName=\"lesson-link-icon fas fa-external-link-alt\"\r\n\t\t\t\t\t\t\tonClick={this.copyLinkToClipboard}\r\n\t\t\t\t\t\t\tonKeyPress={this.copyLinkToClipboard}\r\n\t\t\t\t\t\t\taria-label={t('common:copy-link')}\r\n\t\t\t\t\t\t></i>\r\n\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t{this.renderButtonToolbar()}\r\n\t\t\t\t\t{this.renderModals()}\r\n\t\t\t\t</Card.Body>\r\n\t\t\t</Card>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\n// PROPERTIES //\r\n\r\nLesson.propTypes = {\r\n\tactivateLesson: PropTypes.func.isRequired,\r\n\tactive: PropTypes.bool.isRequired,\r\n\taddNotification: PropTypes.func.isRequired,\r\n\tcolorIndex: PropTypes.number.isRequired,\r\n\tcreatedAt: PropTypes.any.isRequired,\r\n\tdeactivateLesson: PropTypes.func.isRequired,\r\n\tdeleteLesson: PropTypes.func.isRequired,\r\n\tdescription: PropTypes.string.isRequired,\r\n\tgetIsleFile: PropTypes.func.isRequired,\r\n\tgetLessons: PropTypes.func.isRequired,\r\n\thideFromDashboard: PropTypes.bool,\r\n\thideLessonInGallery: PropTypes.func.isRequired,\r\n\tlockAfter: PropTypes.instanceOf( Date ),\r\n\tlockUntil: PropTypes.instanceOf( Date ),\r\n\tnamespace: PropTypes.string.isRequired,\r\n\tpublic: PropTypes.bool.isRequired,\r\n\tshowLessonInGallery: PropTypes.func.isRequired,\r\n\ttitle: PropTypes.string.isRequired,\r\n\tupdateLesson: PropTypes.func.isRequired,\r\n\tupdatedAt: PropTypes.any.isRequired,\r\n\turl: PropTypes.string.isRequired,\r\n\tuser: PropTypes.object.isRequired\r\n};\r\n\r\nLesson.defaultProps = {\r\n\thideFromDashboard: false,\r\n\tlockAfter: null,\r\n\tlockUntil: null\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default withTranslation( [ 'lesson', 'common' ] )( Lesson );\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { useRef } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useTranslation } from 'react-i18next';\r\nimport Card from 'react-bootstrap/Card';\r\nimport ButtonToolbar from 'react-bootstrap/ButtonToolbar';\r\nimport ProgressBar from 'react-bootstrap/ProgressBar';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport copyToClipboard from 'clipboard-copy';\r\nimport round from '@stdlib/math/base/special/round';\r\nimport min from '@stdlib/math/base/special/min';\r\nimport COLORS from 'constants/colors';\r\nimport formatTime from 'utils/format_time.js';\r\nimport background from './architecture.jpeg';\r\nimport './lessons.css';\r\n\r\n\r\n// FUNCTIONS //\r\n\r\n/**\r\n * Adds a default background image to the card.\r\n *\r\n * @private\r\n * @param {Event} event - event object\r\n * @returns {void}\r\n */\r\nfunction addDefaultSrc( event ) {\r\n\tevent.target.src = background;\r\n}\r\n\r\n/**\r\n * Renders user progress.\r\n *\r\n * @private\r\n * @param {Object} props - component properties\r\n * @param {Object} props.user - user object\r\n * @param {string} props._id - id of the lesson\r\n * @param {Object} props.metadata - metadata associated with the lesson\r\n * @param {Function} props.t - i18n translation function\r\n * @returns {ReactElement} component\r\n */\r\nfunction LessonProgress( props ) {\r\n\tlet progress;\r\n\tif ( props.metadata && props.metadata.hideProgressBar === true ) {\r\n\t\treturn <div className=\"enrolled-lesson-progress\"></div>;\r\n\t}\r\n\tconst lessonData = props.user.lessonData;\r\n\tconst data = lessonData[ props._id ];\r\n\tif ( data ) {\r\n\t\tprogress = data.progress;\r\n\t\tprogress *= 100;\r\n\t\tprogress = min( round( progress ), 100.0 );\r\n\t} else {\r\n\t\tprogress = 0;\r\n\t}\r\n\tconst { t } = props;\r\n\treturn ( <div className=\"enrolled-lesson-progress\">\r\n\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"open_details\">{t('your-progress')}</Tooltip>}>\r\n\t\t\t<ProgressBar aria-label={t('your-progress')} variant='success' now={progress} label={`${progress}%`} />\r\n\t\t</OverlayTrigger>\r\n\t</div> );\r\n}\r\n\r\n/**\r\n * Renders user progress and information about the lesson.\r\n *\r\n * @private\r\n * @param {Object} props - component properties\r\n * @param {Object} props.user - user object\r\n * @param {string} props._id - id of the lesson\r\n * @param {Object} props.metadata - metadata associated with the lesson\r\n * @param {Function} props.t - i18n translation function\r\n * @returns {ReactElement} component\r\n */\r\nfunction LessonInfo( props ) {\r\n\tlet duration;\r\n\tconst lessonData = props.user.lessonData;\r\n\tconst data = lessonData[ props._id ];\r\n\tif ( data ) {\r\n\t\tduration = data.spentTime;\r\n\t} else {\r\n\t\tduration = 0;\r\n\t}\r\n\tconst { t } = props;\r\n\treturn (\r\n\t\t<ButtonToolbar style={{\r\n\t\t\tposition: 'absolute',\r\n\t\t\ttop: 180,\r\n\t\t\twidth: '100%',\r\n\t\t\theight: '36px',\r\n\t\t\tbackground: 'rgba(0, 0, 0, 0.75)'\r\n\t\t}}>\r\n\t\t\t<LessonProgress {...props} t={t} />\r\n\t\t\t<div className=\"enrolled-lesson-time\" style={{ width: '35%', height: '100%' }} >\r\n\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"open_details\">{t('time-format')}</Tooltip>}>\r\n\t\t\t\t\t<span>{t('time-spent')}: {formatTime( duration )}</span>\r\n\t\t\t\t</OverlayTrigger>\r\n\t\t\t</div>\r\n\t\t</ButtonToolbar>\r\n\t);\r\n}\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst DEFAULT_DESCRIPTION = 'No description supplied.';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n * A component which displays a lesson that the user has enrolled in.\r\n *\r\n * @param {Object} props - component properties\r\n * @param {string} props.title - title of the lesson\r\n * @param {string} props.description - description of the lesson\r\n * @param {string} props._id - id of the lesson\r\n * @param {string} props.url - URL of the lesson\r\n * @param {Object} props.metadata - metadata associated with the lesson\r\n * @param {number} props.colorIndex - color index associated with the lesson\r\n * @param {Object} props.user - user object\r\n * @param {Function} props.addNotification - function to add a notification\r\n * @returns {ReactElement} lesson component\r\n */\r\nconst EnrolledLesson = ( props ) => {\r\n\tconst { t } = useTranslation( [ 'lesson', 'common' ] );\r\n\tconst imgRef = useRef();\r\n\tconst openLesson = () => {\r\n\t\tconst win = window.open( props.url, '_blank' );\r\n\t\twin.focus();\r\n\t};\r\n\tconst showPreviewImage = () => {\r\n\t\timgRef.current.src = props.url+'/preview.jpg';\r\n\t};\r\n\tconst copyLinkToClipboard = () => {\r\n\t\tconst promise = copyToClipboard( props.url );\r\n\t\tpromise.then( () => {\r\n\t\t\tprops.addNotification({\r\n\t\t\t\tmessage: t('link-copied'),\r\n\t\t\t\tlevel: 'success'\r\n\t\t\t});\r\n\t\t}).catch( err => {\r\n\t\t\tprops.addNotification({\r\n\t\t\t\tmessage: err.message,\r\n\t\t\t\tlevel: 'error'\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\treturn (\r\n\t\t<Card className=\"animated-lesson-card\">\r\n\t\t\t<Card.Body style={{ padding: 0 }}>\r\n\t\t\t\t<div style={{\r\n\t\t\t\t\tfilter: 'grayscale(30%)',\r\n\t\t\t\t\tbackground: COLORS[ props.colorIndex ]\r\n\t\t\t\t}} onMouseOver={showPreviewImage} onFocus={showPreviewImage}\r\n\t\t\t\t\tclassName=\"hovereffect\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<img\r\n\t\t\t\t\t\tclassName=\"img-responsive\"\r\n\t\t\t\t\t\tsrc={background}\r\n\t\t\t\t\t\tref={imgRef}\r\n\t\t\t\t\t\talt=\"\"\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\twidth: '100%',\r\n\t\t\t\t\t\t\theight: 180\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonError={addDefaultSrc}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<div className=\"overlay\" >\r\n\t\t\t\t\t\t<h2>{props.title}</h2>\r\n\t\t\t\t\t\t{props.description !== DEFAULT_DESCRIPTION ?\r\n\t\t\t\t\t\t\t<h3>{props.description}</h3> :\r\n\t\t\t\t\t\t\tnull\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\tclassName=\"info\"\r\n\t\t\t\t\t\t\trole=\"button\" tabIndex={0}\r\n\t\t\t\t\t\t\tonClick={openLesson} onKeyPress={openLesson}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{t('open-lesson')}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id=\"copy_link\">{t('common:copy-link')}</Tooltip>}>\r\n\t\t\t\t\t<i\r\n\t\t\t\t\t\trole=\"button\" tabIndex={0}\r\n\t\t\t\t\t\tclassName=\"lesson-link-icon fas fa-external-link-alt\"\r\n\t\t\t\t\t\tonClick={copyLinkToClipboard}\r\n\t\t\t\t\t\tonKeyPress={copyLinkToClipboard}\r\n\t\t\t\t\t\taria-label={t('common:copy-link')}\r\n\t\t\t\t\t></i>\r\n\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t<LessonInfo {...props} t={t} />\r\n\t\t\t</Card.Body>\r\n\t\t</Card>\r\n\t);\r\n};\r\n\r\n\r\n// PROPERTIES //\r\n\r\nEnrolledLesson.propTypes = {\r\n\t'_id': PropTypes.string.isRequired,\r\n\taddNotification: PropTypes.func.isRequired,\r\n\tcolorIndex: PropTypes.number.isRequired,\r\n\tdescription: PropTypes.string.isRequired,\r\n\tmetadata: PropTypes.object,\r\n\ttitle: PropTypes.string.isRequired,\r\n\turl: PropTypes.string.isRequired,\r\n\tuser: PropTypes.object.isRequired\r\n};\r\n\r\nEnrolledLesson.defaultProps = {\r\n\tmetadata: null\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default EnrolledLesson;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n * A component which displays a message to the user indicating that they have not selected a course.\r\n *\r\n * @param {Object} props - component properties\r\n * @param {Object} props.t - i18next translation function\r\n * @param {Object} props.user - user object\r\n * @returns {ReactElement} banner component\r\n */\r\nconst NoCourseBanner = ( props ) => {\r\n\tconst { user } = props;\r\n\tconst { t } = useTranslation( [ 'lessons_page', 'common' ] );\r\n\tlet appendix = null;\r\n\tif ( user.writeAccess ) {\r\n\t\tappendix = <span>{t('create-new-one')}<i className=\"fa fa-pencil-alt\"></i>.</span>;\r\n\t} else {\r\n\t\tappendix = ' .';\r\n\t}\r\n\treturn ( <div className=\"jumbotron lessons-jumbotron\" >\r\n\t\t<h1>{t('common:no-course-selected')}</h1>\r\n\t\t<p>{t('no-course-description')}<i className=\"fa fa-align-justify\"></i>{appendix}\r\n\t\t</p>\r\n\t</div> );\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default NoCourseBanner;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n * A banner displayed for a course that has no lessons.\r\n *\r\n * @param {Object} props - component props\r\n * @param {Object} props.user - user object\r\n * @returns {ReactElement} banner\r\n */\r\nconst NoLessonBanner = ({ user }) => {\r\n\tconst { t } = useTranslation( [ 'lessons_page', 'common' ] );\r\n\tlet description = t('no-lessons');\r\n\tif ( user.writeAccess ) {\r\n\t\tdescription += t('upload-from-editor');\r\n\t}\r\n\treturn ( <div className=\"jumbotron lessons-jumbotron\">\r\n\t\t<h1>{t('no-lessons-found')}</h1>\r\n\t\t<p>{description}</p>\r\n\t</div> );\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default NoLessonBanner;\r\n\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component, Fragment } from 'react';\r\nimport logger from 'debug';\r\nimport { withTranslation } from 'react-i18next';\r\nimport PropTypes from 'prop-types';\r\nimport { Responsive, WidthProvider } from 'react-grid-layout';\r\nimport Button from 'react-bootstrap/Button';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport isArray from '@stdlib/assert/is-array';\r\nimport contains from '@stdlib/assert/contains';\r\nimport lowercase from '@stdlib/string/lowercase';\r\nimport pluck from '@stdlib/utils/pluck';\r\nimport floor from '@stdlib/math/base/special/floor';\r\nimport LessonCreator from 'ev/containers/lesson-creator';\r\nimport Lesson from './lesson.js';\r\nimport EnrolledLesson from './enrolled_lesson.js';\r\nimport NoCourseBanner from './no_course_banner.js';\r\nimport NoLessonBanner from './no_lesson_banner.js';\r\nimport sortLessons from 'utils/sort_lessons.js';\r\nimport isOwner from 'utils/is_owner.js';\r\nimport 'css/image.css';\r\nimport 'react-grid-layout/css/styles.css';\r\nimport 'react-resizable/css/styles.css';\r\nimport './lessons.css';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst debug = logger( 'isle-dashboard:lessons-page' );\r\nconst ResponsiveReactGridLayout = WidthProvider( Responsive );\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nfunction searchLessons( lessons, phrase ) {\r\n\tif ( !phrase ) {\r\n\t\treturn lessons;\r\n\t}\r\n\tconst filteredLessons = [];\r\n\tif ( isArray( lessons ) ) {\r\n\t\tfor ( let i = 0; i < lessons.length; i++ ) {\r\n\t\t\tif (\r\n\t\t\t\tcontains( lowercase( lessons[ i ].title ), phrase ) ||\r\n\t\t\t\tcontains( lowercase( lessons[ i ].description ), phrase )\r\n\t\t\t) {\r\n\t\t\t\tfilteredLessons.push( lessons[ i ] );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn filteredLessons;\r\n}\r\n\r\nfunction createLayout( lessons ) {\r\n\tdebug( 'Create layout...' );\r\n\tconst elemH = 3.52;\r\n\tlet layouts = lessons.map( ( e, i ) => {\r\n\t\treturn {\r\n\t\t\tlg: { i: `cell-${e.title}-${i}`, x: i*4 % 24, y: floor( i / 6 ) * elemH, w: 4, h: elemH },\r\n\t\t\tmd: { i: `cell-${e.title}-${i}`, x: i*4 % 20, y: floor( i / 5 ) * elemH, w: 4, h: elemH },\r\n\t\t\tsm: { i: `cell-${e.title}-${i}`, x: i*4 % 16, y: floor( i / 4 ) * elemH, w: 4, h: elemH },\r\n\t\t\txs: { i: `cell-${e.title}-${i}`, x: i*4 % 12, y: floor( i / 3 ) * elemH, w: 4, h: elemH },\r\n\t\t\txxs: { i: `cell-${e.title}-${i}`, x: i*4 % 8, y: floor( i / 2 ) * elemH, w: 4, h: elemH },\r\n\t\t\ttiny: { i: `cell-${e.title}-${i}`, x: i*4 % 4, y: floor( i / 1 ) * elemH, w: 4, h: elemH }\r\n\t\t};\r\n\t});\r\n\tlayouts = {\r\n\t\tlg: pluck( layouts, 'lg' ),\r\n\t\tmd: pluck( layouts, 'md' ),\r\n\t\tsm: pluck( layouts, 'sm' ),\r\n\t\txs: pluck( layouts, 'xs' ),\r\n\t\txxs: pluck( layouts, 'xxs' ),\r\n\t\ttiny: pluck( layouts, 'tiny' )\r\n\t};\r\n\treturn layouts;\r\n}\r\n\r\n\r\n// MAIN //\r\n\r\nclass LessonsPage extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\r\n\t\tlet lessons = props.namespace.lessons;\r\n\t\tif ( !isOwner( props.user, props.namespace ) ) {\r\n\t\t\tdebug( 'Filter out inactive or hidden lessons for enrolled students...' );\r\n\t\t\tlessons = lessons.filter( e => e.active === true && e.hideFromDashboard !== true );\r\n\t\t}\r\n\t\tthis.state = {\r\n\t\t\tfilteredLessons: searchLessons( lessons, props.search.phrase ),\r\n\t\t\tlayouts: createLayout( lessons ),\r\n\t\t\tunfilteredLessons: lessons,\r\n\t\t\tsearch: props.search,\r\n\t\t\tactiveElement: null,\r\n\t\t\tshowLessonCreator: false\r\n\t\t};\r\n\t}\r\n\r\n\tstatic getDerivedStateFromProps( nextProps, prevState ) {\r\n\t\tif (\r\n\t\t\tnextProps.namespace.lessons !== prevState.unfilteredLessons ||\r\n\t\t\tnextProps.search.phrase !== prevState.search.phrase ||\r\n\t\t\tnextProps.search.direction !== prevState.search.direction ||\r\n\t\t\tnextProps.search.type !== prevState.search.type\r\n\t\t) {\r\n\t\t\tdebug( 'Get derived state...' );\r\n\t\t\tlet lessons = nextProps.namespace.lessons || [];\r\n\t\t\tif ( !isOwner( nextProps.user, nextProps.namespace ) ) {\r\n\t\t\t\tdebug( 'Filter out inactive or hidden lessons for enrolled students...' );\r\n\t\t\t\tlessons = lessons.filter( e => e.active === true && e.hideFromDashboard !== true );\r\n\t\t\t}\r\n\t\t\tconst filteredLessons = searchLessons( lessons, nextProps.search.phrase );\r\n\t\t\tsortLessons( filteredLessons, nextProps.search );\r\n\t\t\tconst layouts = createLayout( filteredLessons );\r\n\t\t\treturn {\r\n\t\t\t\tfilteredLessons,\r\n\t\t\t\tlayouts,\r\n\t\t\t\tunfilteredLessons: nextProps.namespace.lessons,\r\n\t\t\t\tsearch: nextProps.search\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tdebug( 'Component did mount...' );\r\n\t\tconst course = this.props.namespace;\r\n\t\tif ( course.title ) {\r\n\t\t\tdebug( 'Fetch lessons...' );\r\n\t\t\tthis.props.getLessons( course.title );\r\n\t\t}\r\n\t}\r\n\r\n\tshouldComponentUpdate( nextProps, nextState ) {\r\n\t\tif (\r\n\t\t\tnextProps.search.direction !== this.props.search.direction ||\r\n\t\t\tnextProps.search.type !== this.props.search.type ||\r\n\t\t\tnextState.filteredLessons !== this.state.filteredLessons ||\r\n\t\t\tnextState.showLessonCreator !== this.state.showLessonCreator\r\n\t\t) {\r\n\t\t\tdebug( 'Should update page...' );\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpreventOpeningLink = ( event ) => {\r\n\t\tevent.preventDefault();\r\n\t};\r\n\r\n\trepositionLessons( idx, direction ) {\r\n\t\tconst unfilteredLessons = this.state.unfilteredLessons.slice();\r\n\t\tif ( direction === 'left' ) {\r\n\t\t\tif ( idx > 0 ) {\r\n\t\t\t\tconst lesson = unfilteredLessons[ idx ];\r\n\t\t\t\tconst left = unfilteredLessons[ idx - 1 ];\r\n\t\t\t\tconst tmp = left.pos;\r\n\t\t\t\tleft.pos = lesson.pos;\r\n\t\t\t\tlesson.pos = tmp;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if ( direction === 'right' ) {\r\n\t\t\tif ( idx < unfilteredLessons.length - 1 ) {\r\n\t\t\t\tconst lesson = unfilteredLessons[ idx ];\r\n\t\t\t\tconst right = unfilteredLessons[ idx + 1 ];\r\n\t\t\t\tconst tmp = right.pos;\r\n\t\t\t\tright.pos = lesson.pos;\r\n\t\t\t\tlesson.pos = tmp;\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst filteredLessons = searchLessons( unfilteredLessons, this.props.search.phrase );\r\n\t\tsortLessons( filteredLessons, this.props.search );\r\n\t\tconst layouts = createLayout( filteredLessons );\r\n\t\tthis.setState({\r\n\t\t\tfilteredLessons,\r\n\t\t\tlayouts,\r\n\t\t\tunfilteredLessons\r\n\t\t}, this.forceUpdate );\r\n\t\tthis.props.setLessonOrder({\r\n\t\t\tid: this.props.namespace._id,\r\n\t\t\tlessons: unfilteredLessons.map( x => x._id )\r\n\t\t});\r\n\t}\r\n\r\n\thandlePositionChangeFactory = ( idx ) => {\r\n\t\treturn ( event ) => {\r\n\t\t\tlet bool = false;\r\n\t\t\tswitch ( event.code ) {\r\n\t\t\t\tcase 'ArrowLeft':\r\n\t\t\t\t\tbool = true;\r\n\t\t\t\t\tthis.repositionLessons( idx, 'left' );\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'ArrowRight':\r\n\t\t\t\t\tbool = true;\r\n\t\t\t\t\tthis.repositionLessons( idx, 'right' );\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif ( bool ) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\ttoggleCreator = () => {\r\n\t\tthis.props.getTemplateLessons();\r\n\t\tthis.setState({ showLessonCreator: !this.state.showLessonCreator });\r\n\t};\r\n\r\n\thandleCreate = () => {\r\n\t\tthis.setState({ showLessonCreator: false });\r\n\t\tconst course = this.props.namespace;\r\n\t\tif ( course.title ) {\r\n\t\t\tdebug( 'Fetch lessons...' );\r\n\t\t\tthis.props.getLessons( course.title );\r\n\t\t}\r\n\t};\r\n\r\n\trenderLessons() {\r\n\t\tlet lessons = this.state.filteredLessons;\r\n\t\tif ( !isOwner( this.props.user, this.props.namespace ) ) {\r\n\t\t\treturn lessons.map( ( e, i ) => {\r\n\t\t\t\treturn (<div className=\"lesson-grid-item\" key={`cell-${e.title}-${i}`}>\r\n\t\t\t\t\t<EnrolledLesson\r\n\t\t\t\t\t\t{...lessons[ i ]}\r\n\t\t\t\t\t\taddNotification={this.props.addNotification}\r\n\t\t\t\t\t\tuser={this.props.user}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn (\r\n\t\t\tlessons.map( ( e, i ) => {\r\n\t\t\t\tconst lesson = <Lesson\r\n\t\t\t\t\t{...lessons[ i ]}\r\n\t\t\t\t\taddNotification={this.props.addNotification}\r\n\t\t\t\t\tdeleteLesson={this.props.deleteLesson}\r\n\t\t\t\t\tupdateLesson={this.props.updateLesson}\r\n\t\t\t\t\tdeactivateLesson={this.props.deactivateLesson}\r\n\t\t\t\t\tactivateLesson={this.props.activateLesson}\r\n\t\t\t\t\tshowLessonInGallery={this.props.showLessonInGallery}\r\n\t\t\t\t\thideLessonInGallery={this.props.hideLessonInGallery}\r\n\t\t\t\t\tgetLessons={this.props.getLessons}\r\n\t\t\t\t\tgetIsleFile={this.props.getIsleFile}\r\n\t\t\t\t\tuser={this.props.user}\r\n\t\t\t\t/>;\r\n\t\t\t\tif ( this.props.search.type === 'sequentially' ) {\r\n\t\t\t\t\treturn ( <div\r\n\t\t\t\t\t\tclassName=\"lesson-grid-item\"\r\n\t\t\t\t\t\tkey={`cell-${e.title}-${i}`}\r\n\t\t\t\t\t\ttabIndex={0} role=\"button\"\r\n\t\t\t\t\t\tref={input => {\r\n\t\t\t\t\t\t\tif ( input && this.state.activeElement === e.title ) {\r\n\t\t\t\t\t\t\t\tinput.focus();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn input;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonKeyDown={this.handlePositionChangeFactory( i )}\r\n\t\t\t\t\t\tonFocus={() => {\r\n\t\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\t\tactiveElement: e.title\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{lesson}\r\n\t\t\t\t\t</div> );\r\n\t\t\t\t}\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName=\"lesson-grid-item\" key={`cell-${e.title}-${i}`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{lesson}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\trender() {\r\n\t\tif ( !this.props.namespace.title ) {\r\n\t\t\treturn <NoCourseBanner user={this.props.user} />;\r\n\t\t}\r\n\t\tlet lessons = this.state.filteredLessons;\r\n\t\tif ( isArray( lessons ) ) {\r\n\t\t\tconst templateButton = <OverlayTrigger placement=\"left\" overlay={<Tooltip id=\"create-from-template-tooltip\">{this.props.t('create-from-template')}</Tooltip>}>\r\n\t\t\t\t<Button aria-label={this.props.t('create-from-template')} className=\"create-from-template-button\" onClick={this.toggleCreator} >\r\n\t\t\t\t\t<i className=\"fas fa-plus\" />\r\n\t\t\t\t</Button>\r\n\t\t\t</OverlayTrigger>;\r\n\t\t\tif ( lessons.length === 0 ) {\r\n\t\t\t\treturn ( <Fragment>\r\n\t\t\t\t\t<NoLessonBanner user={this.props.user} />\r\n\t\t\t\t\t{templateButton}\r\n\t\t\t\t\t{this.state.showLessonCreator ? <LessonCreator\r\n\t\t\t\t\t\tonHide={this.toggleCreator}\r\n\t\t\t\t\t\tonCreate={this.handleCreate}\r\n\t\t\t\t\t\tnamespace={this.props.namespace}\r\n\t\t\t\t\t/> : null}\r\n\t\t\t\t</Fragment> );\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<Fragment>\r\n\t\t\t\t\t<div className=\"lessons-grid-container\">\r\n\t\t\t\t\t\t<ResponsiveReactGridLayout\r\n\t\t\t\t\t\t\tlayouts={this.state.layouts}\r\n\t\t\t\t\t\t\tbreakpoints={{ lg: 1800, md: 1550, sm: 1200, xs: 900, xxs: 400, tiny: 0 }}\r\n\t\t\t\t\t\t\tcols={{ lg: 24, md: 20, sm: 16, xs: 12, xxs: 8, tiny: 4 }}\r\n\t\t\t\t\t\t\tcontainerPadding={[10, 10]}\r\n\t\t\t\t\t\t\tisResizable={false}\r\n\t\t\t\t\t\t\tisBounded={true}\r\n\t\t\t\t\t\t\tisDraggable={false}\r\n\t\t\t\t\t\t\trowHeight={isOwner( this.props.user, this.props.namespace ) ? 54.5 : 55}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{this.renderLessons()}\r\n\t\t\t\t\t\t</ResponsiveReactGridLayout>\r\n\t\t\t\t\t\t{templateButton}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{this.state.showLessonCreator ? <LessonCreator\r\n\t\t\t\t\t\tonHide={this.toggleCreator}\r\n\t\t\t\t\t\tonCreate={this.handleCreate}\r\n\t\t\t\t\t\tnamespace={this.props.namespace}\r\n\t\t\t\t\t/> : null}\r\n\t\t\t\t</Fragment>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n// PROPERTIES //\r\n\r\nLessonsPage.propTypes = {\r\n\tactivateLesson: PropTypes.func.isRequired,\r\n\taddNotification: PropTypes.func.isRequired,\r\n\tdeactivateLesson: PropTypes.func.isRequired,\r\n\tdeleteLesson: PropTypes.func.isRequired,\r\n\tgetIsleFile: PropTypes.func.isRequired,\r\n\tgetLessons: PropTypes.func.isRequired,\r\n\tgetTemplateLessons: PropTypes.func.isRequired,\r\n\thideLessonInGallery: PropTypes.func.isRequired,\r\n\tnamespace: PropTypes.object.isRequired,\r\n\tsearch: PropTypes.object.isRequired,\r\n\tsetLessonOrder: PropTypes.func.isRequired,\r\n\tshowLessonInGallery: PropTypes.func.isRequired,\r\n\tupdateLesson: PropTypes.func.isRequired,\r\n\turl: PropTypes.string,\r\n\tuser: PropTypes.object.isRequired\r\n};\r\n\r\nLessonsPage.defaultProps = {\r\n\turl: null\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default withTranslation( [ 'lessons_page', 'common' ] )( LessonsPage );\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport LessonsPage from 'components/lessons-page';\r\nimport { setLessonOrderInjector } from 'actions/namespace';\r\nimport { activateLessonInjector, deactivateLessonInjector, deleteLessonInjector, getIsleFileInjector, getLessonsInjector, getTemplateLessonsInjector,\r\n\tshowLessonInGalleryInjector, hideLessonInGalleryInjector, updateLessonInjector } from 'actions/lesson';\r\nimport { addNotificationInjector } from 'actions/notification';\r\n\r\n\r\n// EXPORTS //\r\n\r\nconst VisibleLessonsPage = connect( mapStateToProps, mapDispatchToProps )( LessonsPage );\r\n\r\nfunction mapStateToProps( state ) {\r\n\treturn {\r\n\t\tsearch: state.search,\r\n\t\tuser: state.user,\r\n\t\tnamespace: state.namespace\r\n\t};\r\n}\r\n\r\nfunction mapDispatchToProps( dispatch ) {\r\n\treturn {\r\n\t\taddNotification: addNotificationInjector( dispatch ),\r\n\t\tshowLessonInGallery: showLessonInGalleryInjector( dispatch ),\r\n\t\thideLessonInGallery: hideLessonInGalleryInjector( dispatch ),\r\n\t\tactivateLesson: activateLessonInjector( dispatch ),\r\n\t\tdeactivateLesson: deactivateLessonInjector( dispatch ),\r\n\t\tupdateLesson: updateLessonInjector( dispatch ),\r\n\t\tdeleteLesson: deleteLessonInjector( dispatch ),\r\n\t\tgetLessons: getLessonsInjector( dispatch ),\r\n\t\tgetTemplateLessons: getTemplateLessonsInjector( dispatch ),\r\n\t\tgetIsleFile: getIsleFileInjector( dispatch ),\r\n\t\tsetLessonOrder: setLessonOrderInjector( dispatch )\r\n\t};\r\n}\r\n\r\nexport default VisibleLessonsPage;\r\n","/*\r\n* Adapted from:\r\n*\r\n* FileSaver.js\r\n* A saveAs() FileSaver implementation.\r\n* 1.3.8\r\n* 2018-03-22 14:03:47\r\n*\r\n* By Eli Grey, https://eligrey.com\r\n* License: MIT\r\n*   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\r\n*\r\n* @source http://purl.eligrey.com/github/FileSaver.js/blob/master/src/FileSaver.js\r\n*/\r\n\r\n// VARIABLES //\r\n\r\nconst RE_AUTO_BOM = /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i;\r\nconst ARBITRARY_REVOKE_TIMEOUT = 1000 * 40; // Time in ms\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nfunction click(node) {\r\n\tconst event = new MouseEvent( 'click' );\r\n\tnode.dispatchEvent( event );\r\n}\r\n\r\nfunction throwOutside( ex ) {\r\n\tsetImmediate(function throwEx() {\r\n\t\tthrow ex;\r\n\t}, 0 );\r\n}\r\n\r\nfunction autoBOM( blob ) {\r\n\t// Prepend BOM for UTF-8 XML and text/* types (including HTML). Note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\r\n\tif ( RE_AUTO_BOM.test( blob.type ) ) {\r\n\t\treturn new Blob([ String.fromCharCode( 0xFEFF ), blob ], {\r\n\t\t\ttype: blob.type\r\n\t\t});\r\n\t}\r\n\treturn blob;\r\n}\r\n\r\nfunction dispatch( filesaver, eventTypes, event ) {\r\n\teventTypes = [].concat( eventTypes );\r\n\tlet i = eventTypes.length;\r\n\twhile ( i-- ) {\r\n\t\tlet listener = filesaver[ 'on' + eventTypes[i] ];\r\n\t\tif ( typeof listener === 'function' ) {\r\n\t\t\ttry {\r\n\t\t\t\tlistener.call( filesaver, event || filesaver );\r\n\t\t\t} catch ( ex ) {\r\n\t\t\t\tthrowOutside( ex );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n// MAIN //\r\n\r\nfunction saveFactory( view ) {\r\n\tif (\r\n\t\ttypeof view === 'undefined' ||\r\n\t\ttypeof navigator !== 'undefined' &&\r\n\t\t/MSIE [1-9]\\./.test( navigator.userAgent )\r\n\t) {\r\n\t\treturn;\r\n\t}\r\n\tconst doc = view.document;\r\n\r\n\t// Only get URL when necessary in case Blob.js hasn't overridden it yet:\r\n\tfunction getURL() {\r\n\t\treturn view.URL || view.webkitURL || view;\r\n\t}\r\n\tfunction revoke( file ) {\r\n\t\tfunction revoker() {\r\n\t\t\tif ( typeof file === 'string' ) { // File is an object URL...\r\n\t\t\t\tgetURL().revokeObjectURL(file);\r\n\t\t\t} else { // File is a File...\r\n\t\t\t\tfile.remove();\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetTimeout( revoker, ARBITRARY_REVOKE_TIMEOUT );\r\n\t}\r\n\r\n\tconst saveLink = doc.createElementNS( 'http://www.w3.org/1999/xhtml', 'a' );\r\n\tconst canUseSaveLink = 'download' in saveLink;\r\n\tconst isSafari = /constructor/i.test( view.HTMLElement ) || view.safari;\r\n\tconst isChromeIOS =/CriOS\\/[\\d]+/.test( navigator.userAgent );\r\n\tconst setImmediate = view.setImmediate || view.setTimeout;\r\n\tconst forceSavableType = 'application/octet-stream';\r\n\r\n\tfunction FileSaver(blob, name, noAutoBOM ) {\r\n\t\tif ( !noAutoBOM ) {\r\n\t\t\tblob = autoBOM(blob);\r\n\t\t}\r\n\t\t// First try a.download, then web filesystem, then object URLs\r\n\t\tconst self = this;\r\n\t\tconst type = blob.type;\r\n\t\tconst force = type === forceSavableType;\r\n\t\tlet objectURL;\r\n\t\tfunction dispatchAll() {\r\n\t\t\tdispatch( self, 'writestart progress write writeend'.split(' ') );\r\n\t\t}\r\n\t\t// On any filesystem errors, revert to saving with object URLs:\r\n\t\tfunction fsError() {\r\n\t\t\tif ((isChromeIOS || (force && isSafari)) && view.FileReader) {\r\n\t\t\t\t// Safari doesn't allow downloading of blob urls\r\n\t\t\t\tconst reader = new FileReader();\r\n\t\t\t\treader.onloadend = function onLoadEnd() {\r\n\t\t\t\t\tlet url = isChromeIOS ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\r\n\t\t\t\t\tconst popup = view.open(url, '_blank');\r\n\t\t\t\t\tif ( !popup ) {\r\n\t\t\t\t\t\tview.location.href = url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\turl = void 0; // Release reference before dispatching...\r\n\t\t\t\t\tself.readyState = self.DONE;\r\n\t\t\t\t\tdispatchAll();\r\n\t\t\t\t};\r\n\t\t\t\treader.readAsDataURL(blob);\r\n\t\t\t\tself.readyState = self.INIT;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// Don't create more object URLs than needed:\r\n\t\t\tif ( !objectURL ) {\r\n\t\t\t\tobjectURL = getURL().createObjectURL( blob );\r\n\t\t\t}\r\n\t\t\tif ( force ) {\r\n\t\t\t\tview.location.href = objectURL;\r\n\t\t\t} else {\r\n\t\t\t\tconst opened = view.open( objectURL, '_blank' );\r\n\t\t\t\tif ( !opened ) {\r\n\t\t\t\t\t// Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\r\n\t\t\t\t\tview.location.href = objectURL;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.readyState = self.DONE;\r\n\t\t\tdispatchAll();\r\n\t\t\trevoke( objectURL );\r\n\t\t}\r\n\t\tself.readyState = self.INIT;\r\n\r\n\t\tif ( canUseSaveLink ) {\r\n\t\t\tobjectURL = getURL().createObjectURL(blob);\r\n\t\t\tsetImmediate(function save() {\r\n\t\t\t\tsaveLink.href = objectURL;\r\n\t\t\t\tsaveLink.download = name;\r\n\t\t\t\tclick( saveLink );\r\n\t\t\t\tdispatchAll();\r\n\t\t\t\trevoke( objectURL );\r\n\t\t\t\tself.readyState = self.DONE;\r\n\t\t\t}, 0);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfsError();\r\n\t}\r\n\tconst proto = FileSaver.prototype;\r\n\tfunction saveAs( blob, name, noAutoBOM ) {\r\n\t\treturn new FileSaver( blob, name || blob.name || 'download', noAutoBOM );\r\n\t}\r\n\r\n\t// IE 10+ (native saveAs)\r\n\tif ( typeof navigator !== 'undefined' && navigator.msSaveOrOpenBlob ) {\r\n\t\treturn function saveAs( blob, name, noAutoBOM ) {\r\n\t\t\tname = name || blob.name || 'download';\r\n\t\t\tif ( !noAutoBOM ) {\r\n\t\t\t\tblob = autoBOM( blob );\r\n\t\t\t}\r\n\t\t\treturn navigator.msSaveOrOpenBlob(blob, name);\r\n\t\t};\r\n\t}\r\n\r\n\tproto.abort = function abort() {};\r\n\tproto.readyState = proto.INIT = 0;\r\n\tproto.WRITING = 1;\r\n\tproto.DONE = 2;\r\n\r\n\tproto.error = null;\r\n\tproto.onwritestart = null;\r\n\tproto.onprogress = null;\r\n\tproto.onwrite = null;\r\n\tproto.onabort = null;\r\n\tproto.onerror = null;\r\n\tproto.onwriteend = null;\r\n\r\n\treturn saveAs;\r\n}\r\n\r\nconst saveAs = saveFactory(\r\n\ttypeof self !== 'undefined' && self ||\r\n\ttypeof window !== 'undefined' && window ||\r\n\tthis.content\r\n);\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default saveAs;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport floor from '@stdlib/math/base/special/floor';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n* Formats a timestamp in a human readable format.\r\n*\r\n* @param {number} timestamp - timestamp\r\n* @param {Object} [opts] - options\r\n* @param {string} [opts.hours] - hours\r\n* @param {string} [opts.minutes] - minutes\r\n* @param {string} [opts.seconds] - seconds\r\n* @returns {string} formatted timestamp\r\n*/\r\nconst formatTime = ( time, opts = { hours: true, minutes: true, seconds: true }) => {\r\n\ttime = time / 1000;\r\n\tconst hours = floor( time / ( 60*60 ) );\r\n\ttime = time % ( 60*60 );\r\n\tlet minutes = floor( time / 60 );\r\n\tif ( minutes < 10 ) {\r\n\t\tminutes = '0'+minutes;\r\n\t}\r\n\ttime = time % 60;\r\n\tlet seconds = floor( time );\r\n\tif ( seconds < 10 ) {\r\n\t\tseconds = '0'+seconds;\r\n\t}\r\n\tlet out = '';\r\n\tif ( opts.hours ) {\r\n\t\tout += hours;\r\n\t}\r\n\tif ( opts.minutes ) {\r\n\t\tif ( out ) {\r\n\t\t\tout += ':';\r\n\t\t}\r\n\t\tout += minutes;\r\n\t}\r\n\tif ( opts.seconds ) {\r\n\t\tif ( out ) {\r\n\t\t\tout += ':';\r\n\t\t}\r\n\t\tout += seconds;\r\n\t}\r\n\treturn out;\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default formatTime;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport isObject from '@stdlib/assert/is-object';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n* Validates if a user is an owner of the specified namespace.\r\n*\r\n* @param {Object} user - user object\r\n* @param {Object} namespace - namespace object\r\n* @returns {boolean} boolean indicating if the user is an owner of the namespace\r\n*/\r\nfunction isOwner( user, namespace ) {\r\n\tlet bool = false;\r\n\tfor ( let i = 0; i < namespace.owners.length; i++ ) {\r\n\t\tconst owner = namespace.owners[ i ];\r\n\t\tif ( isObject( owner ) ) {\r\n\t\t\tif ( owner.email === user.email ) {\r\n\t\t\t\tbool = true;\r\n\t\t\t}\r\n\t\t} else if ( owner === user.id ) {\r\n\t\t\t// Case: Owners array is not yet populated but contains only string IDs:\r\n\t\t\tbool = true;\r\n\t\t}\r\n\t}\r\n\treturn bool;\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default isOwner;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// VARIABLES //\r\n\r\nconst OPTS = {\r\n\tnumeric: true // Use numeric collation such that \"1\" < \"2\" < \"10\"...\r\n};\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n* Sorts lessons according to the `search` object in place.\r\n*\r\n* @param {Array} lessons - a list of lessons\r\n* @param {Object} search - search object\r\n* @param {string} search.type - either `sequentially`, `alphabetically`, `created_at`, or `updated_at`\r\n* @param {string} search.direction - either `ascending` or `descending`\r\n*/\r\nfunction sortLessons( lessons, search ) {\r\n\tconst { type, direction } = search;\r\n\tif ( type === 'sequentially' ) {\r\n\t\tif ( direction === 'ascending' ) {\r\n\t\t\tlessons.sort( ( a, b ) => {\r\n\t\t\t\treturn a.pos - b.pos;\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tlessons.sort( ( a, b ) => {\r\n\t\t\t\treturn b.pos - a.pos;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\telse if ( type === 'alphabetically' ) {\r\n\t\tif ( direction === 'ascending' ) {\r\n\t\t\tlessons.sort( ( a, b ) => {\r\n\t\t\t\tconst x = a.namespace + a.title;\r\n\t\t\t\tconst y = b.namespace + b.title;\r\n\t\t\t\treturn x.localeCompare( y, void 0, OPTS );\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tlessons.sort( ( a, b ) => {\r\n\t\t\t\tconst x = a.namespace + a.title;\r\n\t\t\t\tconst y = b.namespace + b.title;\r\n\t\t\t\treturn y.localeCompare( x, void 0, OPTS );\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\telse if ( type === 'created_at' ) {\r\n\t\tif ( direction === 'ascending' ) {\r\n\t\t\tlessons.sort( ( a, b ) => {\r\n\t\t\t\treturn a.createdAt.localeCompare( b.createdAt, void 0, OPTS );\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tlessons.sort( ( a, b ) => {\r\n\t\t\t\treturn b.createdAt.localeCompare( a.createdAt, void 0, OPTS );\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\telse if ( type === 'updated_at' ) {\r\n\t\tif ( direction === 'ascending' ) {\r\n\t\t\tlessons.sort( ( a, b ) => {\r\n\t\t\t\treturn a.updatedAt.localeCompare( b.updatedAt, void 0, OPTS );\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tlessons.sort( ( a, b ) => {\r\n\t\t\t\treturn b.updatedAt.localeCompare( a.updatedAt, void 0, OPTS );\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default sortLessons;\r\n"],"sourceRoot":""}