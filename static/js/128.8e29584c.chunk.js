"use strict";var __defProp=Object.defineProperty,__defProps=Object.defineProperties;var __getOwnPropDescs=Object.getOwnPropertyDescriptors;var __getOwnPropSymbols=Object.getOwnPropertySymbols;var __hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__spreadValues=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a},__spreadProps=(a,b)=>__defProps(a,__getOwnPropDescs(b));var __objRest=(source,exclude)=>{var target={};for(var prop in source)__hasOwnProp.call(source,prop)&&exclude.indexOf(prop)<0&&(target[prop]=source[prop]);if(source!=null&&__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(source))exclude.indexOf(prop)<0&&__propIsEnum.call(source,prop)&&(target[prop]=source[prop]);return target};(self.webpackChunkisle_dashboard=self.webpackChunkisle_dashboard||[]).push([[128],{20128:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return visible_login}});var react=__webpack_require__(67294),lib=__webpack_require__(37424),prop_types=__webpack_require__(45697),prop_types_default=__webpack_require__.n(prop_types),commonjs=__webpack_require__(81468),react_router_dom_production_min=__webpack_require__(59685),axios=__webpack_require__(9669),axios_default=__webpack_require__.n(axios),browser=__webpack_require__(11227),browser_default=__webpack_require__.n(browser),Button=__webpack_require__(89876),Button_default=__webpack_require__.n(Button),Card=__webpack_require__(51889),Card_default=__webpack_require__.n(Card),Col=__webpack_require__(1266),Row=__webpack_require__(28269),Row_default=__webpack_require__.n(Row),FormLabel=__webpack_require__(65903),FormLabel_default=__webpack_require__.n(FormLabel),FormControl=__webpack_require__(26199),FormControl_default=__webpack_require__.n(FormControl),FormGroup=__webpack_require__(34168),FormGroup_default=__webpack_require__.n(FormGroup),Form=__webpack_require__(17383),Form_default=__webpack_require__.n(Form),Popover=__webpack_require__(44981),Popover_default=__webpack_require__.n(Popover),Overlay=__webpack_require__(62760),Overlay_default=__webpack_require__.n(Overlay),use_mount_effect=__webpack_require__(31394),server=__webpack_require__(94204),login=__webpack_require__(97847),__async=(__this,__arguments,generator)=>new Promise((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())});const debug=browser_default()("isle-dashboard:login"),Login=({user:user2,restoreLogin,fetchCredentials,getEnrollableCohorts,handleLogin,settings})=>{const[email,setEmail]=(0,react.useState)(""),[password,setPassword]=(0,react.useState)(""),[overlay,setOverlay]=(0,react.useState)({show:!1,target:null,message:""}),passwordInput=(0,react.useRef)(null),emailInput=(0,react.useRef)(null),{t}=(0,commonjs.$G)(["login","common"]),navigate=(0,react_router_dom_production_min.useNavigate)();(0,use_mount_effect.Z)(()=>{user2&&user2.loggedIn&&!window.location.search?(debug("User is already logged in, restore login and get enrollable cohorts..."),restoreLogin(user2),getEnrollableCohorts(user2)):axios_default().get(server.ZP+"/saml-xmw/login-type").then(response=>{response.data==="SSO"&&(debug("Redirect to SSO login choices as regular login is disabled..."),navigate(server.ZP+"/saml-xmw/login-choices"))}).catch(err=>{debug("Encountered an error: ",err)})});const handleEmailChange=event=>{setEmail(event.target.value)},handlePasswordChange=event=>{setPassword(event.target.value)},handleSubmit=event=>__async(void 0,null,function*(){event.preventDefault();const form2={password,email};if(form2.email==="")setOverlay({show:!0,target:emailInput.current,message:"Enter your email address."});else if(form2.password==="")setOverlay({show:!0,target:passwordInput.current,message:"Enter your password."});else try{const res=yield handleLogin(form2),{message}=res.data;if(message==="finish-login-via-tfa")navigate("/login-tfa");else if(message==="ok"){const{token,id}=res.data,user22=yield fetchCredentials({token,id});user22&&getEnrollableCohorts(user22)}}catch(err){const msg=err.response?err.response.data:err.message;setOverlay({show:!0,target:msg==="Password is not correct."?passwordInput.current:emailInput.current,message:msg}),setTimeout(()=>{setOverlay({show:!1})},4e3)}}),form=react.createElement(Form_default(),{className:"d-grid gap-3"},react.createElement(FormGroup_default(),{controlId:"form-email"},react.createElement(Row_default(),null,react.createElement(Col.default,{sm:3},react.createElement(FormLabel_default(),null,t("common:email"))),react.createElement(Col.default,{sm:9},react.createElement(FormControl_default(),{name:"email",type:"email",autoComplete:"isle-email",placeholder:t("common:email"),onChange:handleEmailChange,ref:emailInput})))),react.createElement(FormGroup_default(),{controlId:"form-password"},react.createElement(Row_default(),null,react.createElement(Col.default,{sm:3},react.createElement(FormLabel_default(),null,t("common:password"))),react.createElement(Col.default,{sm:9},react.createElement(FormControl_default(),{name:"password",type:"password",autoComplete:"isle-password",placeholder:t("common:password"),onChange:handlePasswordChange,ref:passwordInput})))),react.createElement(FormGroup_default(),null,react.createElement(Button_default(),{className:"centered",variant:"primary",onClick:handleSubmit,type:"submit"},t("common:login"))));return react.createElement(react.Fragment,null,react.createElement("div",{className:"login"},react.createElement(Card_default(),{className:"login-panel"},react.createElement(Card_default().Header,null,react.createElement(Card_default().Title,{as:"h1",style:{textAlign:"center"}},react.createElement("img",{alt:"ISLE Logo",className:"login-isle-logo",src:"img/isle_logo.svg"}),"ISLE ",react.createElement("small",null,settings.siteTitle))),react.createElement(Card_default().Body,null,form),react.createElement(Card_default().Footer,{style:{background:"rgba(255,255,255,0.6)",textAlign:"right"}},settings.saml==="enabled"?react.createElement(react.Fragment,null,react.createElement("a",{href:server.ZP+"/saml-xmw/login-choice"},"SSO"),react.createElement("span",null," | ")):null,react.createElement(react_router_dom_production_min.Link,{to:"/forgot-password"},t("common:forgot-password")),settings.allowUserRegistrations?react.createElement(react.Fragment,null,react.createElement("span",null," | "),react.createElement(react_router_dom_production_min.Link,{to:"/signup"},t("common:register"))):null)),settings.brandingLogo?react.createElement("img",{className:"login-branding-logo",src:settings.brandingLogo,alt:"Branded Logo"}):null),react.createElement(Overlay_default(),{show:overlay.show,target:overlay.target,placement:"right",containerPadding:20},react.createElement(Popover_default(),{id:"popover-contained",title:"Not valid"},overlay.message)))};Login.propTypes={fetchCredentials:prop_types_default().func.isRequired,getEnrollableCohorts:prop_types_default().func.isRequired,handleLogin:prop_types_default().func.isRequired,restoreLogin:prop_types_default().func.isRequired,settings:prop_types_default().object,user:prop_types_default().object.isRequired},Login.defaultProps={settings:{}};var components_login=Login,authentication=__webpack_require__(55194),cohort=__webpack_require__(72371),user=__webpack_require__(37344);function mapStateToProps(state){return{user:state.user,settings:state.settings}}function mapDispatchToProps(dispatch){return{handleLogin:(0,user.IJ)(dispatch),restoreLogin:(0,user.Dv)(dispatch),fetchCredentials:(0,authentication.GI)(dispatch),getEnrollableCohorts:(0,cohort.R9)(dispatch)}}var visible_login=(0,lib.connect)(mapStateToProps,mapDispatchToProps)(components_login)},97847:function(){},51889:function(module,exports,__webpack_require__){var _interopRequireDefault=__webpack_require__(95318);exports.__esModule=!0,exports.default=void 0;var _classnames=_interopRequireDefault(__webpack_require__(94184)),React=_interopRequireWildcard(__webpack_require__(67294)),_ThemeProvider=__webpack_require__(3349),_createWithBsPrefix=_interopRequireDefault(__webpack_require__(20158)),_divWithClassName=_interopRequireDefault(__webpack_require__(3081)),_CardImg=_interopRequireDefault(__webpack_require__(87550)),_CardHeader=_interopRequireDefault(__webpack_require__(6003)),_jsxRuntime=__webpack_require__(85893);function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!="function")return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop2){return nodeInterop2?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(obj===null||typeof obj!="object"&&typeof obj!="function")return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}const DivStyledAsH5=(0,_divWithClassName.default)("h5"),DivStyledAsH6=(0,_divWithClassName.default)("h6"),CardBody=(0,_createWithBsPrefix.default)("card-body"),CardTitle=(0,_createWithBsPrefix.default)("card-title",{Component:DivStyledAsH5}),CardSubtitle=(0,_createWithBsPrefix.default)("card-subtitle",{Component:DivStyledAsH6}),CardLink=(0,_createWithBsPrefix.default)("card-link",{Component:"a"}),CardText=(0,_createWithBsPrefix.default)("card-text",{Component:"p"}),CardFooter=(0,_createWithBsPrefix.default)("card-footer"),CardImgOverlay=(0,_createWithBsPrefix.default)("card-img-overlay"),defaultProps={body:!1},Card=React.forwardRef((_a,ref)=>{var _b=_a,{bsPrefix,className,bg,text,border,body,children,as:Component="div"}=_b,props=__objRest(_b,["bsPrefix","className","bg","text","border","body","children","as"]);const prefix=(0,_ThemeProvider.useBootstrapPrefix)(bsPrefix,"card");return(0,_jsxRuntime.jsx)(Component,__spreadProps(__spreadValues({ref},props),{className:(0,_classnames.default)(className,prefix,bg&&`bg-${bg}`,text&&`text-${text}`,border&&`border-${border}`),children:body?(0,_jsxRuntime.jsx)(CardBody,{children}):children}))});Card.displayName="Card",Card.defaultProps=defaultProps;var _default=Object.assign(Card,{Img:_CardImg.default,Title:CardTitle,Subtitle:CardSubtitle,Body:CardBody,Link:CardLink,Text:CardText,Header:_CardHeader.default,Footer:CardFooter,ImgOverlay:CardImgOverlay});exports.default=_default,module.exports=exports.default},6003:function(module,exports,__webpack_require__){var _interopRequireDefault=__webpack_require__(95318);exports.__esModule=!0,exports.default=void 0;var _classnames=_interopRequireDefault(__webpack_require__(94184)),React=_interopRequireWildcard(__webpack_require__(67294)),_ThemeProvider=__webpack_require__(3349),_CardHeaderContext=_interopRequireDefault(__webpack_require__(88296)),_jsxRuntime=__webpack_require__(85893);function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!="function")return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop2){return nodeInterop2?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(obj===null||typeof obj!="object"&&typeof obj!="function")return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}const CardHeader=React.forwardRef((_a,ref)=>{var _b=_a,{bsPrefix,className,as:Component="div"}=_b,props=__objRest(_b,["bsPrefix","className","as"]);const prefix=(0,_ThemeProvider.useBootstrapPrefix)(bsPrefix,"card-header"),contextValue=(0,React.useMemo)(()=>({cardHeaderBsPrefix:prefix}),[prefix]);return(0,_jsxRuntime.jsx)(_CardHeaderContext.default.Provider,{value:contextValue,children:(0,_jsxRuntime.jsx)(Component,__spreadProps(__spreadValues({ref},props),{className:(0,_classnames.default)(className,prefix)}))})});CardHeader.displayName="CardHeader";var _default=CardHeader;exports.default=_default,module.exports=exports.default},88296:function(module,exports,__webpack_require__){exports.__esModule=!0,exports.default=void 0;var React=_interopRequireWildcard(__webpack_require__(67294));function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!="function")return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop2){return nodeInterop2?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(obj===null||typeof obj!="object"&&typeof obj!="function")return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}const context=React.createContext(null);context.displayName="CardHeaderContext";var _default=context;exports.default=_default,module.exports=exports.default},87550:function(module,exports,__webpack_require__){var _interopRequireDefault=__webpack_require__(95318);exports.__esModule=!0,exports.default=void 0;var _classnames=_interopRequireDefault(__webpack_require__(94184)),React=_interopRequireWildcard(__webpack_require__(67294)),_ThemeProvider=__webpack_require__(3349),_jsxRuntime=__webpack_require__(85893);function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!="function")return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop2){return nodeInterop2?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(obj===null||typeof obj!="object"&&typeof obj!="function")return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}const CardImg=React.forwardRef((_a,ref)=>{var _b=_a,{bsPrefix,className,variant,as:Component="img"}=_b,props=__objRest(_b,["bsPrefix","className","variant","as"]);const prefix=(0,_ThemeProvider.useBootstrapPrefix)(bsPrefix,"card-img");return(0,_jsxRuntime.jsx)(Component,__spreadValues({ref,className:(0,_classnames.default)(variant?`${prefix}-${variant}`:prefix,className)},props))});CardImg.displayName="CardImg";var _default=CardImg;exports.default=_default,module.exports=exports.default},28269:function(module,exports,__webpack_require__){var _interopRequireDefault=__webpack_require__(95318);exports.__esModule=!0,exports.default=void 0;var _classnames=_interopRequireDefault(__webpack_require__(94184)),React=_interopRequireWildcard(__webpack_require__(67294)),_ThemeProvider=__webpack_require__(3349),_jsxRuntime=__webpack_require__(85893);function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!="function")return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop2){return nodeInterop2?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(obj===null||typeof obj!="object"&&typeof obj!="function")return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}const DEVICE_SIZES=["xxl","xl","lg","md","sm","xs"],Row=React.forwardRef((_a,ref)=>{var _b=_a,{bsPrefix,className,as:Component="div"}=_b,props=__objRest(_b,["bsPrefix","className","as"]);const decoratedBsPrefix=(0,_ThemeProvider.useBootstrapPrefix)(bsPrefix,"row"),sizePrefix=`${decoratedBsPrefix}-cols`,classes=[];return DEVICE_SIZES.forEach(brkPoint=>{const propValue=props[brkPoint];delete props[brkPoint];let cols;propValue!=null&&typeof propValue=="object"?{cols}=propValue:cols=propValue;const infix=brkPoint!=="xs"?`-${brkPoint}`:"";cols!=null&&classes.push(`${sizePrefix}${infix}-${cols}`)}),(0,_jsxRuntime.jsx)(Component,__spreadProps(__spreadValues({ref},props),{className:(0,_classnames.default)(className,decoratedBsPrefix,...classes)}))});Row.displayName="Row";var _default=Row;exports.default=_default,module.exports=exports.default}}]);

//# sourceMappingURL=128.8e29584c.chunk.js.map