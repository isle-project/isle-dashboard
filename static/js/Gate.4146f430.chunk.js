"use strict";(self.webpackChunkisle_dashboard=self.webpackChunkisle_dashboard||[]).push([[5576],{15207:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return main}});var react=__webpack_require__(67294),prop_types=__webpack_require__(45697),prop_types_default=__webpack_require__.n(prop_types),Alert=__webpack_require__(24032),Alert_default=__webpack_require__.n(Alert),Button=__webpack_require__(30276),Button_default=__webpack_require__.n(Button),commonjs=__webpack_require__(81468),lib=__webpack_require__(22532),lib_default=__webpack_require__.n(lib),is_null_lib=__webpack_require__(95447),is_null_lib_default=__webpack_require__.n(is_null_lib),events=__webpack_require__(4365),actions=__webpack_require__(67033),context=__webpack_require__(32283),role_context=react.createContext("anonymous");class Gate extends react.Component{constructor(props,context2){super(props);this.state={isEnrolled:!1,isOwner:!1,validCheck:props.check?props.check(context2):!0,bypassTimeCheck:!1}}componentDidMount(){this._isMounted=!0;const session=this.context;session&&(this.unsubscribe=session.subscribe((type,action)=>{if((type===events.YQ||type===events.Fw||type===events.E7||type===actions.x$)&&this.checkAuthorization(),this.props.check){const validCheck=this.props.check(session);if(validCheck!==this.state.validCheck)return this.setState({validCheck})}this._isMounted&&this.forceUpdate()}),this.checkAuthorization())}componentDidUpdate(){if(this.props.check){const validCheck=this.props.check(this.context);if(validCheck!==this.state.validCheck)return this.setState({validCheck})}}componentWillUnmount(){this.unsubscribe&&this.unsubscribe(),this._isMounted=!1}checkAuthorization(){const session=this.context;let newState={isEnrolled:session.isEnrolled(),isOwner:session.isOwner(),presentationMode:session.presentationMode};(newState.isEnrolled!==this.state.isEnrolled||newState.isOwner!==this.state.isOwner||newState.presentationMode!==this.state.presentationMode)&&this.setState(newState)}isTimeActive(){if(!this.props.after&&!this.props.until)return!0;const session=this.context;return this.props.after&&this.props.until?this.props.after<session.startTime&&session.startTime<=this.props.until:this.props.until?session.startTime<=this.props.until:this.props.after<session.startTime}renderBanner(){if(!lib_default()(this.props.banner))return this.props.banner;const{check,disabled,user,notUser,enrolled,notEnrolled,owner,notOwner,after,until,t}=this.props;let banner;if(check&&!this.state.validCheck)return banner=t("check-not-satisfied"),react.createElement(Alert_default(),{variant:"info"},banner);if(after||until)if(after)banner=t("available-after")+" "+after.toLocaleString(),until&&(banner+=" ",banner+=t("remain-until")+" "+until.toLocaleString());else{const time=until.toLocaleString();banner=t("available-until")+" "+time}else{if(disabled)return banner=t("not-available"),react.createElement(Alert_default(),{variant:"info"},banner);banner=t("content-only-available")}let bool=!1;if(user){if(notUser)return banner=t("not-available"),react.createElement(Alert_default(),{variant:"info"},banner);banner+=" to logged-in users",bool=!0}else notUser&&(banner+=" to logged-out users",bool=!0);if(enrolled){if(notEnrolled)return banner=t("not-available"),react.createElement(Alert_default(),{variant:"info"},banner);bool&&(banner+=" ",banner+=t("and")),banner+=" ",banner+=t("to-enrolled"),bool=!0}else notEnrolled&&(bool&&(banner+=" ",banner+=t("and")),banner+=" ",banner+=t("to-not-enrolled"),bool=!0);if(owner){if(notOwner)return banner=t("not-available"),react.createElement(Alert_default(),{variant:"info"},banner);bool&&(banner+=" ",banner+=t("and")),banner+=" ",banner+=t("to-owners")}else notOwner&&(bool&&(banner+=" ",banner+=t("and")),banner+=" ",banner+=t("to-non-owners"));return banner+=".",react.createElement(Alert_default(),{variant:"info"},banner)}renderShowButton(){return is_null_lib_default()(this.props.banner)?null:react.createElement(Button_default(),{variant:"secondary",size:"small",onClick:()=>{this.setState({bypassTimeCheck:!this.state.bypassTimeCheck})},style:{float:"right"}},react.createElement("i",{className:"fas fa-clock"})," ",this.props.t("toggle-hidden-content"))}renderChildren(authenticated,isOwner){const timeActive=authenticated&&this.isTimeActive();return react.createElement(react.Fragment,null,!authenticated||!timeActive?this.renderBanner():null,isOwner&&!timeActive?this.renderShowButton():null,react.createElement("div",{className:"gate outer-element",style:{display:authenticated&&(timeActive||this.state.bypassTimeCheck)?"inline":"none"}},this.props.children))}render(){const session=this.context;return react.createElement(role_context.Consumer,null,currentRole=>{const{disabled,user,notUser,enrolled,notEnrolled,owner,notOwner}=this.props,isEnrolled=this.state.isEnrolled||currentRole==="enrolled",isOwner=this.state.isOwner||currentRole==="owner",isUser=session&&!session.anonymous||currentRole!=="anonymous";let authenticated=!1;return disabled||!this.state.validCheck||notUser&&isUser||notOwner&&isOwner||notEnrolled&&isEnrolled?this.renderChildren(!1):((user&&isUser||enrolled&&isEnrolled||owner&&isOwner&&(this.props.showOwnerInPresentationMode||!this.state.presentationMode)||!user&&!owner&&!enrolled)&&(authenticated=!0),this.renderChildren(authenticated,isOwner))})}}Gate.defaultProps={user:!1,notUser:!1,enrolled:!1,notEnrolled:!1,owner:!1,notOwner:!1,after:null,until:null,banner:void 0,disabled:!1,showOwnerInPresentationMode:!1,check:null},Gate.propTypes={user:prop_types_default().bool,notUser:prop_types_default().bool,enrolled:prop_types_default().bool,notEnrolled:prop_types_default().bool,owner:prop_types_default().bool,notOwner:prop_types_default().bool,after:prop_types_default().instanceOf(Date),until:prop_types_default().instanceOf(Date),banner:prop_types_default().node,disabled:prop_types_default().bool,showOwnerInPresentationMode:prop_types_default().bool,check:prop_types_default().func},Gate.contextType=context.Z;var main=(0,commonjs.Zh)("gate")(Gate)}}]);

//# sourceMappingURL=Gate.4146f430.chunk.js.map