(self.webpackChunkisle_dashboard=self.webpackChunkisle_dashboard||[]).push([[4093],{47082:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return T}});var r=n(28991),i=n(6610),a=n(5991),o=n(10379),s=n(60446),u=n(41488),l=n(25472),c=n(84322),h=n.n(c);function f(t,e){for(var n=0,r=0;r<t.length;r++)n+=(t[r]-e[r])*(t[r]-e[r]);return n}var v={distanceFunction:f};function d(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v,r=n.distanceFunction||v.distanceFunction,i=n.similarityFunction||v.similarityFunction,a=-1;if("function"===typeof i)for(var o=Number.MIN_VALUE,s=0;s<t.length;s++){var u=i(e,t[s]);u>o&&(o=u,a=s)}else{if("function"!==typeof r)throw new Error("A similarity or distance function it's required");for(var l=Number.MAX_VALUE,c=0;c<t.length;c++){var h=r(e,t[c]);h<l&&(l=h,a=c)}}return a}function m(t,e,n,r){for(var i=0;i<t.length;i++)n[i]=d(e,t[i],{distanceFunction:r});return n}var g=n(90237),w=n(65337);var p=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();(0,g.Z)(this,t),this.state=new Uint32Array(4),this.init(e),this.random=this.getFloat.bind(this)}return(0,w.Z)(t,[{key:"getUint32",value:function(){return this.nextState(),this.state[3]+this.state[2]>>>0}},{key:"getFloat",value:function(){return 5.960464477539063e-8*(this.getUint32()>>>8)}},{key:"init",value:function(t){if(!Number.isInteger(t))throw new TypeError("seed must be an integer");this.state[0]=t,this.state[1]=0,this.state[2]=0,this.state[3]=0;for(var e=1;e<8;e++)this.state[3&e]^=e+(n=1812433253,r=this.state[e-1&3]^this.state[e-1&3]>>>30>>>0,i=void 0,i=65535&(n>>>=0),((n-i)*(r>>>=0)>>>0)+i*r>>>0)>>>0;var n,r,i;this.periodCertification();for(var a=0;a<8;a++)this.nextState()}},{key:"periodCertification",value:function(){0===this.state[0]&&0===this.state[1]&&0===this.state[2]&&0===this.state[3]&&(this.state[0]=88,this.state[1]=83,this.state[2]=65,this.state[3]=68)}},{key:"nextState",value:function(){var t=this.state[0];t^=t<<15,t^=t>>>18,t^=this.state[3]<<11,this.state[0]=this.state[1],this.state[1]=this.state[2],this.state[2]=this.state[3],this.state[3]=t}}]),t}();function b(t){for(var e=[],n=0;n<t;n++)e.push(n);return e}function y(t,e,n){var r=e();if(n){for(var i=0;r>n[i];)i++;return i}return Math.floor(r*t)}var k=function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.random,a=r.size,o=void 0===a?1:a,s=r.replace,u=void 0!==s&&s,l=r.probabilities;if(e="number"===typeof t?b(t):t.slice(),l){if(!u)throw new Error("choice with probabilities and no replacement is not implemented");if(l.length!==e.length)throw new Error("the length of probabilities option should be equal to the number of choices");n=[l[0]];for(var c=1;c<l.length;c++)n[c]=n[c-1]+l[c];if(Math.abs(1-n[n.length-1])>1e-8)throw new Error("probabilities should sum to 1, but instead sums to ".concat(n[n.length-1]))}if(!1===u&&o>e.length)throw new Error("size option is too large");for(var h=[],f=0;f<o;f++){var v=y(e.length,i,n);h.push(e[v]),u||e.splice(v,1)}return h},E=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random;if((0,g.Z)(this,t),"number"===typeof e){var n=new p(e);this.randomGenerator=n.random}else this.randomGenerator=e}return(0,w.Z)(t,[{key:"choice",value:function(t,e){return k(t,e,this.randomGenerator)}},{key:"random",value:function(){return this.randomGenerator()}},{key:"randInt",value:function(t,e){return void 0===e&&(e=t,t=0),t+Math.floor(this.randomGenerator()*(e-t))}},{key:"randomSample",value:function(t){for(var e=[],n=0;n<t;n++)e.push(this.random());return e}}]),t}(),z=n(61502);function A(t,e){for(var n=new z.Z(t.rows,e.rows),r=0;r<t.rows;r++)for(var i=0;i<e.rows;i++)n.set(r,i,f(t.getRow(r),e.getRow(i)));return n}function x(t){for(var e=[],n=0;n<t;n++)e.push(n);return e}function Z(t){for(var e=[t[0]],n=1;n<t.length;n++)e[n]=e[n-1]+t[n];return e}var F=Symbol("distance"),I=function(){function t(e,n,r,i,a){(0,g.Z)(this,t),this.clusters=e,this.centroids=n,this.converged=r,this.iterations=i,this[F]=a}return(0,w.Z)(t,[{key:"nearest",value:function(t){var e=new Array(t.length);return m(t,this.centroids.map((function(t){return t.centroid})),e,this[F])}},{key:"computeInformation",value:function(e){for(var n=this.centroids.map((function(t){return{centroid:t,error:0,size:0}})),r=0;r<e.length;r++)n[this.clusters[r]].error+=this[F](e[r],this.centroids[this.clusters[r]]),n[this.clusters[r]].size++;for(var i=0;i<this.centroids.length;i++)n[i].size?n[i].error/=n[i].size:n[i].error=null;return new t(this.clusters,n,this.converged,this.iterations,this[F])}}]),t}(),M=h().mark(N),R={maxIterations:100,tolerance:1e-6,withIterations:!1,initialization:"kmeans++",distanceFunction:f};function K(t,e,n,r,i,a){var o=function(t,e,n,r){for(var i=e[0].length,a=new Array(r),o=new Array(r),s=0;s<r;s++){a[s]=new Array(i),o[s]=0;for(var u=0;u<i;u++)a[s][u]=0}for(var l=0;l<e.length;l++){o[n[l]]++;for(var c=0;c<i;c++)a[n[l]][c]+=e[l][c]}for(var h=0;h<r;h++)for(var f=0;f<i;f++)o[h]?a[h][f]/=o[h]:a[h][f]=t[h][f];return a}(t,e,n=m(e,t,n,i.distanceFunction),r),s=function(t,e,n,r){for(var i=0;i<t.length;i++)if(n(t[i],e[i])>r)return!1;return!0}(o,t,i.distanceFunction,i.tolerance);return new I(n,o,s,a,i.distanceFunction)}function N(t,e,n,r,i){var a,o,s;return h().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:a=!1,o=0;case 2:if(a||!(o<i.maxIterations)){u.next=10;break}return s=K(t,e,n,r,i,++o),u.next=6,s.computeInformation(e);case 6:a=s.converged,t=s.centroids,u.next=2;break;case 10:case"end":return u.stop()}}),M)}function U(t,e,n){if(n=Object.assign({},R,n),e<=0||e>t.length||!Number.isInteger(e))throw new Error("K should be a positive integer smaller than the number of points");var r;if(Array.isArray(n.initialization)){if(n.initialization.length!==e)throw new Error("The initial centers should have the same length as K");r=n.initialization}else switch(n.initialization){case"kmeans++":r=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(t=new z.Z(t)).rows,i=new E(n.seed),a=[],o=n.localTrials||2+Math.floor(Math.log(e)),s=i.randInt(r);a.push(t.getRow(s));for(var u=new z.Z(1,t.rows),l=0;l<t.rows;l++)u.set(0,l,f(t.getRow(l),a[0]));for(var c=[Z(u.getRow(0))],h=1/c[0][r-1],v=z.Z.mul(u,h),d=1;d<e;d++){for(var m=i.choice(r,{replace:!0,size:o,probabilities:v[0]}),g=A(t.selection(m,x(t.columns)),t),w=void 0,p=void 0,b=void 0,y=0;y<o;y++){var k=z.Z.min(u,[g.getRow(y)]),F=k.sum();(void 0===w||F<p)&&(w=m[y],p=F,b=k)}a[d]=t.getRow(w),c=[Z((u=b).getRow(0))],v=z.Z.mul(u,1/c[0][r-1])}return a}(t,e,n);break;case"random":r=function(t,e,n){return new E(n).choice(t,{size:e})}(t,e,n.seed);break;case"mostDistant":r=function(t,e,n,r){var i=new E(r),a=new Array(e);if(a[0]=Math.floor(i.random()*t.length),e>1){for(var o={dist:-1,index:-1},s=0;s<t.length;++s)n[a[0]][s]>o.dist&&(o.dist=n[a[0]][s],o.index=s);if(a[1]=o.index,e>2)for(var u=2;u<e;++u){for(var l={dist:-1,index:-1},c=0;c<t.length;++c){for(var h={dist:Number.MAX_VALUE,index:-1},f=0;f<u;++f)n[f][c]<h.dist&&-1===a.indexOf(c)&&(h={dist:n[f][c],index:c});h.dist!==Number.MAX_VALUE&&h.dist>l.dist&&(l=Object.assign({},h))}a[u]=l.index}}return a.map((function(e){return t[e]}))}(t,e,function(t,e){for(var n=new Array(t.length),r=0;r<t.length;++r)for(var i=r;i<t.length;++i){n[r]||(n[r]=new Array(t.length)),n[i]||(n[i]=new Array(t.length));var a=e(t[r],t[i]);n[r][i]=a,n[i][r]=a}return n}(t,n.distanceFunction),n.seed);break;default:throw new Error('Unknown initialization method: "'.concat(n.initialization,'"'))}0===n.maxIterations&&(n.maxIterations=Number.MAX_VALUE);var i=new Array(t.length);if(n.withIterations)return N(r,t,i,e,n);for(var a,o=!1,s=0;!o&&s<n.maxIterations;)o=(a=K(r,t,i,e,n,++s)).converged,r=a.centroids;return a.computeInformation(t)}var _=n(26881),C=n(12087),S=n.n(C),G=n(37221),L=n(31495),V=n.n(L),X=n(83301),D=n(41993);var O=function(t){var e=t.K,n=t.variables,r=t.data,i=t.initialization;if(!r||!n||!e||!i)return null;var a=[];if(!S()(r,n[0]))return null;for(var o,s=r[n[0]].length,u=[],l=0;l<s;l++){for(var c=[],h=!1,f=0;f<n.length;f++){if(!S()(r,n[f]))return null;var v=r[n[f]][l];if(o=v,!(0,G.isPrimitive)(o)||V()(o)){h=!0;break}c.push(v)}h?u.push(l):a.push(c)}try{for(var d=U(a,e,{initialization:i}),m=0;m<u.length;m++)d.clusters.splice(u[m],0,null);return d.clusters=d.clusters.map((function(t){return null===t?null:"Cluster ".concat(t+1)})),d}catch(g){return null}},P=function(t){(0,o.Z)(n,t);var e=(0,s.Z)(n);function n(t){var a;(0,i.Z)(this,n),a=e.call(this,t);var o=t.K,s=t.variables,u=t.data,l=t.initialization,c=O({K:o,variables:s,data:u,initialization:l});return a.state=(0,r.Z)({result:c},t),c&&t.onResult(c),a}return(0,a.Z)(n,[{key:"render",value:function(){var t=this.state.result,e=this.props,n=e.t,r=e.variables;return t?u.createElement("div",{style:{overflowX:"auto",width:"100%"}},u.createElement("span",{className:"title"},n("kmeans-summary")),u.createElement("p",null,t.converged?n("algorithm-converged",{n:t.iterations}):n("algorithm-not-converged",{n:t.iterations})),function(t,e,n){return u.createElement(X.Z,{bordered:!0,size:"sm"},u.createElement("thead",null,u.createElement("tr",null,u.createElement("th",null,n("cluster")),e.map((function(t,e){return u.createElement("th",{key:e},e+1)})))),u.createElement("tbody",null,t.map((function(t,n){return u.createElement("tr",{key:n},u.createElement("th",null,t),e.map((function(t,e){return u.createElement("td",{key:e},t.centroid[n].toFixed(4))})))}))),u.createElement("tbody",null,u.createElement("tr",null,u.createElement("th",null,n("size")),e.map((function(t,e){return u.createElement("th",{key:e},t.size)})))))}(r,t.centroids,n)):u.createElement(_.Z,{variant:"danger"},n("missing-attributes"))}}],[{key:"getDerivedStateFromProps",value:function(t,e){if(t.data!==e.data||t.variables!==e.variables||t.K!==e.K||t.initialization!==e.initialization){var n=t.K,i=t.variables,a=t.data,o=t.initialization,s=O({K:n,variables:i,data:a,initialization:o});return t.onResult(s),(0,r.Z)({result:s},t)}return null}}]),n}(u.Component);P.defaultProps={K:3,initialization:"kmeans++",onResult:function(){}};var T=(0,l.Z)("models")((0,D.W)(P))}}]);
//# sourceMappingURL=KMeans.7c269d72.chunk.js.map