{"version":3,"sources":["components/confirm-modal/index.js","components/message-modal/index.js","components/help-icon/index.js","components/completions/compute_modal.js","components/completions/level_fields.js","components/completions/edit_metric_modal.js","components/completions/shared_edit_lesson_metrics_modal.js","components/completions/index.js","actions/completions.js","containers/visible-completions/index.js","components/edit-namespace/edit_cohort_modal.js","components/edit-namespace/create_cohort_modal.js","components/edit-namespace/import_course_modal.js","components/edit-namespace/index.js","containers/visible-edit-namespace/index.js"],"names":[],"mappings":"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","file":"static/js/1835.924b681b.chunk.js","sourcesContent":["/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { withTranslation } from 'react-i18next';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Modal from 'react-bootstrap/Modal';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n * A confirmation modal component.\r\n *\r\n * @param {Object} props - component properties\r\n * @param {string} props.title - modal title\r\n * @param {string} props.message - modal message\r\n * @param {boolean} props.show - boolean indicating whether the modal is visible\r\n * @param {Function} props.close - callback to invoke upon hiding the modal\r\n * @param {Function} props.onConfirm - callback to invoke upon confirming the modal\r\n * @returns {ReactElement} modal component\r\n */\r\nconst ConfirmModal = ( props ) => (\r\n\t<Modal show={props.show} onHide={props.close} >\r\n\t\t<Modal.Header>\r\n\t\t\t<Modal.Title as=\"h3\">{props.title}</Modal.Title>\r\n\t\t</Modal.Header>\r\n\t\t<Modal.Body>\r\n\t\t\t{props.message}\r\n\t\t</Modal.Body>\r\n\t\t<Modal.Footer>\r\n\t\t\t<Button onClick={props.close}>\r\n\t\t\t\t{props.t('cancel')}\r\n\t\t\t</Button>\r\n\t\t\t<Button variant=\"danger\" onClick={props.onConfirm}>\r\n\t\t\t\t{props.t('confirm')}\r\n\t\t\t</Button>\r\n\t\t</Modal.Footer>\r\n\t</Modal>\r\n);\r\n\r\n\r\n// PROPERTIES //\r\n\r\nConfirmModal.propTypes = {\r\n\tclose: PropTypes.func,\r\n\tmessage: PropTypes.node,\r\n\tonConfirm: PropTypes.func,\r\n\tshow: PropTypes.bool,\r\n\ttitle: PropTypes.string\r\n};\r\n\r\nConfirmModal.defaultProps = {\r\n\tclose() {},\r\n\tmessage: '',\r\n\tonConfirm() {},\r\n\tshow: false,\r\n\ttitle: ''\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default withTranslation( [ 'common' ] )( ConfirmModal );\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport PropTypes from 'prop-types';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n * A modal dialog for displaying messages.\r\n *\r\n * @param {Object} props - component properties\r\n * @param {string} props.message - message to display\r\n * @param {string} props.title - title of the modal\r\n * @param {boolean} props.show - boolean indicating whether the modal is shown\r\n * @param {Function} props.close - callback invoked upon closing the modal\r\n * @returns {ReactElement} modal dialog\r\n */\r\nconst MsgModal = ({ show, close, message, title }) => (\r\n\t<Modal show={show} onHide={close}>\r\n\t\t<Modal.Header closeButton>\r\n\t\t\t<Modal.Title>{title}</Modal.Title>\r\n\t\t</Modal.Header>\r\n\t\t<Modal.Body>\r\n\t\t\t{message}\r\n\t\t</Modal.Body>\r\n\t\t<Modal.Footer>\r\n\t\t\t<Button onClick={close}>\r\n\t\t\t\tClose\r\n\t\t\t</Button>\r\n\t\t</Modal.Footer>\r\n\t</Modal>\r\n);\r\n\r\n\r\n// PROPERTIES //\r\n\r\nMsgModal.propTypes = {\r\n\tclose: PropTypes.func,\r\n\tmessage: PropTypes.string,\r\n\tshow: PropTypes.bool,\r\n\ttitle: PropTypes.string\r\n};\r\n\r\nMsgModal.defaultProps = {\r\n\tclose() {},\r\n\tmessage: '',\r\n\tshow: false,\r\n\ttitle: ''\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default MsgModal;\r\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React from 'react';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Popover from 'react-bootstrap/Popover';\nimport './help_icon.css';\n\n\n// MAIN //\n\nconst HelpIcon = ( props ) => {\n\tconst overlayRef = React.useRef( null );\n\treturn (\n\t\t<div className=\"help-panel\" role=\"button\" tabIndex={0} onKeyDown={(e) => overlayRef.current && (e.which === 13 || e.which === 32) && overlayRef.current.click(e)}>\n\t\t\t<OverlayTrigger\n\t\t\t\tplacement=\"right\"\n\t\t\t\ttrigger={[ 'click' ]}\n\t\t\t\trootClose={true}\n\t\t\t\tdelay={{ show: 250, hide: 0 }}\n\t\t\t\toverlay={ps => <Popover {...ps} className='help-text'><Popover.Body>{props.children}</Popover.Body></Popover>}\n\t\t\t>\n\t\t\t\t<span className=\"mr-1\" tabIndex=\"0\" role=\"button\" ref={overlayRef}>\n\t\t\t\t\tinfo\n\t\t\t\t</span>\n\t\t\t</OverlayTrigger>\n\t\t</div>\n\t);\n};\n\n\n// EXPORTS //\n\nexport default HelpIcon;\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { useCallback, useEffect, useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport axios from 'axios';\r\nimport { useTranslation } from 'react-i18next';\r\nimport DateTimeRangePicker from '@wojtekmaj/react-datetimerange-picker';\r\nimport HelpIcon from 'components/help-icon';\r\nimport Container from 'react-bootstrap/Container';\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Form from 'react-bootstrap/Form';\r\nimport Row from 'react-bootstrap/Row';\r\nimport Col from 'react-bootstrap/Col';\r\nimport SelectInput from 'react-select';\r\nimport usePrevious from 'hooks/use-previous';\r\nimport server from 'constants/server';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst MULTIPLES_POLICIES = [\r\n\t{ value: 'last', label: 'Last submitted value' },\r\n\t{ value: 'first', label: 'First submitted value' },\r\n\t{ value: 'pass-through', label: 'All submitted values' },\r\n\t{ value: 'max', label: 'Best submitted value' }\r\n];\r\n\r\n\r\n// FUNCTIONS //\r\n\r\n/**\r\n * Returns an object mapping tags to weights of one.\r\n *\r\n * @param {Array<string>} tags - list of tags\r\n * @param {Object} [existingWeights={}] - existing weights\r\n * @returns {Object} map of tag to weight\r\n */\r\nfunction createTagWeights( tags, existingWeights={} ) {\r\n\tif ( !tags ) {\r\n\t\treturn {\r\n\t\t\t'_default_tag': 1\r\n\t\t};\r\n\t}\r\n\tconst weights = {};\r\n\ttags.forEach( tag => {\r\n\t\tweights[ tag ] = existingWeights?.[ tag ] ?? 1;\r\n\t});\r\n\treturn weights;\r\n}\r\n\r\n\r\n// MAIN //\r\n\r\nconst memberSelection =( member ) => {\r\n\treturn { value: member.id, label: `${member.firstName} ${member.lastName} (${member.email})` };\r\n};\r\n\r\nfunction TagWeightInput({ value, t, onChange }) {\r\n\tconst tags = Object.keys( value );\r\n\tconst handleChange = useCallback( ( event ) => {\r\n\t\tconst weight = Number( event.target.value );\r\n\t\tconst tag = event.target.getAttribute( 'data-tag' );\r\n\t\tconst newWeights = { ...value };\r\n\t\tnewWeights[ tag ] = weight;\r\n\t\tonChange( newWeights );\r\n\t}, [ value, onChange ] );\r\n\r\n\tconst inputs = new Array( tags.length );\r\n\tfor ( let i = 0; i < tags.length; i++ ) {\r\n\t\tconst tag = tags[ i ];\r\n\t\tconst weight = value[ tag ];\r\n\t\tinputs[ i ] = ( <Form.Group className=\"mb-1\" as={Row} key={`tag-${i}`} >\r\n\t\t\t<Form.Label column sm={3} >{tag === '_default_tag' ? t( 'default' ) : tag}</Form.Label>\r\n\t\t\t<Col sm={9} >\r\n\t\t\t\t<Form.Control\r\n\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\tvalue={weight}\r\n\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\tplaceholder={1}\r\n\t\t\t\t\tdata-tag={tag}\r\n\t\t\t\t\tmin={0}\r\n\t\t\t\t/>\r\n\t\t\t</Col>\r\n\t\t</Form.Group> );\r\n\t}\r\n\treturn inputs;\r\n}\r\n\r\nfunction ComputeModal({ cohorts, metric, entity, level, show, tags, onHide }) {\r\n\tconsole.log( cohorts );\r\n\tconst { t } = useTranslation();\r\n\r\n\tconst [ formValues, setFormValues ] = useState({\r\n\t\tusers: [],\r\n\t\tactiveCohorts: {},\r\n\t\tpolicyOptions: {\r\n\t\t\ttagWeights: createTagWeights( tags, {} ),\r\n\t\t\tmultiples: MULTIPLES_POLICIES[ 0 ]\r\n\t\t}\r\n\t});\r\n\tconst FORM_STORAGE_KEY = `ISLE?level=${level}&id=${entity._id}&metric=${metric.name}`;\r\n\tuseEffect( () => {\r\n\t\tlet oldFormValues = localStorage.getItem( FORM_STORAGE_KEY );\r\n\t\tif ( oldFormValues ) {\r\n\t\t\toldFormValues = JSON.parse( oldFormValues );\r\n\t\t\tsetFormValues( oldFormValues );\r\n\t\t}\r\n\t}, [ FORM_STORAGE_KEY ] );\r\n\tconst oldTags = usePrevious( tags || [] );\r\n\tuseEffect( () => {\r\n\t\tif ( tags && oldTags && tags.length !== oldTags.length ) {\r\n\t\t\tconst newFormValues = {\r\n\t\t\t\t...formValues\r\n\t\t\t};\r\n\t\t\tnewFormValues.policyOptions.tagWeights = createTagWeights( tags, formValues.policyOptions.tagWeights );\r\n\t\t\tsetFormValues( newFormValues );\r\n\t\t}\r\n\t}, [ tags, oldTags, formValues ] );\r\n\tconst onTimeChange = useCallback( ( dates ) => {\r\n\t\tconst newFormValues = { ...formValues };\r\n\t\tnewFormValues.policyOptions.timeFilter = dates;\r\n\t\tsetFormValues( newFormValues );\r\n\t}, [ formValues ] );\r\n\tconst handleMultiplesPolicyChange = useCallback( ( multiples ) => {\r\n\t\tconst newFormValues = { ...formValues };\r\n\t\tnewFormValues.policyOptions.multiples = multiples;\r\n\t\tsetFormValues( newFormValues );\r\n\t}, [ formValues ] );\r\n\tconst handleTagWeightsChange = useCallback( ( tagWeights ) => {\r\n\t\tconst newFormValues = { ...formValues };\r\n\t\tnewFormValues.policyOptions.tagWeights = tagWeights;\r\n\t\tsetFormValues( newFormValues );\r\n\t}, [ formValues ] );\r\n\tconst onCalculate = useCallback( () => {\r\n\t\tif ( formValues.policyOptions.timeFilter ) {\r\n\t\t\tformValues.policyOptions.timeFilter = formValues.policyOptions.timeFilter.map( x => x.getTime() );\r\n\t\t}\r\n\t\tlocalStorage.setItem( FORM_STORAGE_KEY, JSON.stringify( formValues ) );\r\n\t\tconst body = {\r\n\t\t\tid: entity._id,\r\n\t\t\tusers: formValues.users.map( x => x.value ),\r\n\t\t\tmetric: metric,\r\n\t\t\tpolicyOptions: {\r\n\t\t\t\t...formValues.policyOptions,\r\n\t\t\t\tmultiples: formValues.policyOptions.multiples.value\r\n\t\t\t}\r\n\t\t};\r\n\t\taxios.post( server+'/compute_completions', body ).then( response => {\r\n\t\t\tconsole.log( response );\r\n\t\t});\r\n\t}, [ metric, entity, formValues, FORM_STORAGE_KEY ] );\r\n\tconst users = cohorts.reduce( ( userList, cohort ) => {\r\n\t\tconst members = cohort.members.map( member => memberSelection(member) );\r\n\t\treturn userList.concat( members );\r\n\t}, [] );\r\n\tconst selectOptions = [\r\n\t\t{ value: { category: 'all', members: users }, label: t( 'All users' ) },\r\n\t\t...( cohorts.length > 1 ? cohorts.map( cohort => {\r\n\t\t\treturn { value: { category: 'cohort', id: cohort._id, members: cohort.members }, label: 'Cohort ' + cohort.title };\r\n\t\t}) : [] )\r\n\t].concat( users );\r\n\r\n\tconst userSelectStyles = {\r\n\t\toption: ( styles, { data }) => {\r\n\t\t\tif ( data.value.category === 'cohort' && formValues.activeCohorts[ data.value.id ] ) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...styles,\r\n\t\t\t\t\t':before': {\r\n\t\t\t\t\t\tcontent: '\"\\u2713 \"'\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn styles;\r\n\t\t}\r\n\t};\r\n\tconst handleUserSelectChange = useCallback( ( value ) => {\r\n\t\tif ( !value ) {\r\n\t\t\tsetFormValues( {\r\n\t\t\t\t...formValues,\r\n\t\t\t\tusers: []\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif ( value.some( x => x.value.category === 'all' ) ) {\r\n\t\t\tsetFormValues({\r\n\t\t\t\t...formValues,\r\n\t\t\t\tusers: users,\r\n\t\t\t\tactiveCohorts: {}\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst selectedUsersSet= new Set();\r\n\t\tconst removeIds = new Set();\r\n\t\tconst newValue = [];\r\n\t\tconst newActiveCohorts = Object.assign( {}, formValues.activeCohorts );\r\n\t\tfor ( let i = 0; i < value.length; i++ ) {\r\n\t\t\tif ( value[ i ].value.category === 'cohort' ) {\r\n\t\t\t\tif ( !formValues.activeCohorts[ value[i].value.id ] ) {\r\n\t\t\t\t\tnewActiveCohorts[ value[i].value.id ] = true;\r\n\t\t\t\t\tfor ( let j = 0; j < value[ i ].value.members.length; ++j ) {\r\n\t\t\t\t\t\tif ( !selectedUsersSet.has( value[ i ].value.members[ j ].id ) ) {\r\n\t\t\t\t\t\t\tconst member = value[ i ].value.members[ j ];\r\n\t\t\t\t\t\t\tnewValue.push( memberSelection( member ) );\r\n\t\t\t\t\t\t\tselectedUsersSet.add( member.id );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewActiveCohorts[ value[i].value.id ] = false;\r\n\t\t\t\t\tvalue[ i ].value.members.forEach( member => {\r\n\t\t\t\t\t\tremoveIds.add( member.id );\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if ( !selectedUsersSet.has( value[ i ].value ) ) {\r\n\t\t\t\tnewValue.push( value[ i ] );\r\n\t\t\t\tselectedUsersSet.add( value[ i ].value );\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetFormValues({\r\n\t\t\t...formValues,\r\n\t\t\tusers: newValue.filter( x => !removeIds.has( x.value ) ),\r\n\t\t\tactiveCohorts: newActiveCohorts\r\n\t\t});\r\n\t}, [ formValues, users ] );\r\n\treturn (\r\n\t\t<Modal size=\"lg\" show={show} onHide={onHide}>\r\n\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t<Modal.Title as=\"h3\">{t('calculate-scores')}</Modal.Title>\r\n\t\t\t</Modal.Header>\r\n\t\t\t<Modal.Body>\r\n\t\t\t\t<Container>\r\n\t\t\t\t\t<Form.Group className=\"mb-2\" as={Row} controlId=\"multiplesPolicy\" >\r\n\t\t\t\t\t\t<Form.Label column sm={3} >\r\n\t\t\t\t\t\t\t{t('multiples-policy')}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Col sm={8} >\r\n\t\t\t\t\t\t\t<SelectInput value={formValues.policyOptions.multiples} options={MULTIPLES_POLICIES} onChange={handleMultiplesPolicyChange} />\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t<Col sm={1} >\r\n\t\t\t\t\t\t\t<HelpIcon>\r\n\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t{t('multiples-policy-description')}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</HelpIcon>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t\t<Form.Group className=\"mb-2\" as={Row} controlId=\"timeFilter\" >\r\n\t\t\t\t\t\t<Form.Label column sm={3} >\r\n\t\t\t\t\t\t\t{t('time-filter')}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Col sm={8} >\r\n\t\t\t\t\t\t\t<DateTimeRangePicker onChange={onTimeChange} value={formValues.policyOptions.timeFilter} />\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t<Col sm={1} >\r\n\t\t\t\t\t\t\t<HelpIcon>\r\n\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t{t('time-filter-description')}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</HelpIcon>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t\t<Form.Group className=\"mb-2\" as={Row} controlId=\"users\" >\r\n\t\t\t\t\t\t<Form.Label column sm={3} >\r\n\t\t\t\t\t\t\t{t('users')}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Col sm={8} >\r\n\t\t\t\t\t\t\t<SelectInput\r\n\t\t\t\t\t\t\t\tvalue={formValues.users} isMulti\r\n\t\t\t\t\t\t\t\toptions={selectOptions} onChange={handleUserSelectChange}\r\n\t\t\t\t\t\t\t\thideSelectedOptions={true}\r\n\t\t\t\t\t\t\t\tstyles={userSelectStyles}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t<Col sm={1} >\r\n\t\t\t\t\t\t\t<HelpIcon>\r\n\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t{t('users-description')}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</HelpIcon>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t\t<Form.Group className=\"mb-2\" as={Row} controlId=\"users\" >\r\n\t\t\t\t\t\t<Form.Label column sm={3} >\r\n\t\t\t\t\t\t\t{t('tag-weights')}\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t<Col sm={8} >\r\n\t\t\t\t\t\t\t<TagWeightInput value={formValues.policyOptions.tagWeights} onChange={handleTagWeightsChange} t={t} />\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t<Col sm={1} >\r\n\t\t\t\t\t\t\t<HelpIcon>\r\n\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t{t('tag-weights-description')}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</HelpIcon>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t</Container>\r\n\t\t\t</Modal.Body>\r\n\t\t\t<Modal.Footer>\r\n\t\t\t\t<Button onClick={onHide}>\r\n\t\t\t\t\t{t('common:cancel')}\r\n\t\t\t\t</Button>\r\n\t\t\t\t<Button variant=\"success\" onClick={onCalculate} disabled={formValues.users.length === 0}>\r\n\t\t\t\t\t{t('common:calculate')}\r\n\t\t\t\t</Button>\r\n\t\t\t</Modal.Footer>\r\n\t\t</Modal>\r\n\t);\r\n}\r\n\r\n\r\n// PROPERTIES //\r\n\r\nComputeModal.propTypes = {\r\n\tcohorts: PropTypes.array.isRequired,\r\n\tentity: PropTypes.object.isRequired,\r\n\tlevel: PropTypes.string.isRequired,\r\n\tmetric: PropTypes.object.isRequired,\r\n\tonHide: PropTypes.func.isRequired,\r\n\tshow: PropTypes.bool.isRequired,\r\n\ttags: PropTypes.array\r\n};\r\n\r\nComputeModal.defaultProps = {\r\n\ttags: null\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default ComputeModal;\r\n","// MAIN //\n\n/**\n* Mapping from a given node level to the corresponding field in the schema that contains the children.\n*/\nexport const levelFieldMapping = {\n\tprogram: 'namespaces',\n\tnamespace: 'lessons',\n\tlesson: null,\n\tcomponent: null\n};\n\n/**\n* Returns the next lower level in the hierarchy.\n*\n* @private\n* @param {string} level - input level\n* @returns {string} predecessor level\n*/\nexport function predecessor( level ) {\n\tswitch ( level ) {\n\tcase 'lesson':\n\t\treturn 'component';\n\tcase 'namespace':\n\t\treturn 'lesson';\n\tcase 'program':\n\t\treturn 'namespace';\n\tcase 'global':\n\t\treturn 'program';\n\tcase 'component':\n\tdefault:\n\t\treturn null;\n\t}\n}\n\n/**\n* Returns the next lower level in the hierarchy.\n*/\nexport const levelPredecessorMapping = {\n\tglobal: 'program',\n\tprogram: 'namespace',\n\tnamespace: 'lesson',\n\tlesson: 'component',\n\tcomponent: null\n};\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { useTranslation } from 'react-i18next';\nimport Button from 'react-bootstrap/Button';\nimport Row from 'react-bootstrap/Row';\nimport Modal from 'react-bootstrap/Modal';\nimport Form from 'react-bootstrap/Form';\nimport SelectInput, { components } from 'react-select';\nimport CreatableSelect from 'react-select/creatable';\nimport objectValues from '@stdlib/utils/values';\nimport { levelFieldMapping } from './level_fields.js';\nimport COVERAGE_OPTIONS from './coverage_options.json';\n\n\n// MAIN //\n\nfunction EditMetricModal({ level, entity, show, onHide, allRules, refs, createNew, metric, onConfirm }) {\n\tconst { t } = useTranslation();\n\tconst [ name, setName ] = useState( metric?.name || '' );\n\tconst [ rule, setRule ] = useState( metric?.rule ? allRules[ metric.rule[ 0 ] ] : null );\n\tconst [ ruleParameters, setRuleParameters ] = useState( metric?.rule ? metric.rule.slice( 1 ) : [] );\n\tconst [ coverage, setCoverage ] = useState( COVERAGE_OPTIONS[ metric?.coverage?.[ 0 ] || 'all' ] );\n\tconst [ coverageEntities, setCoverageEntities ] = useState( [] );\n\tconst [ selectedRef, setSelectedRef ] = useState( metric?.ref || null );\n\tconst subEntities = useRef( [] );\n\n\tuseEffect( () => {\n\t\tif ( level === 'lesson' ) {\n\t\t\t// TODO: fetch component IDs of that lesson from completion data table\n\t\t\tsubEntities.current = [];\n\t\t} else if ( levelFieldMapping[ level ] ) {\n\t\t\tconst entities = entity[ levelFieldMapping[ level ] ];\n\t\t\tconsole.log( entities );\n\n\t\t\tsubEntities.current = entities.map( x => {\n\t\t\t\treturn {\n\t\t\t\t\tlabel: x.title,\n\t\t\t\t\tvalue: x\n\t\t\t\t};\n\t\t\t});\n\t\t\tif ( metric && metric.coverage ) {\n\t\t\t\tconst ids = new Set( metric.coverage.slice( 1 ) );\n\t\t\t\tsetCoverageEntities( subEntities.current.filter( x => ids.has( x.value._id ) ) );\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tsubEntities.current = [];\n\t\t}\n\t}, [ level, entity, metric ] );\n\n\tconst handleConfirm = () => {\n\t\tonConfirm({\n\t\t\tname,\n\t\t\trule: [ rule.name ].concat( ruleParameters ),\n\t\t\tcoverage: [ coverage.value ].concat( coverageEntities.map( x => x.value._id ) ),\n\t\t\tlevel,\n\t\t\tid: entity._id,\n\t\t\tref: selectedRef\n\t\t});\n\t\tonHide();\n\t};\n\tconst handleEntityChange = ( value ) => {\n\t\tconsole.log( value );\n\t\tsetCoverageEntities( value );\n\t};\n\tconsole.log( 'Sub-entities:' );\n\tconsole.log( subEntities.current );\n\n\tconst labelStyler = ( styles, { data }) => {\n\t\tif ( !selectedRef || data.value.completions.some( x => x.name === selectedRef ) ) {\n\t\t\treturn styles;\n\t\t}\n\t\treturn {\n\t\t\t...styles,\n\t\t\topacity: 0.65\n\t\t};\n\t};\n\tconst subentitySelectorStyles = {\n\t\toption: labelStyler,\n\t\tmultiValueLabel: labelStyler\n\t};\n\treturn (\n\t\t<Modal size=\"lg\" show={show} onHide={onHide}>\n\t\t\t<Modal.Header closeButton >\n\t\t\t\t<Modal.Title as=\"h3\">{createNew ? t('create-completion-metric') : t('edit-completion-metric')}</Modal.Title>\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Body>\n\t\t\t\t<p>\n\t\t\t\t\t{createNew ? t('create-completion-metric-description') : t('edit-completion-metric-description')}\n\t\t\t\t</p>\n\t\t\t\t<Form.Group className=\"mb-2\" >\n\t\t\t\t\t<Form.Label>{t('common:name')}</Form.Label>\n\t\t\t\t\t<Form.Control\n\t\t\t\t\t\tname=\"metric-name\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tplaceholder={t('metric-name-placeholder')}\n\t\t\t\t\t\tonChange={( event ) => setName( event.target.value )}\n\t\t\t\t\t\tvalue={name}\n\t\t\t\t\t/>\n\t\t\t\t</Form.Group>\n\t\t\t\t<Form.Group className=\"mb-2\" >\n\t\t\t\t\t<Form.Label>{t('common:rule')}</Form.Label>\n\t\t\t\t\t<SelectInput\n\t\t\t\t\t\toptions={objectValues( allRules ).map( ( rule ) => ({ value: rule, label: rule.label }) )}\n\t\t\t\t\t\tonChange={( option ) => {\n\t\t\t\t\t\t\tconst newRule = option.value;\n\t\t\t\t\t\t\tsetRule( newRule );\n\t\t\t\t\t\t\tsetRuleParameters( newRule.defaults );\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tvalue={rule ? { value: rule, label: rule.label } : null}\n\t\t\t\t\t/>\n\t\t\t\t</Form.Group>\n\t\t\t\t{rule && rule.parameters.length > 0 ?\n\t\t\t\t\trule.parameters.map( ( parameter, idx ) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Form.Group key={`param-${idx}`} className=\"mb-2\" >\n\t\t\t\t\t\t\t\t<Form.Label>{parameter.name}</Form.Label>\n\t\t\t\t\t\t\t\t<Form.Control\n\t\t\t\t\t\t\t\t\tname={parameter.name}\n\t\t\t\t\t\t\t\t\ttype={parameter.type}\n\t\t\t\t\t\t\t\t\tplaceholder={t('enter-parameter-value')}\n\t\t\t\t\t\t\t\t\tonChange={( event ) => {\n\t\t\t\t\t\t\t\t\t\tconst newParams = ruleParameters.slice();\n\t\t\t\t\t\t\t\t\t\tswitch ( parameter.type ) {\n\t\t\t\t\t\t\t\t\t\t\tcase 'number':\n\t\t\t\t\t\t\t\t\t\t\t\tnewParams[ idx ] = parseFloat( event.target.value );\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\tcase 'string':\n\t\t\t\t\t\t\t\t\t\t\t\tnewParams[ idx ] = event.target.value;\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tsetRuleParameters( newParams );\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tdefaultValue={ruleParameters[ idx ] !== void 0 ? ruleParameters[ idx ] : rule.defaults[ idx ]}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Form.Group>\n\t\t\t\t\t\t);\n\t\t\t\t\t}) : null}\n\t\t\t\t<Form.Group className=\"mb-2\" >\n\t\t\t\t\t<Form.Label>{t('common:ref')}</Form.Label>\n\t\t\t\t\t<CreatableSelect\n\t\t\t\t\t\tisClearable\n\t\t\t\t\t\toptions={refs.map( ( ref ) => ({ value: ref, label: ref }) )}\n\t\t\t\t\t\tonChange={( option ) => {\n\t\t\t\t\t\t\tsetSelectedRef( option ? option.value : null );\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tdefaultValue={selectedRef ? { value: selectedRef, label: selectedRef } : null}\n\t\t\t\t\t/>\n\t\t\t\t</Form.Group>\n\t\t\t\t<Form.Group className=\"mb-2\" as={Row} >\n\t\t\t\t\t<Form.Label>{t('common:coverage')}</Form.Label>\n\t\t\t\t\t<SelectInput\n\t\t\t\t\t\toptions={objectValues( COVERAGE_OPTIONS )}\n\t\t\t\t\t\tonChange={( option ) => {\n\t\t\t\t\t\t\tsetCoverage( option );\n\t\t\t\t\t\t\tif ( option.value === 'all' ) {\n\t\t\t\t\t\t\t\tsetCoverageEntities( [] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tvalue={coverage}\n\t\t\t\t\t/>\n\t\t\t\t\t{( coverage.value === 'include' || coverage.value === 'exclude' ) ?\n\t\t\t\t\t\t<SelectInput\n\t\t\t\t\t\t\tisMulti\n\t\t\t\t\t\t\toptions={subEntities.current}\n\t\t\t\t\t\t\tonChange={handleEntityChange}\n\t\t\t\t\t\t\tvalue={coverageEntities}\n\t\t\t\t\t\t\tstyles={subentitySelectorStyles}\n\t\t\t\t\t\t\tplaceholder=\"Select lessons...\"\n\t\t\t\t\t\t\tcomponents={{\n\t\t\t\t\t\t\t\tPlaceholder: ({ children, isFocused, ...rest }) => {\n\t\t\t\t\t\t\t\t\tconsole.log( rest );\n\t\t\t\t\t\t\t\t\treturn ( <components.Placeholder {...rest}>\n\t\t\t\t\t\t\t\t\t\t{children} {isFocused ? '(opaque lessons have no metric for the selected ref)' : ''}\n\t\t\t\t\t\t\t\t\t</components.Placeholder> );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/> : null\n\t\t\t\t\t}\n\t\t\t\t</Form.Group>\n\t\t\t</Modal.Body>\n\t\t\t<Modal.Footer>\n\t\t\t\t<Button onClick={onHide}>\n\t\t\t\t\t{t('common:cancel')}\n\t\t\t\t</Button>\n\t\t\t\t<Button variant=\"success\" onClick={handleConfirm} disabled={!rule || !name} >\n\t\t\t\t\t{createNew ? t('common:create') : t('common:save')}\n\t\t\t\t</Button>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n}\n\n\n// PROPERTIES //\n\nEditMetricModal.propTypes = {\n\tallRules: PropTypes.object.isRequired,\n\tcreateNew: PropTypes.bool.isRequired,\n\tentity: PropTypes.object.isRequired,\n\tlevel: PropTypes.oneOf([ 'program', 'namespace', 'lesson', 'component' ]).isRequired,\n\tmetric: PropTypes.object,\n\tonConfirm: PropTypes.func.isRequired,\n\tonHide: PropTypes.func.isRequired,\n\trefs: PropTypes.array.isRequired,\n\tshow: PropTypes.bool.isRequired\n};\n\nEditMetricModal.defaultProps = {\n\tmetric: null\n};\n\n\n// EXPORTS //\n\nexport default EditMetricModal;\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { useTranslation } from 'react-i18next';\nimport Button from 'react-bootstrap/Button';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Modal from 'react-bootstrap/Modal';\nimport Form from 'react-bootstrap/Form';\nimport InputGroup from 'react-bootstrap/InputGroup';\nimport SelectInput from 'react-select';\nimport CreatableSelect from 'react-select/creatable';\nimport objectValues from '@stdlib/utils/values';\nimport COVERAGE_OPTIONS from './coverage_options.json';\nimport hash from 'object-hash';\n\n\n// VARIABLES //\n\nconst COVERAGE_OPTIONS_ARRAY = objectValues( COVERAGE_OPTIONS );\nconst SELECT_STYLES = {\n\tmenuPortal: ( base ) => ({\n\t\t...base,\n\t\tzIndex: 9999\n\t})\n};\n\n\n// FUNCTIONS //\n\nfunction convertRuleParameter( value, parameter ) {\n\tswitch ( parameter.type ) {\n\t\tcase 'number':\n\t\t\treturn parseFloat( value );\n\t\tcase 'string':\n\t\t\treturn value;\n\t}\n}\n\nfunction selectOption( value ) {\n\treturn {\n\t\tlabel: value,\n\t\tvalue: value\n\t};\n}\n\nfunction analyzeLessonMetrics( name, lessons ) {\n\tconst lessonInfo = lessons.reduce( (acc, lesson) => {\n\t\tconst namedMetric = lesson.completions.find( metric => metric.name === name );\n\t\tif ( namedMetric ) {\n\t\t\tacc.active[lesson._id] = namedMetric;\n\t\t\tacc.rules.add( JSON.stringify(namedMetric.rule) );\n\t\t\tacc.rule = namedMetric.rule;\n\t\t\tacc.refs.add( namedMetric.ref );\n\t\t\tacc.ref = namedMetric.ref;\n\t\t}\n\t\treturn acc;\n\t}, { rules: new Set(), refs: new Set(), active: {}, rule: null, ref: null }, lessons);\n\n\tif ( lessonInfo.rules.size > 0 ) {\n\t\treturn {\n\t\t\thasSharedRule: lessonInfo.rules.size === 1,\n\t\t\thasSharedRef: lessonInfo.refs.size === 1,\n\t\t\tactiveLessons: lessonInfo.active,\n\t\t\trule: lessonInfo.rule,\n\t\t\tref: lessonInfo.ref\n\t\t};\n\t}\n\treturn {\n\t\tactiveLessons: {},\n\t\thasSharedRule: true,\n\t\thasSharedRef: true,\n\t\trule: null,\n\t\tref: null\n\t};\n}\n\nfunction availableLessonMetrics( lessons ) {\n\tconst allMetrics = lessons.reduce( ( acc, lesson ) => {\n\t\tlesson.completions.forEach( metric => {\n\t\t\tacc.add( metric.name );\n\t\t});\n\t\treturn acc;\n\t}, new Set() );\n\treturn Array.from( allMetrics ).sort().map( metric => ({ value: metric, label: metric }) );\n}\n\n\n// MAIN //\n\nfunction SharedEditLessonMetricsModal({ name, preferredLesson, lessons, lessonRefs, lessonComponents, namespace, allRules, show, onHide, onSave }) {\n\tconst [ chosenName, setChosenName ] = useState( name );\n\tconst [ hasSharedRule, setHasSharedRule ] = useState( false );\n\tconst [ sharedRule, setSharedRule ] = useState( null );\n\tconst [ sharedRuleParameters, setSharedRuleParameters ] = useState( [] );\n\tconst [ hasSharedRef, setHasSharedRef ] = useState( false );\n\tconst [ sharedRef, setSharedRef ] = useState( null );\n\tconst [ activeLessons, setActiveLessons ] = useState( {} );\n\tconst [ selectedLessons, setSelectedLessons ] = useState( {} );\n\tconst [ currentHash, setCurrentHash ] = useState( null );\n\n\tconst availableMetrics = useRef( null );\n\tconst analyzedHash = useRef( null );\n\tconst analysisRef = useRef( null );\n\n\tconst incorporateAnalysis = useCallback( ( analysis ) => {\n\t\tsetHasSharedRule( analysis.hasSharedRule );\n\t\tlet newSharedRule = null;\n\t\tlet newSharedRuleParameters = [];\n\t\tif ( analysis.hasSharedRule && analysis.rule && analysis.rule[ 0 ] ) {\n\t\t\tnewSharedRule = allRules[ analysis.rule[ 0 ] ];\n\t\t\tnewSharedRuleParameters = analysis.rule.slice( 1 );\n\t\t\tsetSharedRule( newSharedRule );\n\t\t\tsetSharedRuleParameters( newSharedRuleParameters );\n\t\t}\n\t\tsetHasSharedRef( analysis.hasSharedRef );\n\t\tif ( analysis.hasSharedRef ) {\n\t\t\tsetSharedRef( analysis.ref );\n\t\t}\n\t\tconst obj = {\n\t\t\tsharedRule: newSharedRule,\n\t\t\tsharedRuleParameters: newSharedRuleParameters,\n\t\t\tsharedRef: analysis.hasSharedRef ? analysis.ref : null,\n\t\t\tactiveLessons: analysis.activeLessons\n\t\t};\n\t\tconst newSelectedLessons = {};\n\t\tconsole.log( obj );\n\t\tfor ( let i = 0; i < lessons.length; i++ ) {\n\t\t\tconst lesson = lessons[ i ];\n\t\t\tconst lessonId = lesson._id;\n\t\t\tconst lessonMetric = obj.activeLessons[ lessonId ];\n\t\t\tif ( lessonMetric ) {\n\t\t\t\tnewSelectedLessons[ lessonId ] = true;\n\t\t\t} else {\n\t\t\t\tnewSelectedLessons[ lessonId ] = false;\n\t\t\t\tobj.activeLessons[ lessonId ] = {\n\t\t\t\t\tname: chosenName,\n\t\t\t\t\trule: analysis.hasSharedRule ? [ obj.sharedRule.name, ...obj.sharedRuleParameters ] : null,\n\t\t\t\t\tref: analysis.hasSharedRef ? obj.sharedRef : null,\n\t\t\t\t\tcoverage: [ 'all' ],\n\t\t\t\t\tlevel: 'lesson'\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\tconsole.log( 'Analyzed HASHED OBJ: ');\n\t\tconsole.log( obj );\n\t\tanalyzedHash.current = hash( obj );\n\t\tconsole.log( 'Analyzed HASHED: ' + analyzedHash.current );\n\t\tsetCurrentHash( analyzedHash.current );\n\t\tsetActiveLessons( obj.activeLessons );\n\t\tsetSelectedLessons( newSelectedLessons );\n\t}, [ allRules, chosenName, lessons ] );\n\n\tuseEffect( () => {\n\t\tavailableMetrics.current = availableLessonMetrics( lessons );\n\t}, [ lessons ] );\n\tuseEffect( () => {\n\t\tconsole.log( 'EFFECT...' );\n\t\tconsole.log( chosenName );\n\t\tconst analysis = analyzeLessonMetrics( chosenName, lessons );\n\t\tconsole.log( 'ANALYSIS' );\n\t\tconsole.log( analysis );\n\t\tanalysisRef.current = analysis;\n\t\tincorporateAnalysis( analysis );\n\t}, [ allRules, incorporateAnalysis, lessons, chosenName ] );\n\tuseEffect( () => {\n\t\tconst obj = {\n\t\t\tsharedRule: hasSharedRule ? sharedRule : null,\n\t\t\tsharedRuleParameters: hasSharedRule ? sharedRuleParameters : [],\n\t\t\tsharedRef: hasSharedRef ? sharedRef : null,\n\t\t\tactiveLessons\n\t\t};\n\t\tconsole.log( 'CURRENT HASHED OBJ: ');\n\t\tconsole.log( obj );\n\t\tsetCurrentHash( hash( obj ) );\n\t}, [ sharedRule, sharedRef, sharedRuleParameters, activeLessons, hasSharedRef, hasSharedRule ] );\n\n\tconst handleSave = useCallback( () => {\n\t\tconst lessonMetrics = { ...activeLessons };\n\t\tnamespace.lessons.forEach( lesson => {\n\t\t\tif ( !selectedLessons[ lesson._id ] ) {\n\t\t\t\tlessonMetrics[ lesson._id ] = null;\n\t\t\t} else {\n\t\t\t\tlessonMetrics[ lesson._id ] = {\n\t\t\t\t\t...lessonMetrics[ lesson._id ],\n\t\t\t\t\t...( hasSharedRef ? { ref: sharedRef } : {} ),\n\t\t\t\t\t...( hasSharedRule ? { rule: [ sharedRule.name, ...sharedRuleParameters ] } : {} )\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t\tconst body = {\n\t\t\tnamespaceID: namespace._id,\n\t\t\tname: chosenName,\n\t\t\tlessonMetrics\n\t\t};\n\t\tonSave( body );\n\t}, [ activeLessons, chosenName, namespace, hasSharedRef, sharedRef, hasSharedRule, selectedLessons, sharedRule, sharedRuleParameters, onSave ] );\n\n\tfunction lessonActivator() {\n\t\treturn {\n\t\t\tname: chosenName,\n\t\t\trule: hasSharedRule ? [ sharedRule.name, ...sharedRuleParameters ] : null,\n\t\t\tref: hasSharedRef ? sharedRef : null,\n\t\t\tcoverage: [ 'all' ],\n\t\t\tlevel: 'lesson'\n\t\t};\n\t}\n\tconst { t } = useTranslation();\n\tconst lessonRefOptions = lessonRefs.map( ( ref ) => ({ value: ref, label: ref }) );\n\tconst allRulesOptions = objectValues( allRules ).map( ( rule ) => ({ value: rule, label: rule.label }) );\n\tconst sharedInputs = <>\n\t\t<Form.Group className=\"mb-2\" as={Row} >\n\t\t\t<Col sm={4} >\n\t\t\t\t<Form.Check\n\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\tid=\"shared-rule-checkbox\"\n\t\t\t\t\tlabel={t('share-across-lessons')}\n\t\t\t\t\tonChange={( event ) => {\n\t\t\t\t\t\tsetHasSharedRule( event.target.checked );\n\t\t\t\t\t}}\n\t\t\t\t\tchecked={hasSharedRule}\n\t\t\t\t/>\n\t\t\t</Col>\n\t\t\t<Form.Label column sm={2} >{t('common:rule')}</Form.Label>\n\t\t\t<Col sm={6} >\n\t\t\t\t<SelectInput\n\t\t\t\t\tisDisabled={!hasSharedRule}\n\t\t\t\t\toptions={allRulesOptions}\n\t\t\t\t\tonChange={( option ) => {\n\t\t\t\t\t\tconst newRule = option.value;\n\t\t\t\t\t\tsetSharedRule( newRule );\n\t\t\t\t\t\tsetSharedRuleParameters( newRule.defaults );\n\t\t\t\t\t}}\n\t\t\t\t\tvalue={sharedRule ? { value: sharedRule, label: sharedRule.label } : null}\n\t\t\t\t/>\n\t\t\t</Col>\n\t\t</Form.Group>\n\t\t{hasSharedRule && sharedRule && sharedRule.parameters.length > 0 &&\n\t\t\tsharedRule.parameters.map( ( parameter, idx ) => {\n\t\t\t\treturn (\n\t\t\t\t\t<Form.Group key={`param-${idx}`} className=\"mb-2\" as={Row} >\n\t\t\t\t\t\t<Col sm={4} ></Col>\n\t\t\t\t\t\t<Form.Label column sm={2} >{parameter.name}</Form.Label>\n\t\t\t\t\t\t<Col sm={6} >\n\t\t\t\t\t\t\t<Form.Control\n\t\t\t\t\t\t\t\tname={parameter.name}\n\t\t\t\t\t\t\t\ttype={parameter.type}\n\t\t\t\t\t\t\t\tplaceholder={t('enter-parameter-value')}\n\t\t\t\t\t\t\t\tonChange={( event ) => {\n\t\t\t\t\t\t\t\t\tconst newParams = sharedRuleParameters.slice();\n\t\t\t\t\t\t\t\t\tnewParams[ idx ] = convertRuleParameter( event.target.value, parameter );\n\t\t\t\t\t\t\t\t\tsetSharedRuleParameters( newParams );\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tdefaultValue={sharedRuleParameters[ idx ] !== void 0 ? sharedRuleParameters[ idx ] : sharedRule.defaults[ idx ]}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Form.Group>\n\t\t\t\t);\n\t\t})}\n\t\t<Form.Group className=\"mb-2\" as={Row} >\n\t\t\t<Col sm={4} >\n\t\t\t\t<Form.Check\n\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\tid=\"shared-ref-checkbox\"\n\t\t\t\t\tlabel={t('share-across-lessons')}\n\t\t\t\t\tonChange={( event ) => {\n\t\t\t\t\t\tsetHasSharedRef( event.target.checked );\n\t\t\t\t\t}}\n\t\t\t\t\tchecked={hasSharedRef}\n\t\t\t\t/>\n\t\t\t</Col>\n\t\t\t<Form.Label column sm={2} >{t('common:ref')}</Form.Label>\n\t\t\t<Col sm={6} >\n\t\t\t\t<CreatableSelect\n\t\t\t\t\tisClearable\n\t\t\t\t\tisDisabled={!hasSharedRef}\n\t\t\t\t\toptions={lessonRefOptions}\n\t\t\t\t\tonChange={( option ) => {\n\t\t\t\t\t\tsetSharedRef( option ? option.value : null );\n\t\t\t\t\t}}\n\t\t\t\t\tvalue={sharedRef ? { value: sharedRef, label: sharedRef } : null}\n\t\t\t\t/>\n\t\t\t</Col>\n\t\t</Form.Group>\n\t</>;\n\tconst sortedLessons = Array.from( lessons ).sort( preferredLesson ? ( a, b ) => {\n\t\tif ( a.title === preferredLesson.title ) {\n\t\t\treturn -1;\n\t\t}\n\t\tif ( b.title === preferredLesson.title ) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn a.title.localeCompare( b.title );\n\t} : ( a, b ) => a.title.localeCompare( b.title ) );\n\tconst lessonInputs = sortedLessons.map( x => {\n\t\tconst lessonIsActive = activeLessons[ x._id ] !== void 0;\n\t\tlet defaultRuleParameters;\n\t\tlet defaultRule;\n\t\tlet defaultRef;\n\t\tif ( lessonIsActive ) {\n\t\t\tif ( hasSharedRef && sharedRef ) {\n\t\t\t\tdefaultRef = { value: sharedRef, label: sharedRef };\n\t\t\t} else {\n\t\t\t\tdefaultRef = activeLessons[ x._id ].ref ? { value: activeLessons[ x._id ].ref, label: activeLessons[ x._id ].ref } : null;\n\t\t\t}\n\t\t\tif ( hasSharedRule && sharedRule ) {\n\t\t\t\tdefaultRule = { value: sharedRule, label: sharedRule.label };\n\t\t\t\tdefaultRuleParameters = sharedRuleParameters;\n\t\t\t} else if ( activeLessons[ x._id ].rule ) {\n\t\t\t\tconst activeRule = allRules[ activeLessons[ x._id ].rule[ 0 ] ];\n\t\t\t\tdefaultRule = { value: activeRule, label: activeRule.label };\n\t\t\t\tdefaultRuleParameters = activeLessons[ x._id ].rule.slice( 1 );\n\t\t\t} else {\n\t\t\t\tdefaultRule = null;\n\t\t\t\tdefaultRuleParameters = [];\n\t\t\t}\n\t\t}\n\t\tconst activeLesson = activeLessons[ x._id ];\n\t\tconst coverage = activeLesson?.coverage || [ 'all' ];\n\t\tconst coverageQualifier = coverage[ 0 ];\n\t\tconst coverageEntities = coverage.slice( 1 ).map( selectOption );\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<Form.Check\n\t\t\t\t\ttype=\"switch\"\n\t\t\t\t\tid=\"custom-switch\"\n\t\t\t\t\tlabel={x.title}\n\t\t\t\t\tkey={x._id}\n\t\t\t\t\tonChange={( event ) => {\n\t\t\t\t\t\tconst newSelected = { ...selectedLessons };\n\t\t\t\t\t\tnewSelected[ x._id ] = event.target.checked;\n\t\t\t\t\t\tsetSelectedLessons( newSelected );\n\t\t\t\t\t}}\n\t\t\t\t\tchecked={lessonIsActive}\n\t\t\t\t/>\n\t\t\t\t{lessonIsActive && <>\n\t\t\t\t\t<Form.Group className=\"mb-2\" as={Row} >\n\t\t\t\t\t\t<Col sm={2} />\n\t\t\t\t\t\t<Form.Label column sm={4} >{t('common:rule')}</Form.Label>\n\t\t\t\t\t\t<Col sm={6} >\n\t\t\t\t\t\t\t<SelectInput\n\t\t\t\t\t\t\t\toptions={allRulesOptions}\n\t\t\t\t\t\t\t\tisDisabled={hasSharedRule}\n\t\t\t\t\t\t\t\tonChange={( option ) => {\n\t\t\t\t\t\t\t\t\tconst newActive = { ...activeLessons };\n\t\t\t\t\t\t\t\t\tnewActive[ x._id ].rule = [ option.value.name, ...option.value.defaults ];\n\t\t\t\t\t\t\t\t\tsetActiveLessons( newActive );\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tvalue={defaultRule}\n\t\t\t\t\t\t\t\tmenuPortalTarget={document.body}\n\t\t\t\t\t\t\t\tmenuPlacement=\"auto\"\n\t\t\t\t\t\t\t\tstyles={SELECT_STYLES}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Form.Group>\n\t\t\t\t\t{defaultRuleParameters.length > 0 &&\n\t\t\t\t\t\tdefaultRuleParameters.map( ( value, idx ) => {\n\t\t\t\t\t\t\tconst parameter = allRules[ defaultRule.value.name ].parameters[ idx ];\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<Form.Group key={`${x._id}-param-${idx}`} className=\"mb-2\" as={Row} >\n\t\t\t\t\t\t\t\t\t<Col sm={4} ></Col>\n\t\t\t\t\t\t\t\t\t<Form.Label column sm={2} >{parameter.name}</Form.Label>\n\t\t\t\t\t\t\t\t\t<Col sm={6} >\n\t\t\t\t\t\t\t\t\t\t<Form.Control\n\t\t\t\t\t\t\t\t\t\t\tname={parameter.name}\n\t\t\t\t\t\t\t\t\t\t\ttype={parameter.type}\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t('enter-parameter-value')}\n\t\t\t\t\t\t\t\t\t\t\tdisabled={hasSharedRule}\n\t\t\t\t\t\t\t\t\t\t\tonChange={( event ) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst newActive = { ...activeLessons };\n\t\t\t\t\t\t\t\t\t\t\t\tnewActive[ x._id ].rule[ idx + 1 ] = convertRuleParameter( event.target.value, parameter );\n\t\t\t\t\t\t\t\t\t\t\t\tsetActiveLessons( newActive );\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\tvalue={defaultRuleParameters[ idx ]}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t\t</Form.Group>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t\t<Form.Group className=\"mb-2\" as={Row} >\n\t\t\t\t\t\t<Col sm={2} />\n\t\t\t\t\t\t<Form.Label column sm={4} >{t('common:ref')}</Form.Label>\n\t\t\t\t\t\t<Col sm={6} >\n\t\t\t\t\t\t\t<CreatableSelect\n\t\t\t\t\t\t\t\tisClearable\n\t\t\t\t\t\t\t\tisDisabled={hasSharedRef}\n\t\t\t\t\t\t\t\toptions={lessonRefOptions}\n\t\t\t\t\t\t\t\tonChange={( option ) => {\n\t\t\t\t\t\t\t\t\tconst newActive = { ...activeLessons };\n\t\t\t\t\t\t\t\t\tnewActive[ x._id ].ref = option ? option.value : null;\n\t\t\t\t\t\t\t\t\tsetActiveLessons( newActive );\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tvalue={defaultRef}\n\t\t\t\t\t\t\t\tmenuPortalTarget={document.body}\n\t\t\t\t\t\t\t\tmenuPlacement=\"auto\"\n\t\t\t\t\t\t\t\tstyles={SELECT_STYLES}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Form.Group>\n\t\t\t\t\t<Form.Group className=\"mb-2\" as={Row} >\n\t\t\t\t\t\t<Col sm={2} />\n\t\t\t\t\t\t<Form.Label column sm={4} >{t('common:coverage')}</Form.Label>\n\t\t\t\t\t\t<Col sm={6} >\n\t\t\t\t\t\t\t<SelectInput\n\t\t\t\t\t\t\t\toptions={COVERAGE_OPTIONS_ARRAY}\n\t\t\t\t\t\t\t\tonChange={( option ) => {\n\t\t\t\t\t\t\t\t\tconst newActive = { ...activeLessons };\n\t\t\t\t\t\t\t\t\tnewActive[ x._id ].coverage[ 0 ] = option.value;\n\t\t\t\t\t\t\t\t\tsetActiveLessons( newActive );\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tvalue={COVERAGE_OPTIONS[ coverageQualifier ]}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{( coverageQualifier === 'include' || coverageQualifier === 'exclude' ) ?\n\t\t\t\t\t\t\t\t<CreatableSelect\n\t\t\t\t\t\t\t\t\tisMulti\n\t\t\t\t\t\t\t\t\toptions={( lessonComponents[ x._id ] || [] ).map( ( y ) => {\n\t\t\t\t\t\t\t\t\t\tconst label = y.componentType ? `${y.component} (type ${y.componentType})` : y.component;\n\t\t\t\t\t\t\t\t\t\treturn { value: y.component, label };\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\tonChange={( option ) => {\n\t\t\t\t\t\t\t\t\t\tconst newActive = { ...activeLessons };\n\t\t\t\t\t\t\t\t\t\tnewActive[ x._id ].coverage = [ coverageQualifier, ...option.map( ( x ) => x.value ) ];\n\t\t\t\t\t\t\t\t\t\tsetActiveLessons( newActive );\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tvalue={coverageEntities}\n\t\t\t\t\t\t\t\t\tplaceholder=\"Select component identifiers...\"\n\t\t\t\t\t\t\t\t/> : null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Form.Group>\n\t\t\t\t</>}\n\t\t\t</>\n\t\t);\n\t});\n\tconsole.log( currentHash );\n\tconsole.log( analyzedHash.current );\n\tconst hasUnsavedChanges = currentHash !== analyzedHash.current;\n\treturn (\n\t\t<Modal size=\"lg\" show={show} onHide={onHide} dialogClassName=\"modal-75w modal-80h\" >\n\t\t\t<Modal.Header closeButton={!hasUnsavedChanges} >\n\t\t\t\t<Modal.Title as=\"h3\">{`${t('lesson-metrics-for')} ${namespace.title}`}</Modal.Title>\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Body>\n\t\t\t\t<p>\n\t\t\t\t\t{t('lesson-metrics-description')}\n\t\t\t\t</p>\n\t\t\t\t<InputGroup className=\"mb-2\" >\n\t\t\t\t\t<InputGroup.Text>{t('metric-name')}</InputGroup.Text>\n\t\t\t\t\t<CreatableSelect\n\t\t\t\t\t\tname=\"metric-name\"\n\t\t\t\t\t\tplaceholder={t('metric-name-placeholder')}\n\t\t\t\t\t\tonChange={( value ) => {\n\t\t\t\t\t\t\tif ( value ) {\n\t\t\t\t\t\t\t\tsetChosenName( value.value );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsetChosenName( null );\n\t\t\t\t\t\t\t\tsetSharedRule( null );\n\t\t\t\t\t\t\t\tsetSharedRef( null );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tvalue={chosenName ? { value: chosenName, label: chosenName } : null}\n\t\t\t\t\t\tisClearable\n\t\t\t\t\t\tisDisabled={name || ( currentHash && currentHash !== analyzedHash.current )}\n\t\t\t\t\t\toptions={availableMetrics.current}\n\t\t\t\t\t/>\n\t\t\t\t</InputGroup >\n\t\t\t\t{chosenName ? <>\n\t\t\t\t\t{sharedInputs}\n\t\t\t\t\t<Form.Check\n\t\t\t\t\t\ttype=\"switch\"\n\t\t\t\t\t\tid=\"all-lessons-switch\"\n\t\t\t\t\t\tlabel={<h3>All Lessons</h3>}\n\t\t\t\t\t\tonChange={( event ) => {\n\t\t\t\t\t\t\tlet newActive;\n\t\t\t\t\t\t\tif ( event.target.checked ) {\n\t\t\t\t\t\t\t\tnewActive = { ...activeLessons };\n\t\t\t\t\t\t\t\tlessons.forEach( ( lesson ) => {\n\t\t\t\t\t\t\t\t\tif ( !newActive[ lesson._id ] ) {\n\t\t\t\t\t\t\t\t\t\tnewActive[ lesson._id ] = lessonActivator();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewActive = {};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsetActiveLessons( newActive );\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t\t<div style={{ maxHeight: '75vh', minHeight: '50vh', border: 'solid 1px darkgray', overflowY: 'auto', padding: 4, overflowX: 'hidden' }} >\n\t\t\t\t\t\t{lessonInputs}\n\t\t\t\t\t</div>\n\t\t\t\t</> : null}\n\t\t\t</Modal.Body>\n\t\t\t{chosenName && <Modal.Footer>\n\t\t\t\t<Button onClick={onHide} disabled={hasUnsavedChanges} >\n\t\t\t\t\t{t('common:dismiss')}\n\t\t\t\t</Button>\n\t\t\t\t<Button\n\t\t\t\t\tvariant={hasUnsavedChanges ? 'warning' : 'secondary'}\n\t\t\t\t\tdisabled={!hasUnsavedChanges}\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tif ( analysisRef.current ) {\n\t\t\t\t\t\t\tincorporateAnalysis( analysisRef.current );\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{t('discard-unsaved-changes')}\n\t\t\t\t</Button>\n\t\t\t\t<Button variant=\"success\" onClick={handleSave} >\n\t\t\t\t\t{t('common:save')}\n\t\t\t\t</Button>\n\t\t\t</Modal.Footer>}\n\t\t</Modal>\n\t);\n}\n\n\n// PROPERTIES //\n\nSharedEditLessonMetricsModal.propTypes = {\n\tallRules: PropTypes.array.isRequired,\n\tlessonComponents: PropTypes.object,\n\tlessonRefs: PropTypes.arrayOf( PropTypes.string ).isRequired,\n\tlessons: PropTypes.array.isRequired,\n\tname: PropTypes.string,\n\tnamespace: PropTypes.object.isRequired,\n\tonHide: PropTypes.func.isRequired,\n\tonSave: PropTypes.func.isRequired,\n\tpreferredLesson: PropTypes.object,\n\tshow: PropTypes.bool.isRequired\n};\n\nSharedEditLessonMetricsModal.defaultProps = {\n\tname: null,\n\tlessonComponents: {},\n\tpreferredLesson: null\n};\n\n\n// EXPORTS //\n\nexport default SharedEditLessonMetricsModal;\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport axios from 'axios';\nimport { useTranslation } from 'react-i18next';\nimport debounce from 'lodash.debounce';\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport Button from 'react-bootstrap/Button';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Tooltip from 'react-bootstrap/Tooltip';\nimport incrspace from '@stdlib/array/incrspace';\nimport server from 'constants/server';\nimport ConfirmModal from 'components/confirm-modal';\nimport ComputeModal from './compute_modal.js';\nimport EditMetricModal from './edit_metric_modal.js';\nimport SharedEditLessonMetricsModal from './shared_edit_lesson_metrics_modal.js';\nimport { levelFieldMapping } from './level_fields.js';\nimport './completions.css';\n\n\n// VARIABLES //\n\n// TODO: Need specification for the parameters and their types (use the `attr-types` library)\nconst COMPLETION_RULES = {\n\taverage: {\n\t\tname: 'average',\n\t\tlabel: 'Average',\n\t\tdescription: 'Average value of the completions',\n\t\tparameters: [],\n\t\tdefaults: []\n\t},\n\tdropLowest: {\n\t\tname: 'dropLowest',\n\t\tlabel: 'Drop Lowest',\n\t\tdescription: 'Average value after dropping the lowest value of the completions',\n\t\tparameters: [],\n\t\tdefaults: []\n\t},\n\tdropNLowest: {\n\t\tname: 'dropNLowest',\n\t\tlabel: 'Drop N Lowest',\n\t\tdescription: 'Average value after dropping the lowest N values of the completions',\n\t\tparameters: [ {\n\t\t\tname: 'N',\n\t\t\ttype: 'number'\n\t\t}],\n\t\tdefaults: [ 3 ]\n\t}\n}; // TODO: read completion rules from the server\n\n\n// MAIN //\n\n/**\n* Completion and assessment reports pane.\n*\n* ## Notes\n*\n* -   Renders the list of completion metrics for the course\n* -   Configuration displays the list of completion for the course with an edit and delete button as well as a button to create a new completion metric.\n* -   When creating or editing a completion metric, users will have to choose a name, the coverage (multi-select box with \"all\" lessons or ones to \"include\" or \"exclude\"), the rule for combining the information across lessons (selected from a fixed list of options) with associated parameters (e.g., dropN where the lowest N grades are dropped), and a `ref` select field that specifies which metric to use on the lower level (populated by the metrics contained in the selected lessons of the course)\n* -   Each completion metric item has a compute button, which opens a form in a model window containing four fields: A date range select box to define the time range, a multi-select field to choose the set of users for which to compute the grades, a select field for the multiples policy ('last', 'first', 'max', or 'pass-through'), and a tag weight selector\n* -   Computing the scores will save the generated results within the individual user objects (associated with the data when they were last computed)\n*/\nfunction CompletionsPage( props ) {\n\tconst { t } = useTranslation( 'completions' );\n\tconst [ selectedMetric, setSelectedMetric ] = useState( null );\n\tconst [ showComputeModal, setShowComputeModal ] = useState( false );\n\tconst [ showDeleteModal, setShowDeleteModal ] = useState( false );\n\tconst [ showCreateModal, setShowCreateModal ] = useState( false );\n\tconst [ showEditModal, setShowEditModal ] = useState( false );\n\tconst [ showLessonMetricsModal, setShowLessonMetricsModal ] = useState( false );\n\tconst [ tags, setTags ] = useState( null );\n\tconst [ refs, setRefs ] = useState( null );\n\tconst [ lessonComponents, setLessonComponents ] = useState( {} );\n\tconst metrics = props.entity.completions;\n\tconsole.log( incrspace( 0, metrics.length, 1 ) );\n\tconst [ order, setOrder ] = useState( incrspace( 0, metrics.length, 1 ) );\n\tuseEffect( () => {\n\t\taxios.post( `${server}/completion_tags` )\n\t\t\t.then( response => {\n\t\t\t\tsetTags( response.data );\n\t\t\t})\n\t\t\t.catch( err => {\n\t\t\t\tconsole.log( 'Error fetching completion tags:', err );\n\t\t\t\tsetTags([\n\t\t\t\t\t'quiz',\n\t\t\t\t\t'homework',\n\t\t\t\t\t'exam',\n\t\t\t\t\t'_default_tag'\n\t\t\t\t]);\n\t\t\t});\n\t\tconst lessonIds = props.entity.lessons.map( lesson => lesson._id );\n\t\tconsole.log( 'LESSON IDS');\n\t\tconsole.log( lessonIds );\n\t\taxios.post( `${server}/completion_components`, {\n\t\t\tlessons: lessonIds\n\t\t})\n\t\t\t.then( response => {\n\t\t\t\tconsole.log( 'RECEIVED COMPONENT DATA' );\n\t\t\t\tsetLessonComponents( response.data );\n\t\t\t})\n\t\t\t.catch( err => {\n\t\t\t\tconsole.log( 'Error fetching completion components:', err );\n\t\t\t});\n\t\tif ( props.level === 'lesson' ) {\n\t\t\tsetRefs( props.lessonRefs );\n\t\t} else {\n\t\t\tconst subentities = props.entity[ levelFieldMapping[ props.level ] ];\n\t\t\tconst completions = new Set();\n\t\t\tsubentities.forEach( subentity => {\n\t\t\t\tsubentity.completions.forEach( completion => {\n\t\t\t\t\tcompletions.add( completion.name );\n\t\t\t\t});\n\t\t\t});\n\t\t\tsetRefs( Array.from( completions ).sort() );\n\t\t}\n\t}, [ props.entity, props.level, props.lessonRefs ] );\n\n\tconst handleDeleteMetric = () => {\n\t\tconst idx = metrics.findIndex( metric => metric.name === selectedMetric.name );\n\t\tconst newOrder = order.filter( v => v !== idx ).map( x => {\n\t\t\tif ( x > idx ) {\n\t\t\t\treturn x - 1;\n\t\t\t}\n\t\t\treturn x;\n\t\t});\n\t\tsetOrder( newOrder );\n\t\tprops.deleteMetric({\n\t\t\tid: props.entity._id,\n\t\t\tlevel: props.level,\n\t\t\tname: selectedMetric.name\n\t\t})\n\t\t\t.then( response => {\n\t\t\t\tsetSelectedMetric( null );\n\t\t\t\tsetShowDeleteModal( false );\n\t\t\t})\n\t\t\t.catch( err => {\n\t\t\t\tconsole.log( 'Error deleting metric:', err );\n\t\t\t});\n\t};\n\tconst transposeMetrics = ( index, next ) => {\n\t\treturn debounce( () => {\n\t\t\tconst newOrder = [ ...order ];\n\t\t\tconst i = newOrder[ index ];\n\t\t\tif ( next ) {\n\t\t\t\tnewOrder[ index ] = newOrder[ index + 1 ];\n\t\t\t\tnewOrder[ index + 1 ] = i;\n\t\t\t} else {\n\t\t\t\tnewOrder[ index ] = newOrder[ index - 1 ];\n\t\t\t\tnewOrder[ index - 1 ] = i;\n\t\t\t}\n\t\t\tsetOrder( newOrder );\n\t\t\taxios.post( `${server}/metric_order`, { id: props.entity._id, level: props.level, index: index, next: next })\n\t\t\t\t.then( response => {\n\t\t\t\t\tconsole.log( response );\n\t\t\t\t})\n\t\t\t\t.catch( err => {\n\t\t\t\t\tconsole.log( 'Error updating metric order:', err );\n\t\t\t\t});\n\t\t}, 200 );\n\t};\n\tconsole.log( 'ORDER: ', order );\n\tconsole.log( 'METRICS: ', metrics );\n\treturn (\n\t\t<div style={{ margin: 12 }} >\n\t\t\t<ListGroup>\n\t\t\t\t{order.map( ( metricIndex, idx ) => {\n\t\t\t\t\tconst metric = metrics[ metricIndex ];\n\t\t\t\t\tif ( !metric ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\tconst handleCompute = () => {\n\t\t\t\t\t\tsetSelectedMetric( metric );\n\t\t\t\t\t\tsetShowComputeModal( true );\n\t\t\t\t\t};\n\t\t\t\t\t// TODO: edit metric functionality & delete metric functionality\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<ListGroup.Item key={`${metricIndex}-${idx}`} className=\"d-flex w-100 justify-content-start metric-list-item\" >\n\t\t\t\t\t\t\t<label className=\"me-2\" >{metric.name}</label>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tdisplay: 'inline-block',\n\t\t\t\t\t\t\t\t\tmaxWidth: 'calc(100% - 400px)',\n\t\t\t\t\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t\t\t\t\t\ttextOverflow: 'ellipsis',\n\t\t\t\t\t\t\t\t\twhiteSpace: 'nowrap',\n\t\t\t\t\t\t\t\t\tfontStyle: 'italic'\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>{metric.description}</span>\n\t\t\t\t\t\t\t<span className=\"ms-auto\" >\n\t\t\t\t\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id={`tooltip-compute-${idx}`} >{t( 'compute-metric-tooltip' )}</Tooltip>} >\n\t\t\t\t\t\t\t\t\t<Button variant=\"secondary\" size=\"sm\" className=\"mx-2\" onClick={handleCompute} >{t('common:compute')}</Button>\n\t\t\t\t\t\t\t\t</OverlayTrigger>\n\t\t\t\t\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id={`tooltip-edit-${idx}`} >{t( 'edit-metric-tooltip' )}</Tooltip>} >\n\t\t\t\t\t\t\t\t\t<Button variant=\"secondary\" size=\"sm\" className=\"mx-2\" onClick={() => {\n\t\t\t\t\t\t\t\t\t\tsetSelectedMetric( metric );\n\t\t\t\t\t\t\t\t\t\tsetShowEditModal( true );\n\t\t\t\t\t\t\t\t\t}} >{t('common:edit')}</Button>\n\t\t\t\t\t\t\t\t</OverlayTrigger>\n\t\t\t\t\t\t\t\t<OverlayTrigger placement=\"top\" overlay={<Tooltip id={`tooltip-delete-${idx}`} >{t( 'delete-metric-tooltip' )}</Tooltip>} >\n\t\t\t\t\t\t\t\t\t<Button variant=\"danger\" size=\"sm\" className=\"mx-2\" onClick={() => {\n\t\t\t\t\t\t\t\t\t\tsetSelectedMetric( metric );\n\t\t\t\t\t\t\t\t\t\tsetShowDeleteModal( true );\n\t\t\t\t\t\t\t\t\t}} >{t('common:delete')}</Button>\n\t\t\t\t\t\t\t\t</OverlayTrigger>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\taria-label={t('move-metric-down')}\n\t\t\t\t\t\t\t\t\tsize=\"sm\" variant=\"secondary\"\n\t\t\t\t\t\t\t\t\tclassName=\"mx-1\" disabled={idx === metrics.length - 1}\n\t\t\t\t\t\t\t\t\tonClick={transposeMetrics( idx, true )}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<i className=\"fas fa-chevron-down\" />\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\taria-label={t('move-metric-up')}\n\t\t\t\t\t\t\t\t\tsize=\"sm\" variant=\"secondary\"\n\t\t\t\t\t\t\t\t\tdisabled={idx === 0}\n\t\t\t\t\t\t\t\t\tonClick={transposeMetrics( idx, false )}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<i className=\"fas fa-chevron-up\" />\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</ListGroup.Item>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</ListGroup>\n\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"tooltip-create-metric\" >{t( 'create-metric-tooltip' )}</Tooltip>} >\n\t\t\t\t<Button variant=\"primary\" style={{ marginTop: 12 }} onClick={() => {\n\t\t\t\t\tsetShowCreateModal( true );\n\t\t\t\t}} >\n\t\t\t\t\t{t('create-completion-metric')}\n\t\t\t\t</Button>\n\t\t\t</OverlayTrigger>\n\t\t\t<OverlayTrigger placement=\"bottom\" overlay={<Tooltip id=\"tooltip-create-metric\" >{t( 'lesson-metrics-tooltip' )}</Tooltip>} >\n\t\t\t\t<Button variant=\"primary\" style={{ marginTop: 12, marginLeft: 6 }} onClick={() => {\n\t\t\t\t\tsetShowLessonMetricsModal( true );\n\t\t\t\t}} >\n\t\t\t\t\t{t('lesson-metrics')}\n\t\t\t\t</Button>\n\t\t\t</OverlayTrigger>\n\t\t\t{selectedMetric ? <ComputeModal\n\t\t\t\tkey={`compute-modal-${selectedMetric.name}`}\n\t\t\t\tmetric={selectedMetric}\n\t\t\t\tshow={showComputeModal}\n\t\t\t\tonHide={() => setShowComputeModal( false )}\n\t\t\t\tcohorts={props.cohorts}\n\t\t\t\ttags={tags}\n\t\t\t\tentity={props.entity}\n\t\t\t\tlevel={props.level}\n\t\t\t/> : null}\n\t\t\t{showCreateModal ? <EditMetricModal\n\t\t\t\tkey=\"create-modal\"\n\t\t\t\tshow={showCreateModal}\n\t\t\t\tonHide={() => setShowCreateModal( false )}\n\t\t\t\tallRules={COMPLETION_RULES}\n\t\t\t\tlevel={props.level}\n\t\t\t\tentity={props.entity}\n\t\t\t\trefs={refs}\n\t\t\t\tcreateNew={true}\n\t\t\t\tonConfirm={( body ) => {\n\t\t\t\t\tprops.createMetric( body );\n\t\t\t\t\tconst newOrder = order.slice();\n\t\t\t\t\tnewOrder.push( order.length );\n\t\t\t\t\tsetOrder( newOrder );\n\t\t\t\t}}\n\t\t\t/> : null}\n\t\t\t{showDeleteModal ? <ConfirmModal\n\t\t\t\ttitle={t('delete-metric')}\n\t\t\t\tmessage={t('namespace:delete-metric-confirm')}\n\t\t\t\tclose={() => setShowDeleteModal( false )}\n\t\t\t\tshow={showDeleteModal}\n\t\t\t\tonConfirm={handleDeleteMetric}\n\t\t\t/> : null }\n\t\t\t{showEditModal ? <EditMetricModal\n\t\t\t\tkey={`edit-modal-${selectedMetric.name}`}\n\t\t\t\tshow={showEditModal}\n\t\t\t\tonHide={() => setShowEditModal( false )}\n\t\t\t\tallRules={COMPLETION_RULES}\n\t\t\t\tlevel={props.level}\n\t\t\t\tentity={props.entity}\n\t\t\t\trefs={refs}\n\t\t\t\tcreateNew={false}\n\t\t\t\tmetric={selectedMetric}\n\t\t\t\tonConfirm={props.updateMetric}\n\t\t\t/> : null}\n\t\t\t{showLessonMetricsModal ? <SharedEditLessonMetricsModal\n\t\t\t\tkey=\"lesson-metrics-modal\"\n\t\t\t\tshow={showLessonMetricsModal}\n\t\t\t\tonHide={() => setShowLessonMetricsModal( false )}\n\t\t\t\tlessons={props.entity.lessons}\n\t\t\t\tallRules={COMPLETION_RULES}\n\t\t\t\tlessonRefs={props.lessonRefs}\n\t\t\t\tlessonComponents={lessonComponents}\n\t\t\t\tnamespace={props.entity}\n\t\t\t\tonSave={( body ) => {\n\t\t\t\t\taxios.post( `${server}/save_lesson_metrics`, body )\n\t\t\t\t\t\t.then( ( res ) => {\n\t\t\t\t\t\t\tconsole.log( 'Response: ', res );\n\t\t\t\t\t\t\tsetShowLessonMetricsModal( false );\n\t\t\t\t\t\t\tprops.updateLessonMetrics({ lessons: res.data.lessons });\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch( ( err ) => {\n\t\t\t\t\t\t\tconsole.error( err );\n\t\t\t\t\t\t});\n\t\t\t\t}}\n\t\t\t/> : null}\n\t\t</div>\n\t);\n}\n\n\n// PROPERTIES //\n\nCompletionsPage.propTypes = {\n\tcohorts: PropTypes.array.isRequired,\n\tcreateMetric: PropTypes.func.isRequired,\n\tdeleteMetric: PropTypes.func.isRequired,\n\tentity: PropTypes.object.isRequired,\n\tlessonRefs: PropTypes.array.isRequired,\n\tlevel: PropTypes.string.isRequired,\n\tupdateLessonMetrics: PropTypes.func,\n\tupdateMetric: PropTypes.func.isRequired\n};\n\nCompletionsPage.defaultProps = {\n\tupdateLessonMetrics: () => {}\n};\n\n\n// EXPORTS //\n\nexport default CompletionsPage;\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport axios from 'axios';\nimport server from 'constants/server';\nimport { addErrorNotification } from 'actions/notification';\nimport { COMPUTED_COMPLETIONS, CREATED_METRIC, DELETED_METRIC,\n\tGET_COMPLETION_LESSON_REFS, GET_COMPLETION_TAGS, UPDATED_METRIC } from 'constants/action_types.js';\n\n\n// MAIN //\n\n/**\n * Makes a GET request to the server to retrieve all completion tags.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Array<ObjectId>} lessonIDs - ids for lessons whose tags are\n *     to be retrieved.\n * @returns {void}\n */\nexport const getCompletionTags = async ( dispatch, lessonIDs ) => {\n\ttry {\n\t\tconst res = await axios.post( `${server}/completion_tags`, {\n\t\t\tlessons: lessonIDs\n\t\t});\n\t\tdispatch({\n\t\t\ttype: GET_COMPLETION_TAGS,\n\t\t\tpayload: {\n\t\t\t\tcompletionTags: res.data\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n* Returns a function to retrieve all completion tags for a set of lessons.\n*\n* @param {Function} dispatch - dispatch function\n* @returns {Function} function to retrieve completion tags\n*/\nexport const getCompletionTagsInjector = dispatch => {\n\treturn async ( lessonIDs ) => {\n\t\tawait getCompletionTags( dispatch, lessonIDs );\n\t};\n};\n\n/**\n * Retrieves the names of lower level metrics (refs)\n *\n * @param {Function} dispatch - dispatch function\n * @param {Array<ObjectId>} entities - id of entities whose refs (metrics at next lowest level)\n *     we are retrieving. In the typical case, these will be lesson ids.\n * @param {string} target - name of the target field in the Completions table that we\n *     constrain to be in `entities`.  In the typical case, this will be 'lesson'.\n *     We then search for refs (component metric names) for which lesson id belongs to\n *     the given list of entities.\n * @returns {void}\n */\nexport const getCompletionLessonRefs = async ( dispatch, { entities, target } ) => {\n\ttry {\n\t\tconst res = await axios.post( `${server}/completion_refs`, {\n\t\t\tentities,\n\t\t\ttarget\n\t\t});\n\t\tdispatch({\n\t\t\ttype: GET_COMPLETION_LESSON_REFS,\n\t\t\tpayload: {\n\t\t\t\tcompletionRefs: res.data\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to retrieve the names of lower level metrics (refs).\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to retrieve completion refs\n */\nexport const getCompletionLessonRefsInjector = dispatch => {\n\treturn async ({ entities, target }) => {\n\t\tawait getCompletionLessonRefs( dispatch, { entities, target });\n\t};\n};\n\n/**\n * Makes a POST request to the server to compute completion values for a particular metric, entity, and a set of users.\n *\n * @param {Function} dispatch - dispatch function\n */\nexport const computeCompletions = async ( dispatch, { metric, id, users, policyOptions } ) => {\n\ttry {\n\t\tawait axios.post( `${server}/compute_completions`, {\n\t\t\tmetric,\n\t\t\tid,\n\t\t\tusers,\n\t\t\tpolicyOptions\n\t\t});\n\t\tdispatch({\n\t\t\ttype: COMPUTED_COMPLETIONS\n\t\t});\n\t}\n\tcatch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to compute completion values for a particular metric, entity, and a set of users.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} function to compute completion values\n */\nexport const computeCompletionsInjector = dispatch => {\n\treturn async ({ metric, id, users, policyOptions }) => {\n\t\tawait computeCompletions( dispatch, { metric, id, users, policyOptions });\n\t};\n};\n\n/**\n * Makes a POST request to the server to create a new completion metric.\n *\n * @param {Function} dispatch - dispatch function\n * @param {string} name - the metric name\n * @param {string} level - the level of the hierarchy for which we are computing completions,\n *     one of: 'program', 'namespace', 'lesson', 'component'.\n * @param {ObjectId} id - the id of the entity at the given level for which we are computing\n *     the completions.\n * @param {Array} rule - a vector of the form ['rule-name', ...params], specifying\n *     the aggregation rule used by the completion\n * @param {Array} coverage - an array of the form ['all'], ['include', ...ids], or\n *     ['exclude', ...ids], where ids are the ObjectId's for the  entities at the next\n *     sublevel (e.g., lessons when level is 'namespace').\n * @param {string} ref - the name of the metric to use at the next lower level for computing\n *     the completions that are used at this level.\n * @returns {void}\n */\n export const createMetric = async ( dispatch, { name, rule, coverage, level, id, ref }) => {\n\ttry {\n\t\tconst res = await axios.post( `${server}/create_metric`, {\n\t\t\tname, rule, coverage, level, id, ref\n\t\t});\n\t\tconsole.log( res.data );\n\t\tdispatch({\n\t\t\ttype: CREATED_METRIC,\n\t\t\tpayload: {\n\t\t\t\tmetric: res.data.metric,\n\t\t\t\tlevel,\n\t\t\t\tid\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to create a new completion metric.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} a function to make a POST request to the server to create a new completion metric\n */\nexport const createMetricInjector = dispatch => {\n\treturn async ( metric ) => {\n\t\tawait createMetric( dispatch, metric );\n\t};\n};\n\n/**\n * Makes a POST request to the server to update a completion metric.\n *\n * @param {Function} dispatch - dispatch function\n * @param {string} name - the metric name\n * @param {string} level - the level of the hierarchy for which we are computing completions,\n *     one of: 'program', 'namespace', 'lesson', 'component'.\n * @param {ObjectId} id - the id of the entity at the given level for which we are computing\n *     the completions.\n * @param {Array} rule - a vector of the form ['rule-name', ...params], specifying\n *     the aggregation rule used by the completion\n * @param {Array} coverage - an array of the form ['all'], ['include', ...ids], or\n *     ['exclude', ...ids], where ids are the ObjectId's for the  entities at the next\n *     sublevel (e.g., lessons when level is 'namespace').\n * @param {string} ref - the name of the metric to use at the next lower level for computing\n *     the completions that are used at this level.\n * @returns {void}\n */\nexport const updateMetric = async ( dispatch, body ) => {\n\ttry {\n\t\tconst res = await axios.post( `${server}/update_metric`, body );\n\t\tconsole.log( res.data );\n\t\tdispatch({\n\t\t\ttype: UPDATED_METRIC,\n\t\t\tpayload: {\n\t\t\t\tmetric: body,\n\t\t\t\tlevel: body.level,\n\t\t\t\tid: body.id\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to update a completion metric.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} a function to make a POST request to the server to update a completion metric\n */\nexport const updateMetricInjector = dispatch => {\n\treturn async ( metric ) => {\n\t\tawait updateMetric( dispatch, metric );\n\t};\n};\n\n/**\n * Makes a POST request to the server to delete a completion metric.\n *\n * @param {Function} dispatch - dispatch function\n * @param {Object} body - request body\n * @param {string} body.name - the metric name\n * @param {string} body.level - the level of the hierarchy for which we are computing completions,\n *     one of: 'program', 'namespace', 'lesson', 'component'.\n * @param {ObjectId} body.id - the id of the entity at the given level for which we are computing\n *     the completions.\n * @returns {void}\n */\nexport const deleteMetric = async ( dispatch, { name, level, id }) => {\n\ttry {\n\t\tawait axios.post( `${server}/delete_metric`, {\n\t\t\tname, level, id\n\t\t});\n\t\tdispatch({\n\t\t\ttype: DELETED_METRIC,\n\t\t\tpayload: {\n\t\t\t\tname, level, id\n\t\t\t}\n\t\t});\n\t} catch ( err ) {\n\t\treturn addErrorNotification( dispatch, err );\n\t}\n};\n\n/**\n * Returns a function to make a POST request to the server to delete a completion metric.\n *\n * @param {Function} dispatch - dispatch function\n * @returns {Function} a function to make a POST request to the server to delete a completion metric\n */\nexport const deleteMetricInjector = dispatch => {\n\treturn async ({ name, level, id }) => {\n\t\tconst res = await deleteMetric( dispatch, { name, level, id });\n\t\treturn res;\n\t};\n};\n","/**\n* Copyright (C) 2016-present The ISLE Authors\n*\n* The isle-dashboard program is free software: you can redistribute it and/or modify\n* it under the terms of the GNU Affero General Public License as\n* published by the Free Software Foundation, either version 3 of the\n* License, or (at your option) any later version.\n*\n* This program is distributed in the hope that it will be useful,\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n* GNU Affero General Public License for more details.\n*\n* You should have received a copy of the GNU Affero General Public License\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n// MODULES //\n\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport Completions from 'components/completions';\nimport { createMetricInjector, deleteMetricInjector, updateMetricInjector } from 'actions/completions';\nimport { addNotificationInjector } from 'actions/notification';\n\n\n// FUNCTIONS //\n\nfunction mapStateToProps( state ) {\n\treturn {\n\t\tuser: state.user,\n\t\tnamespace: state.namespace,\n\t\tcohorts: state.namespace.cohorts\n\t};\n}\n\nfunction mapDispatchToProps( dispatch ) {\n\treturn {\n\t\taddNotification: addNotificationInjector( dispatch ),\n\t\tcreateMetric: createMetricInjector( dispatch ),\n\t\tdeleteMetric: deleteMetricInjector( dispatch ),\n\t\tupdateMetric: updateMetricInjector( dispatch )\n\t};\n}\n\n\n// MAIN //\n\nconst VisibleCompletions = connect( mapStateToProps, mapDispatchToProps )( Completions );\n\n\n// EXPORTS //\n\nexport default VisibleCompletions;\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component, Fragment } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport logger from 'debug';\r\nimport Button from 'react-bootstrap/Button';\r\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport FormControl from 'react-bootstrap/FormControl';\r\nimport FormCheck from 'react-bootstrap/FormCheck';\r\nimport FormGroup from 'react-bootstrap/FormGroup';\r\nimport FormLabel from 'react-bootstrap/FormLabel';\r\nimport Form from 'react-bootstrap/Form';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport Col from 'react-bootstrap/Col';\r\nimport Row from 'react-bootstrap/Row';\r\nimport { DateRangePicker } from 'react-dates';\r\nimport moment from 'moment';\r\nimport isEmail from '@stdlib/assert/is-email-address';\r\nimport isArray from '@stdlib/assert/is-array';\r\nimport ConfirmModal from 'components/confirm-modal';\r\nimport TextSelect from 'components/text-select';\r\nimport 'react-dates/lib/css/_datepicker.css';\r\nimport './cohort_modal.css';\r\n\r\n\r\n// VARIABLES //\r\n\r\nconst debug = logger( 'isle-dashboard:edit-cohort' );\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nfunction validateInputs({ emails, title }) {\r\n\tlet invalid = false;\r\n\temails.forEach( owner => {\r\n\t\tif ( !isEmail( owner ) ) {\r\n\t\t\tinvalid = true;\r\n\t\t}\r\n\t});\r\n\tif ( invalid ) {\r\n\t\treturn false;\r\n\t}\r\n\treturn title.length >= 4;\r\n}\r\n\r\n\r\n// MAIN //\r\n\r\nclass EditCohortModal extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\r\n\t\tthis.state = {\r\n\t\t\tdisabled: false,\r\n\t\t\tstartDate: moment( props.startDate ),\r\n\t\t\tendDate: moment( props.endDate ),\r\n\t\t\ttitle: props.title,\r\n\t\t\tmembers: props.members.map( user => user.email ),\r\n\t\t\tshowDeleteModal: false,\r\n\t\t\tprivate: props.private,\r\n\t\t\temailFilter: props.emailFilter\r\n\t\t};\r\n\t}\r\n\r\n\thandleInputChange = ( event ) => {\r\n\t\tconst target = event.target;\r\n\t\tconst name = target.name;\r\n\t\tlet value = target.value;\r\n\t\tthis.setState({\r\n\t\t\t[ name ]: value\r\n\t\t}, () => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tdisabled: !validateInputs({\r\n\t\t\t\t\temails: this.state.members,\r\n\t\t\t\t\ttitle: this.state.title\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\thandleUpdate = () => {\r\n\t\tconst updatedCohort = {\r\n\t\t\t_id: this.props._id,\r\n\t\t\temailFilter: this.state.emailFilter,\r\n\t\t\tstartDate: this.state.startDate.startOf( 'day' ).toDate(),\r\n\t\t\tendDate: this.state.endDate.endOf( 'day' ).toDate(),\r\n\t\t\tmembers: this.state.members.join( ',' ),\r\n\t\t\ttitle: this.state.title,\r\n\t\t\tprivate: this.state.private\r\n\t\t};\r\n\t\tthis.props.onUpdate( updatedCohort );\r\n\t\tthis.props.onHide();\r\n\t};\r\n\r\n\thandleDelete = () => {\r\n\t\tthis.props.onDelete( this.props._id );\r\n\t\tthis.closeDeleteModal();\r\n\t\tthis.props.onHide();\r\n\t};\r\n\r\n\tcloseDeleteModal = () => {\r\n\t\tthis.setState({\r\n\t\t\tshowDeleteModal: false\r\n\t\t});\r\n\t};\r\n\r\n\thandleStudentChange = ( newValue ) => {\r\n\t\tdebug( 'Handle change of cohort members...' );\r\n\t\tconst members = isArray( newValue ) ? newValue.map( x => x.value ) : [];\r\n\t\tthis.setState({\r\n\t\t\tmembers: members,\r\n\t\t\tdisabled: !validateInputs({\r\n\t\t\t\temails: members,\r\n\t\t\t\ttitle: this.state.title\r\n\t\t\t})\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { t } = this.props;\r\n\t\tconst content = (\r\n\t\t\t<Form style={{ padding: '10px' }}>\r\n\t\t\t\t<Row>\r\n\t\t\t\t\t<Col md={6}>\r\n\t\t\t\t\t\t<OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"titleTooltip\">{t('cohort-title-tooltip')}</Tooltip>}>\r\n\t\t\t\t\t\t\t<FormGroup>\r\n\t\t\t\t\t\t\t\t<FormLabel>{t('common:title')}</FormLabel>\r\n\t\t\t\t\t\t\t\t<FormControl\r\n\t\t\t\t\t\t\t\t\tname=\"title\"\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\tvalue={this.state.title}\r\n\t\t\t\t\t\t\t\t\tonChange={this.handleInputChange}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t\t<Col md={6}>\r\n\t\t\t\t\t\t<FormGroup>\r\n\t\t\t\t\t\t\t<FormLabel>{t('cohort-period')}</FormLabel>\r\n\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t<DateRangePicker\r\n\t\t\t\t\t\t\t\tstartDateId=\"panel_start_date_input\"\r\n\t\t\t\t\t\t\t\tendDateId=\"panel_end_date_input\"\r\n\t\t\t\t\t\t\t\tstartDate={this.state.startDate}\r\n\t\t\t\t\t\t\t\tendDate={this.state.endDate}\r\n\t\t\t\t\t\t\t\tonDatesChange={({ startDate, endDate }) =>\r\n\t\t\t\t\t\t\t\t\tthis.setState({ startDate, endDate })\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tfocusedInput={this.state.focusedInput}\r\n\t\t\t\t\t\t\t\tonFocusChange={focusedInput => this.setState({ focusedInput })}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t\t<hr />\r\n\t\t\t\t<Row>\r\n\t\t\t\t\t<OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"enrolledTooltip\">{t('enrolled-tooltip')}</Tooltip>}>\r\n\t\t\t\t\t\t<FormGroup className=\"cohort-modal-enrolled-group\" >\r\n\t\t\t\t\t\t\t<FormLabel>{t('enrolled-students')}</FormLabel>\r\n\t\t\t\t\t\t\t<TextSelect\r\n\t\t\t\t\t\t\t\tplaceholder={t('enter-emails')}\r\n\t\t\t\t\t\t\t\tdefaultValue={this.state.members}\r\n\t\t\t\t\t\t\t\tonChange={this.handleStudentChange}\r\n\t\t\t\t\t\t\t\tstyles={{\r\n\t\t\t\t\t\t\t\t\tcontrol: () => ({\r\n\t\t\t\t\t\t\t\t\t\twidth: '100%'\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t</Row>\r\n\t\t\t\t<hr />\r\n\t\t\t\t<Row>\r\n\t\t\t\t<OverlayTrigger placement=\"left\" overlay={<Tooltip id=\"preventTooltip\">{t('prevent-tooltip')}</Tooltip>}>\r\n\t\t\t\t\t<FormCheck checked={this.state.private} onChange={(event) => {\r\n\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\tprivate: !this.state.private\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}} type=\"checkbox\" label={t('prevent-label')} />\r\n\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t</Row>\r\n\t\t\t\t<hr />\r\n\t\t\t<Row>\r\n\t\t\t\t<OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"filterTooltip\">{t('filter-tooltip')}</Tooltip>}>\r\n\t\t\t\t\t\t<FormGroup>\r\n\t\t\t\t\t\t\t<FormLabel>{t('email-filter')}</FormLabel>\r\n\t\t\t\t\t\t\t<FormControl style={{ width: '25vw' }}\r\n\t\t\t\t\t\t\t\tname=\"emailFilter\"\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tvalue={this.state.emailFilter}\r\n\t\t\t\t\t\t\t\tplaceholder={t('filter-placeholder')}\r\n\t\t\t\t\t\t\t\tonChange={this.handleInputChange}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t</Row>\r\n\t\t\t</Form>\r\n\t\t);\r\n\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<Modal size=\"lg\" show={this.props.show} onHide={this.props.onHide} >\r\n\t\t\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t\t\t<Modal.Title as=\"h3\">\r\n\t\t\t\t\t\t\t{t('edit-cohort', { title: this.props.title })}\r\n\t\t\t\t\t\t</Modal.Title>\r\n\t\t\t\t\t</Modal.Header>\r\n\t\t\t\t\t<Modal.Body>\r\n\t\t\t\t\t\t{content}\r\n\t\t\t\t\t</Modal.Body>\r\n\t\t\t\t\t<Modal.Footer>\r\n\t\t\t\t\t\t<ButtonGroup>\r\n\t\t\t\t\t\t\t<Button onClick={() => {\r\n\t\t\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\t\t\tshowDeleteModal: true\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}} variant=\"danger\">{t('common:delete')}</Button>\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\tonClick={this.props.onHide}\r\n\t\t\t\t\t\t\t>{t('common:cancel')}</Button>\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\tvariant=\"success\"\r\n\t\t\t\t\t\t\t\tdisabled={this.state.disabled}\r\n\t\t\t\t\t\t\t\tonClick={this.handleUpdate}\r\n\t\t\t\t\t\t\t>{t('common:save')}</Button>\r\n\t\t\t\t\t\t</ButtonGroup>\r\n\t\t\t\t\t</Modal.Footer>\r\n\t\t\t\t</Modal>\r\n\t\t\t\t<ConfirmModal\r\n\t\t\t\t\tshow={this.state.showDeleteModal}\r\n\t\t\t\t\tclose={this.closeDeleteModal}\r\n\t\t\t\t\tmessage={t('delete-cohort')}\r\n\t\t\t\t\ttitle={`${t('delete')}?`}\r\n\t\t\t\t\tonConfirm={this.handleDelete}\r\n\t\t\t\t/>\r\n\t\t\t</Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\n// PROPERTIES //\r\n\r\nEditCohortModal.propTypes = {\r\n\t_id: PropTypes.string.isRequired,\r\n\temailFilter: PropTypes.string.isRequired,\r\n\tendDate: PropTypes.string,\r\n\tmembers: PropTypes.array.isRequired,\r\n\tonDelete: PropTypes.func,\r\n\tonHide: PropTypes.func.isRequired,\r\n\tonUpdate: PropTypes.func,\r\n\tprivate: PropTypes.bool.isRequired,\r\n\tshow: PropTypes.bool.isRequired,\r\n\tstartDate: PropTypes.string.isRequired,\r\n\tt: PropTypes.func.isRequired,\r\n\ttitle: PropTypes.string.isRequired\r\n};\r\n\r\nEditCohortModal.defaultProps = {\r\n\tendDate: null,\r\n\tonUpdate() {},\r\n\tonDelete() {}\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default EditCohortModal;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Col from 'react-bootstrap/Col';\r\nimport Row from 'react-bootstrap/Row';\r\nimport FormLabel from 'react-bootstrap/FormLabel';\r\nimport Form from 'react-bootstrap/Form';\r\nimport FormCheck from 'react-bootstrap/FormCheck';\r\nimport FormControl from 'react-bootstrap/FormControl';\r\nimport FormGroup from 'react-bootstrap/FormGroup';\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport { DateRangePicker } from 'react-dates';\r\nimport moment from 'moment';\r\nimport isEmail from '@stdlib/assert/is-email-address';\r\nimport isArray from '@stdlib/assert/is-array';\r\nimport TextSelect from 'components/text-select';\r\nimport './cohort_modal.css';\r\n\r\n\r\n// FUNCTIONS //\r\n\r\n/**\r\n * Validate a list of emails and namespace title.\r\n *\r\n * @private\r\n * @param {Array<string>} emails - list of emails\r\n * @param {string} title - namespace title\r\n * @returns {boolean} boolean indicating whether the list of emails and namespace title are valid\r\n */\r\nfunction validateInputs( emails, title ) {\r\n\tlet invalid = false;\r\n\temails.forEach( owner => {\r\n\t\tif ( !isEmail( owner ) ) {\r\n\t\t\tinvalid = true;\r\n\t\t}\r\n\t});\r\n\tif ( invalid ) {\r\n\t\treturn false;\r\n\t}\r\n\treturn title.length >= 4;\r\n}\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n * A modal for creating a new cohort.\r\n *\r\n * @param {Object} props - component properties\r\n * @param {boolean} props.show - boolean indicating whether the modal is visible\r\n * @param {Function} props.close - callback to invoke upon hiding the modal\r\n * @param {Function} props.onCreate - callback to invoke upon creating a new cohort\r\n * @param {Function} props.t - i18n translation function\r\n * @returns {ReactElement} modal dialog\r\n */\r\nconst CreateCohortModal = ({ close, onCreate, show, t }) => {\r\n\tconst [ title, setTitle ] = useState( '' );\r\n\tconst [ emailFilter, setEmailFilter ] = useState( '' );\r\n\tconst [ dates, setDates ] = useState({\r\n\t\tstart: moment()\r\n\t\t\t.startOf( 'day' ),\r\n\t\tend: moment()\r\n\t\t\t.add( 3, 'months' )\r\n\t\t\t.endOf( 'day' )\r\n\t});\r\n\tconst [ isPrivate, setIsPrivate ] = useState( false );\r\n\tconst [ students, setStudents ] = useState( [] );\r\n\tconst [ focusedInput, setFocusedInput ] = useState( null );\r\n\r\n\tconst handleClose = () => {\r\n\t\tclose();\r\n\t};\r\n\tconst handleCreate = () => {\r\n\t\tconst cohort = {\r\n\t\t\temailFilter,\r\n\t\t\ttitle,\r\n\t\t\tstartDate: dates.start.startOf( 'day' ).toDate(),\r\n\t\t\tendDate: dates.end.endOf( 'day' ).toDate(),\r\n\t\t\tprivate: isPrivate,\r\n\t\t\tstudents: students.join( ',' )\r\n\t\t};\r\n\t\tonCreate( cohort );\r\n\t};\r\n\tconst disabled = !validateInputs( students, title );\r\n\tconst body = <Form style={{ paddingLeft: 20, paddingRight: 20 }}>\r\n\t\t<Row>\r\n\t\t\t<Col md={6}>\r\n\t\t\t\t<OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"titleTooltip\">{t('cohort-title-tooltip')}</Tooltip>}>\r\n\t\t\t\t\t<FormGroup>\r\n\t\t\t\t\t\t<FormLabel>{t('common:title')}</FormLabel>\r\n\t\t\t\t\t\t<FormControl\r\n\t\t\t\t\t\t\tname=\"title\"\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tplaceholder={t('cohort-title-placeholder')}\r\n\t\t\t\t\t\t\tonChange={( event ) => setTitle( event.target.value )}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</FormGroup>\r\n\t\t\t\t</OverlayTrigger>\r\n\t\t\t</Col>\r\n\t\t\t<Col md={6}>\r\n\t\t\t\t<FormGroup>\r\n\t\t\t\t\t<FormLabel>{t('cohort-period')}</FormLabel>\r\n\t\t\t\t\t<DateRangePicker\r\n\t\t\t\t\t\tstartDateId=\"start_date_input\"\r\n\t\t\t\t\t\tendDateId=\"end_date_input\"\r\n\t\t\t\t\t\tstartDate={dates.start}\r\n\t\t\t\t\t\tendDate={dates.end}\r\n\t\t\t\t\t\tonDatesChange={({ startDate, endDate }) => {\r\n\t\t\t\t\t\t\tsetDates({ start: startDate, end: endDate });\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tfocusedInput={focusedInput}\r\n\t\t\t\t\t\tonFocusChange={setFocusedInput}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</FormGroup>\r\n\t\t\t</Col>\r\n\t\t</Row>\r\n\t\t<hr />\r\n\t\t<Row>\r\n\t\t\t<OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"enrolledTooltip\">{t('enrolled-tooltip')}</Tooltip>}>\r\n\t\t\t\t<FormGroup className=\"cohort-modal-enrolled-group\" >\r\n\t\t\t\t\t<FormLabel>{t('enrolled-students')}</FormLabel>\r\n\t\t\t\t\t<TextSelect\r\n\t\t\t\t\t\tplaceholder={t('enter-emails')}\r\n\t\t\t\t\t\tonChange={( newValue ) => {\r\n\t\t\t\t\t\t\tconst newStudents = isArray( newValue ) ? newValue.map( x => x.value ) : [];\r\n\t\t\t\t\t\t\tsetStudents( newStudents );\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tdefaultValue={students}\r\n\t\t\t\t\t\tisClearable\r\n\t\t\t\t\t\tstyles={{\r\n\t\t\t\t\t\t\tcontrol: () => ({\r\n\t\t\t\t\t\t\t\twidth: '100%'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</FormGroup>\r\n\t\t\t</OverlayTrigger>\r\n\t\t</Row>\r\n\t\t<hr />\r\n\t\t<Row>\r\n\t\t\t<OverlayTrigger placement=\"left\" overlay={<Tooltip id=\"preventTooltip\">{t('prevent-tooltip')}</Tooltip>}>\r\n\t\t\t\t<FormCheck checked={isPrivate} onChange={() => {\r\n\t\t\t\t\tsetIsPrivate( !isPrivate );\r\n\t\t\t\t}} type=\"checkbox\" label={t('prevent-label')} />\r\n\t\t\t</OverlayTrigger>\r\n\t\t</Row>\r\n\t\t<hr />\r\n\t\t<Row>\r\n\t\t\t<OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"filterTooltip\">{t('filter-tooltip')}</Tooltip>}>\r\n\t\t\t\t<FormGroup>\r\n\t\t\t\t\t<FormLabel>{t('email-filter')}</FormLabel>\r\n\t\t\t\t\t<FormControl\r\n\t\t\t\t\t\tstyle={{ width: '25vw' }}\r\n\t\t\t\t\t\tname=\"emailFilter\"\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tplaceholder={t('filter-placeholder')}\r\n\t\t\t\t\t\tonChange={( event ) => setEmailFilter( event.target.value )}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</FormGroup>\r\n\t\t\t</OverlayTrigger>\r\n\t\t</Row>\r\n\t</Form>;\r\n\treturn (\r\n\t\t<Modal size=\"lg\" show={show} onHide={handleClose}>\r\n\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t<Modal.Title as=\"h3\">{t('create-new-cohort')}</Modal.Title>\r\n\t\t\t</Modal.Header>\r\n\t\t\t<Modal.Body>\r\n\t\t\t\t{body}\r\n\t\t\t</Modal.Body>\r\n\t\t\t<Modal.Footer>\r\n\t\t\t\t<Button onClick={handleClose}>\r\n\t\t\t\t\t{t('common:cancel')}\r\n\t\t\t\t</Button>\r\n\t\t\t\t<Button variant=\"success\" disabled={disabled} onClick={handleCreate} >\r\n\t\t\t\t\t{t('common:create')}\r\n\t\t\t\t</Button>\r\n\t\t\t</Modal.Footer>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\n\r\n// PROPERTIES //\r\n\r\nCreateCohortModal.propTypes = {\r\n\tclose: PropTypes.func,\r\n\tonCreate: PropTypes.func,\r\n\tshow: PropTypes.bool,\r\n\tt: PropTypes.func.isRequired\r\n};\r\n\r\nCreateCohortModal.defaultProps = {\r\n\tclose() {},\r\n\tonCreate() {},\r\n\tshow: false\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default CreateCohortModal;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport SelectInput from 'react-select';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport Form from 'react-bootstrap/Form';\r\n\r\n\r\n// MAIN //\r\n\r\n/**\r\n* A modal dialog for importing an existing course into a namespace.\r\n*\r\n* @param {Object} props - component props\r\n* @param {boolean} props.show - boolean indicating whether the modal is visible\r\n* @param {Function} props.close - callback to hide the modal\r\n* @param {Function} props.copyNamespaceLessons - callback to copy a course's lessons into a namespace\r\n* @param {Object} props.targetNamespace - target namespace\r\n* @param {Object} props.namespaces - available namespaces\r\n* @param {Function} props.t - translation function\r\n* @returns {ReactElement} modal dialog\r\n*/\r\nconst ImportCourseModal = ({ namespaces, show, close, targetNamespace, copyNamespaceLessons, t }) => {\r\n\tconst [ selectedCourse, setSelectedCourse ] = useState( null );\r\n\r\n\tconst handleSelection = ( obj ) => {\r\n\t\tsetSelectedCourse( obj.value );\r\n\t};\r\n\tconst handleImport = async () => {\r\n\t\tconst res = await copyNamespaceLessons({\r\n\t\t\tsource: selectedCourse.title,\r\n\t\t\ttarget: targetNamespace.title\r\n\t\t});\r\n\t\tif ( res instanceof Error === false ) {\r\n\t\t\tclose();\r\n\t\t}\r\n\t};\r\n\tconst options = namespaces.map( x => {\r\n\t\treturn {\r\n\t\t\tlabel: x.title,\r\n\t\t\tvalue: x\r\n\t\t};\r\n\t});\r\n\treturn (\r\n\t\t<Modal size=\"lg\" show={show} onHide={close}>\r\n\t\t\t<Modal.Header closeButton>\r\n\t\t\t\t<Modal.Title as=\"h3\">{t('import-course')}</Modal.Title>\r\n\t\t\t</Modal.Header>\r\n\t\t\t<Modal.Body>\r\n\t\t\t\t<p>\r\n\t\t\t\t\t{t('import-course-description')}\r\n\t\t\t\t</p>\r\n\t\t\t\t<Form.Group controlId=\"form-course-select\" >\r\n\t\t\t\t\t<Form.Label>{t('select-namespace')}</Form.Label>\r\n\t\t\t\t\t<SelectInput\r\n\t\t\t\t\t\toptions={options}\r\n\t\t\t\t\t\tonChange={handleSelection}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Form.Group>\r\n\t\t\t</Modal.Body>\r\n\t\t\t<Modal.Footer>\r\n\t\t\t\t<Button onClick={close}>{t('common:cancel')}</Button>\r\n\t\t\t\t<Button variant=\"success\" disabled={!selectedCourse} onClick={handleImport}>{t('common:import')}</Button>\r\n\t\t\t</Modal.Footer>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\n\r\n// PROPERTIES //\r\n\r\nImportCourseModal.propTypes = {\r\n\tclose: PropTypes.func.isRequired,\r\n\tcopyNamespaceLessons: PropTypes.func.isRequired,\r\n\tnamespaces: PropTypes.array,\r\n\tshow: PropTypes.bool,\r\n\tt: PropTypes.func.isRequired,\r\n\ttargetNamespace: PropTypes.object.isRequired\r\n};\r\n\r\nImportCourseModal.defaultProps = {\r\n\tnamespaces: [],\r\n\tshow: false\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default ImportCourseModal;\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React, { Component, Fragment } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport axios from 'axios';\r\nimport { withTranslation } from 'react-i18next';\r\nimport Tabs from 'react-bootstrap/Tabs';\r\nimport Tab from 'react-bootstrap/Tab';\r\nimport Alert from 'react-bootstrap/Alert';\r\nimport Badge from 'react-bootstrap/Badge';\r\nimport Button from 'react-bootstrap/Button';\r\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\r\nimport Card from 'react-bootstrap/Card';\r\nimport Container from 'react-bootstrap/Container';\r\nimport Col from 'react-bootstrap/Col';\r\nimport Row from 'react-bootstrap/Row';\r\nimport FormControl from 'react-bootstrap/FormControl';\r\nimport FormLabel from 'react-bootstrap/FormLabel';\r\nimport FormGroup from 'react-bootstrap/FormGroup';\r\nimport Form from 'react-bootstrap/Form';\r\nimport ListGroup from 'react-bootstrap/ListGroup';\r\nimport ListGroupItem from 'react-bootstrap/ListGroupItem';\r\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\r\nimport Tooltip from 'react-bootstrap/Tooltip';\r\nimport isArray from '@stdlib/assert/is-array';\r\nimport trim from '@stdlib/string/trim';\r\nimport TextSelect from 'components/text-select';\r\nimport MsgModal from 'components/message-modal';\r\nimport ConfirmModal from 'components/confirm-modal';\r\nimport { validateOwners, validateDescription, validateTitle } from 'components/create-namespace';\r\nimport CompletionsPage from 'containers/visible-completions';\r\nimport checkURLPath from 'utils/check_url_path.js';\r\nimport EditCohortModal from './edit_cohort_modal.js';\r\nimport CreateCohortModal from './create_cohort_modal.js';\r\nimport ImportCourseModal from './import_course_modal.js';\r\nimport SERVER from 'constants/server';\r\nimport 'react-dates/lib/css/_datepicker.css';\r\nimport './edit_namespace.css';\r\n\r\n\r\n// MAIN //\r\n\r\nclass EditNamespace extends Component {\r\n\tconstructor( props ) {\r\n\t\tsuper( props );\r\n\t\tlet { title, description, owners, enableTicketing } = this.props.namespace;\r\n\t\tif ( isArray( owners ) ) {\r\n\t\t\towners = owners.map( ( owner ) => {\r\n\t\t\t\treturn owner.email;\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.state = {\r\n\t\t\ttitle,\r\n\t\t\tdescription,\r\n\t\t\towners,\r\n\t\t\tenableTicketing,\r\n\t\t\tshowDeleteModal: false,\r\n\t\t\tshowImportModal: false,\r\n\t\t\tshowCreateCohortModal: false,\r\n\t\t\tshowEditCohortModal: false,\r\n\t\t\tselectedCohort: null,\r\n\t\t\tlessonRefs: []\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\taxios.post( `${SERVER}/completion_refs`, {\r\n\t\t\ttarget: 'lesson',\r\n\t\t\tentities: this.props.namespace.lessons.map( x => x._id )\r\n\t\t})\r\n\t\t\t.then( response => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tlessonRefs: response.data\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.catch( err => {\r\n\t\t\t\tconsole.log( 'Error fetching completion refs:', err );\r\n\t\t\t});\r\n\t}\r\n\r\n\thandleInputChange = ( event ) => {\r\n\t\tconst target = event.target;\r\n\t\tconst name = target.name;\r\n\t\tlet value = target.value;\r\n\t\tthis.setState({\r\n\t\t\t[ name ]: value\r\n\t\t});\r\n\t};\r\n\r\n\thandleUpdate = () => {\r\n\t\tthis.props.updateCurrentNamespace({\r\n\t\t\t_id: this.props.namespace._id,\r\n\t\t\tdescription: this.state.description,\r\n\t\t\ttitle: this.state.title,\r\n\t\t\tenableTicketing: this.state.enableTicketing,\r\n\t\t\towners: this.state.owners\r\n\t\t});\r\n\t};\r\n\r\n\thandleDelete = () => {\r\n\t\tthis.props.deleteCurrentNamespace( this.props.namespace._id, this.props.history );\r\n\t};\r\n\r\n\tclose = () => {\r\n\t\tthis.setState({\r\n\t\t\tshowModal: false\r\n\t\t});\r\n\t};\r\n\r\n\tcloseDeleteModal = () => {\r\n\t\tthis.setState({\r\n\t\t\tshowDeleteModal: false\r\n\t\t});\r\n\t};\r\n\r\n\tcloseCreateCohortModal = () => {\r\n\t\tthis.setState({\r\n\t\t\tshowCreateCohortModal: false\r\n\t\t});\r\n\t};\r\n\r\n\tcloseImportModal = () => {\r\n\t\tthis.setState({\r\n\t\t\tshowImportModal: false\r\n\t\t});\r\n\t};\r\n\r\n\tcreateCohort = ( cohort ) => {\r\n\t\tcohort.namespaceID = this.props.namespace._id;\r\n\t\tthis.props.createCohort( cohort, this.props.namespace._id );\r\n\t\tthis.closeCreateCohortModal();\r\n\t};\r\n\r\n\tdeleteCohort = ( cohortID ) => {\r\n\t\tthis.props.deleteCohort( cohortID, this.props.namespace._id );\r\n\t};\r\n\r\n\tupdateCohort = ( cohort ) => {\r\n\t\tthis.props.updateCohort( cohort, this.props.namespace._id );\r\n\t};\r\n\r\n\thandleOwnerChange = ( newValue ) => {\r\n\t\tif ( !newValue ) {\r\n\t\t\treturn this.setState({\r\n\t\t\t\towners: []\r\n\t\t\t});\r\n\t\t}\r\n\t\tconst owners = newValue.map( x => trim( x.value ) );\r\n\t\tthis.setState({\r\n\t\t\towners: owners\r\n\t\t});\r\n\t};\r\n\r\n\tcloseEditCohortModal = () => {\r\n\t\tthis.setState({\r\n\t\t\tselectedCohort: null,\r\n\t\t\tshowEditCohortModal: false\r\n\t\t});\r\n\t};\r\n\r\n\tcohortModalFactory = ( idx ) => {\r\n\t\treturn () => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tselectedCohort: this.props.cohorts[ idx ],\r\n\t\t\t\tshowEditCohortModal: true\r\n\t\t\t});\r\n\t\t};\r\n\t};\r\n\r\n\trenderModals() {\r\n\t\tconst { t } = this.props;\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<MsgModal\r\n\t\t\t\t\tshow={this.state.showModal}\r\n\t\t\t\t\tclose={this.close}\r\n\t\t\t\t\tmessage={this.state.message}\r\n\t\t\t\t\tsuccessful={this.state.successful}\r\n\t\t\t\t\ttitle={t('update-course')}\r\n\t\t\t\t/>\r\n\t\t\t\t<ConfirmModal\r\n\t\t\t\t\tshow={this.state.showDeleteModal}\r\n\t\t\t\t\tclose={this.closeDeleteModal}\r\n\t\t\t\t\tmessage={t('delete-course')}\r\n\t\t\t\t\ttitle={`${t('delete')}?`}\r\n\t\t\t\t\tonConfirm={this.handleDelete}\r\n\t\t\t\t/>\r\n\t\t\t\t{ this.state.showCreateCohortModal ? <CreateCohortModal\r\n\t\t\t\t\tshow={this.state.showCreateCohortModal}\r\n\t\t\t\t\tclose={this.closeCreateCohortModal}\r\n\t\t\t\t\tonCreate={this.createCohort}\r\n\t\t\t\t\tt={this.props.t}\r\n\t\t\t\t/> : null }\r\n\t\t\t\t{ this.state.showImportModal ? <ImportCourseModal\r\n\t\t\t\t\tshow={this.state.showImportModal}\r\n\t\t\t\t\tclose={this.closeImportModal}\r\n\t\t\t\t\tnamespaces={this.props.user.ownedNamespaces}\r\n\t\t\t\t\ttargetNamespace={this.props.namespace}\r\n\t\t\t\t\tcopyNamespaceLessons={this.props.copyNamespaceLessons}\r\n\t\t\t\t\tt={this.props.t}\r\n\t\t\t\t/> : null }\r\n\t\t\t\t{ this.state.showEditCohortModal ? <EditCohortModal\r\n\t\t\t\t\tshow={this.state.showEditCohortModal}\r\n\t\t\t\t\t{...this.state.selectedCohort}\r\n\t\t\t\t\tonDelete={this.deleteCohort}\r\n\t\t\t\t\tonHide={this.closeEditCohortModal}\r\n\t\t\t\t\tonUpdate={this.updateCohort}\r\n\t\t\t\t\tt={this.props.t}\r\n\t\t\t\t/> : null }\r\n\t\t\t</Fragment>\r\n\t\t);\r\n\t}\r\n\r\n\trenderCohortList() {\r\n\t\tconst { t } = this.props;\r\n\t\treturn ( <ListGroup>\r\n\t\t\t{this.props.cohorts.map( ( cohort, idx ) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<ListGroupItem\r\n\t\t\t\t\t\tvariant=\"light\"\r\n\t\t\t\t\t\teventKey={idx}\r\n\t\t\t\t\t\tkey={idx}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tbackgroundColor: 'white'\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<label>{cohort.title}</label>\r\n\t\t\t\t\t\t<span style={{ marginLeft: 5, color: 'black' }} >\r\n\t\t\t\t\t\t\t({t('no-students')}:\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<Badge bg=\"primary\">{cohort.members.length}</Badge>\r\n\t\t\t\t\t\t<span style={{ color: 'black' }} >)</span>\r\n\t\t\t\t\t\t<Button size=\"sm\" onClick={this.cohortModalFactory( idx )} style={{ float: 'right' }}>{t('common:edit')}</Button>\r\n\t\t\t\t\t</ListGroupItem>\r\n\t\t\t\t);\r\n\t\t\t})}\r\n\t\t</ListGroup> );\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { t } = this.props;\r\n\t\tif ( !this.props.namespace._id ) {\r\n\t\t\treturn ( <Container className=\"edit-namespace-container\" >\r\n\t\t\t\t<Alert variant=\"danger\">{t('common:no-course-selected')}</Alert>\r\n\t\t\t</Container> );\r\n\t\t}\r\n\t\tconst validTitle = validateTitle( this.state.title );\r\n\t\tconst invalidTitleChars = checkURLPath( this.state.title );\r\n\t\tconst validDescription = validateDescription( this.state.description );\r\n\t\tconst validOwners = validateOwners( this.state.owners );\r\n\t\treturn (\r\n\t\t\t<Container className=\"edit-namespace-container\" >\r\n\t\t\t\t<Row>\r\n\t\t\t\t\t<Col sm={9} >\r\n\t\t\t\t\t\t<Card>\r\n\t\t\t\t\t\t\t<Tabs defaultActiveKey=\"manage-cohorts\" >\r\n\t\t\t\t\t\t\t\t<Tab eventKey=\"manage-cohorts\" title={<h3>{t('manage-cohorts')}</h3>} style={{ padding: 12 }} >\r\n\t\t\t\t\t\t\t\t\t{this.renderCohortList()}\r\n\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\t\tvariant=\"success\"\r\n\t\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\t\tmarginTop: 10, background: '#3c763d'\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowCreateCohortModal: true\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{t('create-cohort')}\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</Tab>\r\n\t\t\t\t\t\t\t\t<Tab eventKey=\"completions\" title={<h3>{t('completions')}</h3>} >\r\n\t\t\t\t\t\t\t\t\t<CompletionsPage\r\n\t\t\t\t\t\t\t\t\t\tentity={this.props.namespace}\r\n\t\t\t\t\t\t\t\t\t\tlevel=\"namespace\"\r\n\t\t\t\t\t\t\t\t\t\tcohorts={this.props.cohorts}\r\n\t\t\t\t\t\t\t\t\t\tlessonRefs={this.state.lessonRefs}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</Tab>\r\n\t\t\t\t\t\t\t\t<Tab eventKey=\"edit-course\" title={<h3>{t('edit-course')}</h3>} style={{ padding: 12 }} >\r\n\t\t\t\t\t\t\t\t\t<Form style={{ padding: '20px' }} className=\"d-grid gap-3\" >\r\n\t\t\t\t\t\t\t\t\t\t<OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"ownerTooltip\">{t('owner-tooltip')}</Tooltip>}>\r\n\t\t\t\t\t\t\t\t\t\t\t<FormGroup >\r\n\t\t\t\t\t\t\t\t\t\t\t\t<FormLabel htmlFor=\"owners-text-select\" >{t('common:owners')}</FormLabel>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<TextSelect\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"owners-text-select\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder={t('enter-emails')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.handleOwnerChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdefaultValue={this.state.owners}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tisInvalid={!validateOwners( this.state.owners )}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<FormControl.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{t('invalid-owners')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</FormControl.Feedback>\r\n\t\t\t\t\t\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t\t\t\t\t\t<OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"courseTooltip\">{t('accessible-at')}<code>{SERVER+'/<course>/<lesson>'}</code></Tooltip>}>\r\n\t\t\t\t\t\t\t\t\t\t\t<FormGroup controlId=\"form-course\" >\r\n\t\t\t\t\t\t\t\t\t\t\t\t<FormLabel>{t('course-identifier')}</FormLabel>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<FormControl\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"title\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={this.state.title}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.handleInputChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tisInvalid={!validTitle}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<FormControl.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ invalidTitleChars ?\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Course identifier contains invalid character(s): '+invalidTitleChars[ 0 ] :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Course identifier must be at least three characters long and should not contain any spaces.'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</FormControl.Feedback>\r\n\t\t\t\t\t\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t\t\t\t\t\t<OverlayTrigger placement=\"right\" overlay={<Tooltip id=\"titleTooltip\">{t('title-tooltip')}</Tooltip>}>\r\n\t\t\t\t\t\t\t\t\t\t\t<FormGroup controlId=\"form-description\" >\r\n\t\t\t\t\t\t\t\t\t\t\t\t<FormLabel>{t('title-description')}</FormLabel>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<FormControl\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"description\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={this.state.description}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.handleInputChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tisInvalid={!validDescription}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</FormControl>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<FormControl.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{t('invalid-description')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</FormControl.Feedback>\r\n\t\t\t\t\t\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t\t\t\t\t\t\t<Form.Check\r\n\t\t\t\t\t\t\t\t\t\t\taria-label={t('enable-ticketing')}\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\t\t\t\tlabel={t('enable-ticketing')}\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultChecked={this.state.enableTicketing}\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={( event) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tenableTicketing: event.target.checked\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\t\t\tdisabled={!validOwners || !validTitle || !validDescription}\r\n\t\t\t\t\t\t\t\t\t\tonClick={this.handleUpdate}\r\n\t\t\t\t\t\t\t\t\t>{t('common:update')}</Button>\r\n\t\t\t\t\t\t\t\t\t{this.renderModals()}\r\n\t\t\t\t\t\t\t\t</Tab>\r\n\t\t\t\t\t\t\t\t<Tab eventKey=\"permissions\" title={<h3>{t('permissions')}</h3>} disabled >\r\n\t\t\t\t\t\t\t\t</Tab>\r\n\t\t\t\t\t\t\t</Tabs>\r\n\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t\t<Col sm={3} >\r\n\t\t\t\t\t\t<Card>\r\n\t\t\t\t\t\t\t<Card.Body>\r\n\t\t\t\t\t\t\t\t<ButtonGroup vertical>\r\n\t\t\t\t\t\t\t\t\t<Button onClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\t\t\t\t\tshowImportModal: true\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}} variant=\"outline-danger\" >{t('import-existing-course')}</Button>\r\n\t\t\t\t\t\t\t\t\t<Button onClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\t\t\t\t\tshowDeleteModal: true\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}} variant=\"outline-danger\">{t('delete-namespace')}</Button>\r\n\t\t\t\t\t\t\t\t</ButtonGroup>\r\n\t\t\t\t\t\t\t</Card.Body>\r\n\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t</Container>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\n// PROPERTIES //\r\n\r\nEditNamespace.propTypes = {\r\n\taddNotification: PropTypes.func.isRequired,\r\n\tcohorts: PropTypes.array,\r\n\tcopyNamespaceLessons: PropTypes.func.isRequired,\r\n\tcreateCohort: PropTypes.func.isRequired,\r\n\tdeleteCohort: PropTypes.func.isRequired,\r\n\tdeleteCurrentNamespace: PropTypes.func.isRequired,\r\n\thistory: PropTypes.object.isRequired,\r\n\tnamespace: PropTypes.object.isRequired,\r\n\tt: PropTypes.func.isRequired,\r\n\tupdateCohort: PropTypes.func.isRequired,\r\n\tupdateCurrentNamespace: PropTypes.func.isRequired,\r\n\tuser: PropTypes.object.isRequired\r\n};\r\n\r\nEditNamespace.defaultProps = {\r\n\tcohorts: []\r\n};\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default withTranslation( [ 'namespace', 'common' ] )( EditNamespace );\r\n","/**\r\n* Copyright (C) 2016-present The ISLE Authors\r\n*\r\n* The isle-dashboard program is free software: you can redistribute it and/or modify\r\n* it under the terms of the GNU Affero General Public License as\r\n* published by the Free Software Foundation, either version 3 of the\r\n* License, or (at your option) any later version.\r\n*\r\n* This program is distributed in the hope that it will be useful,\r\n* but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n* GNU Affero General Public License for more details.\r\n*\r\n* You should have received a copy of the GNU Affero General Public License\r\n* along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n*/\r\n\r\n// MODULES //\r\n\r\nimport React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport EditNamespace from 'components/edit-namespace';\r\nimport { createCohortInjector, deleteCohortInjector, updateCohortInjector } from 'actions/cohort';\r\nimport { deleteCurrentNamespaceInjector, updateCurrentNamespaceInjector } from 'actions/namespace';\r\nimport { addNotificationInjector } from 'actions/notification';\r\nimport { copyNamespaceLessonsInjector } from 'actions/lesson';\r\n\r\n\r\n// FUNCTIONS //\r\n\r\nfunction mapStateToProps( state ) {\r\n\treturn {\r\n\t\tuser: state.user,\r\n\t\tnamespace: state.namespace,\r\n\t\tcohorts: state.namespace.cohorts\r\n\t};\r\n}\r\n\r\nfunction mapDispatchToProps( dispatch ) {\r\n\treturn {\r\n\t\taddNotification: addNotificationInjector( dispatch ),\r\n\t\tcreateCohort: createCohortInjector( dispatch ),\r\n\t\tdeleteCohort: deleteCohortInjector( dispatch ),\r\n\t\tupdateCohort: updateCohortInjector( dispatch ),\r\n\t\tdeleteCurrentNamespace: deleteCurrentNamespaceInjector( dispatch ),\r\n\t\tupdateCurrentNamespace: updateCurrentNamespaceInjector( dispatch ),\r\n\t\tcopyNamespaceLessons: copyNamespaceLessonsInjector( dispatch )\r\n\t};\r\n}\r\n\r\n\r\n// MAIN //\r\n\r\nconst VisibleEditNamespace = connect( mapStateToProps, mapDispatchToProps )( EditNamespace );\r\n\r\n\r\n// EXPORTS //\r\n\r\nexport default VisibleEditNamespace;\r\n"],"sourceRoot":""}